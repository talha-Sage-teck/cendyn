"use strict";(self.webpackChunkcustomExt=self.webpackChunkcustomExt||[]).push([["extensions_custom_ext_app_src_extension_extension_module_ts"],{6381:(U,L,e)=>{e(2445),e(7255),e(6660),e(4468),e(1090)},2523:(U,L,e)=>{e(1180),e(2343),e(273),e(9764),e(4468),e(1090),e(8383),e(6381)},3015:(U,L,e)=>{e.d(L,{n:()=>n});var M=e(1090),_=e(2594),O=e(8383),A=e(9764),p=e(4468);let n=(()=>{class o{}return o.\u0275fac=function(T){return new(T||o)},o.\u0275mod=p.\u0275\u0275defineNgModule({type:o}),o.\u0275inj=p.\u0275\u0275defineInjector({imports:[[M.CommonModule,_.AngularSvgIconModule,O.CdkTableModule,A.FieldModule,A.SortButtonModule,A.LineActionModule,A.LoadingSpinnerModule,A.LabelModule]]}),o})()},8906:(U,L,e)=>{e(4468),e(1090),e(2523),e(9764)},5770:(U,L,e)=>{e.d(L,{o:()=>d});var M=e(1090),_=e(2594),O=e(9764),A=e(3015),v=e(4468);let d=(()=>{class n{}return n.\u0275fac=function(P){return new(P||n)},n.\u0275mod=v.\u0275\u0275defineNgModule({type:n}),n.\u0275inj=v.\u0275\u0275defineInjector({imports:[[M.CommonModule,O.TableHeaderModule,A.n,O.TableFooterModule,_.AngularSvgIconModule]]}),n})()},9139:(U,L,e)=>{e.d(L,{Y:()=>I});var M=e(7255),_=e(4562),O=e(1180),A=e(2343),p=e(9764),n=e(4468),P=e(1090);function m(c,u){1&c&&(n.\u0275\u0275elementContainerStart(0),n.\u0275\u0275element(1,"scrm-label",3),n.\u0275\u0275elementContainerEnd())}function S(c,u){if(1&c&&n.\u0275\u0275element(0,"scrm-list-filter",8),2&c){const f=n.\u0275\u0275nextContext(2);n.\u0275\u0275property("config",f.filterConfig)}}function W(c,u){1&c&&n.\u0275\u0275element(0,"scrm-loading-spinner",11),2&c&&n.\u0275\u0275property("overlay",!0)}function F(c,u){if(1&c&&(n.\u0275\u0275elementContainerStart(0),n.\u0275\u0275template(1,W,1,1,"scrm-loading-spinner",10),n.\u0275\u0275elementContainerEnd()),2&c){const f=u.ngIf;n.\u0275\u0275advance(1),n.\u0275\u0275property("ngIf",f)}}function E(c,u){if(1&c&&(n.\u0275\u0275elementContainerStart(0),n.\u0275\u0275elementStart(1,"div"),n.\u0275\u0275elementStart(2,"div",4),n.\u0275\u0275elementStart(3,"div",5),n.\u0275\u0275elementStart(4,"div",6),n.\u0275\u0275template(5,S,1,1,"scrm-list-filter",7),n.\u0275\u0275elementEnd(),n.\u0275\u0275elementEnd(),n.\u0275\u0275elementStart(6,"div",5),n.\u0275\u0275elementStart(7,"div",6),n.\u0275\u0275elementStart(8,"scrm-button",8),n.\u0275\u0275text(9,"Select"),n.\u0275\u0275elementEnd(),n.\u0275\u0275elementEnd(),n.\u0275\u0275elementEnd(),n.\u0275\u0275elementStart(10,"div",9),n.\u0275\u0275elementStart(11,"div",6),n.\u0275\u0275element(12,"scrm-table",8),n.\u0275\u0275elementEnd(),n.\u0275\u0275elementEnd(),n.\u0275\u0275elementEnd(),n.\u0275\u0275template(13,F,2,1,"ng-container",2),n.\u0275\u0275pipe(14,"async"),n.\u0275\u0275elementEnd(),n.\u0275\u0275elementContainerEnd()),2&c){const f=n.\u0275\u0275nextContext();n.\u0275\u0275advance(5),n.\u0275\u0275property("ngIf",f.filterConfig),n.\u0275\u0275advance(3),n.\u0275\u0275property("config",f.selectButton),n.\u0275\u0275advance(4),n.\u0275\u0275property("config",f.tableConfig),n.\u0275\u0275advance(1),n.\u0275\u0275property("ngIf",n.\u0275\u0275pipeBind1(14,4,f.loading$))}}let I=(()=>{class c{constructor(f,s,h,R){this.activeModal=f,this.storeFactory=s,this.languages=h,this.maxColumnCalculator=R,this.titleKey="",this.adapter=null,this.filterAdapter=null,this.select=!1,this.subs=[],this.store=this.storeFactory.create()}ngOnInit(){this.closeButton={klass:["btn","btn-outline-light","btn-sm"],onClick:()=>{this.activeModal.close({type:"close-button"})}},this.selectButton={klass:["btn","btn-outline-dark","btn-sm"],onClick:()=>{this.subs.push(this.store.recordList.selection$.pipe((0,A.distinctUntilChanged)()).subscribe(f=>{!f||!f.selected||Object.keys(f.selected).length<1||this.activeModal.close({selection:f,records:this.store.recordList.records})}))}},this.init()}ngOnDestroy(){this.subs.forEach(f=>f.unsubscribe())}init(){!this.module||(this.initStore(),this.initTableAdapter(),this.initFilterAdapters())}getMaxColumns(){return this.maxColumnCalculator.getMaxColumns((0,O.of)(!0))}initTableAdapter(){null===this.adapter&&(this.adapter=new p.ModalRecordListTableAdapter),this.tableConfig=this.adapter.getTable(this.store,!0),this.tableConfig.maxColumns$=this.getMaxColumns(),this.tableConfig.selection=this.store.recordList,this.tableConfig.selection$=this.store.recordList.selection$}initFilterAdapters(){null===this.filterAdapter&&(this.filterAdapter=new p.ModalRecordFilterAdapter),this.filterConfig=this.filterAdapter.getConfig(this.store)}initStore(){var f;this.store.init(this.module,null!==(f=this.parentModule)&&void 0!==f?f:""),this.loading$=this.store.metadataLoading$}}return c.\u0275fac=function(f){return new(f||c)(n.\u0275\u0275directiveInject(M.NgbActiveModal),n.\u0275\u0275directiveInject(p.RecordListModalStoreFactory),n.\u0275\u0275directiveInject(p.LanguageStore),n.\u0275\u0275directiveInject(p.MaxColumnsCalculator))},c.\u0275cmp=n.\u0275\u0275defineComponent({type:c,selectors:[["scrm-multiselect-record-list-modal"]],inputs:{titleKey:"titleKey",module:"module",parentModule:"parentModule",adapter:"adapter",filterAdapter:"filterAdapter"},features:[n.\u0275\u0275ProvidersFeature([p.MaxColumnsCalculator])],decls:4,vars:5,consts:[["bodyKlass","m-0 small-font","footerKlass","border-0","headerKlass","border-0","klass","record-list-modal",3,"closable","close","title"],["modal-body",""],[4,"ngIf"],["labelKey","LBL_CONFIG_NO_CONFIG"],[1,"container-fluid"],[1,"row","pb-3"],[1,"col"],[3,"config",4,"ngIf"],[3,"config"],[1,"row"],[3,"overlay",4,"ngIf"],[3,"overlay"]],template:function(f,s){1&f&&(n.\u0275\u0275elementStart(0,"scrm-modal",0),n.\u0275\u0275elementStart(1,"div",1),n.\u0275\u0275template(2,m,2,0,"ng-container",2),n.\u0275\u0275template(3,E,15,6,"ng-container",2),n.\u0275\u0275elementEnd(),n.\u0275\u0275elementEnd()),2&f&&(n.\u0275\u0275property("closable",!0)("close",s.closeButton)("title",s.titleKey),n.\u0275\u0275advance(2),n.\u0275\u0275property("ngIf",!s.tableConfig),n.\u0275\u0275advance(1),n.\u0275\u0275property("ngIf",s.tableConfig))},directives:[p.ModalComponent,P.NgIf,p.LabelComponent,p.ButtonComponent,p.TableComponent,p.ListFilterComponent,p.LoadingSpinnerComponent],pipes:[P.AsyncPipe],encapsulation:2,data:{animation:[(0,_.trigger)("modalFade",[(0,_.transition)("void <=> *",[(0,_.animate)("800ms")])])]}}),c})()},3885:(U,L,e)=>{e.d(L,{Q:()=>A});var M=e(1090),_=e(9764),O=e(4468);let A=(()=>{class v{}return v.\u0275fac=function(d){return new(d||v)},v.\u0275mod=O.\u0275\u0275defineNgModule({type:v}),v.\u0275inj=O.\u0275\u0275defineInjector({imports:[[M.CommonModule,_.ModalModule,_.TableModule,_.LabelModule,_.LoadingSpinnerModule,_.ListFilterModule,_.ButtonModule]]}),v})()},7190:(U,L,e)=>{e.d(L,{x:()=>A});var M=e(9764),_=e(2343),O=e(4468);let A=(()=>{class v extends M.BaseWidgetComponent{constructor(d,n,o,P){super(),this.listStoreFactory=d,this.meta=n,this.language=o,this.fieldManager=P,this.loading=!1,this.maxHeight=400,this.module="accounts",this.noData=!0,this.subs=[],this.recordList=d.create()}ngOnInit(){!this.context$||(this.recordList.init(this.module,!1),this.recordList.setPageSize(20),this.initRecordSubscription(),this.initLoading(),this.loading=!0,this.meta.getMetadata(this.module).pipe((0,_.take)(1),(0,_.shareReplay)()).subscribe(d=>{this.loading=!1,this.initFieldDefinitions(d),this.initLoadDataSubscription()}))}ngOnDestroy(){}getHeaderLabel(){return this.language.getFieldLabel("LBL_MODULE_NAME","accounts")||""}allLoaded(){const d=this.recordList.getPagination();return!!d&&d.pageSize>=d.total}getLoadMoreButton(){return{klass:"load-more-button btn btn-link btn-sm",labelKey:"LBL_LOAD_MORE",onClick:()=>{this.loadMore()}}}initField(d,n){var o;if(!d||!n)return null;if(n.fields&&n.fields[d])return n.fields[d];const P=null!==(o=null==this?void 0:this.fieldDefs[d])&&void 0!==o?o:null;return P?this.fieldManager.addField(n,P):null}initRecordSubscription(){this.subs.push(this.recordList.records$.subscribe(d=>{this.records=d}))}initLoading(){this.subs.push(this.recordList.loading$.subscribe(d=>{this.loading=!0===d}))}updateSearchCriteria(){this.recordList.updateSearchCriteria({filters:{},orderBy:"DESC",sortOrder:"",searchModule:this.module})}initLoadDataSubscription(){this.subs.push(this.context$.subscribe(d=>{this.context=d,this.loadData()}))}loadData(){this.updateSearchCriteria(),this.recordList.load().pipe((0,_.take)(1)).subscribe()}initFieldDefinitions(d){var n,o;const P=null!==(o=null===(n=null==d?void 0:d.listView)||void 0===n?void 0:n.fields)&&void 0!==o?o:[];this.fieldDefs=[],P.forEach(T=>{!T||!T.name||(this.fieldDefs[T.name]=T)})}loadMore(d=10){let P=(this.recordList.getPagination().pageSize||0)+d;this.recordList.setPageSize(P),this.recordList.updatePagination(0)}}return v.\u0275fac=function(d){return new(d||v)(O.\u0275\u0275directiveInject(M.RecordListStoreFactory),O.\u0275\u0275directiveInject(M.MetadataStore),O.\u0275\u0275directiveInject(M.LanguageStore),O.\u0275\u0275directiveInject(M.FieldManager))},v.\u0275cmp=O.\u0275\u0275defineComponent({type:v,selectors:[["scrm-account-tree-sidebar-widget"]],features:[O.\u0275\u0275InheritDefinitionFeature],decls:2,vars:1,consts:[[3,"title"],["widget-body","",1,"account-tree-sidebar-widget"]],template:function(d,n){1&d&&(O.\u0275\u0275elementStart(0,"scrm-widget-panel",0),O.\u0275\u0275element(1,"div",1),O.\u0275\u0275elementEnd()),2&d&&O.\u0275\u0275property("title","Account Tree Widget")},directives:[M.WidgetPanelComponent],encapsulation:2}),v})()},3825:(U,L,e)=>{e.d(L,{q:()=>A});var M=e(1090),_=e(9764),O=e(4468);let A=(()=>{class v{}return v.\u0275fac=function(d){return new(d||v)},v.\u0275mod=O.\u0275\u0275defineNgModule({type:v}),v.\u0275inj=O.\u0275\u0275defineInjector({imports:[[M.CommonModule,_.LoadingSpinnerModule,_.WidgetPanelModule]]}),v})()},9605:(U,L,e)=>{e.d(L,{Yn:()=>m.Y}),e(1400),e(4738),e(6707),e(7094),e(8906),e(5770),e(2523),e(3015),e(6381),e(6660),e(6511),e(9878),e(6400),e(8302);var m=e(9139);e(3885),e(6357),e(4190),e(9827),e(6829),e(3827),e(1643),e(2894),e(166),e(9150)},181:(U,L,e)=>{e.r(L),e.d(L,{ExtensionModule:()=>i});var M=e(1090),_=e(9764),O=e(2445),A=e(3825),v=e(7190),p=e(4738),d=e(7094),n=e(5770),o=e(3015),P=e(8302),T=e(4190),m=e(6829),S=e(1643),W=e(3885),F=e(6357),E=e(9827),I=e(3827),c=e(2894),u=e(166),f=e(273),h=e(9150),R=e(4468);let i=(()=>{class a{constructor(g,l,y){this.fieldRegistry=g,this.sidebarWidgetRegistry=l,this.recordMapperRegistry=y,g.register("default","multirelate","list",E.D),g.register("default","multirelate","detail",E.D),g.register("default","multirelate","edit",F.P),g.register("default","multirelate","filter",I.b),g.register("default","relate","edit",c.H),l.register("default","account-tree",v.x),y.register("default","multirelate",new h.M)}init(){}}return a.\u0275fac=function(g){return new(g||a)(R.\u0275\u0275inject(_.FieldRegistry),R.\u0275\u0275inject(_.SidebarWidgetRegistry),R.\u0275\u0275inject(f.RecordMapperRegistry))},a.\u0275mod=R.\u0275\u0275defineNgModule({type:a}),a.\u0275inj=R.\u0275\u0275defineInjector({providers:[],imports:[[M.CommonModule,O.HttpClientModule,A.q,d.d,p.G,o.n,n.o,P.q,T.E,m.h,S.v,W.Q,u.U]]}),a})()},9827:(U,L,e)=>{e.d(L,{D:()=>n});var M=e(4762),b=e(2445),K=e(9764),C=e(4468),v=e(1090);function d(o,P){if(1&o&&(C.\u0275\u0275elementStart(0,"li"),C.\u0275\u0275elementStart(1,"a",2),C.\u0275\u0275text(2),C.\u0275\u0275elementEnd(),C.\u0275\u0275elementEnd()),2&o){const T=P.$implicit,m=C.\u0275\u0275nextContext();C.\u0275\u0275advance(1),C.\u0275\u0275propertyInterpolate2("href","#/",m.field.definition.module,"/record/",T.id,"",C.\u0275\u0275sanitizeUrl),C.\u0275\u0275advance(1),C.\u0275\u0275textInterpolate(T.name)}}let n=(()=>{class o extends K.BaseFieldComponent{constructor(T,m,S){super(m,S),this.http=T,this.typeFormatter=m,this.logic=S,this.fieldsArr=[],this.getMultiRelatedIds=()=>(0,M.mG)(this,void 0,void 0,function*(){let W=new b.HttpHeaders;return W.set("Content-Type","application/json; charset=utf-8"),yield new Promise((F,E)=>{this.http.get(location.origin+location.pathname+"legacy/index.php?entryPoint=getMultiRelatedIds&id="+this.record.id+"&module="+this.record.module+"&field="+this.field.definition.name,{headers:W,responseType:"text"}).subscribe(I=>{F(I)},I=>{E(I)})})})}ngOnInit(){(()=>{(0,M.mG)(this,void 0,void 0,function*(){let T=(yield this.getMultiRelatedIds()).split(", "),m=this.field.value.split(", ");for(let S=0;S<T.length;++S)this.fieldsArr.push({id:T[S],name:m[S]})})})(),super.ngOnInit()}}return o.\u0275fac=function(T){return new(T||o)(C.\u0275\u0275directiveInject(b.HttpClient),C.\u0275\u0275directiveInject(K.DataTypeFormatter),C.\u0275\u0275directiveInject(K.FieldLogicManager))},o.\u0275cmp=C.\u0275\u0275defineComponent({type:o,selectors:[["scrm-multirelate-detail"]],features:[C.\u0275\u0275InheritDefinitionFeature],decls:2,vars:1,consts:[[2,"list-style-type","none"],[4,"ngFor","ngForOf"],[3,"href"]],template:function(T,m){1&T&&(C.\u0275\u0275elementStart(0,"ul",0),C.\u0275\u0275template(1,d,3,3,"li",1),C.\u0275\u0275elementEnd()),2&T&&(C.\u0275\u0275advance(1),C.\u0275\u0275property("ngForOf",m.fieldsArr))},directives:[v.NgForOf],encapsulation:2}),o})()},6829:(U,L,e)=>{e.d(L,{h:()=>O});var M=e(1090),_=e(4468);let O=(()=>{class C{}return C.\u0275fac=function(v){return new(v||C)},C.\u0275mod=_.\u0275\u0275defineNgModule({type:C}),C.\u0275inj=_.\u0275\u0275defineInjector({imports:[[M.CommonModule]]}),C})()},6357:(U,L,e)=>{e.d(L,{P:()=>s});var M=e(4762),b=e(3227),K=e(273),C=e(7255),v=e(1180),d=e(2445),o=e(9764),T=e(9605),m=e(4468),W=e(1090),E=e(5864);const c=["tag"];function u(h,R){if(1&h){const t=m.\u0275\u0275getCurrentView();m.\u0275\u0275elementContainerStart(0),m.\u0275\u0275elementStart(1,"div",3),m.\u0275\u0275elementStart(2,"tag-input",4,5),m.\u0275\u0275listener("keyup.enter",function(){return m.\u0275\u0275restoreView(t),m.\u0275\u0275nextContext().selectFirstElement()})("onAdd",function(a){return m.\u0275\u0275restoreView(t),m.\u0275\u0275nextContext().onAdd(a)})("onBlur",function(){return m.\u0275\u0275restoreView(t),m.\u0275\u0275nextContext().resetStatus()})("onRemove",function(a){return m.\u0275\u0275restoreView(t),m.\u0275\u0275nextContext().onRemove(a)})("ngModelChange",function(a){return m.\u0275\u0275restoreView(t),m.\u0275\u0275nextContext().selectedValues=a}),m.\u0275\u0275element(4,"tag-input-dropdown",6),m.\u0275\u0275elementEnd(),m.\u0275\u0275elementEnd(),m.\u0275\u0275elementStart(5,"div",7),m.\u0275\u0275element(6,"scrm-button",8),m.\u0275\u0275elementEnd(),m.\u0275\u0275elementContainerEnd()}if(2&h){const t=m.\u0275\u0275nextContext();m.\u0275\u0275advance(2),m.\u0275\u0275classMap(t.getInvalidClass()),m.\u0275\u0275property("identifyBy","id")("ngModel",t.selectedValues)("clearOnBlur",!0)("displayBy",t.getRelateFieldName())("inputClass",t.getInvalidClass())("onTextChangeDebounce",500)("onlyFromAutocomplete",!0)("placeholder",t.getPlaceholderLabel())("secondaryPlaceholder",t.getPlaceholderLabel()),m.\u0275\u0275advance(2),m.\u0275\u0275property("autocompleteObservable",t.search)("identifyBy","id")("displayBy",t.getRelateFieldName())("keepOpen",!1)("showDropdownIfEmpty",!0),m.\u0275\u0275advance(2),m.\u0275\u0275property("config",t.selectButton)}}function f(h,R){if(1&h&&(m.\u0275\u0275elementStart(0,"small",9),m.\u0275\u0275element(1,"scrm-label",10),m.\u0275\u0275elementEnd()),2&h){const t=m.\u0275\u0275nextContext();m.\u0275\u0275advance(1),m.\u0275\u0275property("labelKey",t.getMessage())("module",t.module)}}let s=(()=>{class h extends o.BaseRelateComponent{constructor(t,i,a,r,g,l,y){super(i,a,r,g,y),this.http=t,this.languages=i,this.typeFormatter=a,this.relateService=r,this.moduleNameMapper=g,this.modalService=l,this.logic=y,this.getMultiRelatedIds=()=>(0,M.mG)(this,void 0,void 0,function*(){let D=new d.HttpHeaders;return D.set("Content-Type","application/json; charset=utf-8"),yield new Promise((x,B)=>{this.http.get(location.origin+location.pathname+"legacy/index.php?entryPoint=getMultiRelatedIds&id="+this.record.id+"&module="+this.record.module+"&field="+this.field.definition.name,{headers:D,responseType:"text"}).subscribe(j=>{x(j)},j=>{B(j)})})}),this.selectButton={klass:["btn","btn-sm","btn-outline-secondary","select-button","m-0"],onClick:()=>{this.showSelectModal()},icon:"cursor"}}ngOnInit(){super.ngOnInit(),(()=>{(0,M.mG)(this,void 0,void 0,function*(){if(!this.field.valueList){this.field.valueList||(this.field.valueList=[]),this.field.valueObjectArray||(this.field.valueObjectArray=[]);const t=this.field.value&&this.field.criteria&&this.field.criteria.values||[];t.length>0&&(this.field.valueList=t,this.selectedTags=t);const i=this.field&&this.field.valueObjectArray||[];if(this.field.value&&void 0!==this.field.value){let a=(yield this.getMultiRelatedIds()).split(", "),r=this.field.value.split(", ");for(let g=0;g<a.length;++g)i.push({id:a[g],name:r[g]}),this.field.valueList.push(r[g])}i.length>0&&(this.field.valueObjectArray=(0,K.deepClone)(i),this.selectedTags=(0,K.deepClone)(i)),this.init()}})})()}init(){super.init(),this.initValue();const t=this.getRelateIdField();t&&this.record&&this.record.fields&&this.record.fields[t]&&(this.idField=this.record.fields[t])}initValue(){this.field.valueObjectArray?(this.selectedValues=[],this.field.valueObjectArray.forEach(t=>{""!==t.id.trim()&&this.selectedValues.push(t)})):this.selectedValues=[]}onAdd(t){t&&this.setValue(t)}onRemove(t){var i,a;const r=null!==(i=t.id)&&void 0!==i?i:"",g=null!==(a=t.name)&&void 0!==a?a:"";this.field.valueList=this.field.valueList.filter(l=>l!==g),this.field.valueObjectArray=this.field.valueObjectArray.filter(l=>l.id!==r),this.idField&&r&&(this.idField.valueList=this.idField.valueList.filter(l=>l!==r)),setTimeout(()=>{this.tag.focus(!0,!0)},200)}setValue(t){const i=this.getRelateFieldName(),a=t.id,r=t[i];if(this.idField&&this.idField.valueList.includes(a)||!this.idField&&this.field.valueList.includes(r))return;this.field.valueList.push(r);const g=this.buildRelate(a,r);this.field.valueObjectArray.push(g),this.idField&&this.idField.valueList.push(a),this.field.formControl.setValue(this.field.valueObjectArray),this.field.formControl.markAsDirty()}onAdding(t){if(!t||this.idField&&this.idField.valueList.includes(t.id))return v.EMPTY;const i=this.getRelateFieldName();return!this.idField&&this.field.valueList.includes(t[i])?v.EMPTY:(0,v.of)(t)}showSelectModal(){const t=this.modalService.open(T.Yn,{size:"xl",scrollable:!0});t.componentInstance.module=this.getRelatedModule(),t.result.then(i=>{i&&i.selection&&i.selection.selected&&this.getSelectedRecord(i).forEach(r=>this.setItem(r))})}getSelectedRecord(t){let i=[];Object.keys(t.selection.selected).forEach(r=>{i.push(r)});let a=[];return t.records.forEach(r=>{r&&i.includes(r.id)&&a.push(r)}),a}setItem(t){this.field.valueList.includes(t.attributes[this.getRelateFieldName()])||(this.tag.appendTag(t.attributes),this.onAdd(t.attributes))}selectFirstElement(){const t=this.tag.dropdown.items;if(0!==t.length){const i=t[0];this.tag.appendTag(i),this.onAdd(i),this.tag.dropdown.hide()}}}return h.\u0275fac=function(t){return new(t||h)(m.\u0275\u0275directiveInject(d.HttpClient),m.\u0275\u0275directiveInject(o.LanguageStore),m.\u0275\u0275directiveInject(o.DataTypeFormatter),m.\u0275\u0275directiveInject(o.RelateService),m.\u0275\u0275directiveInject(o.ModuleNameMapper),m.\u0275\u0275directiveInject(C.NgbModal),m.\u0275\u0275directiveInject(o.FieldLogicManager))},h.\u0275cmp=m.\u0275\u0275defineComponent({type:h,selectors:[["scrm-multirelate-edit"]],viewQuery:function(t,i){if(1&t&&m.\u0275\u0275viewQuery(c,5),2&t){let a;m.\u0275\u0275queryRefresh(a=m.\u0275\u0275loadQuery())&&(i.tag=a.first)}},features:[m.\u0275\u0275ProvidersFeature([o.RelateService]),m.\u0275\u0275InheritDefinitionFeature],decls:3,vars:2,consts:[[1,"d-flex"],[4,"ngIf"],["class","text-danger form-text text-muted",4,"ngIf"],[1,"flex-grow-1"],[3,"identifyBy","ngModel","clearOnBlur","displayBy","inputClass","onTextChangeDebounce","onlyFromAutocomplete","placeholder","secondaryPlaceholder","keyup.enter","onAdd","onBlur","onRemove","ngModelChange"],["tag",""],[3,"autocompleteObservable","identifyBy","displayBy","keepOpen","showDropdownIfEmpty"],[1,"relate-btn"],[3,"config"],[1,"text-danger","form-text","text-muted"],[3,"labelKey","module"]],template:function(t,i){1&t&&(m.\u0275\u0275elementStart(0,"div",0),m.\u0275\u0275template(1,u,7,17,"ng-container",1),m.\u0275\u0275elementEnd(),m.\u0275\u0275template(2,f,2,2,"small",2)),2&t&&(m.\u0275\u0275advance(1),m.\u0275\u0275property("ngIf",i.initModule),m.\u0275\u0275advance(1),m.\u0275\u0275property("ngIf",i.getMessage()))},directives:[W.NgIf,b.TagInputComponent,E.NgControlStatus,E.NgModel,b.TagInputDropdown,o.ButtonComponent,o.LabelComponent],encapsulation:2}),h})()},4190:(U,L,e)=>{e.d(L,{E:()=>n});var M=e(1090),_=e(3227),O=e(5864),A=e(9764),p=e(4468);let n=(()=>{class o{}return o.\u0275fac=function(T){return new(T||o)},o.\u0275mod=p.\u0275\u0275defineNgModule({type:o}),o.\u0275inj=p.\u0275\u0275defineInjector({imports:[[M.CommonModule,_.TagInputModule,A.LabelModule,O.FormsModule,A.InlineLoadingSpinnerModule,A.ButtonModule,A.TableModule]]}),o})()},3827:(U,L,e)=>{e.d(L,{b:()=>E});var M=e(3227),_=e(273),O=e(7255),A=e(1180),p=e(9764),n=e(4468),P=e(5864),m=e(1090);const W=["tag"];function F(I,c){if(1&I&&(n.\u0275\u0275elementStart(0,"small",8),n.\u0275\u0275element(1,"scrm-label",9),n.\u0275\u0275elementEnd()),2&I){const u=n.\u0275\u0275nextContext();n.\u0275\u0275advance(1),n.\u0275\u0275property("labelKey",u.getMessage())("module",u.module)}}let E=(()=>{class I extends p.BaseRelateComponent{constructor(u,f,s,h,R,t){super(u,f,s,h,t),this.languages=u,this.typeFormatter=f,this.relateService=s,this.moduleNameMapper=h,this.modalService=R,this.logic=t,this.selectButton={klass:["btn","btn-sm","btn-outline-secondary","select-button","m-0"],onClick:()=>{this.showSelectModal()},icon:"cursor"}}ngOnInit(){const u=this.record;this.field.valueList=[],this.field.valueObjectArray=[];const f=this.field&&this.field.criteria&&this.field.criteria.values||[];f.length>0&&(this.field.valueList=f,this.selectedTags=f);const s=this.field&&this.field.criteria&&this.field.criteria.valueObjectArray||[];s.length>0&&(this.field.valueObjectArray=(0,_.deepClone)(s),this.selectedTags=(0,_.deepClone)(s)),super.ngOnInit();const h=this.getRelateIdField();if(h&&u&&u.criteriaFields&&u.criteriaFields[h]){this.idField=u.criteriaFields[h],this.idField.valueList=[];const R=this.idField&&this.idField.criteria&&this.idField.criteria.values||[];R.length>0&&(this.idField.valueList=(0,_.deepClone)(R))}}onAdd(u){u&&this.setValue(u)}onAdding(u){if(!u||this.idField&&this.idField.valueList.includes(u.id))return A.EMPTY;const f=this.getRelateFieldName();return!this.idField&&this.field.valueList.includes(u[f])?A.EMPTY:(0,A.of)(u)}onRemove(u){var f,s;const h=null!==(f=u.id)&&void 0!==f?f:"",R=null!==(s=u.name)&&void 0!==s?s:"";this.field.valueList=this.field.valueList.filter(t=>t!==R),this.field.valueObjectArray=this.field.valueObjectArray.filter(t=>t.id!==h),this.updateSearchCriteria(this.field),this.field.criteria.valueObjectArray=(0,_.deepClone)(this.field.valueObjectArray),this.idField&&h&&(this.idField.valueList=this.idField.valueList.filter(t=>t!==h),this.updateSearchCriteria(this.idField)),setTimeout(()=>{this.tag.focus(!0,!0)},200)}selectFirstElement(){const u=this.tag.dropdown.items;if(0!==u.length){const f=u[0];this.tag.appendTag(f),this.onAdd(f),this.tag.dropdown.hide()}}setValue(u){const f=this.getRelateFieldName(),s=u.id,h=u[f];if(this.idField&&this.idField.valueList.includes(s)||!this.idField&&this.field.valueList.includes(h))return;const R={};R.id=s,R[f]=h,this.field.valueObjectArray.push(R),this.field.valueList.push(h),this.idField&&(this.idField.valueList.push(s),this.updateSearchCriteria(this.idField)),this.updateSearchCriteria(this.field),this.field.criteria.valueObjectArray||(this.field.criteria.valueObjectArray=[]),this.field.criteria.valueObjectArray.push(R)}updateSearchCriteria(u){u.criteria.operator="=",u.criteria.values=u.valueList,u.formControl.setValue(u.valueList),u.formControl.markAsDirty()}showSelectModal(){const u=this.modalService.open(p.RecordListModalComponent,{size:"xl",scrollable:!0});u.componentInstance.module=this.getRelatedModule(),u.result.then(f=>{if(!f||!f.selection||!f.selection.selected)return;const s=this.getSelectedRecord(f);this.field.valueObjectArray.find(R=>R.id===s.id)||this.setItem(s)})}getSelectedRecord(u){let f="";Object.keys(u.selection.selected).some(h=>(f=h,!0));let s=null;return u.records.some(h=>{if(h&&h.id===f)return s=h,!0}),s}setItem(u){this.tag.appendTag(u.attributes),this.onAdd(u.attributes)}}return I.\u0275fac=function(u){return new(u||I)(n.\u0275\u0275directiveInject(p.LanguageStore),n.\u0275\u0275directiveInject(p.DataTypeFormatter),n.\u0275\u0275directiveInject(p.RelateService),n.\u0275\u0275directiveInject(p.ModuleNameMapper),n.\u0275\u0275directiveInject(O.NgbModal),n.\u0275\u0275directiveInject(p.FieldLogicManager))},I.\u0275cmp=n.\u0275\u0275defineComponent({type:I,selectors:[["scrm-multirelate-filter"]],viewQuery:function(u,f){if(1&u&&n.\u0275\u0275viewQuery(W,5),2&u){let s;n.\u0275\u0275queryRefresh(s=n.\u0275\u0275loadQuery())&&(f.tag=s.first)}},features:[n.\u0275\u0275ProvidersFeature([p.RelateService]),n.\u0275\u0275InheritDefinitionFeature],decls:8,vars:18,consts:[[1,"d-flex"],[1,"flex-grow-1"],[3,"ngModel","clearOnBlur","identifyBy","displayBy","inputClass","onTextChangeDebounce","onlyFromAutocomplete","placeholder","secondaryPlaceholder","keyup.enter","onAdd","onBlur","onRemove","ngModelChange"],["tag",""],[3,"autocompleteObservable","identifyBy","displayBy","keepOpen","showDropdownIfEmpty"],[1,"relate-btn"],[3,"config"],["class","text-danger form-text text-muted",4,"ngIf"],[1,"text-danger","form-text","text-muted"],[3,"labelKey","module"]],template:function(u,f){1&u&&(n.\u0275\u0275elementStart(0,"div",0),n.\u0275\u0275elementStart(1,"div",1),n.\u0275\u0275elementStart(2,"tag-input",2,3),n.\u0275\u0275listener("keyup.enter",function(){return f.selectFirstElement()})("onAdd",function(h){return f.onAdd(h)})("onBlur",function(){return f.resetStatus()})("onRemove",function(h){return f.onRemove(h)})("ngModelChange",function(h){return f.selectedTags=h}),n.\u0275\u0275element(4,"tag-input-dropdown",4),n.\u0275\u0275elementEnd(),n.\u0275\u0275elementEnd(),n.\u0275\u0275elementStart(5,"div",5),n.\u0275\u0275element(6,"scrm-button",6),n.\u0275\u0275elementEnd(),n.\u0275\u0275elementEnd(),n.\u0275\u0275template(7,F,2,2,"small",7)),2&u&&(n.\u0275\u0275advance(2),n.\u0275\u0275classMap(f.getInvalidClass()),n.\u0275\u0275property("ngModel",f.selectedTags)("clearOnBlur",!0)("identifyBy","id")("displayBy",f.getRelateFieldName())("inputClass",f.getInvalidClass())("onTextChangeDebounce",500)("onlyFromAutocomplete",!0)("placeholder",f.getPlaceholderLabel())("secondaryPlaceholder",f.getPlaceholderLabel()),n.\u0275\u0275advance(2),n.\u0275\u0275property("autocompleteObservable",f.search)("identifyBy","id")("displayBy",f.getRelateFieldName())("keepOpen",!1)("showDropdownIfEmpty",!0),n.\u0275\u0275advance(2),n.\u0275\u0275property("config",f.selectButton),n.\u0275\u0275advance(1),n.\u0275\u0275property("ngIf",f.getMessage()))},directives:[M.TagInputComponent,P.NgControlStatus,P.NgModel,M.TagInputDropdown,p.ButtonComponent,m.NgIf,p.LabelComponent],encapsulation:2}),I})()},1643:(U,L,e)=>{e.d(L,{v:()=>n});var M=e(1090),_=e(3227),O=e(5864),A=e(9764),p=e(4468);let n=(()=>{class o{}return o.\u0275fac=function(T){return new(T||o)},o.\u0275mod=p.\u0275\u0275defineNgModule({type:o}),o.\u0275inj=p.\u0275\u0275defineInjector({imports:[[M.CommonModule,_.TagInputModule,A.LabelModule,O.FormsModule,A.InlineLoadingSpinnerModule,A.ButtonModule,_.TagInputModule]]}),o})()},2894:(U,L,e)=>{e.d(L,{H:()=>c});var M=e(4762),b=e(3227),K=e(7255),C=e(2445),v=e(8510),d=e(9764),o=e(4468),T=e(1090),S=e(5864);const F=["tag"];function E(u,f){if(1&u){const s=o.\u0275\u0275getCurrentView();o.\u0275\u0275elementContainerStart(0),o.\u0275\u0275elementStart(1,"div",3),o.\u0275\u0275elementStart(2,"tag-input",4,5),o.\u0275\u0275listener("keyup.enter",function(){return o.\u0275\u0275restoreView(s),o.\u0275\u0275nextContext().selectFirstElement()})("onAdd",function(R){return o.\u0275\u0275restoreView(s),o.\u0275\u0275nextContext().onAdd(R)})("onBlur",function(){return o.\u0275\u0275restoreView(s),o.\u0275\u0275nextContext().resetStatus()})("onRemove",function(){return o.\u0275\u0275restoreView(s),o.\u0275\u0275nextContext().onRemove()})("ngModelChange",function(R){return o.\u0275\u0275restoreView(s),o.\u0275\u0275nextContext().selectedValues=R}),o.\u0275\u0275element(4,"tag-input-dropdown",6),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementStart(5,"div",7),o.\u0275\u0275element(6,"scrm-button",8),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementContainerEnd()}if(2&u){const s=o.\u0275\u0275nextContext();o.\u0275\u0275advance(2),o.\u0275\u0275classMap(s.getInvalidClass()),o.\u0275\u0275property("ngModel",s.selectedValues)("clearOnBlur",!0)("displayBy",s.getRelateFieldName())("inputClass",s.getInvalidClass())("onTextChangeDebounce",500)("onlyFromAutocomplete",!0)("placeholder",s.getPlaceholderLabel())("secondaryPlaceholder",s.getPlaceholderLabel()),o.\u0275\u0275advance(2),o.\u0275\u0275property("autocompleteObservable",s.search)("displayBy",s.getRelateFieldName())("keepOpen",!1)("showDropdownIfEmpty",!0),o.\u0275\u0275advance(2),o.\u0275\u0275property("config",s.selectButton)}}function I(u,f){if(1&u&&(o.\u0275\u0275elementStart(0,"small",9),o.\u0275\u0275element(1,"scrm-label",10),o.\u0275\u0275elementEnd()),2&u){const s=o.\u0275\u0275nextContext();o.\u0275\u0275advance(1),o.\u0275\u0275property("labelKey",s.getMessage())("module",s.module)}}let c=(()=>{class u extends d.BaseRelateComponent{constructor(s,h,R,t,i,a,r,g){super(R,t,i,a,g),this.http=s,this.router=h,this.languages=R,this.typeFormatter=t,this.relateService=i,this.moduleNameMapper=a,this.modalService=r,this.logic=g,this.getUnrelatedProfiles=()=>(0,M.mG)(this,void 0,void 0,function*(){let l=new C.HttpHeaders;return l.set("Content-Type","application/json; charset=utf-8"),yield new Promise((y,D)=>{this.http.get(location.origin+location.pathname+"legacy/index.php?entryPoint=checkRelatedProfilesAccounts&profileID="+this.rec,{headers:l,responseType:"text"}).subscribe(x=>{y(parseInt(x))},x=>{D(x)})})}),this.selectButton={klass:["btn","btn-sm","btn-outline-secondary","select-button","m-0"],onClick:()=>{this.showSelectModal()},icon:"cursor"}}ngOnInit(){super.ngOnInit(),(()=>{(0,M.mG)(this,void 0,void 0,function*(){let s=this.router.url.split("/");this.pModule=s[1],this.rec=s[s.length-1],this.unrelated=yield this.getUnrelatedProfiles()})})(),this.init()}init(){super.init(),this.initValue();const s=this.getRelateIdField();s&&this.record&&this.record.fields&&this.record.fields[s]&&(this.idField=this.record.fields[s])}runPMSProfilesAction(){let s=new C.HttpHeaders;s.set("Content-Type","application/json; charset=utf-8"),this.http.get(location.origin+location.pathname+"legacy/index.php?entryPoint=relateProfilesToAccount&profileID="+this.rec,{headers:s,responseType:"text"}).subscribe(h=>{},h=>console.log("Error: "+h))}initValue(){this.field.valueObject&&this.field.valueObject.id?(this.selectedValues=[],this.selectedValues.push(this.field.valueObject)):this.selectedValues=[]}onAdd(s){if(s){const h=this.getRelateFieldName();this.setValue(s.id,s[h]);let R=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/;if("accounts"===this.field.definition.module.toLowerCase()&&"cb2b_pmsprofiles"===this.module.toLowerCase()&&null!==this.rec&&""!==this.rec&&void 0!==this.rec&&R.test(this.rec)&&this.unrelated>0){const t=this.modalService.open(d.MessageModalComponent);t.componentInstance.textKey="LBL_POPUP_PROFILES",t.componentInstance.buttons=[{labelKey:"LBL_POPUP_NO",klass:["btn-secondary"],onClick:i=>{i.dismiss()}},{labelKey:"LBL_POPUP_YES",klass:["btn-main"],onClick:i=>{this.runPMSProfilesAction(),i.close()}}]}}else this.setValue("",""),this.selectedValues=[]}onRemove(){this.setValue("",""),this.selectedValues=[],setTimeout(()=>{this.tag.focus(!0,!0)},200)}setValue(s,h){const R=this.buildRelate(s,h);this.field.value=h,this.field.valueObject=R,this.field.formControl.setValue(h),this.field.formControl.markAsDirty(),this.idField&&(this.idField.value=s,this.idField.formControl.setValue(s),this.idField.formControl.markAsDirty())}showSelectModal(){const s=this.modalService.open(d.RecordListModalComponent,{size:"xl",scrollable:!0});s.componentInstance.module=this.getRelatedModule(),s.result.then(h=>{if(!h||!h.selection||!h.selection.selected)return;const R=this.getSelectedRecord(h);this.setItem(R)})}getSelectedRecord(s){let h="";Object.keys(s.selection.selected).some(t=>(h=t,!0));let R=null;return s.records.some(t=>{if(t&&t.id===h)return R=t,!0}),R}setItem(s){this.tag.writeValue([s.attributes]),this.onAdd(s.attributes)}selectFirstElement(){const s=this.tag.dropdown.items;if(0!==s.length){const h=s[0];this.selectedValues.push(h),this.onAdd(h),this.tag.dropdown.hide()}}}return u.\u0275fac=function(s){return new(s||u)(o.\u0275\u0275directiveInject(C.HttpClient),o.\u0275\u0275directiveInject(v.Router),o.\u0275\u0275directiveInject(d.LanguageStore),o.\u0275\u0275directiveInject(d.DataTypeFormatter),o.\u0275\u0275directiveInject(d.RelateService),o.\u0275\u0275directiveInject(d.ModuleNameMapper),o.\u0275\u0275directiveInject(K.NgbModal),o.\u0275\u0275directiveInject(d.FieldLogicManager))},u.\u0275cmp=o.\u0275\u0275defineComponent({type:u,selectors:[["scrm-override-relate-edit"]],viewQuery:function(s,h){if(1&s&&o.\u0275\u0275viewQuery(F,5),2&s){let R;o.\u0275\u0275queryRefresh(R=o.\u0275\u0275loadQuery())&&(h.tag=R.first)}},features:[o.\u0275\u0275ProvidersFeature([d.RelateService]),o.\u0275\u0275InheritDefinitionFeature],decls:3,vars:2,consts:[[1,"d-flex"],[4,"ngIf"],["class","text-danger form-text text-muted",4,"ngIf"],[1,"flex-grow-1"],["maxItems","1",3,"ngModel","clearOnBlur","displayBy","inputClass","onTextChangeDebounce","onlyFromAutocomplete","placeholder","secondaryPlaceholder","keyup.enter","onAdd","onBlur","onRemove","ngModelChange"],["tag",""],[3,"autocompleteObservable","displayBy","keepOpen","showDropdownIfEmpty"],[1,"relate-btn"],[3,"config"],[1,"text-danger","form-text","text-muted"],[3,"labelKey","module"]],template:function(s,h){1&s&&(o.\u0275\u0275elementStart(0,"div",0),o.\u0275\u0275template(1,E,7,15,"ng-container",1),o.\u0275\u0275elementEnd(),o.\u0275\u0275template(2,I,2,2,"small",2)),2&s&&(o.\u0275\u0275advance(1),o.\u0275\u0275property("ngIf",h.initModule),o.\u0275\u0275advance(1),o.\u0275\u0275property("ngIf",h.getMessage()))},directives:[T.NgIf,b.TagInputComponent,S.NgControlStatus,S.NgModel,b.TagInputDropdown,d.ButtonComponent,d.LabelComponent],encapsulation:2}),u})()},166:(U,L,e)=>{e.d(L,{U:()=>n});var M=e(1090),_=e(3227),O=e(5864),A=e(9764),p=e(4468);let n=(()=>{class o{}return o.\u0275fac=function(T){return new(T||o)},o.\u0275mod=p.\u0275\u0275defineNgModule({type:o}),o.\u0275inj=p.\u0275\u0275defineInjector({imports:[[M.CommonModule,_.TagInputModule,A.LabelModule,O.FormsModule,A.InlineLoadingSpinnerModule,A.ButtonModule]]}),o})()},9150:(U,L,e)=>{e.d(L,{M:()=>O}),e(273);var _=e(4468);let O=(()=>{class C{getKey(){return"multirelate"}map(v){!v.fields||!Object.keys(v.fields).length||Object.keys(v.fields).forEach(p=>{const d=v.fields[p],n=d.type||"",o=d.definition.source||"",T=d.definition.id_name||"";if("multirelate"!==n||"non-db"!==o||T!==p){if("multirelate"===n&&"non-db"===o&&""!==(d.definition.rname||"name")&&d.valueObjectArray){var m=[];return d.valueObjectArray.forEach(S=>{m.push(S.id)}),v.attributes[p]=d.valueObjectArray,void(v.attributes[T]=m.join(", "))}}else v.attributes[p]=d.value})}}return C.\u0275fac=function(v){return new(v||C)},C.\u0275prov=_.\u0275\u0275defineInjectable({token:C,factory:C.\u0275fac,providedIn:"root"}),C})()},6707:(U,L,e)=>{e(1180),e(2343),e(9764),e(4468),e(1090),e(8906)},7094:(U,L,e)=>{e.d(L,{d:()=>d});var M=e(1090),_=e(2594),O=e(9764),A=e(5770),v=e(4468);let d=(()=>{class n{}return n.\u0275fac=function(P){return new(P||n)},n.\u0275mod=v.\u0275\u0275defineNgModule({type:n}),n.\u0275inj=v.\u0275\u0275defineInjector({imports:[[M.CommonModule,A.o,O.WidgetPanelModule,_.AngularSvgIconModule,O.SidebarWidgetModule]]}),n})()},1400:(U,L,e)=>{e(9764),e(4468),e(1090),e(6707)},4738:(U,L,e)=>{e.d(L,{G:()=>d});var M=e(1090),_=e(9764),O=e(7094),C=e(8383),v=e(4468);let d=(()=>{class n{}return n.\u0275fac=function(P){return new(P||n)},n.\u0275mod=v.\u0275\u0275defineNgModule({type:n}),n.\u0275inj=v.\u0275\u0275defineInjector({imports:[[M.CommonModule,_.ListHeaderModule,O.d,_.FieldModule,C.CdkTableModule,_.ModalModule]]}),n})()},6660:(U,L,e)=>{e(7255),e(4468),e(9764),e(1090)},6511:(U,L,e)=>{e(9764),e(4468),e(1090),e(6381)},9878:(U,L,e)=>{e.d(L,{C:()=>v});var M=e(1090),_=e(9764),O=e(3015),C=e(4468);let v=(()=>{class p{}return p.\u0275fac=function(n){return new(n||p)},p.\u0275mod=C.\u0275\u0275defineNgModule({type:p}),p.\u0275inj=C.\u0275\u0275defineInjector({imports:[[M.CommonModule,_.ModuleTitleModule,_.DynamicLabelModule,_.ActionGroupMenuModule,_.FavoriteToggleModule,O.n]]}),p})()},6400:(U,L,e)=>{e(9764),e(8510),e(4468),e(1090),e(6511)},8302:(U,L,e)=>{e.d(L,{q:()=>v});var M=e(1090),_=e(9764),O=e(9878),C=e(4468);let v=(()=>{class p{}return p.\u0275fac=function(n){return new(n||p)},p.\u0275mod=C.\u0275\u0275defineNgModule({type:p}),p.\u0275inj=C.\u0275\u0275defineInjector({imports:[[M.CommonModule,_.FieldModule,_.RecordContainerModule,O.C,_.StatusBarModule,_.SubpanelModule]]}),p})()},4762:(U,L,e)=>{e.d(L,{ZT:()=>b,pi:()=>_,_T:()=>K,gn:()=>O,mG:()=>v,Jh:()=>p,ev:()=>S});var M=function(t,i){return(M=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,r){a.__proto__=r}||function(a,r){for(var g in r)Object.prototype.hasOwnProperty.call(r,g)&&(a[g]=r[g])})(t,i)};function b(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function a(){this.constructor=t}M(t,i),t.prototype=null===i?Object.create(i):(a.prototype=i.prototype,new a)}var _=function(){return(_=Object.assign||function(i){for(var a,r=1,g=arguments.length;r<g;r++)for(var l in a=arguments[r])Object.prototype.hasOwnProperty.call(a,l)&&(i[l]=a[l]);return i}).apply(this,arguments)};function K(t,i){var a={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&i.indexOf(r)<0&&(a[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var g=0;for(r=Object.getOwnPropertySymbols(t);g<r.length;g++)i.indexOf(r[g])<0&&Object.prototype.propertyIsEnumerable.call(t,r[g])&&(a[r[g]]=t[r[g]])}return a}function O(t,i,a,r){var y,g=arguments.length,l=g<3?i:null===r?r=Object.getOwnPropertyDescriptor(i,a):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(t,i,a,r);else for(var D=t.length-1;D>=0;D--)(y=t[D])&&(l=(g<3?y(l):g>3?y(i,a,l):y(i,a))||l);return g>3&&l&&Object.defineProperty(i,a,l),l}function v(t,i,a,r){return new(a||(a=Promise))(function(l,y){function D(j){try{B(r.next(j))}catch(V){y(V)}}function x(j){try{B(r.throw(j))}catch(V){y(V)}}function B(j){j.done?l(j.value):function(l){return l instanceof a?l:new a(function(y){y(l)})}(j.value).then(D,x)}B((r=r.apply(t,i||[])).next())})}function p(t,i){var r,g,l,y,a={label:0,sent:function(){if(1&l[0])throw l[1];return l[1]},trys:[],ops:[]};return y={next:D(0),throw:D(1),return:D(2)},"function"==typeof Symbol&&(y[Symbol.iterator]=function(){return this}),y;function D(B){return function(j){return function(B){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,g&&(l=2&B[0]?g.return:B[0]?g.throw||((l=g.return)&&l.call(g),0):g.next)&&!(l=l.call(g,B[1])).done)return l;switch(g=0,l&&(B=[2&B[0],l.value]),B[0]){case 0:case 1:l=B;break;case 4:return a.label++,{value:B[1],done:!1};case 5:a.label++,g=B[1],B=[0];continue;case 7:B=a.ops.pop(),a.trys.pop();continue;default:if(!(l=(l=a.trys).length>0&&l[l.length-1])&&(6===B[0]||2===B[0])){a=0;continue}if(3===B[0]&&(!l||B[1]>l[0]&&B[1]<l[3])){a.label=B[1];break}if(6===B[0]&&a.label<l[1]){a.label=l[1],l=B;break}if(l&&a.label<l[2]){a.label=l[2],a.ops.push(B);break}l[2]&&a.ops.pop(),a.trys.pop();continue}B=i.call(t,a)}catch(j){B=[6,j],g=0}finally{r=l=0}if(5&B[0])throw B[1];return{value:B[0]?B[1]:void 0,done:!0}}([B,j])}}}function S(t,i,a){if(a||2===arguments.length)for(var l,r=0,g=i.length;r<g;r++)(l||!(r in i))&&(l||(l=Array.prototype.slice.call(i,0,r)),l[r]=i[r]);return t.concat(l||Array.prototype.slice.call(i))}}}]);