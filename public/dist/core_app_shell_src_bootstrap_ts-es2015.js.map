{"version":3,"mappings":"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","names":["__proto__","Array","m","u","this","R","b","Object","apply","A","f","ee","ie","L","U","O","label","trys","next","value","C","he","ApolloCache","getFragmentDoc","wrap","getFragmentQueryDocument","prototype","batch","options","performTransaction","update","optimistic","recordOptimisticTransaction","transaction","optimisticId","transformDocument","document","identify","object","gc","modify","transformForLink","readQuery","read","__assign","rootId","id","readFragment","query","fragment","fragmentName","writeQuery","_a","data","__rest","write","assign","dataId","result","writeFragment","MissingFieldError","_super","message","path","variables","_this","call","__extends","Error","obj","__DEV__","workSet","Set","forEach","isNonNullObject","isFrozen","freeze","getOwnPropertyNames","name","add","hasOwn","hasOwnProperty","TypeOrFieldNameRegExp","storeFieldName","match","selectionSet","isArray","every","item","selectionSetMatchesResult","selections","field","isField","shouldInclude","key","resultKeyNameFromField","isReference","EntityStore","Root","DELETE","create","delModifier","INVALIDATE","policies","group","rootIds","refs","getFieldValue","objectOrReference","maybeDeepFreeze","get","__ref","canRead","objOrRef","has","toReference","objOrIdOrRef","mergeIntoStore","makeReference","ref","merge","toObject","lookup","fieldName","depend","storeObject","rootTypenamesById","Layer","parent","dependOnExistence","older","newer","existing","incoming","invariant","merged","DeepMerger","storeObjectReconciler","caching","fieldsToDirty_1","__exists","keys","fieldNameFromStoreName","hasKeyArgs","__typename","dirty","fields","changedFields_1","needToMerge_1","allDeleted_1","sharedDetails_1","readField","fieldNameOrOptions","from","store","fieldValue","newValue","storage","getStorage","delete","args","typename","getStoreFieldName","evict","evicted","clear","replace","extract","extraRootIds","getRootIdSet","push","length","__META","sort","newData","rest_1","retain","release","count","ids","snapshot","findChildRefIds","idsToRemove","root_1","found_1","root","workSet_1","child","makeCacheKey","keyMaker","lookupArray","arguments","CacheGroup","d","resetCaching","dep","Trie","canUseWeakMap","makeDepKey","entityId","supportsResultCaching","_b","resultCaching","seed","stump","Stump","storageTrie","addLayer","layerId","replay","removeLayer","ownStoreObject","parentStoreObject","equal","fromParent","p","existingObject","incomingObject","property","existingValue","incomingValue","err","context","slice","canonizeResults","StoreReader","config","knownResults","WeakMap","Map","addTypename","canon","ObjectCanon","executeSelectionSet","peekArgs","execSelectionSetKeyArgs","other","peek","admit","maybeDependOnExistenceOfEntity","enclosingRef","execSelectionSetImpl","max","resultCacheMaxSize","keyArgs","varString","executeSubSelectedArray","execSubSelectedArrayImpl","array","resetCanon","diffQueryAgainstStore","_c","returnPartialData","_d","cache","getDefaultValues","getQueryDefinition","rootRef","execResult","getMainDefinition","canonicalStringify","fragmentMap","createFragmentMap","getFragmentDefinitions","hasMissingFields","missing","complete","isFresh","latest","isKnown","empty","missingFromInvariant","InvariantError","objectsToMerge","finalResult","getMissing","rootIdsByTypename","selection","resultName","addTypenameToDocument","JSON","stringify","handleMissing","pass","pop","getFragmentFromSelection","fragmentMatches","mergeDeepArray","set","childResult","i","filter","map","values","StoreWriter","reader","writeToStore","overwrite","operationDefinition","getOperationDefinition","merger","written","incomingById","clientOnly","processSelectionSet","mergeTree","entityRef","size","applied","applyMerges","fieldsWithSelectionSets_1","childTree","Boolean","info","existingRef","incomingObj","getChild","parentType","typeDotName","warnings","childTypenames","includes","join","keyObject","sets","indexOf","incomingFields","getTypenameFromResult","resultFieldKey","wasClientOnly","directives","some","getChildMergeTree","processFieldValue","childTypename","getMergeFunction","maybeRecycleChildMergeTree","substring","previous","mergeMergeTrees","mergeTreeIsEmpty","cloneDeep","getStorageArgs","e_1","storeValueIsStoreObject","i_1","getValue_1","String","eVal","iVal","aVal","runMergeFunction","emptyMergeTreePool","left","right","needToMergeMaps","remainingRightKeys_1","leftTree","tree","undefId","makeUniqueId","split","spec","argumentsObjectFromField","getStoreKeyName","defaultDataIdFromObject","_id","nullKeyFieldsFn","simpleKeyArgsFn","_args","mergeTrueFn","mergeObjects","mergeFalseFn","_","Policies","typePolicies","toBeAdded","supertypeMap","fuzzySubtypes","usingPossibleTypes","dataIdFromObject","setRootTypename","possibleTypes","addPossibleTypes","addTypePolicies","ROOT_QUERY","policy","getTypePolicy","keyFn","specifierOrId","keyFieldsFnFromSpecifier","queryType","mutationType","subscriptionType","de","updateTypePolicy","keyFields","setMerge","getFieldPolicy","keyArgsFnFromSpecifier","which","toUpperCase","old","supertype","getSupertypeSet","subtype","RegExp","policy_1","supertypes","rest","inbox","splice","createIfMissing","fieldPolicies","supertypeSet","typeCondition","typenameSupertypeSet","workQueue_1","maybeEnqueue_1","needToCheckFuzzySubtypes","checkingFuzzySubtypes","regExp","fuzzyString","fieldSpec","argsFromFieldSpecifier","specifierOrString","storeKeyNameFromField","readOptions","makeFieldFunctionOptions","cacheSlot","parentTypename","makeMergeObjectsFunction","stringifyForDisplay","eType","iType","specifier","computeKeyObject","trie","aliasMap","makeAliasMap","workQueue","alias","responseKey","storeKey","aliases","subsets","response","strict","lastResponseKey","lastActualKey","keyObj","s","responseName","defaultConfig","InMemoryCache","watches","typenameDocumentCache","makeVar","txCount","init","rootStore","optimisticData","resetResultCache","resetResultIdentities","previousReader","storeReader","storeWriter","maybeBroadcastWatch","c","broadcastWatch","callback","restore","e","broadcast","broadcastWatches","diff","watch","recallCache","immediate","forgetCache","forget","reset","Promise","resolve","removeOptimistic","idToRemove","newOptimisticData","onWatchUpdated","perform","layer","alreadyDirty","l","lastDiff","fromOptimisticTransaction","En","pt","r","Ve","useHash","onSameUrlNavigation","relativeLinkResolution","D","Tn","constructor","t","n","appStateStore","vm$","pipe","mt","events","subscribe","o","checkRouterEvent","updateLoading","conditionalCacheReset","window","scrollTo","setRouteUrl","url","updateInitialAppLoading","systemConfigs","getConfigValue","getModule","getView","stateManager","clearAuthBased","selectors","process","toString","players","NoopAnimationPlayer","ɵAnimationGroupPlayer","driver","normalizer","element","keyframes","preStyles","postStyles","errors","normalizedKeyframes","previousOffset","previousKeyframe","kf","offset","isSameOffset","normalizedKeyframe","prop","normalizedProp","normalizedValue","normalizePropertyName","ɵPRE_STYLE","AUTO_STYLE","normalizeStyleValue","LINE_START","player","eventName","event","onStart","copyAnimationEvent","onDone","onDestroy","phaseName","totalTime","makeAnimationEvent","triggerName","fromState","toState","undefined","disabled","_data","defaultValue","command","separatorPos","substr","_contains","elm1","elm2","_matches","selector","_query","multi","_isNode","isNode","Element","isBrowser","documentElement","parentNode","host","contains","matches","proto","fn","matchesSelector","mozMatchesSelector","msMatchesSelector","oMatchesSelector","webkitMatchesSelector","results","elems","querySelectorAll","elm","querySelector","_CACHED_BODY","_IS_WEBKIT","body","style","charAt","matchesElement","containsElement","invokeQuery","newObj","newProp","NoopAnimationDriver","validateStyleProperty","computeStyle","animate","duration","delay","easing","previousPlayers","scrubberAccessRequested","ɵfac","ɵprov","ɵngcc0","token","factory","AnimationDriver","NOOP","ENTER_CLASSNAME","LEAVE_CLASSNAME","NG_TRIGGER_CLASSNAME","NG_TRIGGER_SELECTOR","NG_ANIMATING_CLASSNAME","NG_ANIMATING_SELECTOR","_convertTimeValueToMS","parseFloat","unit","ONE_SECOND","timings","allowNegativeValues","exp","delayMatch","easingVal","containsErrors","startIndex","destination","styles","readPrototype","copyObj","styleAttrValue","getStyleAttributeString","getPropertyValue","startsWith","camelCaseToDashCase","setAttribute","formerStyles","camelProp","dashCaseToCamelCase","writeStyleAttribute","steps","sequence","PARAM_REGEX","params","exec","lastIndex","original","str","varName","localVal","iterator","arr","done","DASH_CASE_REGEXP","input","toLowerCase","previousStyles","previousStyleProps","startingKeyframe","missingStyleProps","visitor","node","type","visitTrigger","visitState","visitTransition","visitSequence","visitGroup","visitAnimate","visitKeyframes","visitStyle","visitReference","visitAnimateChild","visitAnimateRef","visitQuery","visitStagger","getComputedStyle","transitionValue","expressions","eventStr","separator","makeLambdaFromStates","TRUE_BOOLEAN_VALUES","FALSE_BOOLEAN_VALUES","lhs","rhs","LHS_MATCH_BOOLEAN","RHS_MATCH_BOOLEAN","lhsMatch","rhsMatch","SELF_TOKEN_REGEX","metadata","AnimationAstBuilderVisitor","build","_driver","AnimationAstBuilderContext","_resetContextStyleTimingState","visitDslNode","normalizeAnimationEntry","currentQuerySelector","collectedStyles","currentTime","queryCount","depCount","states","transitions","definitions","def","stateDef","transition","styleAst","astParams","containsDynamicStyles","missingSubs","isObject","stylesObj","extractStyleParams","sub","missingSubsArr","iteratorToArray","animation","matchers","parseTransitionExpr","expr","normalizeAnimationOptions","furthestTime","step","innerAst","Math","timingAst","makeTimingAst","resolveTiming","strValue","v","ast","dynamic","currentAnimateTimings","styleMetadata","isEmpty","newStyleData","_styleAst","isEmptyStep","_makeStyleAst","_validateStyleAst","styleTuple","collectedEasing","styleData","styleMap","endTime","startTime","tuple","collectedEntry","updateCollectedStyle","totalKeyframesWithOffsets","offsets","offsetsOutOfOrder","keyframesOutOfRange","offsetVal","generatedOffset","limit","animateDuration","durationUpToThisFrame","parentSelector","currentQuery","includeSelf","hasAmpersand","find","getOrSetAsInMap","optional","originalSelector","currentTransition","preStyleProps","postStyleProps","subTimeline","_map","consume","instructions","append","existingInstructions","ENTER_TOKEN_REGEX","LEAVE_TOKEN_REGEX","rootElement","enterClassName","leaveClassName","startingStyles","finalStyles","subInstructions","AnimationTimelineBuilderVisitor","buildKeyframes","ElementInstructionMap","AnimationTimelineContext","currentTimeline","setStyles","timelines","timeline","containsAnimation","tl","allowOnlyTimelineStyles","createTimelineInstruction","elementInstructions","innerContext","createSubContext","_visitSubInstructions","transformIntoNewTimeline","previousNode","resolveTimingValue","instruction","instructionTimings","appendInstructionToTimeline","updateOptions","subContextCount","ctx","snapshotCurrentStyles","DEFAULT_NOOP_PREVIOUS_NODE","delayNextStep","applyStylesToKeyframe","innerTimelines","mergeTimelineCollectedStyles","_visitTiming","interpolateParams","incrementTime","getCurrentStyleProperties","forwardFrame","applyEmptyStep","innerTimeline","forwardTime","elms","currentQueryTotal","sameElementTimeline","currentQueryIndex","parentContext","abs","maxTime","currentStaggerTime","startingTime","_enterClassName","_leaveClassName","initialTimeline","TimelineBuilder","skipIfExists","newOptions","optionsToUpdate","newParams","paramsToUpdate","_copyOptions","oldParams","newTime","target","fork","updatedTimings","builder","SubTimelineBuilder","stretchStartingKeyframe","time","elements","_elementTimelineStylesLookup","_previousKeyframe","_currentKeyframe","_keyframes","_styleSummary","_pendingStyles","_backFill","_currentEmptyStepKeyframe","_localTimelineStyles","_globalTimelineStyles","_loadKeyframe","hasPreStyleStep","_updateStyle","allStyles","allProperties","copyStyles","val","props","getFinalKeyframe","properties","details0","details1","finalKeyframes","keyframe","finalKeyframe","preProps","postProps","kf0","kf1","_stretchStartingKeyframe","super","newKeyframes","startingGap","newFirstKeyframe","oldFirstKeyframe","roundOffset","decimalPoints","mult","pow","round","AnimationStyleNormalizer","propertyName","userProvidedProperty","normalizedProperty","strVal","trim","DIMENSIONAL_PROP_MAP","valAndSuffixMatch","isRemovalTransition","fromStyles","toStyles","queriedElements","EMPTY_OBJECT","_triggerName","_stateStyles","currentState","nextState","matchFns","buildStyles","stateName","backupStateStyler","stateStyler","backupStyles","currentOptions","nextOptions","skipAstBuild","transitionAnimationParams","currentStateStyles","nextAnimationParams","nextStateStyles","preStyleMap","postStyleMap","isRemoval","animationOptions","buildAnimationTimelines","createTransitionInstruction","queriedElementsList","defaultParams","combinedParams","styleObj","transitionFactories","AnimationStateStyles","balanceProperties","AnimationTransitionFactory","fallbackTransition","matchTransition","matchStyles","key1","key2","EMPTY_INSTRUCTION_MAP","bodyNode","_normalizer","_animations","_playersById","register","buildAnimationAst","_buildPlayer","normalizeKeyframes","autoStylesMap","inst","optimizeGroupPlayer","destroy","_getPlayer","index","listen","baseEvent","listenOnPlayer","play","pause","restart","finish","setPosition","QUEUED_CLASSNAME","DISABLED_CLASSNAME","DISABLED_SELECTOR","EMPTY_PLAYER_ARRAY","NULL_REMOVAL_STATE","namespaceId","setForRemoval","setForMove","hasAnimation","removedBeforeQueried","NULL_REMOVED_QUERIED_STATE","REMOVAL_FLAG","isObj","absorbOptions","VOID_VALUE","DEFAULT_STATE_VALUE","StateValue","hostElement","_engine","_triggers","_queue","_elementListeners","_hostClassName","addClass","phase","listeners","triggersWithStates","statesByElement","afterFlush","_getTrigger","trigger","defaultToFallback","TransitionAnimationPlayer","a","k1","k2","reportError","eraseStyles","playersOnElement","playersByElement","queued","isFallbackTransition","totalQueuedPlayers","removeClass","deregister","stateMap","entry","clearElementCache","elementPlayers","_signalRemovalForInnerTriggers","namespaces","fetchNamespacesByElement","ns","triggerLeaveAnimation","afterFlushAnimationsDone","destroyAfterComplete","triggerStates","markElementAsRemoved","processLeaveNode","prepareLeaveAnimationListeners","elementStates","visitedTriggers","listener","removeNode","engine","childElementCount","containsPotentialParentTransition","totalAnimations","currentPlayers","playersByQueriedElement","removalFlag","destroyInnerAnimations","_onRemovalComplete","insertNode","drainQueuedTransitions","microtaskId","destroyed","markedForDestroy","d0","d1","elementContainsData","containsData","newHostElements","disabledNodes","_namespaceLookup","_namespaceList","_flushFns","_whenQuietFns","namespacesByHostElement","collectedEnterElements","collectedLeaveElements","onRemovalComplete","createNamespace","AnimationTransitionNamespace","_balanceNamespaceList","collectEnterElement","found","registerTrigger","_fetchNamespace","nsId","isElementNode","insertBefore","details","markElementAsDisabled","isHostElement","hostNS","_buildInstruction","subTimelines","skipBuildAst","containerElement","destroyActiveAnimationsForElement","finishActiveQueriedAnimationOnElement","whenRenderingDone","flush","cleanupFns","_flushAnimations","quietFns","skippedPlayers","skippedPlayersMap","queuedInstructions","allPreStyleElements","allPostStyleElements","disabledElementsSet","nodesThatAreDisabled","allTriggerElements","enterNodeMap","buildRootMap","enterNodeMapIds","nodes","className","allLeaveNodes","mergedLeaveNodes","leaveNodesWithoutAnimations","fe","leaveNodeMapIds","leaveNodeMap","allPlayers","erroneousTransitions","nodeIsOrphaned","stringMap","setVal","error","allPreviousPlayersMap","animationElementMap","_beforeAnimationBuild","_getPreviousPlayers","prevPlayer","replaceNodes","replacePostStylesAsPre","postStylesMap","cloakAndComputeStyles","preStylesMap","post","pre","rootPlayers","subPlayers","NO_PARENT_ANIMATION_ELEMENT_DETECTED","overrideTotalTime","parentWithAnimation","parentsToAdd","detectedParent","innerPlayer","_buildAnimation","setRealPlayer","parentPlayers","parentPlayer","playersForElement","syncPlayerEvents","queriedPlayerResults","queriedInnerElements","j","queriedPlayers","activePlayers","removeNodesAfterAnimationDone","isQueriedElement","toStateValue","queriedElementPlayers","isRemovalAnimation","targetNameSpaceId","targetTriggerName","timelineInstruction","realPlayer","getRealPlayer","beforeDestroy","allQueriedPlayers","allConsumedElements","allSubElements","allNewPlayers","finalPlayers","_flattenGroupPlayersRecur","wrappedPlayer","currentValues","_player","_containsRealPlayer","_queuedCallbacks","triggerCallback","_queueEvent","hasStarted","getPosition","nodeType","oldValue","display","valuesMap","elementPropsMap","defaultStyle","cloakVals","cloakElement","failedElements","roots","rootMap","nodeSet","localRootMap","getRoot","CLASSES_CACHE_KEY","classList","classes","remove","postEntry","preEntry","_triggerCache","_transitionEngine","TransitionAnimationEngine","_timelineEngine","TimelineAnimationEngine","componentId","cacheKey","AnimationTrigger","onInsert","onRemove","disableAnimations","disable","action","parseTimelineCommand","eventPhase","concat","startStyles","endStyles","filterNonAnimatableStyles","SpecialCasedStyles","_element","_startStyles","_endStyles","_state","initialStyles","initialStylesByElement","_initialStyles","start","isNonAnimatableStyle","ANIMATION_PROP","ANIMATIONEND_EVENT","_name","_duration","_delay","_easing","_fillMode","_onDoneFn","_finished","_destroyed","_startTime","_position","_eventFn","_handleCallback","anim","getAnimationStyle","char","setAnimationStyle","addRemoveAnimationEvent","Date","now","playPauseAnimation","resume","position","findIndexForAnimation","timestamp","_ngTestManualTimestamp","elapsedTime","toFixed","animationName","tokens","findMatchingTokenIndex","status","searchToken","doRemove","removeEventListener","addEventListener","_finalStyles","_specialStyles","_onDoneFns","_onStartFns","_onDestroyFns","currentSnapshot","_buildStyler","_styler","_flushStartFns","_flushDoneFns","ElementAnimationStyleHandler","methods","finished","_startingStyles","__initialized","_styles","hypenatePropsObject","setProperty","removeProperty","_count","buildKeyframeElement","keyframeStr","tab","kfElm","createElement","textContent","previousCssKeyframePlayers","CssKeyframesPlayer","allowPreviousPlayerStylesMerge","flatKeyframes","balancePreviousStylesIntoKeyframes","DirectStylePlayer","rootNode","getRootNode","ShadowRoot","head","appendChild","specialStyles","packageNonAnimatableStyles","removeChild","_initialized","_started","_onFinish","_preparePlayerBeforeStart","domPlayer","_triggerWebAnimation","_finalKeyframe","_resetDomPlayerState","cancel","_isNativeImpl","test","getElementAnimateFn","_cssKeyframesDriver","CssKeyframesDriver","overrideWebAnimationsSupport","supported","playerOptions","fill","previousWebAnimationPlayers","WebAnimationsPlayer","BrowserAnimationBuilder","AnimationBuilder","rootRenderer","doc","_nextAnimationId","_renderer","createRenderer","encapsulation","ViewEncapsulation","issueAnimationCommand","BrowserAnimationFactory","DOCUMENT","AnimationFactory","RendererAnimationPlayer","_command","_listen","renderer","DISABLE_ANIMATIONS_FLAG","AnimationRendererFactory","delegate","_zone","_currentId","_microtaskId","_animationCallbacksBuffer","_rendererCache","_cdRecurDepth","promise","BaseAnimationRenderer","animationTriggers","AnimationRenderer","begin","_scheduleCountTask","then","scheduleListenerCallback","run","end","runOutsideAngular","ɵngcc1","destroyNode","namespace","createComment","createText","newChild","refChild","isMove","oldChild","selectRootElement","selectorOrNode","preserveContent","nextSibling","el","removeAttribute","setStyle","flags","removeStyle","setValue","dotIndex","InjectableAnimationEngine","ɵAnimationEngine","ngOnDestroy","ANIMATION_MODULE_TYPE","InjectionToken","SHARED_ANIMATION_PROVIDERS","provide","useClass","ɵAnimationStyleNormalizer","useFactory","ɵWebAnimationsStyleNormalizer","RendererFactory2","zone","deps","ɵDomRendererFactory2","NgZone","BROWSER_ANIMATIONS_PROVIDERS","ɵWebAnimationsDriver","ɵCssKeyframesDriver","useValue","BROWSER_NOOP_ANIMATIONS_PROVIDERS","ɵNoopAnimationDriver","BrowserAnimationsModule","withConfig","ngModule","providers","ɵmod","ɵinj","imports","BrowserModule","gs","shouldDetach","shouldAttach","retrieve","shouldReuseRoute","reuseRoute","routeConfig","Wr","systemConfigStore","load","appStore","extensionLoader","injector","router","component","$","canActivate","runGuardsAndResolvers","navigation","preferences","languageStrings","checkSession","module","list","record","view","mode","legacyUrl","redirectTo","resetConfig","ApolloLink","httpClient","print","operationPrinter","requester","operation","Observable$1","observer","getContext","pick","picked","includeQuery","includeExtensions","method","withCredentials","useMultipart","req","operationName","headers","extensions","HttpHeaders","clientAwareness","version","source","reduce","getAll","extractFiles","shouldUseBody","isBatching","multipartInfo","shouldUseMultipart","Observable","files","bodyOrParams","clone","param","form","FormData","paths","file","request","observe","responseType","reportProgress","setContext","closed","unsubscribe","op","HttpLink","HttpLinkHandler","i0","i1","providedIn","Os","Cs","uri","M","graphQLErrors","auth","isUserLoggedIn","logout","h","Q","addActiveRequest","w","F","removeActiveRequest","defaultOptions","watchQuery","fetchPolicy","link","Xn","bootstrap","vs","_s","ms","ys","bootstrapModule","catch","console","ɵDomAdapter","supportsDOMEvents","GenericBrowserDomAdapter","makeCurrent","ɵsetRootDomAdapter","BrowserDomAdapter","onAndCancel","evt","dispatchEvent","tagName","getDefaultDocument","createHtmlDocument","implementation","createHTMLDocument","Node","ELEMENT_NODE","isShadowRoot","DocumentFragment","getGlobalEventTarget","getBaseHref","href","baseElement","getAttribute","urlParsingNode","pathName","pathname","resetBaseElement","getUserAgent","navigator","userAgent","getCookie","ɵparseCookieValue","cookie","TRANSITION_ID","SERVER_TRANSITION_PROVIDERS","APP_INITIALIZER","transitionId","ApplicationInitStatus","donePromise","dom","ɵgetDOM","Injector","setTestabilityGetter","BrowserGetTestability","addToWindow","registry","ɵglobal","elem","findInAncestors","testability","findTestabilityInTree","getAllTestabilities","getAllRootElements","testabilities","didWork","decrement","didWork_","whenStable","getTestability","parentElement","BrowserXhr","XMLHttpRequest","EVENT_MANAGER_PLUGINS","EventManager","plugins","_eventNameToPlugin","manager","_plugins","reverse","handler","plugin","_findPluginFor","addGlobalEventListener","getZone","supports","_doc","SharedStylesHost","_stylesSet","addStyles","additions","onStylesAdded","getAllStyles","DomSharedStylesHost","_hostNodes","_addStylesToHost","styleNodes","styleEl","addHost","hostNode","removeHost","styleNode","NAMESPACE_URIS","svg","xhtml","xlink","xml","xmlns","COMPONENT_REGEX","compId","flattenStyles","eventHandler","preventDefault","returnValue","DomRendererFactory2","eventManager","sharedStylesHost","appId","rendererByCompId","defaultRenderer","DefaultDomRenderer2","EmulatedEncapsulationDomRenderer2","applyToHost","ShadowDomRenderer","APP_ID","createElementNS","createTextNode","namespaceUri","setAttributeNS","removeAttributeNS","RendererStyleFlags2","nodeValue","decoratePreventDefault","contentAttr","hostAttr","hostEl","shadowRoot","attachShadow","nodeOrShadowRoot","DomEventsPlugin","EventManagerPlugin","MODIFIER_KEYS","_keyMap","Del","Esc","Left","Right","Up","Down","Menu","Scroll","Win","_chromeNumKeyPadMap","B","E","G","H","I","J","K","N","MODIFIER_KEY_GETTERS","alt","altKey","control","ctrlKey","meta","metaKey","shift","shiftKey","KeyEventsPlugin","parseEventName","parsedEvent","outsideHandler","eventCallback","fullKey","domEventName","parts","_normalizeKey","modifierName","keyIdentifier","fromCharCode","parseInt","location","modifierGetter","getEventFullKey","runGuarded","keyName","DomSanitizer","ɵɵdefineInjectable","ɵɵinject","DomSanitizerImpl","sanitize","SecurityContext","ɵallowSanitizationBypassAndThrow","ɵunwrapSafeValue","ɵ_sanitizeHtml","ɵgetSanitizationBypassType","ɵ_sanitizeUrl","bypassSecurityTrustHtml","ɵbypassSanitizationTrustHtml","bypassSecurityTrustStyle","ɵbypassSanitizationTrustStyle","bypassSecurityTrustScript","ɵbypassSanitizationTrustScript","bypassSecurityTrustUrl","ɵbypassSanitizationTrustUrl","bypassSecurityTrustResourceUrl","ɵbypassSanitizationTrustResourceUrl","INJECTOR","platformBrowser","createPlatformFactory","platformCore","PLATFORM_ID","ɵPLATFORM_BROWSER_ID","PLATFORM_INITIALIZER","ɵsetDocument","BROWSER_MODULE_PROVIDERS","ɵINJECTOR_SCOPE","ErrorHandler","useExisting","Testability","XhrFactory","parentModule","CommonModule","ApplicationModule","stringifyCanon","stringifyCache","known","canUseWeakSet","WeakSet","pool","passes","keysByJSON","isObjectOrArray","copy","getPrototypeOf","proto_1","array_1","sortedKeys","json","firstValueIndex_1","sorted","obj_1","resetCanonicalStringify","canonical","Slot","cacheInfoMap","vars","getCacheInfo","rv","attachCache","caches","oldListeners","getValue","attach","onNextChange","forward","LinkError","links","toLink","x","y","leftLink","rightLink","passthrough","isTerminating","execute","starting","defineProperty","enumerable","transformedOperation","getOperationName","OPERATION_FIELDS","_i","first","second","firstLink","nextLink","onError","setOnError","product","cloneDeepHelper","seen","copy_1","copy_2","prefixCounts","prefix","random","sources","defaultReconciler","reconciler","pastCopies","sourceKey","targetValue","__spreadArray","shallowCopyForMerge","genericMessage","setPrototypeOf","framesToPop","condition","verbosityLevels","verbosityLevel","log","thunk","debug","wrapConsoleMethod","warn","maybe","globalThis","self","global","Function","__","GLOBAL_KEY","Z","configurable","writable","safeGlobal","needToRemove","env","NODE_ENV","isType","DEV","directive","directiveArguments","directiveName","ifArgument","ifValue","kind","evaledValue","names","visit","Directive","hasDirectives","actualFragmentName","fragments","definition","symTable","operations","checkDocument","queryDef","fragmentDef","queryDoc","fragmentDefinition","defaultValues","defs","variableDefinitions","valueToObjectRepresentation","variable","argObj","Number","nestedArgObj_1","variableValue","listValue","nestedArgArrayObj","directivesObj","KNOWN_DIRECTIVES","connection","filterKeys","filteredArgs_1","completeFieldName","stringifiedArgs","setStringify","stringifyReplacer","_key","argObj_1","TYPENAME_FIELD","getFragmentDefinition","dir","variablesInUse","variablesToRemove","fragmentSpreadsInUse","fragmentSpreadsToRemove","modifiedDoc","nullIfDocIsEmpty","Variable","enter","Field","getDirectiveMatcher","arg","getAllFragmentSpreadsFromSelectionSet","frag","FragmentSpread","filterInPlace","argMatcher","argument","aConfig","OperationDefinition","varDef","argConfig","argMatchCount_1","Argument","fs","FragmentDefinition","SelectionSet","lastIndexOf","added","connectionRemoveConfig","willRemove","removeDirectivesFromDocument","allFragments","isInlineFragment","currentContext","MISSING_VALUE","idCounter","globalKey","hasValue","context_1","slots","withValue","thisArg","bind","saved","noContext","fnToStr","previousComparisons","check","aTag","previouslyCompared","aKeys","definedKeys","bKeys","keyCount","k","aIterator","entries","isMap","aKey","aValue","Uint8Array","len","byteLength","aCode","full","suffix","fromIndex","nativeCodeSuffix","isDefinedKey","bSet","defaultMakeData","weakness","makeData","getChildTrie","weak","strong","exports","_ref","defaultIsExtractableFile","require","isExtractableFile","storedPaths","addFile","FileList","ReactNativeFile","File","Blob","Cache","dispose","Infinity","defaultDispose","newest","oldest","getNode","clean","parentEntrySlot","toArray","collection","entryOrDep","emptySetPool","optionalMessage","Entry","parents","childValues","dirtyChildren","recomputing","mightBeDirty","rememberParent","recompute","assert","forgetChildren","recomputeNewValue","maybeUnsubscribe","setDirty","reportClean","valueGet","reportDirty","eachParent","forgetChild","dependOn","forgetDeps","reportDirtyChild","reportCleanChild","parentCount","parentWasClean","childValue","removeDirtyChild","dc","_value","EntryMethods","depsByKey","dep_1","entryMethodName","m_1","keyTrie","makeDefaultMakeCacheKeyFunction","originalFunction","dirtyKey","peekKey","forgetKey","getKey","arr2","descriptor","Constructor","protoProps","staticProps","_defineProperties","hasSymbols","Symbol","hasSymbol","getSymbol","observable","SymbolIterator","SymbolObservable","SymbolSpecies","TypeError","ctor","hostReportError","setTimeout","subscription","cleanup","_cleanup","getMethod","_observer","closeSubscription","cleanupSubscription","enqueue","queue","notifySubscription","Subscription","subscriber","subscriptionObserver","SubscriptionObserver","_proto","_createClass","_subscription","_proto2","onNotify","_subscriber","_proto3","reject","_this2","getSpecies","_this3","_this4","hasSeed","acc","_this5","_len","startNext","flatMap","_this6","subscriptions","outer","inner","completeIfDone","_step","_iterator","allowArrayLike","it","minLen","_arrayLikeToArray","of","_len2","items","_key2","symbol"],"sources":["webpack:///node_modules/tslib/tslib.es6.js","webpack:///node_modules/@apollo/client/cache/core/cache.js","webpack:///node_modules/@apollo/client/cache/core/types/common.js","webpack:///node_modules/@apollo/client/utilities/common/maybeDeepFreeze.js","webpack:///node_modules/@apollo/client/cache/inmemory/helpers.js","webpack:///node_modules/@apollo/client/cache/inmemory/entityStore.js","webpack:///node_modules/@apollo/client/cache/inmemory/readFromStore.js","webpack:///node_modules/@apollo/client/cache/inmemory/writeToStore.js","webpack:///node_modules/@apollo/client/utilities/common/stringifyForDisplay.js","webpack:///node_modules/@apollo/client/cache/inmemory/policies.js","webpack:///node_modules/@apollo/client/cache/inmemory/inMemoryCache.js","webpack:///core/app/shell/src/app/app-routing.module.ts","webpack:///core/app/shell/src/app/app.component.html","webpack:///core/app/shell/src/app/app.component.ts","webpack:///node_modules/@angular/animations/fesm2015/browser.js","webpack:///node_modules/@angular/platform-browser/fesm2015/animations.js","webpack:///core/app/shell/src/app/app-router-reuse-strategy.ts","webpack:///core/app/shell/src/app/app-initializer.ts","webpack:///node_modules/apollo-angular/fesm2015/ngApolloLinkHttp.js","webpack:///core/app/shell/src/app/app.module.ts","webpack:///core/app/shell/src/environments/environment.ts","webpack:///core/app/shell/src/bootstrap.ts","webpack:///node_modules/@angular/platform-browser/fesm2015/platform-browser.js","webpack:///node_modules/@apollo/client/cache/inmemory/object-canon.js","webpack:///node_modules/@apollo/client/cache/inmemory/reactiveVars.js","webpack:///node_modules/@apollo/client/link/core/ApolloLink.js","webpack:///node_modules/@apollo/client/link/utils/createOperation.js","webpack:///node_modules/@apollo/client/link/utils/transformOperation.js","webpack:///node_modules/@apollo/client/link/utils/validateOperation.js","webpack:///node_modules/@apollo/client/utilities/common/canUse.js","webpack:///node_modules/@apollo/client/utilities/common/cloneDeep.js","webpack:///node_modules/@apollo/client/utilities/common/makeUniqueId.js","webpack:///node_modules/@apollo/client/utilities/common/mergeDeep.js","webpack:///node_modules/@apollo/client/utilities/common/objects.js","webpack:///node_modules/ts-invariant/lib/invariant.esm.js","webpack:///node_modules/@apollo/client/utilities/globals/maybe.js","webpack:///node_modules/@apollo/client/utilities/globals/global.js","webpack:///node_modules/@apollo/client/utilities/globals/DEV.js","webpack:///node_modules/ts-invariant/process/index.js","webpack:///node_modules/@apollo/client/utilities/globals/graphql.js","webpack:///node_modules/@apollo/client/utilities/globals/index.js","webpack:///node_modules/@apollo/client/utilities/graphql/directives.js","webpack:///node_modules/@apollo/client/utilities/graphql/fragments.js","webpack:///node_modules/@apollo/client/utilities/graphql/getFromAST.js","webpack:///node_modules/@apollo/client/utilities/graphql/storeUtils.js","webpack:///node_modules/@apollo/client/utilities/common/filterInPlace.js","webpack:///node_modules/@apollo/client/utilities/graphql/transform.js","webpack:///node_modules/@wry/context/lib/context.esm.js","webpack:///node_modules/@wry/equality/lib/equality.esm.js","webpack:///node_modules/@wry/trie/lib/trie.esm.js","webpack:///node_modules/extract-files/public/ReactNativeFile.js","webpack:///node_modules/extract-files/public/extractFiles.js","webpack:///node_modules/extract-files/public/isExtractableFile.js","webpack:///node_modules/optimism/lib/bundle.esm.js","webpack:///node_modules/zen-observable-ts/module.js"],"sourcesContent":["/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    if (typeof b !== \"function\" && b !== null)\r\n        throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport var __createBinding = Object.create ? (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\r\n}) : (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n});\r\n\r\nexport function __exportStar(m, o) {\r\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(o, p)) __createBinding(o, m, p);\r\n}\r\n\r\nexport function __values(o) {\r\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\r\n    if (m) return m.call(o);\r\n    if (o && typeof o.length === \"number\") return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\n/** @deprecated */\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\n/** @deprecated */\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n}\r\n\r\nexport function __spreadArray(to, from, pack) {\r\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\r\n        if (ar || !(i in from)) {\r\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\r\n            ar[i] = from[i];\r\n        }\r\n    }\r\n    return to.concat(ar || Array.prototype.slice.call(from));\r\n}\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nvar __setModuleDefault = Object.create ? (function(o, v) {\r\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\r\n}) : function(o, v) {\r\n    o[\"default\"] = v;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\r\n    __setModuleDefault(result, mod);\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n\r\nexport function __classPrivateFieldGet(receiver, state, kind, f) {\r\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a getter\");\r\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot read private member from an object whose class did not declare it\");\r\n    return kind === \"m\" ? f : kind === \"a\" ? f.call(receiver) : f ? f.value : state.get(receiver);\r\n}\r\n\r\nexport function __classPrivateFieldSet(receiver, state, value, kind, f) {\r\n    if (kind === \"m\") throw new TypeError(\"Private method is not writable\");\r\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a setter\");\r\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot write private member to an object whose class did not declare it\");\r\n    return (kind === \"a\" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;\r\n}\r\n","import { __assign, __rest } from \"tslib\";\r\nimport { wrap } from 'optimism';\r\nimport { getFragmentQueryDocument, } from \"../../utilities/index.js\";\r\nvar ApolloCache = (function () {\r\n    function ApolloCache() {\r\n        this.getFragmentDoc = wrap(getFragmentQueryDocument);\r\n    }\r\n    ApolloCache.prototype.batch = function (options) {\r\n        var optimisticId = typeof options.optimistic === \"string\" ? options.optimistic :\r\n            options.optimistic === false ? null : void 0;\r\n        this.performTransaction(options.update, optimisticId);\r\n    };\r\n    ApolloCache.prototype.recordOptimisticTransaction = function (transaction, optimisticId) {\r\n        this.performTransaction(transaction, optimisticId);\r\n    };\r\n    ApolloCache.prototype.transformDocument = function (document) {\r\n        return document;\r\n    };\r\n    ApolloCache.prototype.identify = function (object) {\r\n        return;\r\n    };\r\n    ApolloCache.prototype.gc = function () {\r\n        return [];\r\n    };\r\n    ApolloCache.prototype.modify = function (options) {\r\n        return false;\r\n    };\r\n    ApolloCache.prototype.transformForLink = function (document) {\r\n        return document;\r\n    };\r\n    ApolloCache.prototype.readQuery = function (options, optimistic) {\r\n        if (optimistic === void 0) { optimistic = !!options.optimistic; }\r\n        return this.read(__assign(__assign({}, options), { rootId: options.id || 'ROOT_QUERY', optimistic: optimistic }));\r\n    };\r\n    ApolloCache.prototype.readFragment = function (options, optimistic) {\r\n        if (optimistic === void 0) { optimistic = !!options.optimistic; }\r\n        return this.read(__assign(__assign({}, options), { query: this.getFragmentDoc(options.fragment, options.fragmentName), rootId: options.id, optimistic: optimistic }));\r\n    };\r\n    ApolloCache.prototype.writeQuery = function (_a) {\r\n        var id = _a.id, data = _a.data, options = __rest(_a, [\"id\", \"data\"]);\r\n        return this.write(Object.assign(options, {\r\n            dataId: id || 'ROOT_QUERY',\r\n            result: data,\r\n        }));\r\n    };\r\n    ApolloCache.prototype.writeFragment = function (_a) {\r\n        var id = _a.id, data = _a.data, fragment = _a.fragment, fragmentName = _a.fragmentName, options = __rest(_a, [\"id\", \"data\", \"fragment\", \"fragmentName\"]);\r\n        return this.write(Object.assign(options, {\r\n            query: this.getFragmentDoc(fragment, fragmentName),\r\n            dataId: id,\r\n            result: data,\r\n        }));\r\n    };\r\n    return ApolloCache;\r\n}());\r\nexport { ApolloCache };\r\n","import { __extends } from \"tslib\";\r\nvar MissingFieldError = (function (_super) {\r\n    __extends(MissingFieldError, _super);\r\n    function MissingFieldError(message, path, query, variables) {\r\n        var _this = _super.call(this, message) || this;\r\n        _this.message = message;\r\n        _this.path = path;\r\n        _this.query = query;\r\n        _this.variables = variables;\r\n        _this.__proto__ = MissingFieldError.prototype;\r\n        return _this;\r\n    }\r\n    return MissingFieldError;\r\n}(Error));\r\nexport { MissingFieldError };\r\n","import \"../globals/index.js\";\r\nimport { isNonNullObject } from \"./objects.js\";\r\nfunction deepFreeze(value) {\r\n    var workSet = new Set([value]);\r\n    workSet.forEach(function (obj) {\r\n        if (isNonNullObject(obj)) {\r\n            if (!Object.isFrozen(obj))\r\n                Object.freeze(obj);\r\n            Object.getOwnPropertyNames(obj).forEach(function (name) {\r\n                if (isNonNullObject(obj[name]))\r\n                    workSet.add(obj[name]);\r\n            });\r\n        }\r\n    });\r\n    return value;\r\n}\r\nexport function maybeDeepFreeze(obj) {\r\n    if (__DEV__) {\r\n        deepFreeze(obj);\r\n    }\r\n    return obj;\r\n}\r\n","import { isReference, isField, DeepMerger, resultKeyNameFromField, shouldInclude, isNonNullObject, } from \"../../utilities/index.js\";\r\nexport var hasOwn = Object.prototype.hasOwnProperty;\r\nexport function getTypenameFromStoreObject(store, objectOrReference) {\r\n    return isReference(objectOrReference)\r\n        ? store.get(objectOrReference.__ref, \"__typename\")\r\n        : objectOrReference && objectOrReference.__typename;\r\n}\r\nexport var TypeOrFieldNameRegExp = /^[_a-z][_0-9a-z]*/i;\r\nexport function fieldNameFromStoreName(storeFieldName) {\r\n    var match = storeFieldName.match(TypeOrFieldNameRegExp);\r\n    return match ? match[0] : storeFieldName;\r\n}\r\nexport function selectionSetMatchesResult(selectionSet, result, variables) {\r\n    if (isNonNullObject(result)) {\r\n        return Array.isArray(result)\r\n            ? result.every(function (item) { return selectionSetMatchesResult(selectionSet, item, variables); })\r\n            : selectionSet.selections.every(function (field) {\r\n                if (isField(field) && shouldInclude(field, variables)) {\r\n                    var key = resultKeyNameFromField(field);\r\n                    return hasOwn.call(result, key) &&\r\n                        (!field.selectionSet ||\r\n                            selectionSetMatchesResult(field.selectionSet, result[key], variables));\r\n                }\r\n                return true;\r\n            });\r\n    }\r\n    return false;\r\n}\r\nexport function storeValueIsStoreObject(value) {\r\n    return isNonNullObject(value) &&\r\n        !isReference(value) &&\r\n        !Array.isArray(value);\r\n}\r\nexport function makeProcessedFieldsMerger() {\r\n    return new DeepMerger;\r\n}\r\n","import { __assign, __extends, __rest } from \"tslib\";\r\nimport { invariant } from \"../../utilities/globals/index.js\";\r\nimport { dep } from 'optimism';\r\nimport { equal } from '@wry/equality';\r\nimport { Trie } from '@wry/trie';\r\nimport { isReference, makeReference, DeepMerger, maybeDeepFreeze, canUseWeakMap, isNonNullObject, } from \"../../utilities/index.js\";\r\nimport { hasOwn, fieldNameFromStoreName } from \"./helpers.js\";\r\nvar DELETE = Object.create(null);\r\nvar delModifier = function () { return DELETE; };\r\nvar INVALIDATE = Object.create(null);\r\nvar EntityStore = (function () {\r\n    function EntityStore(policies, group) {\r\n        var _this = this;\r\n        this.policies = policies;\r\n        this.group = group;\r\n        this.data = Object.create(null);\r\n        this.rootIds = Object.create(null);\r\n        this.refs = Object.create(null);\r\n        this.getFieldValue = function (objectOrReference, storeFieldName) { return maybeDeepFreeze(isReference(objectOrReference)\r\n            ? _this.get(objectOrReference.__ref, storeFieldName)\r\n            : objectOrReference && objectOrReference[storeFieldName]); };\r\n        this.canRead = function (objOrRef) {\r\n            return isReference(objOrRef)\r\n                ? _this.has(objOrRef.__ref)\r\n                : typeof objOrRef === \"object\";\r\n        };\r\n        this.toReference = function (objOrIdOrRef, mergeIntoStore) {\r\n            if (typeof objOrIdOrRef === \"string\") {\r\n                return makeReference(objOrIdOrRef);\r\n            }\r\n            if (isReference(objOrIdOrRef)) {\r\n                return objOrIdOrRef;\r\n            }\r\n            var id = _this.policies.identify(objOrIdOrRef)[0];\r\n            if (id) {\r\n                var ref = makeReference(id);\r\n                if (mergeIntoStore) {\r\n                    _this.merge(id, objOrIdOrRef);\r\n                }\r\n                return ref;\r\n            }\r\n        };\r\n    }\r\n    EntityStore.prototype.toObject = function () {\r\n        return __assign({}, this.data);\r\n    };\r\n    EntityStore.prototype.has = function (dataId) {\r\n        return this.lookup(dataId, true) !== void 0;\r\n    };\r\n    EntityStore.prototype.get = function (dataId, fieldName) {\r\n        this.group.depend(dataId, fieldName);\r\n        if (hasOwn.call(this.data, dataId)) {\r\n            var storeObject = this.data[dataId];\r\n            if (storeObject && hasOwn.call(storeObject, fieldName)) {\r\n                return storeObject[fieldName];\r\n            }\r\n        }\r\n        if (fieldName === \"__typename\" &&\r\n            hasOwn.call(this.policies.rootTypenamesById, dataId)) {\r\n            return this.policies.rootTypenamesById[dataId];\r\n        }\r\n        if (this instanceof Layer) {\r\n            return this.parent.get(dataId, fieldName);\r\n        }\r\n    };\r\n    EntityStore.prototype.lookup = function (dataId, dependOnExistence) {\r\n        if (dependOnExistence)\r\n            this.group.depend(dataId, \"__exists\");\r\n        if (hasOwn.call(this.data, dataId)) {\r\n            return this.data[dataId];\r\n        }\r\n        if (this instanceof Layer) {\r\n            return this.parent.lookup(dataId, dependOnExistence);\r\n        }\r\n        if (this.policies.rootTypenamesById[dataId]) {\r\n            return Object.create(null);\r\n        }\r\n    };\r\n    EntityStore.prototype.merge = function (older, newer) {\r\n        var _this = this;\r\n        var dataId;\r\n        if (isReference(older))\r\n            older = older.__ref;\r\n        if (isReference(newer))\r\n            newer = newer.__ref;\r\n        var existing = typeof older === \"string\"\r\n            ? this.lookup(dataId = older)\r\n            : older;\r\n        var incoming = typeof newer === \"string\"\r\n            ? this.lookup(dataId = newer)\r\n            : newer;\r\n        if (!incoming)\r\n            return;\r\n        __DEV__ ? invariant(typeof dataId === \"string\", \"store.merge expects a string ID\") : invariant(typeof dataId === \"string\", 1);\r\n        var merged = new DeepMerger(storeObjectReconciler).merge(existing, incoming);\r\n        this.data[dataId] = merged;\r\n        if (merged !== existing) {\r\n            delete this.refs[dataId];\r\n            if (this.group.caching) {\r\n                var fieldsToDirty_1 = Object.create(null);\r\n                if (!existing)\r\n                    fieldsToDirty_1.__exists = 1;\r\n                Object.keys(incoming).forEach(function (storeFieldName) {\r\n                    if (!existing || existing[storeFieldName] !== merged[storeFieldName]) {\r\n                        fieldsToDirty_1[storeFieldName] = 1;\r\n                        var fieldName = fieldNameFromStoreName(storeFieldName);\r\n                        if (fieldName !== storeFieldName &&\r\n                            !_this.policies.hasKeyArgs(merged.__typename, fieldName)) {\r\n                            fieldsToDirty_1[fieldName] = 1;\r\n                        }\r\n                        if (merged[storeFieldName] === void 0 && !(_this instanceof Layer)) {\r\n                            delete merged[storeFieldName];\r\n                        }\r\n                    }\r\n                });\r\n                if (fieldsToDirty_1.__typename &&\r\n                    !(existing && existing.__typename) &&\r\n                    this.policies.rootTypenamesById[dataId] === merged.__typename) {\r\n                    delete fieldsToDirty_1.__typename;\r\n                }\r\n                Object.keys(fieldsToDirty_1).forEach(function (fieldName) { return _this.group.dirty(dataId, fieldName); });\r\n            }\r\n        }\r\n    };\r\n    EntityStore.prototype.modify = function (dataId, fields) {\r\n        var _this = this;\r\n        var storeObject = this.lookup(dataId);\r\n        if (storeObject) {\r\n            var changedFields_1 = Object.create(null);\r\n            var needToMerge_1 = false;\r\n            var allDeleted_1 = true;\r\n            var sharedDetails_1 = {\r\n                DELETE: DELETE,\r\n                INVALIDATE: INVALIDATE,\r\n                isReference: isReference,\r\n                toReference: this.toReference,\r\n                canRead: this.canRead,\r\n                readField: function (fieldNameOrOptions, from) { return _this.policies.readField(typeof fieldNameOrOptions === \"string\" ? {\r\n                    fieldName: fieldNameOrOptions,\r\n                    from: from || makeReference(dataId),\r\n                } : fieldNameOrOptions, { store: _this }); },\r\n            };\r\n            Object.keys(storeObject).forEach(function (storeFieldName) {\r\n                var fieldName = fieldNameFromStoreName(storeFieldName);\r\n                var fieldValue = storeObject[storeFieldName];\r\n                if (fieldValue === void 0)\r\n                    return;\r\n                var modify = typeof fields === \"function\"\r\n                    ? fields\r\n                    : fields[storeFieldName] || fields[fieldName];\r\n                if (modify) {\r\n                    var newValue = modify === delModifier ? DELETE :\r\n                        modify(maybeDeepFreeze(fieldValue), __assign(__assign({}, sharedDetails_1), { fieldName: fieldName, storeFieldName: storeFieldName, storage: _this.getStorage(dataId, storeFieldName) }));\r\n                    if (newValue === INVALIDATE) {\r\n                        _this.group.dirty(dataId, storeFieldName);\r\n                    }\r\n                    else {\r\n                        if (newValue === DELETE)\r\n                            newValue = void 0;\r\n                        if (newValue !== fieldValue) {\r\n                            changedFields_1[storeFieldName] = newValue;\r\n                            needToMerge_1 = true;\r\n                            fieldValue = newValue;\r\n                        }\r\n                    }\r\n                }\r\n                if (fieldValue !== void 0) {\r\n                    allDeleted_1 = false;\r\n                }\r\n            });\r\n            if (needToMerge_1) {\r\n                this.merge(dataId, changedFields_1);\r\n                if (allDeleted_1) {\r\n                    if (this instanceof Layer) {\r\n                        this.data[dataId] = void 0;\r\n                    }\r\n                    else {\r\n                        delete this.data[dataId];\r\n                    }\r\n                    this.group.dirty(dataId, \"__exists\");\r\n                }\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    };\r\n    EntityStore.prototype.delete = function (dataId, fieldName, args) {\r\n        var _a;\r\n        var storeObject = this.lookup(dataId);\r\n        if (storeObject) {\r\n            var typename = this.getFieldValue(storeObject, \"__typename\");\r\n            var storeFieldName = fieldName && args\r\n                ? this.policies.getStoreFieldName({ typename: typename, fieldName: fieldName, args: args })\r\n                : fieldName;\r\n            return this.modify(dataId, storeFieldName ? (_a = {},\r\n                _a[storeFieldName] = delModifier,\r\n                _a) : delModifier);\r\n        }\r\n        return false;\r\n    };\r\n    EntityStore.prototype.evict = function (options) {\r\n        var evicted = false;\r\n        if (options.id) {\r\n            if (hasOwn.call(this.data, options.id)) {\r\n                evicted = this.delete(options.id, options.fieldName, options.args);\r\n            }\r\n            if (this instanceof Layer) {\r\n                evicted = this.parent.evict(options) || evicted;\r\n            }\r\n            if (options.fieldName || evicted) {\r\n                this.group.dirty(options.id, options.fieldName || \"__exists\");\r\n            }\r\n        }\r\n        return evicted;\r\n    };\r\n    EntityStore.prototype.clear = function () {\r\n        this.replace(null);\r\n    };\r\n    EntityStore.prototype.extract = function () {\r\n        var _this = this;\r\n        var obj = this.toObject();\r\n        var extraRootIds = [];\r\n        this.getRootIdSet().forEach(function (id) {\r\n            if (!hasOwn.call(_this.policies.rootTypenamesById, id)) {\r\n                extraRootIds.push(id);\r\n            }\r\n        });\r\n        if (extraRootIds.length) {\r\n            obj.__META = { extraRootIds: extraRootIds.sort() };\r\n        }\r\n        return obj;\r\n    };\r\n    EntityStore.prototype.replace = function (newData) {\r\n        var _this = this;\r\n        Object.keys(this.data).forEach(function (dataId) {\r\n            if (!(newData && hasOwn.call(newData, dataId))) {\r\n                _this.delete(dataId);\r\n            }\r\n        });\r\n        if (newData) {\r\n            var __META = newData.__META, rest_1 = __rest(newData, [\"__META\"]);\r\n            Object.keys(rest_1).forEach(function (dataId) {\r\n                _this.merge(dataId, rest_1[dataId]);\r\n            });\r\n            if (__META) {\r\n                __META.extraRootIds.forEach(this.retain, this);\r\n            }\r\n        }\r\n    };\r\n    EntityStore.prototype.retain = function (rootId) {\r\n        return this.rootIds[rootId] = (this.rootIds[rootId] || 0) + 1;\r\n    };\r\n    EntityStore.prototype.release = function (rootId) {\r\n        if (this.rootIds[rootId] > 0) {\r\n            var count = --this.rootIds[rootId];\r\n            if (!count)\r\n                delete this.rootIds[rootId];\r\n            return count;\r\n        }\r\n        return 0;\r\n    };\r\n    EntityStore.prototype.getRootIdSet = function (ids) {\r\n        if (ids === void 0) { ids = new Set(); }\r\n        Object.keys(this.rootIds).forEach(ids.add, ids);\r\n        if (this instanceof Layer) {\r\n            this.parent.getRootIdSet(ids);\r\n        }\r\n        else {\r\n            Object.keys(this.policies.rootTypenamesById).forEach(ids.add, ids);\r\n        }\r\n        return ids;\r\n    };\r\n    EntityStore.prototype.gc = function () {\r\n        var _this = this;\r\n        var ids = this.getRootIdSet();\r\n        var snapshot = this.toObject();\r\n        ids.forEach(function (id) {\r\n            if (hasOwn.call(snapshot, id)) {\r\n                Object.keys(_this.findChildRefIds(id)).forEach(ids.add, ids);\r\n                delete snapshot[id];\r\n            }\r\n        });\r\n        var idsToRemove = Object.keys(snapshot);\r\n        if (idsToRemove.length) {\r\n            var root_1 = this;\r\n            while (root_1 instanceof Layer)\r\n                root_1 = root_1.parent;\r\n            idsToRemove.forEach(function (id) { return root_1.delete(id); });\r\n        }\r\n        return idsToRemove;\r\n    };\r\n    EntityStore.prototype.findChildRefIds = function (dataId) {\r\n        if (!hasOwn.call(this.refs, dataId)) {\r\n            var found_1 = this.refs[dataId] = Object.create(null);\r\n            var root = this.data[dataId];\r\n            if (!root)\r\n                return found_1;\r\n            var workSet_1 = new Set([root]);\r\n            workSet_1.forEach(function (obj) {\r\n                if (isReference(obj)) {\r\n                    found_1[obj.__ref] = true;\r\n                }\r\n                if (isNonNullObject(obj)) {\r\n                    Object.keys(obj).forEach(function (key) {\r\n                        var child = obj[key];\r\n                        if (isNonNullObject(child)) {\r\n                            workSet_1.add(child);\r\n                        }\r\n                    });\r\n                }\r\n            });\r\n        }\r\n        return this.refs[dataId];\r\n    };\r\n    EntityStore.prototype.makeCacheKey = function () {\r\n        return this.group.keyMaker.lookupArray(arguments);\r\n    };\r\n    return EntityStore;\r\n}());\r\nexport { EntityStore };\r\nvar CacheGroup = (function () {\r\n    function CacheGroup(caching, parent) {\r\n        if (parent === void 0) { parent = null; }\r\n        this.caching = caching;\r\n        this.parent = parent;\r\n        this.d = null;\r\n        this.resetCaching();\r\n    }\r\n    CacheGroup.prototype.resetCaching = function () {\r\n        this.d = this.caching ? dep() : null;\r\n        this.keyMaker = new Trie(canUseWeakMap);\r\n    };\r\n    CacheGroup.prototype.depend = function (dataId, storeFieldName) {\r\n        if (this.d) {\r\n            this.d(makeDepKey(dataId, storeFieldName));\r\n            var fieldName = fieldNameFromStoreName(storeFieldName);\r\n            if (fieldName !== storeFieldName) {\r\n                this.d(makeDepKey(dataId, fieldName));\r\n            }\r\n            if (this.parent) {\r\n                this.parent.depend(dataId, storeFieldName);\r\n            }\r\n        }\r\n    };\r\n    CacheGroup.prototype.dirty = function (dataId, storeFieldName) {\r\n        if (this.d) {\r\n            this.d.dirty(makeDepKey(dataId, storeFieldName), storeFieldName === \"__exists\" ? \"forget\" : \"setDirty\");\r\n        }\r\n    };\r\n    return CacheGroup;\r\n}());\r\nfunction makeDepKey(dataId, storeFieldName) {\r\n    return storeFieldName + '#' + dataId;\r\n}\r\nexport function maybeDependOnExistenceOfEntity(store, entityId) {\r\n    if (supportsResultCaching(store)) {\r\n        store.group.depend(entityId, \"__exists\");\r\n    }\r\n}\r\n(function (EntityStore) {\r\n    var Root = (function (_super) {\r\n        __extends(Root, _super);\r\n        function Root(_a) {\r\n            var policies = _a.policies, _b = _a.resultCaching, resultCaching = _b === void 0 ? true : _b, seed = _a.seed;\r\n            var _this = _super.call(this, policies, new CacheGroup(resultCaching)) || this;\r\n            _this.stump = new Stump(_this);\r\n            _this.storageTrie = new Trie(canUseWeakMap);\r\n            if (seed)\r\n                _this.replace(seed);\r\n            return _this;\r\n        }\r\n        Root.prototype.addLayer = function (layerId, replay) {\r\n            return this.stump.addLayer(layerId, replay);\r\n        };\r\n        Root.prototype.removeLayer = function () {\r\n            return this;\r\n        };\r\n        Root.prototype.getStorage = function () {\r\n            return this.storageTrie.lookupArray(arguments);\r\n        };\r\n        return Root;\r\n    }(EntityStore));\r\n    EntityStore.Root = Root;\r\n})(EntityStore || (EntityStore = {}));\r\nvar Layer = (function (_super) {\r\n    __extends(Layer, _super);\r\n    function Layer(id, parent, replay, group) {\r\n        var _this = _super.call(this, parent.policies, group) || this;\r\n        _this.id = id;\r\n        _this.parent = parent;\r\n        _this.replay = replay;\r\n        _this.group = group;\r\n        replay(_this);\r\n        return _this;\r\n    }\r\n    Layer.prototype.addLayer = function (layerId, replay) {\r\n        return new Layer(layerId, this, replay, this.group);\r\n    };\r\n    Layer.prototype.removeLayer = function (layerId) {\r\n        var _this = this;\r\n        var parent = this.parent.removeLayer(layerId);\r\n        if (layerId === this.id) {\r\n            if (this.group.caching) {\r\n                Object.keys(this.data).forEach(function (dataId) {\r\n                    var ownStoreObject = _this.data[dataId];\r\n                    var parentStoreObject = parent[\"lookup\"](dataId);\r\n                    if (!parentStoreObject) {\r\n                        _this.delete(dataId);\r\n                    }\r\n                    else if (!ownStoreObject) {\r\n                        _this.group.dirty(dataId, \"__exists\");\r\n                        Object.keys(parentStoreObject).forEach(function (storeFieldName) {\r\n                            _this.group.dirty(dataId, storeFieldName);\r\n                        });\r\n                    }\r\n                    else if (ownStoreObject !== parentStoreObject) {\r\n                        Object.keys(ownStoreObject).forEach(function (storeFieldName) {\r\n                            if (!equal(ownStoreObject[storeFieldName], parentStoreObject[storeFieldName])) {\r\n                                _this.group.dirty(dataId, storeFieldName);\r\n                            }\r\n                        });\r\n                    }\r\n                });\r\n            }\r\n            return parent;\r\n        }\r\n        if (parent === this.parent)\r\n            return this;\r\n        return parent.addLayer(this.id, this.replay);\r\n    };\r\n    Layer.prototype.toObject = function () {\r\n        return __assign(__assign({}, this.parent.toObject()), this.data);\r\n    };\r\n    Layer.prototype.findChildRefIds = function (dataId) {\r\n        var fromParent = this.parent.findChildRefIds(dataId);\r\n        return hasOwn.call(this.data, dataId) ? __assign(__assign({}, fromParent), _super.prototype.findChildRefIds.call(this, dataId)) : fromParent;\r\n    };\r\n    Layer.prototype.getStorage = function () {\r\n        var p = this.parent;\r\n        while (p.parent)\r\n            p = p.parent;\r\n        return p.getStorage.apply(p, arguments);\r\n    };\r\n    return Layer;\r\n}(EntityStore));\r\nvar Stump = (function (_super) {\r\n    __extends(Stump, _super);\r\n    function Stump(root) {\r\n        return _super.call(this, \"EntityStore.Stump\", root, function () { }, new CacheGroup(root.group.caching, root.group)) || this;\r\n    }\r\n    Stump.prototype.removeLayer = function () {\r\n        return this;\r\n    };\r\n    Stump.prototype.merge = function () {\r\n        return this.parent.merge.apply(this.parent, arguments);\r\n    };\r\n    return Stump;\r\n}(Layer));\r\nfunction storeObjectReconciler(existingObject, incomingObject, property) {\r\n    var existingValue = existingObject[property];\r\n    var incomingValue = incomingObject[property];\r\n    return equal(existingValue, incomingValue) ? existingValue : incomingValue;\r\n}\r\nexport function supportsResultCaching(store) {\r\n    return !!(store instanceof EntityStore && store.group.caching);\r\n}\r\n","import { __assign } from \"tslib\";\r\nimport { invariant, InvariantError } from \"../../utilities/globals/index.js\";\r\nimport { wrap } from 'optimism';\r\nimport { isField, resultKeyNameFromField, isReference, makeReference, createFragmentMap, shouldInclude, addTypenameToDocument, getDefaultValues, getFragmentDefinitions, getMainDefinition, getQueryDefinition, mergeDeepArray, getFragmentFromSelection, maybeDeepFreeze, isNonNullObject, canUseWeakMap, } from \"../../utilities/index.js\";\r\nimport { maybeDependOnExistenceOfEntity, supportsResultCaching } from \"./entityStore.js\";\r\nimport { getTypenameFromStoreObject } from \"./helpers.js\";\r\nimport { MissingFieldError } from \"../core/types/common.js\";\r\nimport { canonicalStringify, ObjectCanon } from \"./object-canon.js\";\r\n;\r\nfunction missingFromInvariant(err, context) {\r\n    return new MissingFieldError(err.message, context.path.slice(), context.query, context.variables);\r\n}\r\nfunction execSelectionSetKeyArgs(options) {\r\n    return [\r\n        options.selectionSet,\r\n        options.objectOrReference,\r\n        options.context,\r\n        options.context.canonizeResults,\r\n    ];\r\n}\r\nvar StoreReader = (function () {\r\n    function StoreReader(config) {\r\n        var _this = this;\r\n        this.knownResults = new (canUseWeakMap ? WeakMap : Map)();\r\n        this.config = __assign(__assign({}, config), { addTypename: config.addTypename !== false });\r\n        this.canon = config.canon || new ObjectCanon;\r\n        this.executeSelectionSet = wrap(function (options) {\r\n            var _a;\r\n            var canonizeResults = options.context.canonizeResults;\r\n            var peekArgs = execSelectionSetKeyArgs(options);\r\n            peekArgs[3] = !canonizeResults;\r\n            var other = (_a = _this.executeSelectionSet).peek.apply(_a, peekArgs);\r\n            if (other) {\r\n                if (canonizeResults) {\r\n                    return __assign(__assign({}, other), { result: _this.canon.admit(other.result) });\r\n                }\r\n                return other;\r\n            }\r\n            maybeDependOnExistenceOfEntity(options.context.store, options.enclosingRef.__ref);\r\n            return _this.execSelectionSetImpl(options);\r\n        }, {\r\n            max: this.config.resultCacheMaxSize,\r\n            keyArgs: execSelectionSetKeyArgs,\r\n            makeCacheKey: function (selectionSet, parent, context, canonizeResults) {\r\n                if (supportsResultCaching(context.store)) {\r\n                    return context.store.makeCacheKey(selectionSet, isReference(parent) ? parent.__ref : parent, context.varString, canonizeResults);\r\n                }\r\n            }\r\n        });\r\n        this.executeSubSelectedArray = wrap(function (options) {\r\n            maybeDependOnExistenceOfEntity(options.context.store, options.enclosingRef.__ref);\r\n            return _this.execSubSelectedArrayImpl(options);\r\n        }, {\r\n            max: this.config.resultCacheMaxSize,\r\n            makeCacheKey: function (_a) {\r\n                var field = _a.field, array = _a.array, context = _a.context;\r\n                if (supportsResultCaching(context.store)) {\r\n                    return context.store.makeCacheKey(field, array, context.varString);\r\n                }\r\n            }\r\n        });\r\n    }\r\n    StoreReader.prototype.resetCanon = function () {\r\n        this.canon = new ObjectCanon;\r\n    };\r\n    StoreReader.prototype.diffQueryAgainstStore = function (_a) {\r\n        var store = _a.store, query = _a.query, _b = _a.rootId, rootId = _b === void 0 ? 'ROOT_QUERY' : _b, variables = _a.variables, _c = _a.returnPartialData, returnPartialData = _c === void 0 ? true : _c, _d = _a.canonizeResults, canonizeResults = _d === void 0 ? true : _d;\r\n        var policies = this.config.cache.policies;\r\n        variables = __assign(__assign({}, getDefaultValues(getQueryDefinition(query))), variables);\r\n        var rootRef = makeReference(rootId);\r\n        var execResult = this.executeSelectionSet({\r\n            selectionSet: getMainDefinition(query).selectionSet,\r\n            objectOrReference: rootRef,\r\n            enclosingRef: rootRef,\r\n            context: {\r\n                store: store,\r\n                query: query,\r\n                policies: policies,\r\n                variables: variables,\r\n                varString: canonicalStringify(variables),\r\n                canonizeResults: canonizeResults,\r\n                fragmentMap: createFragmentMap(getFragmentDefinitions(query)),\r\n                path: [],\r\n            },\r\n        });\r\n        var hasMissingFields = execResult.missing && execResult.missing.length > 0;\r\n        if (hasMissingFields && !returnPartialData) {\r\n            throw execResult.missing[0];\r\n        }\r\n        return {\r\n            result: execResult.result,\r\n            missing: execResult.missing,\r\n            complete: !hasMissingFields,\r\n        };\r\n    };\r\n    StoreReader.prototype.isFresh = function (result, parent, selectionSet, context) {\r\n        if (supportsResultCaching(context.store) &&\r\n            this.knownResults.get(result) === selectionSet) {\r\n            var latest = this.executeSelectionSet.peek(selectionSet, parent, context, this.canon.isKnown(result));\r\n            if (latest && result === latest.result) {\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    };\r\n    StoreReader.prototype.execSelectionSetImpl = function (_a) {\r\n        var _this = this;\r\n        var selectionSet = _a.selectionSet, objectOrReference = _a.objectOrReference, enclosingRef = _a.enclosingRef, context = _a.context;\r\n        if (isReference(objectOrReference) &&\r\n            !context.policies.rootTypenamesById[objectOrReference.__ref] &&\r\n            !context.store.has(objectOrReference.__ref)) {\r\n            return {\r\n                result: this.canon.empty,\r\n                missing: [missingFromInvariant(__DEV__ ? new InvariantError(\"Dangling reference to missing \" + objectOrReference.__ref + \" object\") : new InvariantError(5), context)],\r\n            };\r\n        }\r\n        var variables = context.variables, policies = context.policies, store = context.store;\r\n        var objectsToMerge = [];\r\n        var finalResult = { result: null };\r\n        var typename = store.getFieldValue(objectOrReference, \"__typename\");\r\n        if (this.config.addTypename &&\r\n            typeof typename === \"string\" &&\r\n            !policies.rootIdsByTypename[typename]) {\r\n            objectsToMerge.push({ __typename: typename });\r\n        }\r\n        function getMissing() {\r\n            return finalResult.missing || (finalResult.missing = []);\r\n        }\r\n        function handleMissing(result) {\r\n            var _a;\r\n            if (result.missing)\r\n                (_a = getMissing()).push.apply(_a, result.missing);\r\n            return result.result;\r\n        }\r\n        var workSet = new Set(selectionSet.selections);\r\n        workSet.forEach(function (selection) {\r\n            var _a;\r\n            if (!shouldInclude(selection, variables))\r\n                return;\r\n            if (isField(selection)) {\r\n                var fieldValue = policies.readField({\r\n                    fieldName: selection.name.value,\r\n                    field: selection,\r\n                    variables: context.variables,\r\n                    from: objectOrReference,\r\n                }, context);\r\n                var resultName = resultKeyNameFromField(selection);\r\n                context.path.push(resultName);\r\n                if (fieldValue === void 0) {\r\n                    if (!addTypenameToDocument.added(selection)) {\r\n                        getMissing().push(missingFromInvariant(__DEV__ ? new InvariantError(\"Can't find field '\" + selection.name.value + \"' on \" + (isReference(objectOrReference)\r\n                            ? objectOrReference.__ref + \" object\"\r\n                            : \"object \" + JSON.stringify(objectOrReference, null, 2))) : new InvariantError(6), context));\r\n                    }\r\n                }\r\n                else if (Array.isArray(fieldValue)) {\r\n                    fieldValue = handleMissing(_this.executeSubSelectedArray({\r\n                        field: selection,\r\n                        array: fieldValue,\r\n                        enclosingRef: enclosingRef,\r\n                        context: context,\r\n                    }));\r\n                }\r\n                else if (!selection.selectionSet) {\r\n                    if (context.canonizeResults) {\r\n                        fieldValue = _this.canon.pass(fieldValue);\r\n                    }\r\n                }\r\n                else if (fieldValue != null) {\r\n                    fieldValue = handleMissing(_this.executeSelectionSet({\r\n                        selectionSet: selection.selectionSet,\r\n                        objectOrReference: fieldValue,\r\n                        enclosingRef: isReference(fieldValue) ? fieldValue : enclosingRef,\r\n                        context: context,\r\n                    }));\r\n                }\r\n                if (fieldValue !== void 0) {\r\n                    objectsToMerge.push((_a = {}, _a[resultName] = fieldValue, _a));\r\n                }\r\n                invariant(context.path.pop() === resultName);\r\n            }\r\n            else {\r\n                var fragment = getFragmentFromSelection(selection, context.fragmentMap);\r\n                if (fragment && policies.fragmentMatches(fragment, typename)) {\r\n                    fragment.selectionSet.selections.forEach(workSet.add, workSet);\r\n                }\r\n            }\r\n        });\r\n        var merged = mergeDeepArray(objectsToMerge);\r\n        finalResult.result = context.canonizeResults\r\n            ? this.canon.admit(merged)\r\n            : maybeDeepFreeze(merged);\r\n        this.knownResults.set(finalResult.result, selectionSet);\r\n        return finalResult;\r\n    };\r\n    StoreReader.prototype.execSubSelectedArrayImpl = function (_a) {\r\n        var _this = this;\r\n        var field = _a.field, array = _a.array, enclosingRef = _a.enclosingRef, context = _a.context;\r\n        var missing;\r\n        function handleMissing(childResult, i) {\r\n            if (childResult.missing) {\r\n                missing = missing || [];\r\n                missing.push.apply(missing, childResult.missing);\r\n            }\r\n            invariant(context.path.pop() === i);\r\n            return childResult.result;\r\n        }\r\n        if (field.selectionSet) {\r\n            array = array.filter(context.store.canRead);\r\n        }\r\n        array = array.map(function (item, i) {\r\n            if (item === null) {\r\n                return null;\r\n            }\r\n            context.path.push(i);\r\n            if (Array.isArray(item)) {\r\n                return handleMissing(_this.executeSubSelectedArray({\r\n                    field: field,\r\n                    array: item,\r\n                    enclosingRef: enclosingRef,\r\n                    context: context,\r\n                }), i);\r\n            }\r\n            if (field.selectionSet) {\r\n                return handleMissing(_this.executeSelectionSet({\r\n                    selectionSet: field.selectionSet,\r\n                    objectOrReference: item,\r\n                    enclosingRef: isReference(item) ? item : enclosingRef,\r\n                    context: context,\r\n                }), i);\r\n            }\r\n            if (__DEV__) {\r\n                assertSelectionSetForIdValue(context.store, field, item);\r\n            }\r\n            invariant(context.path.pop() === i);\r\n            return item;\r\n        });\r\n        return {\r\n            result: context.canonizeResults ? this.canon.admit(array) : array,\r\n            missing: missing,\r\n        };\r\n    };\r\n    return StoreReader;\r\n}());\r\nexport { StoreReader };\r\nfunction assertSelectionSetForIdValue(store, field, fieldValue) {\r\n    if (!field.selectionSet) {\r\n        var workSet_1 = new Set([fieldValue]);\r\n        workSet_1.forEach(function (value) {\r\n            if (isNonNullObject(value)) {\r\n                __DEV__ ? invariant(!isReference(value), \"Missing selection set for object of type \" + getTypenameFromStoreObject(store, value) + \" returned for query field \" + field.name.value) : invariant(!isReference(value), 7);\r\n                Object.values(value).forEach(workSet_1.add, workSet_1);\r\n            }\r\n        });\r\n    }\r\n}\r\n","import { __assign } from \"tslib\";\r\nimport { invariant, InvariantError } from \"../../utilities/globals/index.js\";\r\nimport { equal } from '@wry/equality';\r\nimport { createFragmentMap, getFragmentFromSelection, getDefaultValues, getFragmentDefinitions, getOperationDefinition, getTypenameFromResult, makeReference, isField, resultKeyNameFromField, isReference, shouldInclude, cloneDeep, addTypenameToDocument, } from \"../../utilities/index.js\";\r\nimport { makeProcessedFieldsMerger, fieldNameFromStoreName, storeValueIsStoreObject } from \"./helpers.js\";\r\nimport { canonicalStringify } from \"./object-canon.js\";\r\n;\r\nvar StoreWriter = (function () {\r\n    function StoreWriter(cache, reader) {\r\n        this.cache = cache;\r\n        this.reader = reader;\r\n    }\r\n    StoreWriter.prototype.writeToStore = function (store, _a) {\r\n        var _this = this;\r\n        var query = _a.query, result = _a.result, dataId = _a.dataId, variables = _a.variables, overwrite = _a.overwrite;\r\n        var operationDefinition = getOperationDefinition(query);\r\n        var merger = makeProcessedFieldsMerger();\r\n        variables = __assign(__assign({}, getDefaultValues(operationDefinition)), variables);\r\n        var context = {\r\n            store: store,\r\n            written: Object.create(null),\r\n            merge: function (existing, incoming) {\r\n                return merger.merge(existing, incoming);\r\n            },\r\n            variables: variables,\r\n            varString: canonicalStringify(variables),\r\n            fragmentMap: createFragmentMap(getFragmentDefinitions(query)),\r\n            overwrite: !!overwrite,\r\n            incomingById: new Map,\r\n            clientOnly: false,\r\n        };\r\n        var ref = this.processSelectionSet({\r\n            result: result || Object.create(null),\r\n            dataId: dataId,\r\n            selectionSet: operationDefinition.selectionSet,\r\n            mergeTree: { map: new Map },\r\n            context: context,\r\n        });\r\n        if (!isReference(ref)) {\r\n            throw __DEV__ ? new InvariantError(\"Could not identify object \" + JSON.stringify(result)) : new InvariantError(8);\r\n        }\r\n        context.incomingById.forEach(function (_a, dataId) {\r\n            var fields = _a.fields, mergeTree = _a.mergeTree, selections = _a.selections;\r\n            var entityRef = makeReference(dataId);\r\n            if (mergeTree && mergeTree.map.size) {\r\n                var applied = _this.applyMerges(mergeTree, entityRef, fields, context);\r\n                if (isReference(applied)) {\r\n                    return;\r\n                }\r\n                fields = applied;\r\n            }\r\n            if (__DEV__ && !context.overwrite) {\r\n                var hasSelectionSet_1 = function (storeFieldName) {\r\n                    return fieldsWithSelectionSets_1.has(fieldNameFromStoreName(storeFieldName));\r\n                };\r\n                var fieldsWithSelectionSets_1 = new Set();\r\n                selections.forEach(function (selection) {\r\n                    if (isField(selection) && selection.selectionSet) {\r\n                        fieldsWithSelectionSets_1.add(selection.name.value);\r\n                    }\r\n                });\r\n                var hasMergeFunction_1 = function (storeFieldName) {\r\n                    var childTree = mergeTree && mergeTree.map.get(storeFieldName);\r\n                    return Boolean(childTree && childTree.info && childTree.info.merge);\r\n                };\r\n                Object.keys(fields).forEach(function (storeFieldName) {\r\n                    if (hasSelectionSet_1(storeFieldName) &&\r\n                        !hasMergeFunction_1(storeFieldName)) {\r\n                        warnAboutDataLoss(entityRef, fields, storeFieldName, context.store);\r\n                    }\r\n                });\r\n            }\r\n            store.merge(dataId, fields);\r\n        });\r\n        store.retain(ref.__ref);\r\n        return ref;\r\n    };\r\n    StoreWriter.prototype.processSelectionSet = function (_a) {\r\n        var _this = this;\r\n        var dataId = _a.dataId, result = _a.result, selectionSet = _a.selectionSet, context = _a.context, mergeTree = _a.mergeTree;\r\n        var policies = this.cache.policies;\r\n        var _b = policies.identify(result, selectionSet, context.fragmentMap), id = _b[0], keyObject = _b[1];\r\n        dataId = dataId || id;\r\n        if (\"string\" === typeof dataId) {\r\n            var sets = context.written[dataId] || (context.written[dataId] = []);\r\n            var ref = makeReference(dataId);\r\n            if (sets.indexOf(selectionSet) >= 0)\r\n                return ref;\r\n            sets.push(selectionSet);\r\n            if (this.reader && this.reader.isFresh(result, ref, selectionSet, context)) {\r\n                return ref;\r\n            }\r\n        }\r\n        var incomingFields = Object.create(null);\r\n        if (keyObject) {\r\n            incomingFields = context.merge(incomingFields, keyObject);\r\n        }\r\n        var typename = (dataId && policies.rootTypenamesById[dataId]) ||\r\n            getTypenameFromResult(result, selectionSet, context.fragmentMap) ||\r\n            (dataId && context.store.get(dataId, \"__typename\"));\r\n        if (\"string\" === typeof typename) {\r\n            incomingFields.__typename = typename;\r\n        }\r\n        var selections = new Set(selectionSet.selections);\r\n        selections.forEach(function (selection) {\r\n            var _a;\r\n            if (!shouldInclude(selection, context.variables))\r\n                return;\r\n            if (isField(selection)) {\r\n                var resultFieldKey = resultKeyNameFromField(selection);\r\n                var value = result[resultFieldKey];\r\n                var wasClientOnly = context.clientOnly;\r\n                context.clientOnly = wasClientOnly || !!(selection.directives &&\r\n                    selection.directives.some(function (d) { return d.name.value === \"client\"; }));\r\n                if (value !== void 0) {\r\n                    var storeFieldName = policies.getStoreFieldName({\r\n                        typename: typename,\r\n                        fieldName: selection.name.value,\r\n                        field: selection,\r\n                        variables: context.variables,\r\n                    });\r\n                    var childTree = getChildMergeTree(mergeTree, storeFieldName);\r\n                    var incomingValue = _this.processFieldValue(value, selection, context, childTree);\r\n                    var childTypename = void 0;\r\n                    if (selection.selectionSet) {\r\n                        childTypename = context.store.getFieldValue(incomingValue, \"__typename\");\r\n                        if (!childTypename && isReference(incomingValue)) {\r\n                            var info = context.incomingById.get(incomingValue.__ref);\r\n                            childTypename = info && info.fields.__typename;\r\n                        }\r\n                    }\r\n                    var merge = policies.getMergeFunction(typename, selection.name.value, childTypename);\r\n                    if (merge) {\r\n                        childTree.info = {\r\n                            field: selection,\r\n                            typename: typename,\r\n                            merge: merge,\r\n                        };\r\n                    }\r\n                    else {\r\n                        maybeRecycleChildMergeTree(mergeTree, storeFieldName);\r\n                    }\r\n                    incomingFields = context.merge(incomingFields, (_a = {},\r\n                        _a[storeFieldName] = incomingValue,\r\n                        _a));\r\n                }\r\n                else if (!context.clientOnly &&\r\n                    !addTypenameToDocument.added(selection)) {\r\n                    __DEV__ && invariant.error((\"Missing field '\" + resultKeyNameFromField(selection) + \"' while writing result \" + JSON.stringify(result, null, 2)).substring(0, 1000));\r\n                }\r\n                context.clientOnly = wasClientOnly;\r\n            }\r\n            else {\r\n                var fragment = getFragmentFromSelection(selection, context.fragmentMap);\r\n                if (fragment &&\r\n                    policies.fragmentMatches(fragment, typename, result, context.variables)) {\r\n                    fragment.selectionSet.selections.forEach(selections.add, selections);\r\n                }\r\n            }\r\n        });\r\n        if (\"string\" === typeof dataId) {\r\n            var previous = context.incomingById.get(dataId);\r\n            if (previous) {\r\n                previous.fields = context.merge(previous.fields, incomingFields);\r\n                previous.mergeTree = mergeMergeTrees(previous.mergeTree, mergeTree);\r\n                previous.selections.forEach(selections.add, selections);\r\n                previous.selections = selections;\r\n            }\r\n            else {\r\n                context.incomingById.set(dataId, {\r\n                    fields: incomingFields,\r\n                    mergeTree: mergeTreeIsEmpty(mergeTree) ? void 0 : mergeTree,\r\n                    selections: selections,\r\n                });\r\n            }\r\n            return makeReference(dataId);\r\n        }\r\n        return incomingFields;\r\n    };\r\n    StoreWriter.prototype.processFieldValue = function (value, field, context, mergeTree) {\r\n        var _this = this;\r\n        if (!field.selectionSet || value === null) {\r\n            return __DEV__ ? cloneDeep(value) : value;\r\n        }\r\n        if (Array.isArray(value)) {\r\n            return value.map(function (item, i) {\r\n                var value = _this.processFieldValue(item, field, context, getChildMergeTree(mergeTree, i));\r\n                maybeRecycleChildMergeTree(mergeTree, i);\r\n                return value;\r\n            });\r\n        }\r\n        return this.processSelectionSet({\r\n            result: value,\r\n            selectionSet: field.selectionSet,\r\n            context: context,\r\n            mergeTree: mergeTree,\r\n        });\r\n    };\r\n    StoreWriter.prototype.applyMerges = function (mergeTree, existing, incoming, context, getStorageArgs) {\r\n        var _a;\r\n        var _this = this;\r\n        if (mergeTree.map.size && !isReference(incoming)) {\r\n            var e_1 = (!Array.isArray(incoming) &&\r\n                (isReference(existing) || storeValueIsStoreObject(existing))) ? existing : void 0;\r\n            var i_1 = incoming;\r\n            if (e_1 && !getStorageArgs) {\r\n                getStorageArgs = [isReference(e_1) ? e_1.__ref : e_1];\r\n            }\r\n            var changedFields_1;\r\n            var getValue_1 = function (from, name) {\r\n                return Array.isArray(from)\r\n                    ? (typeof name === \"number\" ? from[name] : void 0)\r\n                    : context.store.getFieldValue(from, String(name));\r\n            };\r\n            mergeTree.map.forEach(function (childTree, storeFieldName) {\r\n                var eVal = getValue_1(e_1, storeFieldName);\r\n                var iVal = getValue_1(i_1, storeFieldName);\r\n                if (void 0 === iVal)\r\n                    return;\r\n                if (getStorageArgs) {\r\n                    getStorageArgs.push(storeFieldName);\r\n                }\r\n                var aVal = _this.applyMerges(childTree, eVal, iVal, context, getStorageArgs);\r\n                if (aVal !== iVal) {\r\n                    changedFields_1 = changedFields_1 || new Map;\r\n                    changedFields_1.set(storeFieldName, aVal);\r\n                }\r\n                if (getStorageArgs) {\r\n                    invariant(getStorageArgs.pop() === storeFieldName);\r\n                }\r\n            });\r\n            if (changedFields_1) {\r\n                incoming = (Array.isArray(i_1) ? i_1.slice(0) : __assign({}, i_1));\r\n                changedFields_1.forEach(function (value, name) {\r\n                    incoming[name] = value;\r\n                });\r\n            }\r\n        }\r\n        if (mergeTree.info) {\r\n            return this.cache.policies.runMergeFunction(existing, incoming, mergeTree.info, context, getStorageArgs && (_a = context.store).getStorage.apply(_a, getStorageArgs));\r\n        }\r\n        return incoming;\r\n    };\r\n    return StoreWriter;\r\n}());\r\nexport { StoreWriter };\r\nvar emptyMergeTreePool = [];\r\nfunction getChildMergeTree(_a, name) {\r\n    var map = _a.map;\r\n    if (!map.has(name)) {\r\n        map.set(name, emptyMergeTreePool.pop() || { map: new Map });\r\n    }\r\n    return map.get(name);\r\n}\r\nfunction mergeMergeTrees(left, right) {\r\n    if (left === right || !right || mergeTreeIsEmpty(right))\r\n        return left;\r\n    if (!left || mergeTreeIsEmpty(left))\r\n        return right;\r\n    var info = left.info && right.info ? __assign(__assign({}, left.info), right.info) : left.info || right.info;\r\n    var needToMergeMaps = left.map.size && right.map.size;\r\n    var map = needToMergeMaps ? new Map :\r\n        left.map.size ? left.map : right.map;\r\n    var merged = { info: info, map: map };\r\n    if (needToMergeMaps) {\r\n        var remainingRightKeys_1 = new Set(right.map.keys());\r\n        left.map.forEach(function (leftTree, key) {\r\n            merged.map.set(key, mergeMergeTrees(leftTree, right.map.get(key)));\r\n            remainingRightKeys_1.delete(key);\r\n        });\r\n        remainingRightKeys_1.forEach(function (key) {\r\n            merged.map.set(key, mergeMergeTrees(right.map.get(key), left.map.get(key)));\r\n        });\r\n    }\r\n    return merged;\r\n}\r\nfunction mergeTreeIsEmpty(tree) {\r\n    return !tree || !(tree.info || tree.map.size);\r\n}\r\nfunction maybeRecycleChildMergeTree(_a, name) {\r\n    var map = _a.map;\r\n    var childTree = map.get(name);\r\n    if (childTree && mergeTreeIsEmpty(childTree)) {\r\n        emptyMergeTreePool.push(childTree);\r\n        map.delete(name);\r\n    }\r\n}\r\nvar warnings = new Set();\r\nfunction warnAboutDataLoss(existingRef, incomingObj, storeFieldName, store) {\r\n    var getChild = function (objOrRef) {\r\n        var child = store.getFieldValue(objOrRef, storeFieldName);\r\n        return typeof child === \"object\" && child;\r\n    };\r\n    var existing = getChild(existingRef);\r\n    if (!existing)\r\n        return;\r\n    var incoming = getChild(incomingObj);\r\n    if (!incoming)\r\n        return;\r\n    if (isReference(existing))\r\n        return;\r\n    if (equal(existing, incoming))\r\n        return;\r\n    if (Object.keys(existing).every(function (key) { return store.getFieldValue(incoming, key) !== void 0; })) {\r\n        return;\r\n    }\r\n    var parentType = store.getFieldValue(existingRef, \"__typename\") ||\r\n        store.getFieldValue(incomingObj, \"__typename\");\r\n    var fieldName = fieldNameFromStoreName(storeFieldName);\r\n    var typeDotName = parentType + \".\" + fieldName;\r\n    if (warnings.has(typeDotName))\r\n        return;\r\n    warnings.add(typeDotName);\r\n    var childTypenames = [];\r\n    if (!Array.isArray(existing) &&\r\n        !Array.isArray(incoming)) {\r\n        [existing, incoming].forEach(function (child) {\r\n            var typename = store.getFieldValue(child, \"__typename\");\r\n            if (typeof typename === \"string\" &&\r\n                !childTypenames.includes(typename)) {\r\n                childTypenames.push(typename);\r\n            }\r\n        });\r\n    }\r\n    __DEV__ && invariant.warn(\"Cache data may be lost when replacing the \" + fieldName + \" field of a \" + parentType + \" object.\\n\\nTo address this problem (which is not a bug in Apollo Client), \" + (childTypenames.length\r\n        ? \"either ensure all objects of type \" +\r\n            childTypenames.join(\" and \") + \" have an ID or a custom merge function, or \"\r\n        : \"\") + \"define a custom merge function for the \" + typeDotName + \" field, so InMemoryCache can safely merge these objects:\\n\\n  existing: \" + JSON.stringify(existing).slice(0, 1000) + \"\\n  incoming: \" + JSON.stringify(incoming).slice(0, 1000) + \"\\n\\nFor more information about these options, please refer to the documentation:\\n\\n  * Ensuring entity objects have IDs: https://go.apollo.dev/c/generating-unique-identifiers\\n  * Defining custom merge functions: https://go.apollo.dev/c/merging-non-normalized-objects\\n\");\r\n}\r\n","import { makeUniqueId } from \"./makeUniqueId.js\";\r\nexport function stringifyForDisplay(value) {\r\n    var undefId = makeUniqueId(\"stringifyForDisplay\");\r\n    return JSON.stringify(value, function (key, value) {\r\n        return value === void 0 ? undefId : value;\r\n    }).split(JSON.stringify(undefId)).join(\"<undefined>\");\r\n}\r\n","import { __assign, __rest } from \"tslib\";\r\nimport { invariant, InvariantError } from \"../../utilities/globals/index.js\";\r\nimport { Trie } from '@wry/trie';\r\nimport { getFragmentFromSelection, isField, getTypenameFromResult, storeKeyNameFromField, argumentsObjectFromField, isReference, getStoreKeyName, canUseWeakMap, isNonNullObject, stringifyForDisplay, } from \"../../utilities/index.js\";\r\nimport { hasOwn, fieldNameFromStoreName, storeValueIsStoreObject, selectionSetMatchesResult, TypeOrFieldNameRegExp, } from \"./helpers.js\";\r\nimport { cacheSlot } from \"./reactiveVars.js\";\r\nimport { canonicalStringify } from \"./object-canon.js\";\r\ngetStoreKeyName.setStringify(canonicalStringify);\r\nfunction argsFromFieldSpecifier(spec) {\r\n    return spec.args !== void 0 ? spec.args :\r\n        spec.field ? argumentsObjectFromField(spec.field, spec.variables) : null;\r\n}\r\nexport var defaultDataIdFromObject = function (_a, context) {\r\n    var __typename = _a.__typename, id = _a.id, _id = _a._id;\r\n    if (typeof __typename === \"string\") {\r\n        if (context) {\r\n            context.keyObject =\r\n                id !== void 0 ? { id: id } :\r\n                    _id !== void 0 ? { _id: _id } :\r\n                        void 0;\r\n        }\r\n        if (id === void 0)\r\n            id = _id;\r\n        if (id !== void 0) {\r\n            return __typename + \":\" + ((typeof id === \"number\" ||\r\n                typeof id === \"string\") ? id : JSON.stringify(id));\r\n        }\r\n    }\r\n};\r\nvar nullKeyFieldsFn = function () { return void 0; };\r\nvar simpleKeyArgsFn = function (_args, context) { return context.fieldName; };\r\nvar mergeTrueFn = function (existing, incoming, _a) {\r\n    var mergeObjects = _a.mergeObjects;\r\n    return mergeObjects(existing, incoming);\r\n};\r\nvar mergeFalseFn = function (_, incoming) { return incoming; };\r\nvar Policies = (function () {\r\n    function Policies(config) {\r\n        this.config = config;\r\n        this.typePolicies = Object.create(null);\r\n        this.toBeAdded = Object.create(null);\r\n        this.supertypeMap = new Map();\r\n        this.fuzzySubtypes = new Map();\r\n        this.rootIdsByTypename = Object.create(null);\r\n        this.rootTypenamesById = Object.create(null);\r\n        this.usingPossibleTypes = false;\r\n        this.config = __assign({ dataIdFromObject: defaultDataIdFromObject }, config);\r\n        this.cache = this.config.cache;\r\n        this.setRootTypename(\"Query\");\r\n        this.setRootTypename(\"Mutation\");\r\n        this.setRootTypename(\"Subscription\");\r\n        if (config.possibleTypes) {\r\n            this.addPossibleTypes(config.possibleTypes);\r\n        }\r\n        if (config.typePolicies) {\r\n            this.addTypePolicies(config.typePolicies);\r\n        }\r\n    }\r\n    Policies.prototype.identify = function (object, selectionSet, fragmentMap) {\r\n        var typename = selectionSet && fragmentMap\r\n            ? getTypenameFromResult(object, selectionSet, fragmentMap)\r\n            : object.__typename;\r\n        if (typename === this.rootTypenamesById.ROOT_QUERY) {\r\n            return [\"ROOT_QUERY\"];\r\n        }\r\n        var context = {\r\n            typename: typename,\r\n            selectionSet: selectionSet,\r\n            fragmentMap: fragmentMap,\r\n        };\r\n        var id;\r\n        var policy = typename && this.getTypePolicy(typename);\r\n        var keyFn = policy && policy.keyFn || this.config.dataIdFromObject;\r\n        while (keyFn) {\r\n            var specifierOrId = keyFn(object, context);\r\n            if (Array.isArray(specifierOrId)) {\r\n                keyFn = keyFieldsFnFromSpecifier(specifierOrId);\r\n            }\r\n            else {\r\n                id = specifierOrId;\r\n                break;\r\n            }\r\n        }\r\n        id = id ? String(id) : void 0;\r\n        return context.keyObject ? [id, context.keyObject] : [id];\r\n    };\r\n    Policies.prototype.addTypePolicies = function (typePolicies) {\r\n        var _this = this;\r\n        Object.keys(typePolicies).forEach(function (typename) {\r\n            var _a = typePolicies[typename], queryType = _a.queryType, mutationType = _a.mutationType, subscriptionType = _a.subscriptionType, incoming = __rest(_a, [\"queryType\", \"mutationType\", \"subscriptionType\"]);\r\n            if (queryType)\r\n                _this.setRootTypename(\"Query\", typename);\r\n            if (mutationType)\r\n                _this.setRootTypename(\"Mutation\", typename);\r\n            if (subscriptionType)\r\n                _this.setRootTypename(\"Subscription\", typename);\r\n            if (hasOwn.call(_this.toBeAdded, typename)) {\r\n                _this.toBeAdded[typename].push(incoming);\r\n            }\r\n            else {\r\n                _this.toBeAdded[typename] = [incoming];\r\n            }\r\n        });\r\n    };\r\n    Policies.prototype.updateTypePolicy = function (typename, incoming) {\r\n        var _this = this;\r\n        var existing = this.getTypePolicy(typename);\r\n        var keyFields = incoming.keyFields, fields = incoming.fields;\r\n        function setMerge(existing, merge) {\r\n            existing.merge =\r\n                typeof merge === \"function\" ? merge :\r\n                    merge === true ? mergeTrueFn :\r\n                        merge === false ? mergeFalseFn :\r\n                            existing.merge;\r\n        }\r\n        setMerge(existing, incoming.merge);\r\n        existing.keyFn =\r\n            keyFields === false ? nullKeyFieldsFn :\r\n                Array.isArray(keyFields) ? keyFieldsFnFromSpecifier(keyFields) :\r\n                    typeof keyFields === \"function\" ? keyFields :\r\n                        existing.keyFn;\r\n        if (fields) {\r\n            Object.keys(fields).forEach(function (fieldName) {\r\n                var existing = _this.getFieldPolicy(typename, fieldName, true);\r\n                var incoming = fields[fieldName];\r\n                if (typeof incoming === \"function\") {\r\n                    existing.read = incoming;\r\n                }\r\n                else {\r\n                    var keyArgs = incoming.keyArgs, read = incoming.read, merge = incoming.merge;\r\n                    existing.keyFn =\r\n                        keyArgs === false ? simpleKeyArgsFn :\r\n                            Array.isArray(keyArgs) ? keyArgsFnFromSpecifier(keyArgs) :\r\n                                typeof keyArgs === \"function\" ? keyArgs :\r\n                                    existing.keyFn;\r\n                    if (typeof read === \"function\") {\r\n                        existing.read = read;\r\n                    }\r\n                    setMerge(existing, merge);\r\n                }\r\n                if (existing.read && existing.merge) {\r\n                    existing.keyFn = existing.keyFn || simpleKeyArgsFn;\r\n                }\r\n            });\r\n        }\r\n    };\r\n    Policies.prototype.setRootTypename = function (which, typename) {\r\n        if (typename === void 0) { typename = which; }\r\n        var rootId = \"ROOT_\" + which.toUpperCase();\r\n        var old = this.rootTypenamesById[rootId];\r\n        if (typename !== old) {\r\n            __DEV__ ? invariant(!old || old === which, \"Cannot change root \" + which + \" __typename more than once\") : invariant(!old || old === which, 2);\r\n            if (old)\r\n                delete this.rootIdsByTypename[old];\r\n            this.rootIdsByTypename[typename] = rootId;\r\n            this.rootTypenamesById[rootId] = typename;\r\n        }\r\n    };\r\n    Policies.prototype.addPossibleTypes = function (possibleTypes) {\r\n        var _this = this;\r\n        this.usingPossibleTypes = true;\r\n        Object.keys(possibleTypes).forEach(function (supertype) {\r\n            _this.getSupertypeSet(supertype, true);\r\n            possibleTypes[supertype].forEach(function (subtype) {\r\n                _this.getSupertypeSet(subtype, true).add(supertype);\r\n                var match = subtype.match(TypeOrFieldNameRegExp);\r\n                if (!match || match[0] !== subtype) {\r\n                    _this.fuzzySubtypes.set(subtype, new RegExp(subtype));\r\n                }\r\n            });\r\n        });\r\n    };\r\n    Policies.prototype.getTypePolicy = function (typename) {\r\n        var _this = this;\r\n        if (!hasOwn.call(this.typePolicies, typename)) {\r\n            var policy_1 = this.typePolicies[typename] = Object.create(null);\r\n            policy_1.fields = Object.create(null);\r\n            var supertypes = this.supertypeMap.get(typename);\r\n            if (supertypes && supertypes.size) {\r\n                supertypes.forEach(function (supertype) {\r\n                    var _a = _this.getTypePolicy(supertype), fields = _a.fields, rest = __rest(_a, [\"fields\"]);\r\n                    Object.assign(policy_1, rest);\r\n                    Object.assign(policy_1.fields, fields);\r\n                });\r\n            }\r\n        }\r\n        var inbox = this.toBeAdded[typename];\r\n        if (inbox && inbox.length) {\r\n            inbox.splice(0).forEach(function (policy) {\r\n                _this.updateTypePolicy(typename, policy);\r\n            });\r\n        }\r\n        return this.typePolicies[typename];\r\n    };\r\n    Policies.prototype.getFieldPolicy = function (typename, fieldName, createIfMissing) {\r\n        if (typename) {\r\n            var fieldPolicies = this.getTypePolicy(typename).fields;\r\n            return fieldPolicies[fieldName] || (createIfMissing && (fieldPolicies[fieldName] = Object.create(null)));\r\n        }\r\n    };\r\n    Policies.prototype.getSupertypeSet = function (subtype, createIfMissing) {\r\n        var supertypeSet = this.supertypeMap.get(subtype);\r\n        if (!supertypeSet && createIfMissing) {\r\n            this.supertypeMap.set(subtype, supertypeSet = new Set());\r\n        }\r\n        return supertypeSet;\r\n    };\r\n    Policies.prototype.fragmentMatches = function (fragment, typename, result, variables) {\r\n        var _this = this;\r\n        if (!fragment.typeCondition)\r\n            return true;\r\n        if (!typename)\r\n            return false;\r\n        var supertype = fragment.typeCondition.name.value;\r\n        if (typename === supertype)\r\n            return true;\r\n        if (this.usingPossibleTypes &&\r\n            this.supertypeMap.has(supertype)) {\r\n            var typenameSupertypeSet = this.getSupertypeSet(typename, true);\r\n            var workQueue_1 = [typenameSupertypeSet];\r\n            var maybeEnqueue_1 = function (subtype) {\r\n                var supertypeSet = _this.getSupertypeSet(subtype, false);\r\n                if (supertypeSet &&\r\n                    supertypeSet.size &&\r\n                    workQueue_1.indexOf(supertypeSet) < 0) {\r\n                    workQueue_1.push(supertypeSet);\r\n                }\r\n            };\r\n            var needToCheckFuzzySubtypes = !!(result && this.fuzzySubtypes.size);\r\n            var checkingFuzzySubtypes = false;\r\n            for (var i = 0; i < workQueue_1.length; ++i) {\r\n                var supertypeSet = workQueue_1[i];\r\n                if (supertypeSet.has(supertype)) {\r\n                    if (!typenameSupertypeSet.has(supertype)) {\r\n                        if (checkingFuzzySubtypes) {\r\n                            __DEV__ && invariant.warn(\"Inferring subtype \" + typename + \" of supertype \" + supertype);\r\n                        }\r\n                        typenameSupertypeSet.add(supertype);\r\n                    }\r\n                    return true;\r\n                }\r\n                supertypeSet.forEach(maybeEnqueue_1);\r\n                if (needToCheckFuzzySubtypes &&\r\n                    i === workQueue_1.length - 1 &&\r\n                    selectionSetMatchesResult(fragment.selectionSet, result, variables)) {\r\n                    needToCheckFuzzySubtypes = false;\r\n                    checkingFuzzySubtypes = true;\r\n                    this.fuzzySubtypes.forEach(function (regExp, fuzzyString) {\r\n                        var match = typename.match(regExp);\r\n                        if (match && match[0] === typename) {\r\n                            maybeEnqueue_1(fuzzyString);\r\n                        }\r\n                    });\r\n                }\r\n            }\r\n        }\r\n        return false;\r\n    };\r\n    Policies.prototype.hasKeyArgs = function (typename, fieldName) {\r\n        var policy = this.getFieldPolicy(typename, fieldName, false);\r\n        return !!(policy && policy.keyFn);\r\n    };\r\n    Policies.prototype.getStoreFieldName = function (fieldSpec) {\r\n        var typename = fieldSpec.typename, fieldName = fieldSpec.fieldName;\r\n        var policy = this.getFieldPolicy(typename, fieldName, false);\r\n        var storeFieldName;\r\n        var keyFn = policy && policy.keyFn;\r\n        if (keyFn && typename) {\r\n            var context = {\r\n                typename: typename,\r\n                fieldName: fieldName,\r\n                field: fieldSpec.field || null,\r\n                variables: fieldSpec.variables,\r\n            };\r\n            var args = argsFromFieldSpecifier(fieldSpec);\r\n            while (keyFn) {\r\n                var specifierOrString = keyFn(args, context);\r\n                if (Array.isArray(specifierOrString)) {\r\n                    keyFn = keyArgsFnFromSpecifier(specifierOrString);\r\n                }\r\n                else {\r\n                    storeFieldName = specifierOrString || fieldName;\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n        if (storeFieldName === void 0) {\r\n            storeFieldName = fieldSpec.field\r\n                ? storeKeyNameFromField(fieldSpec.field, fieldSpec.variables)\r\n                : getStoreKeyName(fieldName, argsFromFieldSpecifier(fieldSpec));\r\n        }\r\n        if (storeFieldName === false) {\r\n            return fieldName;\r\n        }\r\n        return fieldName === fieldNameFromStoreName(storeFieldName)\r\n            ? storeFieldName\r\n            : fieldName + \":\" + storeFieldName;\r\n    };\r\n    Policies.prototype.readField = function (options, context) {\r\n        var objectOrReference = options.from;\r\n        if (!objectOrReference)\r\n            return;\r\n        var nameOrField = options.field || options.fieldName;\r\n        if (!nameOrField)\r\n            return;\r\n        if (options.typename === void 0) {\r\n            var typename = context.store.getFieldValue(objectOrReference, \"__typename\");\r\n            if (typename)\r\n                options.typename = typename;\r\n        }\r\n        var storeFieldName = this.getStoreFieldName(options);\r\n        var fieldName = fieldNameFromStoreName(storeFieldName);\r\n        var existing = context.store.getFieldValue(objectOrReference, storeFieldName);\r\n        var policy = this.getFieldPolicy(options.typename, fieldName, false);\r\n        var read = policy && policy.read;\r\n        if (read) {\r\n            var readOptions = makeFieldFunctionOptions(this, objectOrReference, options, context, context.store.getStorage(isReference(objectOrReference)\r\n                ? objectOrReference.__ref\r\n                : objectOrReference, storeFieldName));\r\n            return cacheSlot.withValue(this.cache, read, [existing, readOptions]);\r\n        }\r\n        return existing;\r\n    };\r\n    Policies.prototype.getMergeFunction = function (parentTypename, fieldName, childTypename) {\r\n        var policy = this.getFieldPolicy(parentTypename, fieldName, false);\r\n        var merge = policy && policy.merge;\r\n        if (!merge && childTypename) {\r\n            policy = this.getTypePolicy(childTypename);\r\n            merge = policy && policy.merge;\r\n        }\r\n        return merge;\r\n    };\r\n    Policies.prototype.runMergeFunction = function (existing, incoming, _a, context, storage) {\r\n        var field = _a.field, typename = _a.typename, merge = _a.merge;\r\n        if (merge === mergeTrueFn) {\r\n            return makeMergeObjectsFunction(context.store)(existing, incoming);\r\n        }\r\n        if (merge === mergeFalseFn) {\r\n            return incoming;\r\n        }\r\n        if (context.overwrite) {\r\n            existing = void 0;\r\n        }\r\n        return merge(existing, incoming, makeFieldFunctionOptions(this, void 0, { typename: typename, fieldName: field.name.value, field: field, variables: context.variables }, context, storage || Object.create(null)));\r\n    };\r\n    return Policies;\r\n}());\r\nexport { Policies };\r\nfunction makeFieldFunctionOptions(policies, objectOrReference, fieldSpec, context, storage) {\r\n    var storeFieldName = policies.getStoreFieldName(fieldSpec);\r\n    var fieldName = fieldNameFromStoreName(storeFieldName);\r\n    var variables = fieldSpec.variables || context.variables;\r\n    var _a = context.store, toReference = _a.toReference, canRead = _a.canRead;\r\n    return {\r\n        args: argsFromFieldSpecifier(fieldSpec),\r\n        field: fieldSpec.field || null,\r\n        fieldName: fieldName,\r\n        storeFieldName: storeFieldName,\r\n        variables: variables,\r\n        isReference: isReference,\r\n        toReference: toReference,\r\n        storage: storage,\r\n        cache: policies.cache,\r\n        canRead: canRead,\r\n        readField: function (fieldNameOrOptions, from) {\r\n            var options;\r\n            if (typeof fieldNameOrOptions === \"string\") {\r\n                options = {\r\n                    fieldName: fieldNameOrOptions,\r\n                    from: arguments.length > 1 ? from : objectOrReference,\r\n                };\r\n            }\r\n            else if (isNonNullObject(fieldNameOrOptions)) {\r\n                options = __assign({}, fieldNameOrOptions);\r\n                if (!hasOwn.call(fieldNameOrOptions, \"from\")) {\r\n                    options.from = objectOrReference;\r\n                }\r\n            }\r\n            else {\r\n                __DEV__ && invariant.warn(\"Unexpected readField arguments: \" + stringifyForDisplay(Array.from(arguments)));\r\n                return;\r\n            }\r\n            if (__DEV__ && options.from === void 0) {\r\n                __DEV__ && invariant.warn(\"Undefined 'from' passed to readField with arguments \" + stringifyForDisplay(Array.from(arguments)));\r\n            }\r\n            if (void 0 === options.variables) {\r\n                options.variables = variables;\r\n            }\r\n            return policies.readField(options, context);\r\n        },\r\n        mergeObjects: makeMergeObjectsFunction(context.store),\r\n    };\r\n}\r\nfunction makeMergeObjectsFunction(store) {\r\n    return function mergeObjects(existing, incoming) {\r\n        if (Array.isArray(existing) || Array.isArray(incoming)) {\r\n            throw __DEV__ ? new InvariantError(\"Cannot automatically merge arrays\") : new InvariantError(3);\r\n        }\r\n        if (isNonNullObject(existing) &&\r\n            isNonNullObject(incoming)) {\r\n            var eType = store.getFieldValue(existing, \"__typename\");\r\n            var iType = store.getFieldValue(incoming, \"__typename\");\r\n            var typesDiffer = eType && iType && eType !== iType;\r\n            if (typesDiffer) {\r\n                return incoming;\r\n            }\r\n            if (isReference(existing) &&\r\n                storeValueIsStoreObject(incoming)) {\r\n                store.merge(existing.__ref, incoming);\r\n                return existing;\r\n            }\r\n            if (storeValueIsStoreObject(existing) &&\r\n                isReference(incoming)) {\r\n                store.merge(existing, incoming.__ref);\r\n                return incoming;\r\n            }\r\n            if (storeValueIsStoreObject(existing) &&\r\n                storeValueIsStoreObject(incoming)) {\r\n                return __assign(__assign({}, existing), incoming);\r\n            }\r\n        }\r\n        return incoming;\r\n    };\r\n}\r\nfunction keyArgsFnFromSpecifier(specifier) {\r\n    return function (args, context) {\r\n        return args ? context.fieldName + \":\" + JSON.stringify(computeKeyObject(args, specifier, false)) : context.fieldName;\r\n    };\r\n}\r\nfunction keyFieldsFnFromSpecifier(specifier) {\r\n    var trie = new Trie(canUseWeakMap);\r\n    return function (object, context) {\r\n        var aliasMap;\r\n        if (context.selectionSet && context.fragmentMap) {\r\n            var info = trie.lookupArray([\r\n                context.selectionSet,\r\n                context.fragmentMap,\r\n            ]);\r\n            aliasMap = info.aliasMap || (info.aliasMap = makeAliasMap(context.selectionSet, context.fragmentMap));\r\n        }\r\n        var keyObject = context.keyObject =\r\n            computeKeyObject(object, specifier, true, aliasMap);\r\n        return context.typename + \":\" + JSON.stringify(keyObject);\r\n    };\r\n}\r\nfunction makeAliasMap(selectionSet, fragmentMap) {\r\n    var map = Object.create(null);\r\n    var workQueue = new Set([selectionSet]);\r\n    workQueue.forEach(function (selectionSet) {\r\n        selectionSet.selections.forEach(function (selection) {\r\n            if (isField(selection)) {\r\n                if (selection.alias) {\r\n                    var responseKey = selection.alias.value;\r\n                    var storeKey = selection.name.value;\r\n                    if (storeKey !== responseKey) {\r\n                        var aliases = map.aliases || (map.aliases = Object.create(null));\r\n                        aliases[storeKey] = responseKey;\r\n                    }\r\n                }\r\n                if (selection.selectionSet) {\r\n                    var subsets = map.subsets || (map.subsets = Object.create(null));\r\n                    subsets[selection.name.value] =\r\n                        makeAliasMap(selection.selectionSet, fragmentMap);\r\n                }\r\n            }\r\n            else {\r\n                var fragment = getFragmentFromSelection(selection, fragmentMap);\r\n                if (fragment) {\r\n                    workQueue.add(fragment.selectionSet);\r\n                }\r\n            }\r\n        });\r\n    });\r\n    return map;\r\n}\r\nfunction computeKeyObject(response, specifier, strict, aliasMap) {\r\n    var keyObj = Object.create(null);\r\n    var lastResponseKey;\r\n    var lastActualKey;\r\n    specifier.forEach(function (s) {\r\n        if (Array.isArray(s)) {\r\n            if (typeof lastActualKey === \"string\" &&\r\n                typeof lastResponseKey === \"string\") {\r\n                var subsets = aliasMap && aliasMap.subsets;\r\n                var subset = subsets && subsets[lastActualKey];\r\n                keyObj[lastActualKey] =\r\n                    computeKeyObject(response[lastResponseKey], s, strict, subset);\r\n            }\r\n        }\r\n        else {\r\n            var aliases = aliasMap && aliasMap.aliases;\r\n            var responseName = aliases && aliases[s] || s;\r\n            if (hasOwn.call(response, responseName)) {\r\n                keyObj[lastActualKey = s] = response[lastResponseKey = responseName];\r\n            }\r\n            else {\r\n                __DEV__ ? invariant(!strict, \"Missing field '\" + responseName + \"' while computing key fields\") : invariant(!strict, 4);\r\n                lastResponseKey = lastActualKey = void 0;\r\n            }\r\n        }\r\n    });\r\n    return keyObj;\r\n}\r\n","import { __assign, __extends } from \"tslib\";\r\nimport \"./fixPolyfills.js\";\r\nimport { wrap } from 'optimism';\r\nimport { equal } from '@wry/equality';\r\nimport { ApolloCache } from \"../core/cache.js\";\r\nimport { MissingFieldError } from \"../core/types/common.js\";\r\nimport { addTypenameToDocument, isReference, } from \"../../utilities/index.js\";\r\nimport { StoreReader } from \"./readFromStore.js\";\r\nimport { StoreWriter } from \"./writeToStore.js\";\r\nimport { EntityStore, supportsResultCaching } from \"./entityStore.js\";\r\nimport { makeVar, forgetCache, recallCache } from \"./reactiveVars.js\";\r\nimport { defaultDataIdFromObject, Policies, } from \"./policies.js\";\r\nimport { hasOwn } from \"./helpers.js\";\r\nimport { canonicalStringify } from \"./object-canon.js\";\r\nvar defaultConfig = {\r\n    dataIdFromObject: defaultDataIdFromObject,\r\n    addTypename: true,\r\n    resultCaching: true,\r\n    typePolicies: {},\r\n};\r\nvar InMemoryCache = (function (_super) {\r\n    __extends(InMemoryCache, _super);\r\n    function InMemoryCache(config) {\r\n        if (config === void 0) { config = {}; }\r\n        var _this = _super.call(this) || this;\r\n        _this.watches = new Set();\r\n        _this.typenameDocumentCache = new Map();\r\n        _this.makeVar = makeVar;\r\n        _this.txCount = 0;\r\n        _this.config = __assign(__assign({}, defaultConfig), config);\r\n        _this.addTypename = !!_this.config.addTypename;\r\n        _this.policies = new Policies({\r\n            cache: _this,\r\n            dataIdFromObject: _this.config.dataIdFromObject,\r\n            possibleTypes: _this.config.possibleTypes,\r\n            typePolicies: _this.config.typePolicies,\r\n        });\r\n        _this.init();\r\n        return _this;\r\n    }\r\n    InMemoryCache.prototype.init = function () {\r\n        var rootStore = this.data = new EntityStore.Root({\r\n            policies: this.policies,\r\n            resultCaching: this.config.resultCaching,\r\n        });\r\n        this.optimisticData = rootStore.stump;\r\n        this.resetResultCache();\r\n    };\r\n    InMemoryCache.prototype.resetResultCache = function (resetResultIdentities) {\r\n        var _this = this;\r\n        var previousReader = this.storeReader;\r\n        this.storeWriter = new StoreWriter(this, this.storeReader = new StoreReader({\r\n            cache: this,\r\n            addTypename: this.addTypename,\r\n            resultCacheMaxSize: this.config.resultCacheMaxSize,\r\n            canon: resetResultIdentities\r\n                ? void 0\r\n                : previousReader && previousReader.canon,\r\n        }));\r\n        this.maybeBroadcastWatch = wrap(function (c, options) {\r\n            return _this.broadcastWatch(c, options);\r\n        }, {\r\n            max: this.config.resultCacheMaxSize,\r\n            makeCacheKey: function (c) {\r\n                var store = c.optimistic ? _this.optimisticData : _this.data;\r\n                if (supportsResultCaching(store)) {\r\n                    var optimistic = c.optimistic, rootId = c.rootId, variables = c.variables;\r\n                    return store.makeCacheKey(c.query, c.callback, canonicalStringify({ optimistic: optimistic, rootId: rootId, variables: variables }));\r\n                }\r\n            }\r\n        });\r\n        new Set([\r\n            this.data.group,\r\n            this.optimisticData.group,\r\n        ]).forEach(function (group) { return group.resetCaching(); });\r\n    };\r\n    InMemoryCache.prototype.restore = function (data) {\r\n        this.init();\r\n        if (data)\r\n            this.data.replace(data);\r\n        return this;\r\n    };\r\n    InMemoryCache.prototype.extract = function (optimistic) {\r\n        if (optimistic === void 0) { optimistic = false; }\r\n        return (optimistic ? this.optimisticData : this.data).extract();\r\n    };\r\n    InMemoryCache.prototype.read = function (options) {\r\n        var _a = options.returnPartialData, returnPartialData = _a === void 0 ? false : _a;\r\n        try {\r\n            return this.storeReader.diffQueryAgainstStore(__assign(__assign({}, options), { store: options.optimistic ? this.optimisticData : this.data, config: this.config, returnPartialData: returnPartialData })).result || null;\r\n        }\r\n        catch (e) {\r\n            if (e instanceof MissingFieldError) {\r\n                return null;\r\n            }\r\n            throw e;\r\n        }\r\n    };\r\n    InMemoryCache.prototype.write = function (options) {\r\n        try {\r\n            ++this.txCount;\r\n            return this.storeWriter.writeToStore(this.data, options);\r\n        }\r\n        finally {\r\n            if (!--this.txCount && options.broadcast !== false) {\r\n                this.broadcastWatches();\r\n            }\r\n        }\r\n    };\r\n    InMemoryCache.prototype.modify = function (options) {\r\n        if (hasOwn.call(options, \"id\") && !options.id) {\r\n            return false;\r\n        }\r\n        var store = options.optimistic\r\n            ? this.optimisticData\r\n            : this.data;\r\n        try {\r\n            ++this.txCount;\r\n            return store.modify(options.id || \"ROOT_QUERY\", options.fields);\r\n        }\r\n        finally {\r\n            if (!--this.txCount && options.broadcast !== false) {\r\n                this.broadcastWatches();\r\n            }\r\n        }\r\n    };\r\n    InMemoryCache.prototype.diff = function (options) {\r\n        return this.storeReader.diffQueryAgainstStore(__assign(__assign({}, options), { store: options.optimistic ? this.optimisticData : this.data, rootId: options.id || \"ROOT_QUERY\", config: this.config }));\r\n    };\r\n    InMemoryCache.prototype.watch = function (watch) {\r\n        var _this = this;\r\n        if (!this.watches.size) {\r\n            recallCache(this);\r\n        }\r\n        this.watches.add(watch);\r\n        if (watch.immediate) {\r\n            this.maybeBroadcastWatch(watch);\r\n        }\r\n        return function () {\r\n            if (_this.watches.delete(watch) && !_this.watches.size) {\r\n                forgetCache(_this);\r\n            }\r\n            _this.maybeBroadcastWatch.forget(watch);\r\n        };\r\n    };\r\n    InMemoryCache.prototype.gc = function (options) {\r\n        canonicalStringify.reset();\r\n        var ids = this.optimisticData.gc();\r\n        if (options && !this.txCount) {\r\n            if (options.resetResultCache) {\r\n                this.resetResultCache(options.resetResultIdentities);\r\n            }\r\n            else if (options.resetResultIdentities) {\r\n                this.storeReader.resetCanon();\r\n            }\r\n        }\r\n        return ids;\r\n    };\r\n    InMemoryCache.prototype.retain = function (rootId, optimistic) {\r\n        return (optimistic ? this.optimisticData : this.data).retain(rootId);\r\n    };\r\n    InMemoryCache.prototype.release = function (rootId, optimistic) {\r\n        return (optimistic ? this.optimisticData : this.data).release(rootId);\r\n    };\r\n    InMemoryCache.prototype.identify = function (object) {\r\n        return isReference(object) ? object.__ref :\r\n            this.policies.identify(object)[0];\r\n    };\r\n    InMemoryCache.prototype.evict = function (options) {\r\n        if (!options.id) {\r\n            if (hasOwn.call(options, \"id\")) {\r\n                return false;\r\n            }\r\n            options = __assign(__assign({}, options), { id: \"ROOT_QUERY\" });\r\n        }\r\n        try {\r\n            ++this.txCount;\r\n            return this.optimisticData.evict(options);\r\n        }\r\n        finally {\r\n            if (!--this.txCount && options.broadcast !== false) {\r\n                this.broadcastWatches();\r\n            }\r\n        }\r\n    };\r\n    InMemoryCache.prototype.reset = function () {\r\n        this.init();\r\n        this.broadcastWatches();\r\n        canonicalStringify.reset();\r\n        return Promise.resolve();\r\n    };\r\n    InMemoryCache.prototype.removeOptimistic = function (idToRemove) {\r\n        var newOptimisticData = this.optimisticData.removeLayer(idToRemove);\r\n        if (newOptimisticData !== this.optimisticData) {\r\n            this.optimisticData = newOptimisticData;\r\n            this.broadcastWatches();\r\n        }\r\n    };\r\n    InMemoryCache.prototype.batch = function (options) {\r\n        var _this = this;\r\n        var update = options.update, _a = options.optimistic, optimistic = _a === void 0 ? true : _a, removeOptimistic = options.removeOptimistic, onWatchUpdated = options.onWatchUpdated;\r\n        var perform = function (layer) {\r\n            var _a = _this, data = _a.data, optimisticData = _a.optimisticData;\r\n            ++_this.txCount;\r\n            if (layer) {\r\n                _this.data = _this.optimisticData = layer;\r\n            }\r\n            try {\r\n                update(_this);\r\n            }\r\n            finally {\r\n                --_this.txCount;\r\n                _this.data = data;\r\n                _this.optimisticData = optimisticData;\r\n            }\r\n        };\r\n        var alreadyDirty = new Set();\r\n        if (onWatchUpdated && !this.txCount) {\r\n            this.broadcastWatches(__assign(__assign({}, options), { onWatchUpdated: function (watch) {\r\n                    alreadyDirty.add(watch);\r\n                    return false;\r\n                } }));\r\n        }\r\n        if (typeof optimistic === 'string') {\r\n            this.optimisticData = this.optimisticData.addLayer(optimistic, perform);\r\n        }\r\n        else if (optimistic === false) {\r\n            perform(this.data);\r\n        }\r\n        else {\r\n            perform();\r\n        }\r\n        if (typeof removeOptimistic === \"string\") {\r\n            this.optimisticData = this.optimisticData.removeLayer(removeOptimistic);\r\n        }\r\n        if (onWatchUpdated && alreadyDirty.size) {\r\n            this.broadcastWatches(__assign(__assign({}, options), { onWatchUpdated: function (watch, diff) {\r\n                    var result = onWatchUpdated.call(this, watch, diff);\r\n                    if (result !== false) {\r\n                        alreadyDirty.delete(watch);\r\n                    }\r\n                    return result;\r\n                } }));\r\n            if (alreadyDirty.size) {\r\n                alreadyDirty.forEach(function (watch) { return _this.maybeBroadcastWatch.dirty(watch); });\r\n            }\r\n        }\r\n        else {\r\n            this.broadcastWatches(options);\r\n        }\r\n    };\r\n    InMemoryCache.prototype.performTransaction = function (update, optimisticId) {\r\n        return this.batch({\r\n            update: update,\r\n            optimistic: optimisticId || (optimisticId !== null),\r\n        });\r\n    };\r\n    InMemoryCache.prototype.transformDocument = function (document) {\r\n        if (this.addTypename) {\r\n            var result = this.typenameDocumentCache.get(document);\r\n            if (!result) {\r\n                result = addTypenameToDocument(document);\r\n                this.typenameDocumentCache.set(document, result);\r\n                this.typenameDocumentCache.set(result, result);\r\n            }\r\n            return result;\r\n        }\r\n        return document;\r\n    };\r\n    InMemoryCache.prototype.broadcastWatches = function (options) {\r\n        var _this = this;\r\n        if (!this.txCount) {\r\n            this.watches.forEach(function (c) { return _this.maybeBroadcastWatch(c, options); });\r\n        }\r\n    };\r\n    InMemoryCache.prototype.broadcastWatch = function (c, options) {\r\n        var lastDiff = c.lastDiff;\r\n        var diff = this.diff({\r\n            query: c.query,\r\n            variables: c.variables,\r\n            optimistic: c.optimistic,\r\n        });\r\n        if (options) {\r\n            if (c.optimistic &&\r\n                typeof options.optimistic === \"string\") {\r\n                diff.fromOptimisticTransaction = true;\r\n            }\r\n            if (options.onWatchUpdated &&\r\n                options.onWatchUpdated.call(this, c, diff, lastDiff) === false) {\r\n                return;\r\n            }\r\n        }\r\n        if (!lastDiff || !equal(lastDiff.result, diff.result)) {\r\n            c.callback(c.lastDiff = diff, lastDiff);\r\n        }\r\n    };\r\n    return InMemoryCache;\r\n}(ApolloCache));\r\nexport { InMemoryCache };\r\n","/**\r\n * SuiteCRM is a customer relationship management program developed by SalesAgility Ltd.\r\n * Copyright (C) 2021 SalesAgility Ltd.\r\n *\r\n * This program is free software; you can redistribute it and/or modify it under\r\n * the terms of the GNU Affero General Public License version 3 as published by the\r\n * Free Software Foundation with the addition of the following permission added\r\n * to Section 15 as permitted in Section 7(a): FOR ANY PART OF THE COVERED WORK\r\n * IN WHICH THE COPYRIGHT IS OWNED BY SALESAGILITY, SALESAGILITY DISCLAIMS THE\r\n * WARRANTY OF NON INFRINGEMENT OF THIRD PARTY RIGHTS.\r\n *\r\n * This program is distributed in the hope that it will be useful, but WITHOUT\r\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS\r\n * FOR A PARTICULAR PURPOSE. See the GNU Affero General Public License for more\r\n * details.\r\n *\r\n * You should have received a copy of the GNU Affero General Public License\r\n * along with this program.  If not, see <http://www.gnu.org/licenses/>.\r\n *\r\n * In accordance with Section 7(b) of the GNU Affero General Public License\r\n * version 3, these Appropriate Legal Notices must retain the display of the\r\n * \"Supercharged by SuiteCRM\" logo. If the display of the logos is not reasonably\r\n * feasible for technical reasons, the Appropriate Legal Notices must display\r\n * the words \"Supercharged by SuiteCRM\".\r\n */\r\n\r\nimport {NgModule} from '@angular/core';\r\nimport {RouterModule, Routes} from '@angular/router';\r\n\r\nconst routes: Routes = [];\r\n\r\n@NgModule({\r\n    imports: [RouterModule.forRoot(routes, {\r\n        useHash: true,\r\n        onSameUrlNavigation: 'reload',\r\n        relativeLinkResolution: 'legacy'\r\n    })],\r\n    exports: [RouterModule]\r\n})\r\nexport class AppRoutingModule {\r\n}\r\n","<! --\r\n/**\r\n* SuiteCRM is a customer relationship management program developed by SalesAgility Ltd.\r\n* Copyright (C) 2021 SalesAgility Ltd.\r\n*\r\n* This program is free software; you can redistribute it and/or modify it under\r\n* the terms of the GNU Affero General Public License version 3 as published by the\r\n* Free Software Foundation with the addition of the following permission added\r\n* to Section 15 as permitted in Section 7(a): FOR ANY PART OF THE COVERED WORK\r\n* IN WHICH THE COPYRIGHT IS OWNED BY SALESAGILITY, SALESAGILITY DISCLAIMS THE\r\n* WARRANTY OF NON INFRINGEMENT OF THIRD PARTY RIGHTS.\r\n*\r\n* This program is distributed in the hope that it will be useful, but WITHOUT\r\n* ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS\r\n* FOR A PARTICULAR PURPOSE. See the GNU Affero General Public License for more\r\n* details.\r\n*\r\n* You should have received a copy of the GNU Affero General Public License\r\n* along with this program.  If not, see http://www.gnu.org/licenses.\r\n*\r\n* In accordance with Section 7(b) of the GNU Affero General Public License\r\n* version 3, these Appropriate Legal Notices must retain the display of the\r\n* \"Supercharged by SuiteCRM\" logo. If the display of the logos is not reasonably\r\n* feasible for technical reasons, the Appropriate Legal Notices must display\r\n* the words \"Supercharged by SuiteCRM\".\r\n*/\r\n-->\r\n<div class=\"app-shell\">\r\n    <ng-container *ngIf=\"(appState$ | async) as appState\">\r\n        <app-full-page-spinner *ngIf=\"appState.loading || appState.initialAppLoading\"></app-full-page-spinner>\r\n    </ng-container>\r\n    <scrm-navbar-ui></scrm-navbar-ui>\r\n    <scrm-message-ui></scrm-message-ui>\r\n    <div #mainOutlet></div>\r\n    <router-outlet></router-outlet>\r\n</div>\r\n<scrm-footer-ui></scrm-footer-ui>\r\n","/**\r\n * SuiteCRM is a customer relationship management program developed by SalesAgility Ltd.\r\n * Copyright (C) 2021 SalesAgility Ltd.\r\n *\r\n * This program is free software; you can redistribute it and/or modify it under\r\n * the terms of the GNU Affero General Public License version 3 as published by the\r\n * Free Software Foundation with the addition of the following permission added\r\n * to Section 15 as permitted in Section 7(a): FOR ANY PART OF THE COVERED WORK\r\n * IN WHICH THE COPYRIGHT IS OWNED BY SALESAGILITY, SALESAGILITY DISCLAIMS THE\r\n * WARRANTY OF NON INFRINGEMENT OF THIRD PARTY RIGHTS.\r\n *\r\n * This program is distributed in the hope that it will be useful, but WITHOUT\r\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS\r\n * FOR A PARTICULAR PURPOSE. See the GNU Affero General Public License for more\r\n * details.\r\n *\r\n * You should have received a copy of the GNU Affero General Public License\r\n * along with this program.  If not, see <http://www.gnu.org/licenses/>.\r\n *\r\n * In accordance with Section 7(b) of the GNU Affero General Public License\r\n * version 3, these Appropriate Legal Notices must retain the display of the\r\n * \"Supercharged by SuiteCRM\" logo. If the display of the logos is not reasonably\r\n * feasible for technical reasons, the Appropriate Legal Notices must display\r\n * the words \"Supercharged by SuiteCRM\".\r\n */\r\n\r\nimport {Component, ViewChild, ViewContainerRef} from '@angular/core';\r\nimport {Event, NavigationCancel, NavigationEnd, NavigationError, NavigationStart, Router} from '@angular/router';\r\nimport {AppState, AppStateStore, StateManager, SystemConfigStore} from 'core';\r\nimport {Observable} from 'rxjs';\r\nimport {debounceTime} from 'rxjs/operators';\r\n\r\n@Component({\r\n    selector: 'app-root',\r\n    templateUrl: './app.component.html'\r\n})\r\nexport class AppComponent {\r\n    @ViewChild('mainOutlet', {read: ViewContainerRef, static: true})\r\n    mainOutlet: ViewContainerRef | undefined;\r\n    appState$: Observable<AppState> = this.appStateStore.vm$.pipe(debounceTime(0));\r\n\r\n    constructor(\r\n        private router: Router,\r\n        private appStateStore: AppStateStore,\r\n        protected stateManager: StateManager,\r\n        protected systemConfigs: SystemConfigStore\r\n    ) {\r\n        router.events.subscribe((routerEvent: Event) => this.checkRouterEvent(routerEvent));\r\n    }\r\n\r\n    protected checkRouterEvent(routerEvent: Event): void {\r\n        if (routerEvent instanceof NavigationStart) {\r\n            this.appStateStore.updateLoading('router-navigation', true);\r\n            this.conditionalCacheReset();\r\n\r\n        }\r\n\r\n        if (routerEvent instanceof NavigationEnd) {\r\n            // reset scroll on navigation\r\n            window.scrollTo(0, 0);\r\n            this.appStateStore.setRouteUrl(routerEvent.url)\r\n        }\r\n\r\n\r\n        if (routerEvent instanceof NavigationEnd ||\r\n            routerEvent instanceof NavigationCancel ||\r\n            routerEvent instanceof NavigationError) {\r\n            this.appStateStore.updateLoading('router-navigation', false);\r\n            this.appStateStore.updateInitialAppLoading(false);\r\n        }\r\n    }\r\n\r\n    protected conditionalCacheReset(): void {\r\n        const cacheClearActions = this.systemConfigs.getConfigValue('cache_reset_actions');\r\n        const previousModule = this.appStateStore.getModule();\r\n        const view = this.appStateStore.getView();\r\n\r\n        if (!cacheClearActions || !previousModule) {\r\n            return;\r\n        }\r\n\r\n        const resetCacheActions: string[] = cacheClearActions[previousModule];\r\n\r\n        if (!resetCacheActions || !resetCacheActions.length) {\r\n            return;\r\n        }\r\n\r\n        resetCacheActions.some(action => {\r\n            if (action === 'any' || action === view) {\r\n                this.stateManager.clearAuthBased();\r\n                return true;\r\n            }\r\n        });\r\n    }\r\n}\r\n","/**\r\n * @license Angular v12.1.0\r\n * (c) 2010-2021 Google LLC. https://angular.io/\r\n * License: MIT\r\n */\r\n\r\nimport { ɵAnimationGroupPlayer, NoopAnimationPlayer, AUTO_STYLE, ɵPRE_STYLE, sequence, style } from '@angular/animations';\r\nimport { Injectable } from '@angular/core';\r\n\r\n/**\r\n * @license\r\n * Copyright Google LLC All Rights Reserved.\r\n *\r\n * Use of this source code is governed by an MIT-style license that can be\r\n * found in the LICENSE file at https://angular.io/license\r\n */\r\nimport * as ɵngcc0 from '@angular/core';\r\nfunction isBrowser() {\r\n    return (typeof window !== 'undefined' && typeof window.document !== 'undefined');\r\n}\r\nfunction isNode() {\r\n    // Checking only for `process` isn't enough to identify whether or not we're in a Node\r\n    // environment, because Webpack by default will polyfill the `process`. While we can discern\r\n    // that Webpack polyfilled it by looking at `process.browser`, it's very Webpack-specific and\r\n    // might not be future-proof. Instead we look at the stringified version of `process` which\r\n    // is `[object process]` in Node and `[object Object]` when polyfilled.\r\n    return typeof process !== 'undefined' && {}.toString.call(process) === '[object process]';\r\n}\r\nfunction optimizeGroupPlayer(players) {\r\n    switch (players.length) {\r\n        case 0:\r\n            return new NoopAnimationPlayer();\r\n        case 1:\r\n            return players[0];\r\n        default:\r\n            return new ɵAnimationGroupPlayer(players);\r\n    }\r\n}\r\nfunction normalizeKeyframes(driver, normalizer, element, keyframes, preStyles = {}, postStyles = {}) {\r\n    const errors = [];\r\n    const normalizedKeyframes = [];\r\n    let previousOffset = -1;\r\n    let previousKeyframe = null;\r\n    keyframes.forEach(kf => {\r\n        const offset = kf['offset'];\r\n        const isSameOffset = offset == previousOffset;\r\n        const normalizedKeyframe = (isSameOffset && previousKeyframe) || {};\r\n        Object.keys(kf).forEach(prop => {\r\n            let normalizedProp = prop;\r\n            let normalizedValue = kf[prop];\r\n            if (prop !== 'offset') {\r\n                normalizedProp = normalizer.normalizePropertyName(normalizedProp, errors);\r\n                switch (normalizedValue) {\r\n                    case ɵPRE_STYLE:\r\n                        normalizedValue = preStyles[prop];\r\n                        break;\r\n                    case AUTO_STYLE:\r\n                        normalizedValue = postStyles[prop];\r\n                        break;\r\n                    default:\r\n                        normalizedValue =\r\n                            normalizer.normalizeStyleValue(prop, normalizedProp, normalizedValue, errors);\r\n                        break;\r\n                }\r\n            }\r\n            normalizedKeyframe[normalizedProp] = normalizedValue;\r\n        });\r\n        if (!isSameOffset) {\r\n            normalizedKeyframes.push(normalizedKeyframe);\r\n        }\r\n        previousKeyframe = normalizedKeyframe;\r\n        previousOffset = offset;\r\n    });\r\n    if (errors.length) {\r\n        const LINE_START = '\\n - ';\r\n        throw new Error(`Unable to animate due to the following errors:${LINE_START}${errors.join(LINE_START)}`);\r\n    }\r\n    return normalizedKeyframes;\r\n}\r\nfunction listenOnPlayer(player, eventName, event, callback) {\r\n    switch (eventName) {\r\n        case 'start':\r\n            player.onStart(() => callback(event && copyAnimationEvent(event, 'start', player)));\r\n            break;\r\n        case 'done':\r\n            player.onDone(() => callback(event && copyAnimationEvent(event, 'done', player)));\r\n            break;\r\n        case 'destroy':\r\n            player.onDestroy(() => callback(event && copyAnimationEvent(event, 'destroy', player)));\r\n            break;\r\n    }\r\n}\r\nfunction copyAnimationEvent(e, phaseName, player) {\r\n    const totalTime = player.totalTime;\r\n    const disabled = player.disabled ? true : false;\r\n    const event = makeAnimationEvent(e.element, e.triggerName, e.fromState, e.toState, phaseName || e.phaseName, totalTime == undefined ? e.totalTime : totalTime, disabled);\r\n    const data = e['_data'];\r\n    if (data != null) {\r\n        event['_data'] = data;\r\n    }\r\n    return event;\r\n}\r\nfunction makeAnimationEvent(element, triggerName, fromState, toState, phaseName = '', totalTime = 0, disabled) {\r\n    return { element, triggerName, fromState, toState, phaseName, totalTime, disabled: !!disabled };\r\n}\r\nfunction getOrSetAsInMap(map, key, defaultValue) {\r\n    let value;\r\n    if (map instanceof Map) {\r\n        value = map.get(key);\r\n        if (!value) {\r\n            map.set(key, value = defaultValue);\r\n        }\r\n    }\r\n    else {\r\n        value = map[key];\r\n        if (!value) {\r\n            value = map[key] = defaultValue;\r\n        }\r\n    }\r\n    return value;\r\n}\r\nfunction parseTimelineCommand(command) {\r\n    const separatorPos = command.indexOf(':');\r\n    const id = command.substring(1, separatorPos);\r\n    const action = command.substr(separatorPos + 1);\r\n    return [id, action];\r\n}\r\nlet _contains = (elm1, elm2) => false;\r\nconst ɵ0 = _contains;\r\nlet _matches = (element, selector) => false;\r\nconst ɵ1 = _matches;\r\nlet _query = (element, selector, multi) => {\r\n    return [];\r\n};\r\nconst ɵ2 = _query;\r\n// Define utility methods for browsers and platform-server(domino) where Element\r\n// and utility methods exist.\r\nconst _isNode = isNode();\r\nif (_isNode || typeof Element !== 'undefined') {\r\n    if (!isBrowser()) {\r\n        _contains = (elm1, elm2) => elm1.contains(elm2);\r\n    }\r\n    else {\r\n        _contains = (elm1, elm2) => {\r\n            while (elm2 && elm2 !== document.documentElement) {\r\n                if (elm2 === elm1) {\r\n                    return true;\r\n                }\r\n                elm2 = elm2.parentNode || elm2.host; // consider host to support shadow DOM\r\n            }\r\n            return false;\r\n        };\r\n    }\r\n    _matches = (() => {\r\n        if (_isNode || Element.prototype.matches) {\r\n            return (element, selector) => element.matches(selector);\r\n        }\r\n        else {\r\n            const proto = Element.prototype;\r\n            const fn = proto.matchesSelector || proto.mozMatchesSelector || proto.msMatchesSelector ||\r\n                proto.oMatchesSelector || proto.webkitMatchesSelector;\r\n            if (fn) {\r\n                return (element, selector) => fn.apply(element, [selector]);\r\n            }\r\n            else {\r\n                return _matches;\r\n            }\r\n        }\r\n    })();\r\n    _query = (element, selector, multi) => {\r\n        let results = [];\r\n        if (multi) {\r\n            // DO NOT REFACTOR TO USE SPREAD SYNTAX.\r\n            // For element queries that return sufficiently large NodeList objects,\r\n            // using spread syntax to populate the results array causes a RangeError\r\n            // due to the call stack limit being reached. `Array.from` can not be used\r\n            // as well, since NodeList is not iterable in IE 11, see\r\n            // https://developer.mozilla.org/en-US/docs/Web/API/NodeList\r\n            // More info is available in #38551.\r\n            const elems = element.querySelectorAll(selector);\r\n            for (let i = 0; i < elems.length; i++) {\r\n                results.push(elems[i]);\r\n            }\r\n        }\r\n        else {\r\n            const elm = element.querySelector(selector);\r\n            if (elm) {\r\n                results.push(elm);\r\n            }\r\n        }\r\n        return results;\r\n    };\r\n}\r\nfunction containsVendorPrefix(prop) {\r\n    // Webkit is the only real popular vendor prefix nowadays\r\n    // cc: http://shouldiprefix.com/\r\n    return prop.substring(1, 6) == 'ebkit'; // webkit or Webkit\r\n}\r\nlet _CACHED_BODY = null;\r\nlet _IS_WEBKIT = false;\r\nfunction validateStyleProperty(prop) {\r\n    if (!_CACHED_BODY) {\r\n        _CACHED_BODY = getBodyNode() || {};\r\n        _IS_WEBKIT = _CACHED_BODY.style ? ('WebkitAppearance' in _CACHED_BODY.style) : false;\r\n    }\r\n    let result = true;\r\n    if (_CACHED_BODY.style && !containsVendorPrefix(prop)) {\r\n        result = prop in _CACHED_BODY.style;\r\n        if (!result && _IS_WEBKIT) {\r\n            const camelProp = 'Webkit' + prop.charAt(0).toUpperCase() + prop.substr(1);\r\n            result = camelProp in _CACHED_BODY.style;\r\n        }\r\n    }\r\n    return result;\r\n}\r\nfunction getBodyNode() {\r\n    if (typeof document != 'undefined') {\r\n        return document.body;\r\n    }\r\n    return null;\r\n}\r\nconst matchesElement = _matches;\r\nconst containsElement = _contains;\r\nconst invokeQuery = _query;\r\nfunction hypenatePropsObject(object) {\r\n    const newObj = {};\r\n    Object.keys(object).forEach(prop => {\r\n        const newProp = prop.replace(/([a-z])([A-Z])/g, '$1-$2');\r\n        newObj[newProp] = object[prop];\r\n    });\r\n    return newObj;\r\n}\r\n\r\n/**\r\n * @license\r\n * Copyright Google LLC All Rights Reserved.\r\n *\r\n * Use of this source code is governed by an MIT-style license that can be\r\n * found in the LICENSE file at https://angular.io/license\r\n */\r\n/**\r\n * @publicApi\r\n */\r\nclass NoopAnimationDriver {\r\n    validateStyleProperty(prop) {\r\n        return validateStyleProperty(prop);\r\n    }\r\n    matchesElement(element, selector) {\r\n        return matchesElement(element, selector);\r\n    }\r\n    containsElement(elm1, elm2) {\r\n        return containsElement(elm1, elm2);\r\n    }\r\n    query(element, selector, multi) {\r\n        return invokeQuery(element, selector, multi);\r\n    }\r\n    computeStyle(element, prop, defaultValue) {\r\n        return defaultValue || '';\r\n    }\r\n    animate(element, keyframes, duration, delay, easing, previousPlayers = [], scrubberAccessRequested) {\r\n        return new NoopAnimationPlayer(duration, delay);\r\n    }\r\n}\r\nNoopAnimationDriver.ɵfac = function NoopAnimationDriver_Factory(t) { return new (t || NoopAnimationDriver)(); };\r\nNoopAnimationDriver.ɵprov = /*@__PURE__*/ ɵngcc0.ɵɵdefineInjectable({ token: NoopAnimationDriver, factory: NoopAnimationDriver.ɵfac });\r\n(function () { (typeof ngDevMode === \"undefined\" || ngDevMode) && ɵngcc0.ɵsetClassMetadata(NoopAnimationDriver, [{\r\n        type: Injectable\r\n    }], null, null); })();\r\n/**\r\n * @publicApi\r\n */\r\nclass AnimationDriver {\r\n}\r\nAnimationDriver.NOOP = new NoopAnimationDriver();\r\n\r\n/**\r\n * @license\r\n * Copyright Google LLC All Rights Reserved.\r\n *\r\n * Use of this source code is governed by an MIT-style license that can be\r\n * found in the LICENSE file at https://angular.io/license\r\n */\r\nconst ONE_SECOND = 1000;\r\nconst SUBSTITUTION_EXPR_START = '{{';\r\nconst SUBSTITUTION_EXPR_END = '}}';\r\nconst ENTER_CLASSNAME = 'ng-enter';\r\nconst LEAVE_CLASSNAME = 'ng-leave';\r\nconst ENTER_SELECTOR = '.ng-enter';\r\nconst LEAVE_SELECTOR = '.ng-leave';\r\nconst NG_TRIGGER_CLASSNAME = 'ng-trigger';\r\nconst NG_TRIGGER_SELECTOR = '.ng-trigger';\r\nconst NG_ANIMATING_CLASSNAME = 'ng-animating';\r\nconst NG_ANIMATING_SELECTOR = '.ng-animating';\r\nfunction resolveTimingValue(value) {\r\n    if (typeof value == 'number')\r\n        return value;\r\n    const matches = value.match(/^(-?[\\.\\d]+)(m?s)/);\r\n    if (!matches || matches.length < 2)\r\n        return 0;\r\n    return _convertTimeValueToMS(parseFloat(matches[1]), matches[2]);\r\n}\r\nfunction _convertTimeValueToMS(value, unit) {\r\n    switch (unit) {\r\n        case 's':\r\n            return value * ONE_SECOND;\r\n        default: // ms or something else\r\n            return value;\r\n    }\r\n}\r\nfunction resolveTiming(timings, errors, allowNegativeValues) {\r\n    return timings.hasOwnProperty('duration') ?\r\n        timings :\r\n        parseTimeExpression(timings, errors, allowNegativeValues);\r\n}\r\nfunction parseTimeExpression(exp, errors, allowNegativeValues) {\r\n    const regex = /^(-?[\\.\\d]+)(m?s)(?:\\s+(-?[\\.\\d]+)(m?s))?(?:\\s+([-a-z]+(?:\\(.+?\\))?))?$/i;\r\n    let duration;\r\n    let delay = 0;\r\n    let easing = '';\r\n    if (typeof exp === 'string') {\r\n        const matches = exp.match(regex);\r\n        if (matches === null) {\r\n            errors.push(`The provided timing value \"${exp}\" is invalid.`);\r\n            return { duration: 0, delay: 0, easing: '' };\r\n        }\r\n        duration = _convertTimeValueToMS(parseFloat(matches[1]), matches[2]);\r\n        const delayMatch = matches[3];\r\n        if (delayMatch != null) {\r\n            delay = _convertTimeValueToMS(parseFloat(delayMatch), matches[4]);\r\n        }\r\n        const easingVal = matches[5];\r\n        if (easingVal) {\r\n            easing = easingVal;\r\n        }\r\n    }\r\n    else {\r\n        duration = exp;\r\n    }\r\n    if (!allowNegativeValues) {\r\n        let containsErrors = false;\r\n        let startIndex = errors.length;\r\n        if (duration < 0) {\r\n            errors.push(`Duration values below 0 are not allowed for this animation step.`);\r\n            containsErrors = true;\r\n        }\r\n        if (delay < 0) {\r\n            errors.push(`Delay values below 0 are not allowed for this animation step.`);\r\n            containsErrors = true;\r\n        }\r\n        if (containsErrors) {\r\n            errors.splice(startIndex, 0, `The provided timing value \"${exp}\" is invalid.`);\r\n        }\r\n    }\r\n    return { duration, delay, easing };\r\n}\r\nfunction copyObj(obj, destination = {}) {\r\n    Object.keys(obj).forEach(prop => {\r\n        destination[prop] = obj[prop];\r\n    });\r\n    return destination;\r\n}\r\nfunction normalizeStyles(styles) {\r\n    const normalizedStyles = {};\r\n    if (Array.isArray(styles)) {\r\n        styles.forEach(data => copyStyles(data, false, normalizedStyles));\r\n    }\r\n    else {\r\n        copyStyles(styles, false, normalizedStyles);\r\n    }\r\n    return normalizedStyles;\r\n}\r\nfunction copyStyles(styles, readPrototype, destination = {}) {\r\n    if (readPrototype) {\r\n        // we make use of a for-in loop so that the\r\n        // prototypically inherited properties are\r\n        // revealed from the backFill map\r\n        for (let prop in styles) {\r\n            destination[prop] = styles[prop];\r\n        }\r\n    }\r\n    else {\r\n        copyObj(styles, destination);\r\n    }\r\n    return destination;\r\n}\r\nfunction getStyleAttributeString(element, key, value) {\r\n    // Return the key-value pair string to be added to the style attribute for the\r\n    // given CSS style key.\r\n    if (value) {\r\n        return key + ':' + value + ';';\r\n    }\r\n    else {\r\n        return '';\r\n    }\r\n}\r\nfunction writeStyleAttribute(element) {\r\n    // Read the style property of the element and manually reflect it to the\r\n    // style attribute. This is needed because Domino on platform-server doesn't\r\n    // understand the full set of allowed CSS properties and doesn't reflect some\r\n    // of them automatically.\r\n    let styleAttrValue = '';\r\n    for (let i = 0; i < element.style.length; i++) {\r\n        const key = element.style.item(i);\r\n        styleAttrValue += getStyleAttributeString(element, key, element.style.getPropertyValue(key));\r\n    }\r\n    for (const key in element.style) {\r\n        // Skip internal Domino properties that don't need to be reflected.\r\n        if (!element.style.hasOwnProperty(key) || key.startsWith('_')) {\r\n            continue;\r\n        }\r\n        const dashKey = camelCaseToDashCase(key);\r\n        styleAttrValue += getStyleAttributeString(element, dashKey, element.style[key]);\r\n    }\r\n    element.setAttribute('style', styleAttrValue);\r\n}\r\nfunction setStyles(element, styles, formerStyles) {\r\n    if (element['style']) {\r\n        Object.keys(styles).forEach(prop => {\r\n            const camelProp = dashCaseToCamelCase(prop);\r\n            if (formerStyles && !formerStyles.hasOwnProperty(prop)) {\r\n                formerStyles[prop] = element.style[camelProp];\r\n            }\r\n            element.style[camelProp] = styles[prop];\r\n        });\r\n        // On the server set the 'style' attribute since it's not automatically reflected.\r\n        if (isNode()) {\r\n            writeStyleAttribute(element);\r\n        }\r\n    }\r\n}\r\nfunction eraseStyles(element, styles) {\r\n    if (element['style']) {\r\n        Object.keys(styles).forEach(prop => {\r\n            const camelProp = dashCaseToCamelCase(prop);\r\n            element.style[camelProp] = '';\r\n        });\r\n        // On the server set the 'style' attribute since it's not automatically reflected.\r\n        if (isNode()) {\r\n            writeStyleAttribute(element);\r\n        }\r\n    }\r\n}\r\nfunction normalizeAnimationEntry(steps) {\r\n    if (Array.isArray(steps)) {\r\n        if (steps.length == 1)\r\n            return steps[0];\r\n        return sequence(steps);\r\n    }\r\n    return steps;\r\n}\r\nfunction validateStyleParams(value, options, errors) {\r\n    const params = options.params || {};\r\n    const matches = extractStyleParams(value);\r\n    if (matches.length) {\r\n        matches.forEach(varName => {\r\n            if (!params.hasOwnProperty(varName)) {\r\n                errors.push(`Unable to resolve the local animation param ${varName} in the given list of values`);\r\n            }\r\n        });\r\n    }\r\n}\r\nconst PARAM_REGEX = new RegExp(`${SUBSTITUTION_EXPR_START}\\\\s*(.+?)\\\\s*${SUBSTITUTION_EXPR_END}`, 'g');\r\nfunction extractStyleParams(value) {\r\n    let params = [];\r\n    if (typeof value === 'string') {\r\n        let match;\r\n        while (match = PARAM_REGEX.exec(value)) {\r\n            params.push(match[1]);\r\n        }\r\n        PARAM_REGEX.lastIndex = 0;\r\n    }\r\n    return params;\r\n}\r\nfunction interpolateParams(value, params, errors) {\r\n    const original = value.toString();\r\n    const str = original.replace(PARAM_REGEX, (_, varName) => {\r\n        let localVal = params[varName];\r\n        // this means that the value was never overridden by the data passed in by the user\r\n        if (!params.hasOwnProperty(varName)) {\r\n            errors.push(`Please provide a value for the animation param ${varName}`);\r\n            localVal = '';\r\n        }\r\n        return localVal.toString();\r\n    });\r\n    // we do this to assert that numeric values stay as they are\r\n    return str == original ? value : str;\r\n}\r\nfunction iteratorToArray(iterator) {\r\n    const arr = [];\r\n    let item = iterator.next();\r\n    while (!item.done) {\r\n        arr.push(item.value);\r\n        item = iterator.next();\r\n    }\r\n    return arr;\r\n}\r\nconst DASH_CASE_REGEXP = /-+([a-z0-9])/g;\r\nfunction dashCaseToCamelCase(input) {\r\n    return input.replace(DASH_CASE_REGEXP, (...m) => m[1].toUpperCase());\r\n}\r\nfunction camelCaseToDashCase(input) {\r\n    return input.replace(/([a-z])([A-Z])/g, '$1-$2').toLowerCase();\r\n}\r\nfunction allowPreviousPlayerStylesMerge(duration, delay) {\r\n    return duration === 0 || delay === 0;\r\n}\r\nfunction balancePreviousStylesIntoKeyframes(element, keyframes, previousStyles) {\r\n    const previousStyleProps = Object.keys(previousStyles);\r\n    if (previousStyleProps.length && keyframes.length) {\r\n        let startingKeyframe = keyframes[0];\r\n        let missingStyleProps = [];\r\n        previousStyleProps.forEach(prop => {\r\n            if (!startingKeyframe.hasOwnProperty(prop)) {\r\n                missingStyleProps.push(prop);\r\n            }\r\n            startingKeyframe[prop] = previousStyles[prop];\r\n        });\r\n        if (missingStyleProps.length) {\r\n            // tslint:disable-next-line\r\n            for (var i = 1; i < keyframes.length; i++) {\r\n                let kf = keyframes[i];\r\n                missingStyleProps.forEach(function (prop) {\r\n                    kf[prop] = computeStyle(element, prop);\r\n                });\r\n            }\r\n        }\r\n    }\r\n    return keyframes;\r\n}\r\nfunction visitDslNode(visitor, node, context) {\r\n    switch (node.type) {\r\n        case 7 /* Trigger */:\r\n            return visitor.visitTrigger(node, context);\r\n        case 0 /* State */:\r\n            return visitor.visitState(node, context);\r\n        case 1 /* Transition */:\r\n            return visitor.visitTransition(node, context);\r\n        case 2 /* Sequence */:\r\n            return visitor.visitSequence(node, context);\r\n        case 3 /* Group */:\r\n            return visitor.visitGroup(node, context);\r\n        case 4 /* Animate */:\r\n            return visitor.visitAnimate(node, context);\r\n        case 5 /* Keyframes */:\r\n            return visitor.visitKeyframes(node, context);\r\n        case 6 /* Style */:\r\n            return visitor.visitStyle(node, context);\r\n        case 8 /* Reference */:\r\n            return visitor.visitReference(node, context);\r\n        case 9 /* AnimateChild */:\r\n            return visitor.visitAnimateChild(node, context);\r\n        case 10 /* AnimateRef */:\r\n            return visitor.visitAnimateRef(node, context);\r\n        case 11 /* Query */:\r\n            return visitor.visitQuery(node, context);\r\n        case 12 /* Stagger */:\r\n            return visitor.visitStagger(node, context);\r\n        default:\r\n            throw new Error(`Unable to resolve animation metadata node #${node.type}`);\r\n    }\r\n}\r\nfunction computeStyle(element, prop) {\r\n    return window.getComputedStyle(element)[prop];\r\n}\r\n\r\n/**\r\n * @license\r\n * Copyright Google LLC All Rights Reserved.\r\n *\r\n * Use of this source code is governed by an MIT-style license that can be\r\n * found in the LICENSE file at https://angular.io/license\r\n */\r\nconst ANY_STATE = '*';\r\nfunction parseTransitionExpr(transitionValue, errors) {\r\n    const expressions = [];\r\n    if (typeof transitionValue == 'string') {\r\n        transitionValue.split(/\\s*,\\s*/).forEach(str => parseInnerTransitionStr(str, expressions, errors));\r\n    }\r\n    else {\r\n        expressions.push(transitionValue);\r\n    }\r\n    return expressions;\r\n}\r\nfunction parseInnerTransitionStr(eventStr, expressions, errors) {\r\n    if (eventStr[0] == ':') {\r\n        const result = parseAnimationAlias(eventStr, errors);\r\n        if (typeof result == 'function') {\r\n            expressions.push(result);\r\n            return;\r\n        }\r\n        eventStr = result;\r\n    }\r\n    const match = eventStr.match(/^(\\*|[-\\w]+)\\s*(<?[=-]>)\\s*(\\*|[-\\w]+)$/);\r\n    if (match == null || match.length < 4) {\r\n        errors.push(`The provided transition expression \"${eventStr}\" is not supported`);\r\n        return expressions;\r\n    }\r\n    const fromState = match[1];\r\n    const separator = match[2];\r\n    const toState = match[3];\r\n    expressions.push(makeLambdaFromStates(fromState, toState));\r\n    const isFullAnyStateExpr = fromState == ANY_STATE && toState == ANY_STATE;\r\n    if (separator[0] == '<' && !isFullAnyStateExpr) {\r\n        expressions.push(makeLambdaFromStates(toState, fromState));\r\n    }\r\n}\r\nfunction parseAnimationAlias(alias, errors) {\r\n    switch (alias) {\r\n        case ':enter':\r\n            return 'void => *';\r\n        case ':leave':\r\n            return '* => void';\r\n        case ':increment':\r\n            return (fromState, toState) => parseFloat(toState) > parseFloat(fromState);\r\n        case ':decrement':\r\n            return (fromState, toState) => parseFloat(toState) < parseFloat(fromState);\r\n        default:\r\n            errors.push(`The transition alias value \"${alias}\" is not supported`);\r\n            return '* => *';\r\n    }\r\n}\r\n// DO NOT REFACTOR ... keep the follow set instantiations\r\n// with the values intact (closure compiler for some reason\r\n// removes follow-up lines that add the values outside of\r\n// the constructor...\r\nconst TRUE_BOOLEAN_VALUES = new Set(['true', '1']);\r\nconst FALSE_BOOLEAN_VALUES = new Set(['false', '0']);\r\nfunction makeLambdaFromStates(lhs, rhs) {\r\n    const LHS_MATCH_BOOLEAN = TRUE_BOOLEAN_VALUES.has(lhs) || FALSE_BOOLEAN_VALUES.has(lhs);\r\n    const RHS_MATCH_BOOLEAN = TRUE_BOOLEAN_VALUES.has(rhs) || FALSE_BOOLEAN_VALUES.has(rhs);\r\n    return (fromState, toState) => {\r\n        let lhsMatch = lhs == ANY_STATE || lhs == fromState;\r\n        let rhsMatch = rhs == ANY_STATE || rhs == toState;\r\n        if (!lhsMatch && LHS_MATCH_BOOLEAN && typeof fromState === 'boolean') {\r\n            lhsMatch = fromState ? TRUE_BOOLEAN_VALUES.has(lhs) : FALSE_BOOLEAN_VALUES.has(lhs);\r\n        }\r\n        if (!rhsMatch && RHS_MATCH_BOOLEAN && typeof toState === 'boolean') {\r\n            rhsMatch = toState ? TRUE_BOOLEAN_VALUES.has(rhs) : FALSE_BOOLEAN_VALUES.has(rhs);\r\n        }\r\n        return lhsMatch && rhsMatch;\r\n    };\r\n}\r\n\r\n/**\r\n * @license\r\n * Copyright Google LLC All Rights Reserved.\r\n *\r\n * Use of this source code is governed by an MIT-style license that can be\r\n * found in the LICENSE file at https://angular.io/license\r\n */\r\nconst SELF_TOKEN = ':self';\r\nconst SELF_TOKEN_REGEX = new RegExp(`\\s*${SELF_TOKEN}\\s*,?`, 'g');\r\n/*\r\n * [Validation]\r\n * The visitor code below will traverse the animation AST generated by the animation verb functions\r\n * (the output is a tree of objects) and attempt to perform a series of validations on the data. The\r\n * following corner-cases will be validated:\r\n *\r\n * 1. Overlap of animations\r\n * Given that a CSS property cannot be animated in more than one place at the same time, it's\r\n * important that this behavior is detected and validated. The way in which this occurs is that\r\n * each time a style property is examined, a string-map containing the property will be updated with\r\n * the start and end times for when the property is used within an animation step.\r\n *\r\n * If there are two or more parallel animations that are currently running (these are invoked by the\r\n * group()) on the same element then the validator will throw an error. Since the start/end timing\r\n * values are collected for each property then if the current animation step is animating the same\r\n * property and its timing values fall anywhere into the window of time that the property is\r\n * currently being animated within then this is what causes an error.\r\n *\r\n * 2. Timing values\r\n * The validator will validate to see if a timing value of `duration delay easing` or\r\n * `durationNumber` is valid or not.\r\n *\r\n * (note that upon validation the code below will replace the timing data with an object containing\r\n * {duration,delay,easing}.\r\n *\r\n * 3. Offset Validation\r\n * Each of the style() calls are allowed to have an offset value when placed inside of keyframes().\r\n * Offsets within keyframes() are considered valid when:\r\n *\r\n *   - No offsets are used at all\r\n *   - Each style() entry contains an offset value\r\n *   - Each offset is between 0 and 1\r\n *   - Each offset is greater to or equal than the previous one\r\n *\r\n * Otherwise an error will be thrown.\r\n */\r\nfunction buildAnimationAst(driver, metadata, errors) {\r\n    return new AnimationAstBuilderVisitor(driver).build(metadata, errors);\r\n}\r\nconst ROOT_SELECTOR = '';\r\nclass AnimationAstBuilderVisitor {\r\n    constructor(_driver) {\r\n        this._driver = _driver;\r\n    }\r\n    build(metadata, errors) {\r\n        const context = new AnimationAstBuilderContext(errors);\r\n        this._resetContextStyleTimingState(context);\r\n        return visitDslNode(this, normalizeAnimationEntry(metadata), context);\r\n    }\r\n    _resetContextStyleTimingState(context) {\r\n        context.currentQuerySelector = ROOT_SELECTOR;\r\n        context.collectedStyles = {};\r\n        context.collectedStyles[ROOT_SELECTOR] = {};\r\n        context.currentTime = 0;\r\n    }\r\n    visitTrigger(metadata, context) {\r\n        let queryCount = context.queryCount = 0;\r\n        let depCount = context.depCount = 0;\r\n        const states = [];\r\n        const transitions = [];\r\n        if (metadata.name.charAt(0) == '@') {\r\n            context.errors.push('animation triggers cannot be prefixed with an `@` sign (e.g. trigger(\\'@foo\\', [...]))');\r\n        }\r\n        metadata.definitions.forEach(def => {\r\n            this._resetContextStyleTimingState(context);\r\n            if (def.type == 0 /* State */) {\r\n                const stateDef = def;\r\n                const name = stateDef.name;\r\n                name.toString().split(/\\s*,\\s*/).forEach(n => {\r\n                    stateDef.name = n;\r\n                    states.push(this.visitState(stateDef, context));\r\n                });\r\n                stateDef.name = name;\r\n            }\r\n            else if (def.type == 1 /* Transition */) {\r\n                const transition = this.visitTransition(def, context);\r\n                queryCount += transition.queryCount;\r\n                depCount += transition.depCount;\r\n                transitions.push(transition);\r\n            }\r\n            else {\r\n                context.errors.push('only state() and transition() definitions can sit inside of a trigger()');\r\n            }\r\n        });\r\n        return {\r\n            type: 7 /* Trigger */,\r\n            name: metadata.name,\r\n            states,\r\n            transitions,\r\n            queryCount,\r\n            depCount,\r\n            options: null\r\n        };\r\n    }\r\n    visitState(metadata, context) {\r\n        const styleAst = this.visitStyle(metadata.styles, context);\r\n        const astParams = (metadata.options && metadata.options.params) || null;\r\n        if (styleAst.containsDynamicStyles) {\r\n            const missingSubs = new Set();\r\n            const params = astParams || {};\r\n            styleAst.styles.forEach(value => {\r\n                if (isObject(value)) {\r\n                    const stylesObj = value;\r\n                    Object.keys(stylesObj).forEach(prop => {\r\n                        extractStyleParams(stylesObj[prop]).forEach(sub => {\r\n                            if (!params.hasOwnProperty(sub)) {\r\n                                missingSubs.add(sub);\r\n                            }\r\n                        });\r\n                    });\r\n                }\r\n            });\r\n            if (missingSubs.size) {\r\n                const missingSubsArr = iteratorToArray(missingSubs.values());\r\n                context.errors.push(`state(\"${metadata\r\n                    .name}\", ...) must define default values for all the following style substitutions: ${missingSubsArr.join(', ')}`);\r\n            }\r\n        }\r\n        return {\r\n            type: 0 /* State */,\r\n            name: metadata.name,\r\n            style: styleAst,\r\n            options: astParams ? { params: astParams } : null\r\n        };\r\n    }\r\n    visitTransition(metadata, context) {\r\n        context.queryCount = 0;\r\n        context.depCount = 0;\r\n        const animation = visitDslNode(this, normalizeAnimationEntry(metadata.animation), context);\r\n        const matchers = parseTransitionExpr(metadata.expr, context.errors);\r\n        return {\r\n            type: 1 /* Transition */,\r\n            matchers,\r\n            animation,\r\n            queryCount: context.queryCount,\r\n            depCount: context.depCount,\r\n            options: normalizeAnimationOptions(metadata.options)\r\n        };\r\n    }\r\n    visitSequence(metadata, context) {\r\n        return {\r\n            type: 2 /* Sequence */,\r\n            steps: metadata.steps.map(s => visitDslNode(this, s, context)),\r\n            options: normalizeAnimationOptions(metadata.options)\r\n        };\r\n    }\r\n    visitGroup(metadata, context) {\r\n        const currentTime = context.currentTime;\r\n        let furthestTime = 0;\r\n        const steps = metadata.steps.map(step => {\r\n            context.currentTime = currentTime;\r\n            const innerAst = visitDslNode(this, step, context);\r\n            furthestTime = Math.max(furthestTime, context.currentTime);\r\n            return innerAst;\r\n        });\r\n        context.currentTime = furthestTime;\r\n        return {\r\n            type: 3 /* Group */,\r\n            steps,\r\n            options: normalizeAnimationOptions(metadata.options)\r\n        };\r\n    }\r\n    visitAnimate(metadata, context) {\r\n        const timingAst = constructTimingAst(metadata.timings, context.errors);\r\n        context.currentAnimateTimings = timingAst;\r\n        let styleAst;\r\n        let styleMetadata = metadata.styles ? metadata.styles : style({});\r\n        if (styleMetadata.type == 5 /* Keyframes */) {\r\n            styleAst = this.visitKeyframes(styleMetadata, context);\r\n        }\r\n        else {\r\n            let styleMetadata = metadata.styles;\r\n            let isEmpty = false;\r\n            if (!styleMetadata) {\r\n                isEmpty = true;\r\n                const newStyleData = {};\r\n                if (timingAst.easing) {\r\n                    newStyleData['easing'] = timingAst.easing;\r\n                }\r\n                styleMetadata = style(newStyleData);\r\n            }\r\n            context.currentTime += timingAst.duration + timingAst.delay;\r\n            const _styleAst = this.visitStyle(styleMetadata, context);\r\n            _styleAst.isEmptyStep = isEmpty;\r\n            styleAst = _styleAst;\r\n        }\r\n        context.currentAnimateTimings = null;\r\n        return {\r\n            type: 4 /* Animate */,\r\n            timings: timingAst,\r\n            style: styleAst,\r\n            options: null\r\n        };\r\n    }\r\n    visitStyle(metadata, context) {\r\n        const ast = this._makeStyleAst(metadata, context);\r\n        this._validateStyleAst(ast, context);\r\n        return ast;\r\n    }\r\n    _makeStyleAst(metadata, context) {\r\n        const styles = [];\r\n        if (Array.isArray(metadata.styles)) {\r\n            metadata.styles.forEach(styleTuple => {\r\n                if (typeof styleTuple == 'string') {\r\n                    if (styleTuple == AUTO_STYLE) {\r\n                        styles.push(styleTuple);\r\n                    }\r\n                    else {\r\n                        context.errors.push(`The provided style string value ${styleTuple} is not allowed.`);\r\n                    }\r\n                }\r\n                else {\r\n                    styles.push(styleTuple);\r\n                }\r\n            });\r\n        }\r\n        else {\r\n            styles.push(metadata.styles);\r\n        }\r\n        let containsDynamicStyles = false;\r\n        let collectedEasing = null;\r\n        styles.forEach(styleData => {\r\n            if (isObject(styleData)) {\r\n                const styleMap = styleData;\r\n                const easing = styleMap['easing'];\r\n                if (easing) {\r\n                    collectedEasing = easing;\r\n                    delete styleMap['easing'];\r\n                }\r\n                if (!containsDynamicStyles) {\r\n                    for (let prop in styleMap) {\r\n                        const value = styleMap[prop];\r\n                        if (value.toString().indexOf(SUBSTITUTION_EXPR_START) >= 0) {\r\n                            containsDynamicStyles = true;\r\n                            break;\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        });\r\n        return {\r\n            type: 6 /* Style */,\r\n            styles,\r\n            easing: collectedEasing,\r\n            offset: metadata.offset,\r\n            containsDynamicStyles,\r\n            options: null\r\n        };\r\n    }\r\n    _validateStyleAst(ast, context) {\r\n        const timings = context.currentAnimateTimings;\r\n        let endTime = context.currentTime;\r\n        let startTime = context.currentTime;\r\n        if (timings && startTime > 0) {\r\n            startTime -= timings.duration + timings.delay;\r\n        }\r\n        ast.styles.forEach(tuple => {\r\n            if (typeof tuple == 'string')\r\n                return;\r\n            Object.keys(tuple).forEach(prop => {\r\n                if (!this._driver.validateStyleProperty(prop)) {\r\n                    context.errors.push(`The provided animation property \"${prop}\" is not a supported CSS property for animations`);\r\n                    return;\r\n                }\r\n                const collectedStyles = context.collectedStyles[context.currentQuerySelector];\r\n                const collectedEntry = collectedStyles[prop];\r\n                let updateCollectedStyle = true;\r\n                if (collectedEntry) {\r\n                    if (startTime != endTime && startTime >= collectedEntry.startTime &&\r\n                        endTime <= collectedEntry.endTime) {\r\n                        context.errors.push(`The CSS property \"${prop}\" that exists between the times of \"${collectedEntry.startTime}ms\" and \"${collectedEntry\r\n                            .endTime}ms\" is also being animated in a parallel animation between the times of \"${startTime}ms\" and \"${endTime}ms\"`);\r\n                        updateCollectedStyle = false;\r\n                    }\r\n                    // we always choose the smaller start time value since we\r\n                    // want to have a record of the entire animation window where\r\n                    // the style property is being animated in between\r\n                    startTime = collectedEntry.startTime;\r\n                }\r\n                if (updateCollectedStyle) {\r\n                    collectedStyles[prop] = { startTime, endTime };\r\n                }\r\n                if (context.options) {\r\n                    validateStyleParams(tuple[prop], context.options, context.errors);\r\n                }\r\n            });\r\n        });\r\n    }\r\n    visitKeyframes(metadata, context) {\r\n        const ast = { type: 5 /* Keyframes */, styles: [], options: null };\r\n        if (!context.currentAnimateTimings) {\r\n            context.errors.push(`keyframes() must be placed inside of a call to animate()`);\r\n            return ast;\r\n        }\r\n        const MAX_KEYFRAME_OFFSET = 1;\r\n        let totalKeyframesWithOffsets = 0;\r\n        const offsets = [];\r\n        let offsetsOutOfOrder = false;\r\n        let keyframesOutOfRange = false;\r\n        let previousOffset = 0;\r\n        const keyframes = metadata.steps.map(styles => {\r\n            const style = this._makeStyleAst(styles, context);\r\n            let offsetVal = style.offset != null ? style.offset : consumeOffset(style.styles);\r\n            let offset = 0;\r\n            if (offsetVal != null) {\r\n                totalKeyframesWithOffsets++;\r\n                offset = style.offset = offsetVal;\r\n            }\r\n            keyframesOutOfRange = keyframesOutOfRange || offset < 0 || offset > 1;\r\n            offsetsOutOfOrder = offsetsOutOfOrder || offset < previousOffset;\r\n            previousOffset = offset;\r\n            offsets.push(offset);\r\n            return style;\r\n        });\r\n        if (keyframesOutOfRange) {\r\n            context.errors.push(`Please ensure that all keyframe offsets are between 0 and 1`);\r\n        }\r\n        if (offsetsOutOfOrder) {\r\n            context.errors.push(`Please ensure that all keyframe offsets are in order`);\r\n        }\r\n        const length = metadata.steps.length;\r\n        let generatedOffset = 0;\r\n        if (totalKeyframesWithOffsets > 0 && totalKeyframesWithOffsets < length) {\r\n            context.errors.push(`Not all style() steps within the declared keyframes() contain offsets`);\r\n        }\r\n        else if (totalKeyframesWithOffsets == 0) {\r\n            generatedOffset = MAX_KEYFRAME_OFFSET / (length - 1);\r\n        }\r\n        const limit = length - 1;\r\n        const currentTime = context.currentTime;\r\n        const currentAnimateTimings = context.currentAnimateTimings;\r\n        const animateDuration = currentAnimateTimings.duration;\r\n        keyframes.forEach((kf, i) => {\r\n            const offset = generatedOffset > 0 ? (i == limit ? 1 : (generatedOffset * i)) : offsets[i];\r\n            const durationUpToThisFrame = offset * animateDuration;\r\n            context.currentTime = currentTime + currentAnimateTimings.delay + durationUpToThisFrame;\r\n            currentAnimateTimings.duration = durationUpToThisFrame;\r\n            this._validateStyleAst(kf, context);\r\n            kf.offset = offset;\r\n            ast.styles.push(kf);\r\n        });\r\n        return ast;\r\n    }\r\n    visitReference(metadata, context) {\r\n        return {\r\n            type: 8 /* Reference */,\r\n            animation: visitDslNode(this, normalizeAnimationEntry(metadata.animation), context),\r\n            options: normalizeAnimationOptions(metadata.options)\r\n        };\r\n    }\r\n    visitAnimateChild(metadata, context) {\r\n        context.depCount++;\r\n        return {\r\n            type: 9 /* AnimateChild */,\r\n            options: normalizeAnimationOptions(metadata.options)\r\n        };\r\n    }\r\n    visitAnimateRef(metadata, context) {\r\n        return {\r\n            type: 10 /* AnimateRef */,\r\n            animation: this.visitReference(metadata.animation, context),\r\n            options: normalizeAnimationOptions(metadata.options)\r\n        };\r\n    }\r\n    visitQuery(metadata, context) {\r\n        const parentSelector = context.currentQuerySelector;\r\n        const options = (metadata.options || {});\r\n        context.queryCount++;\r\n        context.currentQuery = metadata;\r\n        const [selector, includeSelf] = normalizeSelector(metadata.selector);\r\n        context.currentQuerySelector =\r\n            parentSelector.length ? (parentSelector + ' ' + selector) : selector;\r\n        getOrSetAsInMap(context.collectedStyles, context.currentQuerySelector, {});\r\n        const animation = visitDslNode(this, normalizeAnimationEntry(metadata.animation), context);\r\n        context.currentQuery = null;\r\n        context.currentQuerySelector = parentSelector;\r\n        return {\r\n            type: 11 /* Query */,\r\n            selector,\r\n            limit: options.limit || 0,\r\n            optional: !!options.optional,\r\n            includeSelf,\r\n            animation,\r\n            originalSelector: metadata.selector,\r\n            options: normalizeAnimationOptions(metadata.options)\r\n        };\r\n    }\r\n    visitStagger(metadata, context) {\r\n        if (!context.currentQuery) {\r\n            context.errors.push(`stagger() can only be used inside of query()`);\r\n        }\r\n        const timings = metadata.timings === 'full' ?\r\n            { duration: 0, delay: 0, easing: 'full' } :\r\n            resolveTiming(metadata.timings, context.errors, true);\r\n        return {\r\n            type: 12 /* Stagger */,\r\n            animation: visitDslNode(this, normalizeAnimationEntry(metadata.animation), context),\r\n            timings,\r\n            options: null\r\n        };\r\n    }\r\n}\r\nfunction normalizeSelector(selector) {\r\n    const hasAmpersand = selector.split(/\\s*,\\s*/).find(token => token == SELF_TOKEN) ? true : false;\r\n    if (hasAmpersand) {\r\n        selector = selector.replace(SELF_TOKEN_REGEX, '');\r\n    }\r\n    // the :enter and :leave selectors are filled in at runtime during timeline building\r\n    selector = selector.replace(/@\\*/g, NG_TRIGGER_SELECTOR)\r\n        .replace(/@\\w+/g, match => NG_TRIGGER_SELECTOR + '-' + match.substr(1))\r\n        .replace(/:animating/g, NG_ANIMATING_SELECTOR);\r\n    return [selector, hasAmpersand];\r\n}\r\nfunction normalizeParams(obj) {\r\n    return obj ? copyObj(obj) : null;\r\n}\r\nclass AnimationAstBuilderContext {\r\n    constructor(errors) {\r\n        this.errors = errors;\r\n        this.queryCount = 0;\r\n        this.depCount = 0;\r\n        this.currentTransition = null;\r\n        this.currentQuery = null;\r\n        this.currentQuerySelector = null;\r\n        this.currentAnimateTimings = null;\r\n        this.currentTime = 0;\r\n        this.collectedStyles = {};\r\n        this.options = null;\r\n    }\r\n}\r\nfunction consumeOffset(styles) {\r\n    if (typeof styles == 'string')\r\n        return null;\r\n    let offset = null;\r\n    if (Array.isArray(styles)) {\r\n        styles.forEach(styleTuple => {\r\n            if (isObject(styleTuple) && styleTuple.hasOwnProperty('offset')) {\r\n                const obj = styleTuple;\r\n                offset = parseFloat(obj['offset']);\r\n                delete obj['offset'];\r\n            }\r\n        });\r\n    }\r\n    else if (isObject(styles) && styles.hasOwnProperty('offset')) {\r\n        const obj = styles;\r\n        offset = parseFloat(obj['offset']);\r\n        delete obj['offset'];\r\n    }\r\n    return offset;\r\n}\r\nfunction isObject(value) {\r\n    return !Array.isArray(value) && typeof value == 'object';\r\n}\r\nfunction constructTimingAst(value, errors) {\r\n    let timings = null;\r\n    if (value.hasOwnProperty('duration')) {\r\n        timings = value;\r\n    }\r\n    else if (typeof value == 'number') {\r\n        const duration = resolveTiming(value, errors).duration;\r\n        return makeTimingAst(duration, 0, '');\r\n    }\r\n    const strValue = value;\r\n    const isDynamic = strValue.split(/\\s+/).some(v => v.charAt(0) == '{' && v.charAt(1) == '{');\r\n    if (isDynamic) {\r\n        const ast = makeTimingAst(0, 0, '');\r\n        ast.dynamic = true;\r\n        ast.strValue = strValue;\r\n        return ast;\r\n    }\r\n    timings = timings || resolveTiming(strValue, errors);\r\n    return makeTimingAst(timings.duration, timings.delay, timings.easing);\r\n}\r\nfunction normalizeAnimationOptions(options) {\r\n    if (options) {\r\n        options = copyObj(options);\r\n        if (options['params']) {\r\n            options['params'] = normalizeParams(options['params']);\r\n        }\r\n    }\r\n    else {\r\n        options = {};\r\n    }\r\n    return options;\r\n}\r\nfunction makeTimingAst(duration, delay, easing) {\r\n    return { duration, delay, easing };\r\n}\r\n\r\nfunction createTimelineInstruction(element, keyframes, preStyleProps, postStyleProps, duration, delay, easing = null, subTimeline = false) {\r\n    return {\r\n        type: 1 /* TimelineAnimation */,\r\n        element,\r\n        keyframes,\r\n        preStyleProps,\r\n        postStyleProps,\r\n        duration,\r\n        delay,\r\n        totalTime: duration + delay,\r\n        easing,\r\n        subTimeline\r\n    };\r\n}\r\n\r\nclass ElementInstructionMap {\r\n    constructor() {\r\n        this._map = new Map();\r\n    }\r\n    consume(element) {\r\n        let instructions = this._map.get(element);\r\n        if (instructions) {\r\n            this._map.delete(element);\r\n        }\r\n        else {\r\n            instructions = [];\r\n        }\r\n        return instructions;\r\n    }\r\n    append(element, instructions) {\r\n        let existingInstructions = this._map.get(element);\r\n        if (!existingInstructions) {\r\n            this._map.set(element, existingInstructions = []);\r\n        }\r\n        existingInstructions.push(...instructions);\r\n    }\r\n    has(element) {\r\n        return this._map.has(element);\r\n    }\r\n    clear() {\r\n        this._map.clear();\r\n    }\r\n}\r\n\r\n/**\r\n * @license\r\n * Copyright Google LLC All Rights Reserved.\r\n *\r\n * Use of this source code is governed by an MIT-style license that can be\r\n * found in the LICENSE file at https://angular.io/license\r\n */\r\nconst ONE_FRAME_IN_MILLISECONDS = 1;\r\nconst ENTER_TOKEN = ':enter';\r\nconst ENTER_TOKEN_REGEX = new RegExp(ENTER_TOKEN, 'g');\r\nconst LEAVE_TOKEN = ':leave';\r\nconst LEAVE_TOKEN_REGEX = new RegExp(LEAVE_TOKEN, 'g');\r\n/*\r\n * The code within this file aims to generate web-animations-compatible keyframes from Angular's\r\n * animation DSL code.\r\n *\r\n * The code below will be converted from:\r\n *\r\n * ```\r\n * sequence([\r\n *   style({ opacity: 0 }),\r\n *   animate(1000, style({ opacity: 0 }))\r\n * ])\r\n * ```\r\n *\r\n * To:\r\n * ```\r\n * keyframes = [{ opacity: 0, offset: 0 }, { opacity: 1, offset: 1 }]\r\n * duration = 1000\r\n * delay = 0\r\n * easing = ''\r\n * ```\r\n *\r\n * For this operation to cover the combination of animation verbs (style, animate, group, etc...) a\r\n * combination of prototypical inheritance, AST traversal and merge-sort-like algorithms are used.\r\n *\r\n * [AST Traversal]\r\n * Each of the animation verbs, when executed, will return an string-map object representing what\r\n * type of action it is (style, animate, group, etc...) and the data associated with it. This means\r\n * that when functional composition mix of these functions is evaluated (like in the example above)\r\n * then it will end up producing a tree of objects representing the animation itself.\r\n *\r\n * When this animation object tree is processed by the visitor code below it will visit each of the\r\n * verb statements within the visitor. And during each visit it will build the context of the\r\n * animation keyframes by interacting with the `TimelineBuilder`.\r\n *\r\n * [TimelineBuilder]\r\n * This class is responsible for tracking the styles and building a series of keyframe objects for a\r\n * timeline between a start and end time. The builder starts off with an initial timeline and each\r\n * time the AST comes across a `group()`, `keyframes()` or a combination of the two wihtin a\r\n * `sequence()` then it will generate a sub timeline for each step as well as a new one after\r\n * they are complete.\r\n *\r\n * As the AST is traversed, the timing state on each of the timelines will be incremented. If a sub\r\n * timeline was created (based on one of the cases above) then the parent timeline will attempt to\r\n * merge the styles used within the sub timelines into itself (only with group() this will happen).\r\n * This happens with a merge operation (much like how the merge works in mergesort) and it will only\r\n * copy the most recently used styles from the sub timelines into the parent timeline. This ensures\r\n * that if the styles are used later on in another phase of the animation then they will be the most\r\n * up-to-date values.\r\n *\r\n * [How Missing Styles Are Updated]\r\n * Each timeline has a `backFill` property which is responsible for filling in new styles into\r\n * already processed keyframes if a new style shows up later within the animation sequence.\r\n *\r\n * ```\r\n * sequence([\r\n *   style({ width: 0 }),\r\n *   animate(1000, style({ width: 100 })),\r\n *   animate(1000, style({ width: 200 })),\r\n *   animate(1000, style({ width: 300 }))\r\n *   animate(1000, style({ width: 400, height: 400 })) // notice how `height` doesn't exist anywhere\r\n * else\r\n * ])\r\n * ```\r\n *\r\n * What is happening here is that the `height` value is added later in the sequence, but is missing\r\n * from all previous animation steps. Therefore when a keyframe is created it would also be missing\r\n * from all previous keyframes up until where it is first used. For the timeline keyframe generation\r\n * to properly fill in the style it will place the previous value (the value from the parent\r\n * timeline) or a default value of `*` into the backFill object. Given that each of the keyframe\r\n * styles are objects that prototypically inhert from the backFill object, this means that if a\r\n * value is added into the backFill then it will automatically propagate any missing values to all\r\n * keyframes. Therefore the missing `height` value will be properly filled into the already\r\n * processed keyframes.\r\n *\r\n * When a sub-timeline is created it will have its own backFill property. This is done so that\r\n * styles present within the sub-timeline do not accidentally seep into the previous/future timeline\r\n * keyframes\r\n *\r\n * (For prototypically-inherited contents to be detected a `for(i in obj)` loop must be used.)\r\n *\r\n * [Validation]\r\n * The code in this file is not responsible for validation. That functionality happens with within\r\n * the `AnimationValidatorVisitor` code.\r\n */\r\nfunction buildAnimationTimelines(driver, rootElement, ast, enterClassName, leaveClassName, startingStyles = {}, finalStyles = {}, options, subInstructions, errors = []) {\r\n    return new AnimationTimelineBuilderVisitor().buildKeyframes(driver, rootElement, ast, enterClassName, leaveClassName, startingStyles, finalStyles, options, subInstructions, errors);\r\n}\r\nclass AnimationTimelineBuilderVisitor {\r\n    buildKeyframes(driver, rootElement, ast, enterClassName, leaveClassName, startingStyles, finalStyles, options, subInstructions, errors = []) {\r\n        subInstructions = subInstructions || new ElementInstructionMap();\r\n        const context = new AnimationTimelineContext(driver, rootElement, subInstructions, enterClassName, leaveClassName, errors, []);\r\n        context.options = options;\r\n        context.currentTimeline.setStyles([startingStyles], null, context.errors, options);\r\n        visitDslNode(this, ast, context);\r\n        // this checks to see if an actual animation happened\r\n        const timelines = context.timelines.filter(timeline => timeline.containsAnimation());\r\n        if (timelines.length && Object.keys(finalStyles).length) {\r\n            const tl = timelines[timelines.length - 1];\r\n            if (!tl.allowOnlyTimelineStyles()) {\r\n                tl.setStyles([finalStyles], null, context.errors, options);\r\n            }\r\n        }\r\n        return timelines.length ? timelines.map(timeline => timeline.buildKeyframes()) :\r\n            [createTimelineInstruction(rootElement, [], [], [], 0, 0, '', false)];\r\n    }\r\n    visitTrigger(ast, context) {\r\n        // these values are not visited in this AST\r\n    }\r\n    visitState(ast, context) {\r\n        // these values are not visited in this AST\r\n    }\r\n    visitTransition(ast, context) {\r\n        // these values are not visited in this AST\r\n    }\r\n    visitAnimateChild(ast, context) {\r\n        const elementInstructions = context.subInstructions.consume(context.element);\r\n        if (elementInstructions) {\r\n            const innerContext = context.createSubContext(ast.options);\r\n            const startTime = context.currentTimeline.currentTime;\r\n            const endTime = this._visitSubInstructions(elementInstructions, innerContext, innerContext.options);\r\n            if (startTime != endTime) {\r\n                // we do this on the upper context because we created a sub context for\r\n                // the sub child animations\r\n                context.transformIntoNewTimeline(endTime);\r\n            }\r\n        }\r\n        context.previousNode = ast;\r\n    }\r\n    visitAnimateRef(ast, context) {\r\n        const innerContext = context.createSubContext(ast.options);\r\n        innerContext.transformIntoNewTimeline();\r\n        this.visitReference(ast.animation, innerContext);\r\n        context.transformIntoNewTimeline(innerContext.currentTimeline.currentTime);\r\n        context.previousNode = ast;\r\n    }\r\n    _visitSubInstructions(instructions, context, options) {\r\n        const startTime = context.currentTimeline.currentTime;\r\n        let furthestTime = startTime;\r\n        // this is a special-case for when a user wants to skip a sub\r\n        // animation from being fired entirely.\r\n        const duration = options.duration != null ? resolveTimingValue(options.duration) : null;\r\n        const delay = options.delay != null ? resolveTimingValue(options.delay) : null;\r\n        if (duration !== 0) {\r\n            instructions.forEach(instruction => {\r\n                const instructionTimings = context.appendInstructionToTimeline(instruction, duration, delay);\r\n                furthestTime =\r\n                    Math.max(furthestTime, instructionTimings.duration + instructionTimings.delay);\r\n            });\r\n        }\r\n        return furthestTime;\r\n    }\r\n    visitReference(ast, context) {\r\n        context.updateOptions(ast.options, true);\r\n        visitDslNode(this, ast.animation, context);\r\n        context.previousNode = ast;\r\n    }\r\n    visitSequence(ast, context) {\r\n        const subContextCount = context.subContextCount;\r\n        let ctx = context;\r\n        const options = ast.options;\r\n        if (options && (options.params || options.delay)) {\r\n            ctx = context.createSubContext(options);\r\n            ctx.transformIntoNewTimeline();\r\n            if (options.delay != null) {\r\n                if (ctx.previousNode.type == 6 /* Style */) {\r\n                    ctx.currentTimeline.snapshotCurrentStyles();\r\n                    ctx.previousNode = DEFAULT_NOOP_PREVIOUS_NODE;\r\n                }\r\n                const delay = resolveTimingValue(options.delay);\r\n                ctx.delayNextStep(delay);\r\n            }\r\n        }\r\n        if (ast.steps.length) {\r\n            ast.steps.forEach(s => visitDslNode(this, s, ctx));\r\n            // this is here just incase the inner steps only contain or end with a style() call\r\n            ctx.currentTimeline.applyStylesToKeyframe();\r\n            // this means that some animation function within the sequence\r\n            // ended up creating a sub timeline (which means the current\r\n            // timeline cannot overlap with the contents of the sequence)\r\n            if (ctx.subContextCount > subContextCount) {\r\n                ctx.transformIntoNewTimeline();\r\n            }\r\n        }\r\n        context.previousNode = ast;\r\n    }\r\n    visitGroup(ast, context) {\r\n        const innerTimelines = [];\r\n        let furthestTime = context.currentTimeline.currentTime;\r\n        const delay = ast.options && ast.options.delay ? resolveTimingValue(ast.options.delay) : 0;\r\n        ast.steps.forEach(s => {\r\n            const innerContext = context.createSubContext(ast.options);\r\n            if (delay) {\r\n                innerContext.delayNextStep(delay);\r\n            }\r\n            visitDslNode(this, s, innerContext);\r\n            furthestTime = Math.max(furthestTime, innerContext.currentTimeline.currentTime);\r\n            innerTimelines.push(innerContext.currentTimeline);\r\n        });\r\n        // this operation is run after the AST loop because otherwise\r\n        // if the parent timeline's collected styles were updated then\r\n        // it would pass in invalid data into the new-to-be forked items\r\n        innerTimelines.forEach(timeline => context.currentTimeline.mergeTimelineCollectedStyles(timeline));\r\n        context.transformIntoNewTimeline(furthestTime);\r\n        context.previousNode = ast;\r\n    }\r\n    _visitTiming(ast, context) {\r\n        if (ast.dynamic) {\r\n            const strValue = ast.strValue;\r\n            const timingValue = context.params ? interpolateParams(strValue, context.params, context.errors) : strValue;\r\n            return resolveTiming(timingValue, context.errors);\r\n        }\r\n        else {\r\n            return { duration: ast.duration, delay: ast.delay, easing: ast.easing };\r\n        }\r\n    }\r\n    visitAnimate(ast, context) {\r\n        const timings = context.currentAnimateTimings = this._visitTiming(ast.timings, context);\r\n        const timeline = context.currentTimeline;\r\n        if (timings.delay) {\r\n            context.incrementTime(timings.delay);\r\n            timeline.snapshotCurrentStyles();\r\n        }\r\n        const style = ast.style;\r\n        if (style.type == 5 /* Keyframes */) {\r\n            this.visitKeyframes(style, context);\r\n        }\r\n        else {\r\n            context.incrementTime(timings.duration);\r\n            this.visitStyle(style, context);\r\n            timeline.applyStylesToKeyframe();\r\n        }\r\n        context.currentAnimateTimings = null;\r\n        context.previousNode = ast;\r\n    }\r\n    visitStyle(ast, context) {\r\n        const timeline = context.currentTimeline;\r\n        const timings = context.currentAnimateTimings;\r\n        // this is a special case for when a style() call\r\n        // directly follows  an animate() call (but not inside of an animate() call)\r\n        if (!timings && timeline.getCurrentStyleProperties().length) {\r\n            timeline.forwardFrame();\r\n        }\r\n        const easing = (timings && timings.easing) || ast.easing;\r\n        if (ast.isEmptyStep) {\r\n            timeline.applyEmptyStep(easing);\r\n        }\r\n        else {\r\n            timeline.setStyles(ast.styles, easing, context.errors, context.options);\r\n        }\r\n        context.previousNode = ast;\r\n    }\r\n    visitKeyframes(ast, context) {\r\n        const currentAnimateTimings = context.currentAnimateTimings;\r\n        const startTime = (context.currentTimeline).duration;\r\n        const duration = currentAnimateTimings.duration;\r\n        const innerContext = context.createSubContext();\r\n        const innerTimeline = innerContext.currentTimeline;\r\n        innerTimeline.easing = currentAnimateTimings.easing;\r\n        ast.styles.forEach(step => {\r\n            const offset = step.offset || 0;\r\n            innerTimeline.forwardTime(offset * duration);\r\n            innerTimeline.setStyles(step.styles, step.easing, context.errors, context.options);\r\n            innerTimeline.applyStylesToKeyframe();\r\n        });\r\n        // this will ensure that the parent timeline gets all the styles from\r\n        // the child even if the new timeline below is not used\r\n        context.currentTimeline.mergeTimelineCollectedStyles(innerTimeline);\r\n        // we do this because the window between this timeline and the sub timeline\r\n        // should ensure that the styles within are exactly the same as they were before\r\n        context.transformIntoNewTimeline(startTime + duration);\r\n        context.previousNode = ast;\r\n    }\r\n    visitQuery(ast, context) {\r\n        // in the event that the first step before this is a style step we need\r\n        // to ensure the styles are applied before the children are animated\r\n        const startTime = context.currentTimeline.currentTime;\r\n        const options = (ast.options || {});\r\n        const delay = options.delay ? resolveTimingValue(options.delay) : 0;\r\n        if (delay &&\r\n            (context.previousNode.type === 6 /* Style */ ||\r\n                (startTime == 0 && context.currentTimeline.getCurrentStyleProperties().length))) {\r\n            context.currentTimeline.snapshotCurrentStyles();\r\n            context.previousNode = DEFAULT_NOOP_PREVIOUS_NODE;\r\n        }\r\n        let furthestTime = startTime;\r\n        const elms = context.invokeQuery(ast.selector, ast.originalSelector, ast.limit, ast.includeSelf, options.optional ? true : false, context.errors);\r\n        context.currentQueryTotal = elms.length;\r\n        let sameElementTimeline = null;\r\n        elms.forEach((element, i) => {\r\n            context.currentQueryIndex = i;\r\n            const innerContext = context.createSubContext(ast.options, element);\r\n            if (delay) {\r\n                innerContext.delayNextStep(delay);\r\n            }\r\n            if (element === context.element) {\r\n                sameElementTimeline = innerContext.currentTimeline;\r\n            }\r\n            visitDslNode(this, ast.animation, innerContext);\r\n            // this is here just incase the inner steps only contain or end\r\n            // with a style() call (which is here to signal that this is a preparatory\r\n            // call to style an element before it is animated again)\r\n            innerContext.currentTimeline.applyStylesToKeyframe();\r\n            const endTime = innerContext.currentTimeline.currentTime;\r\n            furthestTime = Math.max(furthestTime, endTime);\r\n        });\r\n        context.currentQueryIndex = 0;\r\n        context.currentQueryTotal = 0;\r\n        context.transformIntoNewTimeline(furthestTime);\r\n        if (sameElementTimeline) {\r\n            context.currentTimeline.mergeTimelineCollectedStyles(sameElementTimeline);\r\n            context.currentTimeline.snapshotCurrentStyles();\r\n        }\r\n        context.previousNode = ast;\r\n    }\r\n    visitStagger(ast, context) {\r\n        const parentContext = context.parentContext;\r\n        const tl = context.currentTimeline;\r\n        const timings = ast.timings;\r\n        const duration = Math.abs(timings.duration);\r\n        const maxTime = duration * (context.currentQueryTotal - 1);\r\n        let delay = duration * context.currentQueryIndex;\r\n        let staggerTransformer = timings.duration < 0 ? 'reverse' : timings.easing;\r\n        switch (staggerTransformer) {\r\n            case 'reverse':\r\n                delay = maxTime - delay;\r\n                break;\r\n            case 'full':\r\n                delay = parentContext.currentStaggerTime;\r\n                break;\r\n        }\r\n        const timeline = context.currentTimeline;\r\n        if (delay) {\r\n            timeline.delayNextStep(delay);\r\n        }\r\n        const startingTime = timeline.currentTime;\r\n        visitDslNode(this, ast.animation, context);\r\n        context.previousNode = ast;\r\n        // time = duration + delay\r\n        // the reason why this computation is so complex is because\r\n        // the inner timeline may either have a delay value or a stretched\r\n        // keyframe depending on if a subtimeline is not used or is used.\r\n        parentContext.currentStaggerTime =\r\n            (tl.currentTime - startingTime) + (tl.startTime - parentContext.currentTimeline.startTime);\r\n    }\r\n}\r\nconst DEFAULT_NOOP_PREVIOUS_NODE = {};\r\nclass AnimationTimelineContext {\r\n    constructor(_driver, element, subInstructions, _enterClassName, _leaveClassName, errors, timelines, initialTimeline) {\r\n        this._driver = _driver;\r\n        this.element = element;\r\n        this.subInstructions = subInstructions;\r\n        this._enterClassName = _enterClassName;\r\n        this._leaveClassName = _leaveClassName;\r\n        this.errors = errors;\r\n        this.timelines = timelines;\r\n        this.parentContext = null;\r\n        this.currentAnimateTimings = null;\r\n        this.previousNode = DEFAULT_NOOP_PREVIOUS_NODE;\r\n        this.subContextCount = 0;\r\n        this.options = {};\r\n        this.currentQueryIndex = 0;\r\n        this.currentQueryTotal = 0;\r\n        this.currentStaggerTime = 0;\r\n        this.currentTimeline = initialTimeline || new TimelineBuilder(this._driver, element, 0);\r\n        timelines.push(this.currentTimeline);\r\n    }\r\n    get params() {\r\n        return this.options.params;\r\n    }\r\n    updateOptions(options, skipIfExists) {\r\n        if (!options)\r\n            return;\r\n        const newOptions = options;\r\n        let optionsToUpdate = this.options;\r\n        // NOTE: this will get patched up when other animation methods support duration overrides\r\n        if (newOptions.duration != null) {\r\n            optionsToUpdate.duration = resolveTimingValue(newOptions.duration);\r\n        }\r\n        if (newOptions.delay != null) {\r\n            optionsToUpdate.delay = resolveTimingValue(newOptions.delay);\r\n        }\r\n        const newParams = newOptions.params;\r\n        if (newParams) {\r\n            let paramsToUpdate = optionsToUpdate.params;\r\n            if (!paramsToUpdate) {\r\n                paramsToUpdate = this.options.params = {};\r\n            }\r\n            Object.keys(newParams).forEach(name => {\r\n                if (!skipIfExists || !paramsToUpdate.hasOwnProperty(name)) {\r\n                    paramsToUpdate[name] = interpolateParams(newParams[name], paramsToUpdate, this.errors);\r\n                }\r\n            });\r\n        }\r\n    }\r\n    _copyOptions() {\r\n        const options = {};\r\n        if (this.options) {\r\n            const oldParams = this.options.params;\r\n            if (oldParams) {\r\n                const params = options['params'] = {};\r\n                Object.keys(oldParams).forEach(name => {\r\n                    params[name] = oldParams[name];\r\n                });\r\n            }\r\n        }\r\n        return options;\r\n    }\r\n    createSubContext(options = null, element, newTime) {\r\n        const target = element || this.element;\r\n        const context = new AnimationTimelineContext(this._driver, target, this.subInstructions, this._enterClassName, this._leaveClassName, this.errors, this.timelines, this.currentTimeline.fork(target, newTime || 0));\r\n        context.previousNode = this.previousNode;\r\n        context.currentAnimateTimings = this.currentAnimateTimings;\r\n        context.options = this._copyOptions();\r\n        context.updateOptions(options);\r\n        context.currentQueryIndex = this.currentQueryIndex;\r\n        context.currentQueryTotal = this.currentQueryTotal;\r\n        context.parentContext = this;\r\n        this.subContextCount++;\r\n        return context;\r\n    }\r\n    transformIntoNewTimeline(newTime) {\r\n        this.previousNode = DEFAULT_NOOP_PREVIOUS_NODE;\r\n        this.currentTimeline = this.currentTimeline.fork(this.element, newTime);\r\n        this.timelines.push(this.currentTimeline);\r\n        return this.currentTimeline;\r\n    }\r\n    appendInstructionToTimeline(instruction, duration, delay) {\r\n        const updatedTimings = {\r\n            duration: duration != null ? duration : instruction.duration,\r\n            delay: this.currentTimeline.currentTime + (delay != null ? delay : 0) + instruction.delay,\r\n            easing: ''\r\n        };\r\n        const builder = new SubTimelineBuilder(this._driver, instruction.element, instruction.keyframes, instruction.preStyleProps, instruction.postStyleProps, updatedTimings, instruction.stretchStartingKeyframe);\r\n        this.timelines.push(builder);\r\n        return updatedTimings;\r\n    }\r\n    incrementTime(time) {\r\n        this.currentTimeline.forwardTime(this.currentTimeline.duration + time);\r\n    }\r\n    delayNextStep(delay) {\r\n        // negative delays are not yet supported\r\n        if (delay > 0) {\r\n            this.currentTimeline.delayNextStep(delay);\r\n        }\r\n    }\r\n    invokeQuery(selector, originalSelector, limit, includeSelf, optional, errors) {\r\n        let results = [];\r\n        if (includeSelf) {\r\n            results.push(this.element);\r\n        }\r\n        if (selector.length > 0) { // if :self is only used then the selector is empty\r\n            selector = selector.replace(ENTER_TOKEN_REGEX, '.' + this._enterClassName);\r\n            selector = selector.replace(LEAVE_TOKEN_REGEX, '.' + this._leaveClassName);\r\n            const multi = limit != 1;\r\n            let elements = this._driver.query(this.element, selector, multi);\r\n            if (limit !== 0) {\r\n                elements = limit < 0 ? elements.slice(elements.length + limit, elements.length) :\r\n                    elements.slice(0, limit);\r\n            }\r\n            results.push(...elements);\r\n        }\r\n        if (!optional && results.length == 0) {\r\n            errors.push(`\\`query(\"${originalSelector}\")\\` returned zero elements. (Use \\`query(\"${originalSelector}\", { optional: true })\\` if you wish to allow this.)`);\r\n        }\r\n        return results;\r\n    }\r\n}\r\nclass TimelineBuilder {\r\n    constructor(_driver, element, startTime, _elementTimelineStylesLookup) {\r\n        this._driver = _driver;\r\n        this.element = element;\r\n        this.startTime = startTime;\r\n        this._elementTimelineStylesLookup = _elementTimelineStylesLookup;\r\n        this.duration = 0;\r\n        this._previousKeyframe = {};\r\n        this._currentKeyframe = {};\r\n        this._keyframes = new Map();\r\n        this._styleSummary = {};\r\n        this._pendingStyles = {};\r\n        this._backFill = {};\r\n        this._currentEmptyStepKeyframe = null;\r\n        if (!this._elementTimelineStylesLookup) {\r\n            this._elementTimelineStylesLookup = new Map();\r\n        }\r\n        this._localTimelineStyles = Object.create(this._backFill, {});\r\n        this._globalTimelineStyles = this._elementTimelineStylesLookup.get(element);\r\n        if (!this._globalTimelineStyles) {\r\n            this._globalTimelineStyles = this._localTimelineStyles;\r\n            this._elementTimelineStylesLookup.set(element, this._localTimelineStyles);\r\n        }\r\n        this._loadKeyframe();\r\n    }\r\n    containsAnimation() {\r\n        switch (this._keyframes.size) {\r\n            case 0:\r\n                return false;\r\n            case 1:\r\n                return this.getCurrentStyleProperties().length > 0;\r\n            default:\r\n                return true;\r\n        }\r\n    }\r\n    getCurrentStyleProperties() {\r\n        return Object.keys(this._currentKeyframe);\r\n    }\r\n    get currentTime() {\r\n        return this.startTime + this.duration;\r\n    }\r\n    delayNextStep(delay) {\r\n        // in the event that a style() step is placed right before a stagger()\r\n        // and that style() step is the very first style() value in the animation\r\n        // then we need to make a copy of the keyframe [0, copy, 1] so that the delay\r\n        // properly applies the style() values to work with the stagger...\r\n        const hasPreStyleStep = this._keyframes.size == 1 && Object.keys(this._pendingStyles).length;\r\n        if (this.duration || hasPreStyleStep) {\r\n            this.forwardTime(this.currentTime + delay);\r\n            if (hasPreStyleStep) {\r\n                this.snapshotCurrentStyles();\r\n            }\r\n        }\r\n        else {\r\n            this.startTime += delay;\r\n        }\r\n    }\r\n    fork(element, currentTime) {\r\n        this.applyStylesToKeyframe();\r\n        return new TimelineBuilder(this._driver, element, currentTime || this.currentTime, this._elementTimelineStylesLookup);\r\n    }\r\n    _loadKeyframe() {\r\n        if (this._currentKeyframe) {\r\n            this._previousKeyframe = this._currentKeyframe;\r\n        }\r\n        this._currentKeyframe = this._keyframes.get(this.duration);\r\n        if (!this._currentKeyframe) {\r\n            this._currentKeyframe = Object.create(this._backFill, {});\r\n            this._keyframes.set(this.duration, this._currentKeyframe);\r\n        }\r\n    }\r\n    forwardFrame() {\r\n        this.duration += ONE_FRAME_IN_MILLISECONDS;\r\n        this._loadKeyframe();\r\n    }\r\n    forwardTime(time) {\r\n        this.applyStylesToKeyframe();\r\n        this.duration = time;\r\n        this._loadKeyframe();\r\n    }\r\n    _updateStyle(prop, value) {\r\n        this._localTimelineStyles[prop] = value;\r\n        this._globalTimelineStyles[prop] = value;\r\n        this._styleSummary[prop] = { time: this.currentTime, value };\r\n    }\r\n    allowOnlyTimelineStyles() {\r\n        return this._currentEmptyStepKeyframe !== this._currentKeyframe;\r\n    }\r\n    applyEmptyStep(easing) {\r\n        if (easing) {\r\n            this._previousKeyframe['easing'] = easing;\r\n        }\r\n        // special case for animate(duration):\r\n        // all missing styles are filled with a `*` value then\r\n        // if any destination styles are filled in later on the same\r\n        // keyframe then they will override the overridden styles\r\n        // We use `_globalTimelineStyles` here because there may be\r\n        // styles in previous keyframes that are not present in this timeline\r\n        Object.keys(this._globalTimelineStyles).forEach(prop => {\r\n            this._backFill[prop] = this._globalTimelineStyles[prop] || AUTO_STYLE;\r\n            this._currentKeyframe[prop] = AUTO_STYLE;\r\n        });\r\n        this._currentEmptyStepKeyframe = this._currentKeyframe;\r\n    }\r\n    setStyles(input, easing, errors, options) {\r\n        if (easing) {\r\n            this._previousKeyframe['easing'] = easing;\r\n        }\r\n        const params = (options && options.params) || {};\r\n        const styles = flattenStyles(input, this._globalTimelineStyles);\r\n        Object.keys(styles).forEach(prop => {\r\n            const val = interpolateParams(styles[prop], params, errors);\r\n            this._pendingStyles[prop] = val;\r\n            if (!this._localTimelineStyles.hasOwnProperty(prop)) {\r\n                this._backFill[prop] = this._globalTimelineStyles.hasOwnProperty(prop) ?\r\n                    this._globalTimelineStyles[prop] :\r\n                    AUTO_STYLE;\r\n            }\r\n            this._updateStyle(prop, val);\r\n        });\r\n    }\r\n    applyStylesToKeyframe() {\r\n        const styles = this._pendingStyles;\r\n        const props = Object.keys(styles);\r\n        if (props.length == 0)\r\n            return;\r\n        this._pendingStyles = {};\r\n        props.forEach(prop => {\r\n            const val = styles[prop];\r\n            this._currentKeyframe[prop] = val;\r\n        });\r\n        Object.keys(this._localTimelineStyles).forEach(prop => {\r\n            if (!this._currentKeyframe.hasOwnProperty(prop)) {\r\n                this._currentKeyframe[prop] = this._localTimelineStyles[prop];\r\n            }\r\n        });\r\n    }\r\n    snapshotCurrentStyles() {\r\n        Object.keys(this._localTimelineStyles).forEach(prop => {\r\n            const val = this._localTimelineStyles[prop];\r\n            this._pendingStyles[prop] = val;\r\n            this._updateStyle(prop, val);\r\n        });\r\n    }\r\n    getFinalKeyframe() {\r\n        return this._keyframes.get(this.duration);\r\n    }\r\n    get properties() {\r\n        const properties = [];\r\n        for (let prop in this._currentKeyframe) {\r\n            properties.push(prop);\r\n        }\r\n        return properties;\r\n    }\r\n    mergeTimelineCollectedStyles(timeline) {\r\n        Object.keys(timeline._styleSummary).forEach(prop => {\r\n            const details0 = this._styleSummary[prop];\r\n            const details1 = timeline._styleSummary[prop];\r\n            if (!details0 || details1.time > details0.time) {\r\n                this._updateStyle(prop, details1.value);\r\n            }\r\n        });\r\n    }\r\n    buildKeyframes() {\r\n        this.applyStylesToKeyframe();\r\n        const preStyleProps = new Set();\r\n        const postStyleProps = new Set();\r\n        const isEmpty = this._keyframes.size === 1 && this.duration === 0;\r\n        let finalKeyframes = [];\r\n        this._keyframes.forEach((keyframe, time) => {\r\n            const finalKeyframe = copyStyles(keyframe, true);\r\n            Object.keys(finalKeyframe).forEach(prop => {\r\n                const value = finalKeyframe[prop];\r\n                if (value == ɵPRE_STYLE) {\r\n                    preStyleProps.add(prop);\r\n                }\r\n                else if (value == AUTO_STYLE) {\r\n                    postStyleProps.add(prop);\r\n                }\r\n            });\r\n            if (!isEmpty) {\r\n                finalKeyframe['offset'] = time / this.duration;\r\n            }\r\n            finalKeyframes.push(finalKeyframe);\r\n        });\r\n        const preProps = preStyleProps.size ? iteratorToArray(preStyleProps.values()) : [];\r\n        const postProps = postStyleProps.size ? iteratorToArray(postStyleProps.values()) : [];\r\n        // special case for a 0-second animation (which is designed just to place styles onscreen)\r\n        if (isEmpty) {\r\n            const kf0 = finalKeyframes[0];\r\n            const kf1 = copyObj(kf0);\r\n            kf0['offset'] = 0;\r\n            kf1['offset'] = 1;\r\n            finalKeyframes = [kf0, kf1];\r\n        }\r\n        return createTimelineInstruction(this.element, finalKeyframes, preProps, postProps, this.duration, this.startTime, this.easing, false);\r\n    }\r\n}\r\nclass SubTimelineBuilder extends TimelineBuilder {\r\n    constructor(driver, element, keyframes, preStyleProps, postStyleProps, timings, _stretchStartingKeyframe = false) {\r\n        super(driver, element, timings.delay);\r\n        this.element = element;\r\n        this.keyframes = keyframes;\r\n        this.preStyleProps = preStyleProps;\r\n        this.postStyleProps = postStyleProps;\r\n        this._stretchStartingKeyframe = _stretchStartingKeyframe;\r\n        this.timings = { duration: timings.duration, delay: timings.delay, easing: timings.easing };\r\n    }\r\n    containsAnimation() {\r\n        return this.keyframes.length > 1;\r\n    }\r\n    buildKeyframes() {\r\n        let keyframes = this.keyframes;\r\n        let { delay, duration, easing } = this.timings;\r\n        if (this._stretchStartingKeyframe && delay) {\r\n            const newKeyframes = [];\r\n            const totalTime = duration + delay;\r\n            const startingGap = delay / totalTime;\r\n            // the original starting keyframe now starts once the delay is done\r\n            const newFirstKeyframe = copyStyles(keyframes[0], false);\r\n            newFirstKeyframe['offset'] = 0;\r\n            newKeyframes.push(newFirstKeyframe);\r\n            const oldFirstKeyframe = copyStyles(keyframes[0], false);\r\n            oldFirstKeyframe['offset'] = roundOffset(startingGap);\r\n            newKeyframes.push(oldFirstKeyframe);\r\n            /*\r\n              When the keyframe is stretched then it means that the delay before the animation\r\n              starts is gone. Instead the first keyframe is placed at the start of the animation\r\n              and it is then copied to where it starts when the original delay is over. This basically\r\n              means nothing animates during that delay, but the styles are still renderered. For this\r\n              to work the original offset values that exist in the original keyframes must be \"warped\"\r\n              so that they can take the new keyframe + delay into account.\r\n      \r\n              delay=1000, duration=1000, keyframes = 0 .5 1\r\n      \r\n              turns into\r\n      \r\n              delay=0, duration=2000, keyframes = 0 .33 .66 1\r\n             */\r\n            // offsets between 1 ... n -1 are all warped by the keyframe stretch\r\n            const limit = keyframes.length - 1;\r\n            for (let i = 1; i <= limit; i++) {\r\n                let kf = copyStyles(keyframes[i], false);\r\n                const oldOffset = kf['offset'];\r\n                const timeAtKeyframe = delay + oldOffset * duration;\r\n                kf['offset'] = roundOffset(timeAtKeyframe / totalTime);\r\n                newKeyframes.push(kf);\r\n            }\r\n            // the new starting keyframe should be added at the start\r\n            duration = totalTime;\r\n            delay = 0;\r\n            easing = '';\r\n            keyframes = newKeyframes;\r\n        }\r\n        return createTimelineInstruction(this.element, keyframes, this.preStyleProps, this.postStyleProps, duration, delay, easing, true);\r\n    }\r\n}\r\nfunction roundOffset(offset, decimalPoints = 3) {\r\n    const mult = Math.pow(10, decimalPoints - 1);\r\n    return Math.round(offset * mult) / mult;\r\n}\r\nfunction flattenStyles(input, allStyles) {\r\n    const styles = {};\r\n    let allProperties;\r\n    input.forEach(token => {\r\n        if (token === '*') {\r\n            allProperties = allProperties || Object.keys(allStyles);\r\n            allProperties.forEach(prop => {\r\n                styles[prop] = AUTO_STYLE;\r\n            });\r\n        }\r\n        else {\r\n            copyStyles(token, false, styles);\r\n        }\r\n    });\r\n    return styles;\r\n}\r\n\r\nclass Animation {\r\n    constructor(_driver, input) {\r\n        this._driver = _driver;\r\n        const errors = [];\r\n        const ast = buildAnimationAst(_driver, input, errors);\r\n        if (errors.length) {\r\n            const errorMessage = `animation validation failed:\\n${errors.join('\\n')}`;\r\n            throw new Error(errorMessage);\r\n        }\r\n        this._animationAst = ast;\r\n    }\r\n    buildTimelines(element, startingStyles, destinationStyles, options, subInstructions) {\r\n        const start = Array.isArray(startingStyles) ? normalizeStyles(startingStyles) :\r\n            startingStyles;\r\n        const dest = Array.isArray(destinationStyles) ? normalizeStyles(destinationStyles) :\r\n            destinationStyles;\r\n        const errors = [];\r\n        subInstructions = subInstructions || new ElementInstructionMap();\r\n        const result = buildAnimationTimelines(this._driver, element, this._animationAst, ENTER_CLASSNAME, LEAVE_CLASSNAME, start, dest, options, subInstructions, errors);\r\n        if (errors.length) {\r\n            const errorMessage = `animation building failed:\\n${errors.join('\\n')}`;\r\n            throw new Error(errorMessage);\r\n        }\r\n        return result;\r\n    }\r\n}\r\n\r\n/**\r\n * @license\r\n * Copyright Google LLC All Rights Reserved.\r\n *\r\n * Use of this source code is governed by an MIT-style license that can be\r\n * found in the LICENSE file at https://angular.io/license\r\n */\r\n/**\r\n * @publicApi\r\n */\r\nclass AnimationStyleNormalizer {\r\n}\r\n/**\r\n * @publicApi\r\n */\r\nclass NoopAnimationStyleNormalizer {\r\n    normalizePropertyName(propertyName, errors) {\r\n        return propertyName;\r\n    }\r\n    normalizeStyleValue(userProvidedProperty, normalizedProperty, value, errors) {\r\n        return value;\r\n    }\r\n}\r\n\r\n/**\r\n * @license\r\n * Copyright Google LLC All Rights Reserved.\r\n *\r\n * Use of this source code is governed by an MIT-style license that can be\r\n * found in the LICENSE file at https://angular.io/license\r\n */\r\nclass WebAnimationsStyleNormalizer extends AnimationStyleNormalizer {\r\n    normalizePropertyName(propertyName, errors) {\r\n        return dashCaseToCamelCase(propertyName);\r\n    }\r\n    normalizeStyleValue(userProvidedProperty, normalizedProperty, value, errors) {\r\n        let unit = '';\r\n        const strVal = value.toString().trim();\r\n        if (DIMENSIONAL_PROP_MAP[normalizedProperty] && value !== 0 && value !== '0') {\r\n            if (typeof value === 'number') {\r\n                unit = 'px';\r\n            }\r\n            else {\r\n                const valAndSuffixMatch = value.match(/^[+-]?[\\d\\.]+([a-z]*)$/);\r\n                if (valAndSuffixMatch && valAndSuffixMatch[1].length == 0) {\r\n                    errors.push(`Please provide a CSS unit value for ${userProvidedProperty}:${value}`);\r\n                }\r\n            }\r\n        }\r\n        return strVal + unit;\r\n    }\r\n}\r\nconst ɵ0$1 = () => makeBooleanMap('width,height,minWidth,minHeight,maxWidth,maxHeight,left,top,bottom,right,fontSize,outlineWidth,outlineOffset,paddingTop,paddingLeft,paddingBottom,paddingRight,marginTop,marginLeft,marginBottom,marginRight,borderRadius,borderWidth,borderTopWidth,borderLeftWidth,borderRightWidth,borderBottomWidth,textIndent,perspective'\r\n    .split(','));\r\nconst DIMENSIONAL_PROP_MAP = (ɵ0$1)();\r\nfunction makeBooleanMap(keys) {\r\n    const map = {};\r\n    keys.forEach(key => map[key] = true);\r\n    return map;\r\n}\r\n\r\nfunction createTransitionInstruction(element, triggerName, fromState, toState, isRemovalTransition, fromStyles, toStyles, timelines, queriedElements, preStyleProps, postStyleProps, totalTime, errors) {\r\n    return {\r\n        type: 0 /* TransitionAnimation */,\r\n        element,\r\n        triggerName,\r\n        isRemovalTransition,\r\n        fromState,\r\n        fromStyles,\r\n        toState,\r\n        toStyles,\r\n        timelines,\r\n        queriedElements,\r\n        preStyleProps,\r\n        postStyleProps,\r\n        totalTime,\r\n        errors\r\n    };\r\n}\r\n\r\nconst EMPTY_OBJECT = {};\r\nclass AnimationTransitionFactory {\r\n    constructor(_triggerName, ast, _stateStyles) {\r\n        this._triggerName = _triggerName;\r\n        this.ast = ast;\r\n        this._stateStyles = _stateStyles;\r\n    }\r\n    match(currentState, nextState, element, params) {\r\n        return oneOrMoreTransitionsMatch(this.ast.matchers, currentState, nextState, element, params);\r\n    }\r\n    buildStyles(stateName, params, errors) {\r\n        const backupStateStyler = this._stateStyles['*'];\r\n        const stateStyler = this._stateStyles[stateName];\r\n        const backupStyles = backupStateStyler ? backupStateStyler.buildStyles(params, errors) : {};\r\n        return stateStyler ? stateStyler.buildStyles(params, errors) : backupStyles;\r\n    }\r\n    build(driver, element, currentState, nextState, enterClassName, leaveClassName, currentOptions, nextOptions, subInstructions, skipAstBuild) {\r\n        const errors = [];\r\n        const transitionAnimationParams = this.ast.options && this.ast.options.params || EMPTY_OBJECT;\r\n        const currentAnimationParams = currentOptions && currentOptions.params || EMPTY_OBJECT;\r\n        const currentStateStyles = this.buildStyles(currentState, currentAnimationParams, errors);\r\n        const nextAnimationParams = nextOptions && nextOptions.params || EMPTY_OBJECT;\r\n        const nextStateStyles = this.buildStyles(nextState, nextAnimationParams, errors);\r\n        const queriedElements = new Set();\r\n        const preStyleMap = new Map();\r\n        const postStyleMap = new Map();\r\n        const isRemoval = nextState === 'void';\r\n        const animationOptions = { params: Object.assign(Object.assign({}, transitionAnimationParams), nextAnimationParams) };\r\n        const timelines = skipAstBuild ?\r\n            [] :\r\n            buildAnimationTimelines(driver, element, this.ast.animation, enterClassName, leaveClassName, currentStateStyles, nextStateStyles, animationOptions, subInstructions, errors);\r\n        let totalTime = 0;\r\n        timelines.forEach(tl => {\r\n            totalTime = Math.max(tl.duration + tl.delay, totalTime);\r\n        });\r\n        if (errors.length) {\r\n            return createTransitionInstruction(element, this._triggerName, currentState, nextState, isRemoval, currentStateStyles, nextStateStyles, [], [], preStyleMap, postStyleMap, totalTime, errors);\r\n        }\r\n        timelines.forEach(tl => {\r\n            const elm = tl.element;\r\n            const preProps = getOrSetAsInMap(preStyleMap, elm, {});\r\n            tl.preStyleProps.forEach(prop => preProps[prop] = true);\r\n            const postProps = getOrSetAsInMap(postStyleMap, elm, {});\r\n            tl.postStyleProps.forEach(prop => postProps[prop] = true);\r\n            if (elm !== element) {\r\n                queriedElements.add(elm);\r\n            }\r\n        });\r\n        const queriedElementsList = iteratorToArray(queriedElements.values());\r\n        return createTransitionInstruction(element, this._triggerName, currentState, nextState, isRemoval, currentStateStyles, nextStateStyles, timelines, queriedElementsList, preStyleMap, postStyleMap, totalTime);\r\n    }\r\n}\r\nfunction oneOrMoreTransitionsMatch(matchFns, currentState, nextState, element, params) {\r\n    return matchFns.some(fn => fn(currentState, nextState, element, params));\r\n}\r\nclass AnimationStateStyles {\r\n    constructor(styles, defaultParams) {\r\n        this.styles = styles;\r\n        this.defaultParams = defaultParams;\r\n    }\r\n    buildStyles(params, errors) {\r\n        const finalStyles = {};\r\n        const combinedParams = copyObj(this.defaultParams);\r\n        Object.keys(params).forEach(key => {\r\n            const value = params[key];\r\n            if (value != null) {\r\n                combinedParams[key] = value;\r\n            }\r\n        });\r\n        this.styles.styles.forEach(value => {\r\n            if (typeof value !== 'string') {\r\n                const styleObj = value;\r\n                Object.keys(styleObj).forEach(prop => {\r\n                    let val = styleObj[prop];\r\n                    if (val.length > 1) {\r\n                        val = interpolateParams(val, combinedParams, errors);\r\n                    }\r\n                    finalStyles[prop] = val;\r\n                });\r\n            }\r\n        });\r\n        return finalStyles;\r\n    }\r\n}\r\n\r\n/**\r\n * @publicApi\r\n */\r\nfunction buildTrigger(name, ast) {\r\n    return new AnimationTrigger(name, ast);\r\n}\r\n/**\r\n * @publicApi\r\n */\r\nclass AnimationTrigger {\r\n    constructor(name, ast) {\r\n        this.name = name;\r\n        this.ast = ast;\r\n        this.transitionFactories = [];\r\n        this.states = {};\r\n        ast.states.forEach(ast => {\r\n            const defaultParams = (ast.options && ast.options.params) || {};\r\n            this.states[ast.name] = new AnimationStateStyles(ast.style, defaultParams);\r\n        });\r\n        balanceProperties(this.states, 'true', '1');\r\n        balanceProperties(this.states, 'false', '0');\r\n        ast.transitions.forEach(ast => {\r\n            this.transitionFactories.push(new AnimationTransitionFactory(name, ast, this.states));\r\n        });\r\n        this.fallbackTransition = createFallbackTransition(name, this.states);\r\n    }\r\n    get containsQueries() {\r\n        return this.ast.queryCount > 0;\r\n    }\r\n    matchTransition(currentState, nextState, element, params) {\r\n        const entry = this.transitionFactories.find(f => f.match(currentState, nextState, element, params));\r\n        return entry || null;\r\n    }\r\n    matchStyles(currentState, params, errors) {\r\n        return this.fallbackTransition.buildStyles(currentState, params, errors);\r\n    }\r\n}\r\nfunction createFallbackTransition(triggerName, states) {\r\n    const matchers = [(fromState, toState) => true];\r\n    const animation = { type: 2 /* Sequence */, steps: [], options: null };\r\n    const transition = {\r\n        type: 1 /* Transition */,\r\n        animation,\r\n        matchers,\r\n        options: null,\r\n        queryCount: 0,\r\n        depCount: 0\r\n    };\r\n    return new AnimationTransitionFactory(triggerName, transition, states);\r\n}\r\nfunction balanceProperties(obj, key1, key2) {\r\n    if (obj.hasOwnProperty(key1)) {\r\n        if (!obj.hasOwnProperty(key2)) {\r\n            obj[key2] = obj[key1];\r\n        }\r\n    }\r\n    else if (obj.hasOwnProperty(key2)) {\r\n        obj[key1] = obj[key2];\r\n    }\r\n}\r\n\r\n/**\r\n * @license\r\n * Copyright Google LLC All Rights Reserved.\r\n *\r\n * Use of this source code is governed by an MIT-style license that can be\r\n * found in the LICENSE file at https://angular.io/license\r\n */\r\nconst EMPTY_INSTRUCTION_MAP = new ElementInstructionMap();\r\nclass TimelineAnimationEngine {\r\n    constructor(bodyNode, _driver, _normalizer) {\r\n        this.bodyNode = bodyNode;\r\n        this._driver = _driver;\r\n        this._normalizer = _normalizer;\r\n        this._animations = {};\r\n        this._playersById = {};\r\n        this.players = [];\r\n    }\r\n    register(id, metadata) {\r\n        const errors = [];\r\n        const ast = buildAnimationAst(this._driver, metadata, errors);\r\n        if (errors.length) {\r\n            throw new Error(`Unable to build the animation due to the following errors: ${errors.join('\\n')}`);\r\n        }\r\n        else {\r\n            this._animations[id] = ast;\r\n        }\r\n    }\r\n    _buildPlayer(i, preStyles, postStyles) {\r\n        const element = i.element;\r\n        const keyframes = normalizeKeyframes(this._driver, this._normalizer, element, i.keyframes, preStyles, postStyles);\r\n        return this._driver.animate(element, keyframes, i.duration, i.delay, i.easing, [], true);\r\n    }\r\n    create(id, element, options = {}) {\r\n        const errors = [];\r\n        const ast = this._animations[id];\r\n        let instructions;\r\n        const autoStylesMap = new Map();\r\n        if (ast) {\r\n            instructions = buildAnimationTimelines(this._driver, element, ast, ENTER_CLASSNAME, LEAVE_CLASSNAME, {}, {}, options, EMPTY_INSTRUCTION_MAP, errors);\r\n            instructions.forEach(inst => {\r\n                const styles = getOrSetAsInMap(autoStylesMap, inst.element, {});\r\n                inst.postStyleProps.forEach(prop => styles[prop] = null);\r\n            });\r\n        }\r\n        else {\r\n            errors.push('The requested animation doesn\\'t exist or has already been destroyed');\r\n            instructions = [];\r\n        }\r\n        if (errors.length) {\r\n            throw new Error(`Unable to create the animation due to the following errors: ${errors.join('\\n')}`);\r\n        }\r\n        autoStylesMap.forEach((styles, element) => {\r\n            Object.keys(styles).forEach(prop => {\r\n                styles[prop] = this._driver.computeStyle(element, prop, AUTO_STYLE);\r\n            });\r\n        });\r\n        const players = instructions.map(i => {\r\n            const styles = autoStylesMap.get(i.element);\r\n            return this._buildPlayer(i, {}, styles);\r\n        });\r\n        const player = optimizeGroupPlayer(players);\r\n        this._playersById[id] = player;\r\n        player.onDestroy(() => this.destroy(id));\r\n        this.players.push(player);\r\n        return player;\r\n    }\r\n    destroy(id) {\r\n        const player = this._getPlayer(id);\r\n        player.destroy();\r\n        delete this._playersById[id];\r\n        const index = this.players.indexOf(player);\r\n        if (index >= 0) {\r\n            this.players.splice(index, 1);\r\n        }\r\n    }\r\n    _getPlayer(id) {\r\n        const player = this._playersById[id];\r\n        if (!player) {\r\n            throw new Error(`Unable to find the timeline player referenced by ${id}`);\r\n        }\r\n        return player;\r\n    }\r\n    listen(id, element, eventName, callback) {\r\n        // triggerName, fromState, toState are all ignored for timeline animations\r\n        const baseEvent = makeAnimationEvent(element, '', '', '');\r\n        listenOnPlayer(this._getPlayer(id), eventName, baseEvent, callback);\r\n        return () => { };\r\n    }\r\n    command(id, element, command, args) {\r\n        if (command == 'register') {\r\n            this.register(id, args[0]);\r\n            return;\r\n        }\r\n        if (command == 'create') {\r\n            const options = (args[0] || {});\r\n            this.create(id, element, options);\r\n            return;\r\n        }\r\n        const player = this._getPlayer(id);\r\n        switch (command) {\r\n            case 'play':\r\n                player.play();\r\n                break;\r\n            case 'pause':\r\n                player.pause();\r\n                break;\r\n            case 'reset':\r\n                player.reset();\r\n                break;\r\n            case 'restart':\r\n                player.restart();\r\n                break;\r\n            case 'finish':\r\n                player.finish();\r\n                break;\r\n            case 'init':\r\n                player.init();\r\n                break;\r\n            case 'setPosition':\r\n                player.setPosition(parseFloat(args[0]));\r\n                break;\r\n            case 'destroy':\r\n                this.destroy(id);\r\n                break;\r\n        }\r\n    }\r\n}\r\n\r\n/**\r\n * @license\r\n * Copyright Google LLC All Rights Reserved.\r\n *\r\n * Use of this source code is governed by an MIT-style license that can be\r\n * found in the LICENSE file at https://angular.io/license\r\n */\r\nconst QUEUED_CLASSNAME = 'ng-animate-queued';\r\nconst QUEUED_SELECTOR = '.ng-animate-queued';\r\nconst DISABLED_CLASSNAME = 'ng-animate-disabled';\r\nconst DISABLED_SELECTOR = '.ng-animate-disabled';\r\nconst STAR_CLASSNAME = 'ng-star-inserted';\r\nconst STAR_SELECTOR = '.ng-star-inserted';\r\nconst EMPTY_PLAYER_ARRAY = [];\r\nconst NULL_REMOVAL_STATE = {\r\n    namespaceId: '',\r\n    setForRemoval: false,\r\n    setForMove: false,\r\n    hasAnimation: false,\r\n    removedBeforeQueried: false\r\n};\r\nconst NULL_REMOVED_QUERIED_STATE = {\r\n    namespaceId: '',\r\n    setForMove: false,\r\n    setForRemoval: false,\r\n    hasAnimation: false,\r\n    removedBeforeQueried: true\r\n};\r\nconst REMOVAL_FLAG = '__ng_removed';\r\nclass StateValue {\r\n    constructor(input, namespaceId = '') {\r\n        this.namespaceId = namespaceId;\r\n        const isObj = input && input.hasOwnProperty('value');\r\n        const value = isObj ? input['value'] : input;\r\n        this.value = normalizeTriggerValue(value);\r\n        if (isObj) {\r\n            const options = copyObj(input);\r\n            delete options['value'];\r\n            this.options = options;\r\n        }\r\n        else {\r\n            this.options = {};\r\n        }\r\n        if (!this.options.params) {\r\n            this.options.params = {};\r\n        }\r\n    }\r\n    get params() {\r\n        return this.options.params;\r\n    }\r\n    absorbOptions(options) {\r\n        const newParams = options.params;\r\n        if (newParams) {\r\n            const oldParams = this.options.params;\r\n            Object.keys(newParams).forEach(prop => {\r\n                if (oldParams[prop] == null) {\r\n                    oldParams[prop] = newParams[prop];\r\n                }\r\n            });\r\n        }\r\n    }\r\n}\r\nconst VOID_VALUE = 'void';\r\nconst DEFAULT_STATE_VALUE = new StateValue(VOID_VALUE);\r\nclass AnimationTransitionNamespace {\r\n    constructor(id, hostElement, _engine) {\r\n        this.id = id;\r\n        this.hostElement = hostElement;\r\n        this._engine = _engine;\r\n        this.players = [];\r\n        this._triggers = {};\r\n        this._queue = [];\r\n        this._elementListeners = new Map();\r\n        this._hostClassName = 'ng-tns-' + id;\r\n        addClass(hostElement, this._hostClassName);\r\n    }\r\n    listen(element, name, phase, callback) {\r\n        if (!this._triggers.hasOwnProperty(name)) {\r\n            throw new Error(`Unable to listen on the animation trigger event \"${phase}\" because the animation trigger \"${name}\" doesn\\'t exist!`);\r\n        }\r\n        if (phase == null || phase.length == 0) {\r\n            throw new Error(`Unable to listen on the animation trigger \"${name}\" because the provided event is undefined!`);\r\n        }\r\n        if (!isTriggerEventValid(phase)) {\r\n            throw new Error(`The provided animation trigger event \"${phase}\" for the animation trigger \"${name}\" is not supported!`);\r\n        }\r\n        const listeners = getOrSetAsInMap(this._elementListeners, element, []);\r\n        const data = { name, phase, callback };\r\n        listeners.push(data);\r\n        const triggersWithStates = getOrSetAsInMap(this._engine.statesByElement, element, {});\r\n        if (!triggersWithStates.hasOwnProperty(name)) {\r\n            addClass(element, NG_TRIGGER_CLASSNAME);\r\n            addClass(element, NG_TRIGGER_CLASSNAME + '-' + name);\r\n            triggersWithStates[name] = DEFAULT_STATE_VALUE;\r\n        }\r\n        return () => {\r\n            // the event listener is removed AFTER the flush has occurred such\r\n            // that leave animations callbacks can fire (otherwise if the node\r\n            // is removed in between then the listeners would be deregistered)\r\n            this._engine.afterFlush(() => {\r\n                const index = listeners.indexOf(data);\r\n                if (index >= 0) {\r\n                    listeners.splice(index, 1);\r\n                }\r\n                if (!this._triggers[name]) {\r\n                    delete triggersWithStates[name];\r\n                }\r\n            });\r\n        };\r\n    }\r\n    register(name, ast) {\r\n        if (this._triggers[name]) {\r\n            // throw\r\n            return false;\r\n        }\r\n        else {\r\n            this._triggers[name] = ast;\r\n            return true;\r\n        }\r\n    }\r\n    _getTrigger(name) {\r\n        const trigger = this._triggers[name];\r\n        if (!trigger) {\r\n            throw new Error(`The provided animation trigger \"${name}\" has not been registered!`);\r\n        }\r\n        return trigger;\r\n    }\r\n    trigger(element, triggerName, value, defaultToFallback = true) {\r\n        const trigger = this._getTrigger(triggerName);\r\n        const player = new TransitionAnimationPlayer(this.id, triggerName, element);\r\n        let triggersWithStates = this._engine.statesByElement.get(element);\r\n        if (!triggersWithStates) {\r\n            addClass(element, NG_TRIGGER_CLASSNAME);\r\n            addClass(element, NG_TRIGGER_CLASSNAME + '-' + triggerName);\r\n            this._engine.statesByElement.set(element, triggersWithStates = {});\r\n        }\r\n        let fromState = triggersWithStates[triggerName];\r\n        const toState = new StateValue(value, this.id);\r\n        const isObj = value && value.hasOwnProperty('value');\r\n        if (!isObj && fromState) {\r\n            toState.absorbOptions(fromState.options);\r\n        }\r\n        triggersWithStates[triggerName] = toState;\r\n        if (!fromState) {\r\n            fromState = DEFAULT_STATE_VALUE;\r\n        }\r\n        const isRemoval = toState.value === VOID_VALUE;\r\n        // normally this isn't reached by here, however, if an object expression\r\n        // is passed in then it may be a new object each time. Comparing the value\r\n        // is important since that will stay the same despite there being a new object.\r\n        // The removal arc here is special cased because the same element is triggered\r\n        // twice in the event that it contains animations on the outer/inner portions\r\n        // of the host container\r\n        if (!isRemoval && fromState.value === toState.value) {\r\n            // this means that despite the value not changing, some inner params\r\n            // have changed which means that the animation final styles need to be applied\r\n            if (!objEquals(fromState.params, toState.params)) {\r\n                const errors = [];\r\n                const fromStyles = trigger.matchStyles(fromState.value, fromState.params, errors);\r\n                const toStyles = trigger.matchStyles(toState.value, toState.params, errors);\r\n                if (errors.length) {\r\n                    this._engine.reportError(errors);\r\n                }\r\n                else {\r\n                    this._engine.afterFlush(() => {\r\n                        eraseStyles(element, fromStyles);\r\n                        setStyles(element, toStyles);\r\n                    });\r\n                }\r\n            }\r\n            return;\r\n        }\r\n        const playersOnElement = getOrSetAsInMap(this._engine.playersByElement, element, []);\r\n        playersOnElement.forEach(player => {\r\n            // only remove the player if it is queued on the EXACT same trigger/namespace\r\n            // we only also deal with queued players here because if the animation has\r\n            // started then we want to keep the player alive until the flush happens\r\n            // (which is where the previousPlayers are passed into the new palyer)\r\n            if (player.namespaceId == this.id && player.triggerName == triggerName && player.queued) {\r\n                player.destroy();\r\n            }\r\n        });\r\n        let transition = trigger.matchTransition(fromState.value, toState.value, element, toState.params);\r\n        let isFallbackTransition = false;\r\n        if (!transition) {\r\n            if (!defaultToFallback)\r\n                return;\r\n            transition = trigger.fallbackTransition;\r\n            isFallbackTransition = true;\r\n        }\r\n        this._engine.totalQueuedPlayers++;\r\n        this._queue.push({ element, triggerName, transition, fromState, toState, player, isFallbackTransition });\r\n        if (!isFallbackTransition) {\r\n            addClass(element, QUEUED_CLASSNAME);\r\n            player.onStart(() => {\r\n                removeClass(element, QUEUED_CLASSNAME);\r\n            });\r\n        }\r\n        player.onDone(() => {\r\n            let index = this.players.indexOf(player);\r\n            if (index >= 0) {\r\n                this.players.splice(index, 1);\r\n            }\r\n            const players = this._engine.playersByElement.get(element);\r\n            if (players) {\r\n                let index = players.indexOf(player);\r\n                if (index >= 0) {\r\n                    players.splice(index, 1);\r\n                }\r\n            }\r\n        });\r\n        this.players.push(player);\r\n        playersOnElement.push(player);\r\n        return player;\r\n    }\r\n    deregister(name) {\r\n        delete this._triggers[name];\r\n        this._engine.statesByElement.forEach((stateMap, element) => {\r\n            delete stateMap[name];\r\n        });\r\n        this._elementListeners.forEach((listeners, element) => {\r\n            this._elementListeners.set(element, listeners.filter(entry => {\r\n                return entry.name != name;\r\n            }));\r\n        });\r\n    }\r\n    clearElementCache(element) {\r\n        this._engine.statesByElement.delete(element);\r\n        this._elementListeners.delete(element);\r\n        const elementPlayers = this._engine.playersByElement.get(element);\r\n        if (elementPlayers) {\r\n            elementPlayers.forEach(player => player.destroy());\r\n            this._engine.playersByElement.delete(element);\r\n        }\r\n    }\r\n    _signalRemovalForInnerTriggers(rootElement, context) {\r\n        const elements = this._engine.driver.query(rootElement, NG_TRIGGER_SELECTOR, true);\r\n        // emulate a leave animation for all inner nodes within this node.\r\n        // If there are no animations found for any of the nodes then clear the cache\r\n        // for the element.\r\n        elements.forEach(elm => {\r\n            // this means that an inner remove() operation has already kicked off\r\n            // the animation on this element...\r\n            if (elm[REMOVAL_FLAG])\r\n                return;\r\n            const namespaces = this._engine.fetchNamespacesByElement(elm);\r\n            if (namespaces.size) {\r\n                namespaces.forEach(ns => ns.triggerLeaveAnimation(elm, context, false, true));\r\n            }\r\n            else {\r\n                this.clearElementCache(elm);\r\n            }\r\n        });\r\n        // If the child elements were removed along with the parent, their animations might not\r\n        // have completed. Clear all the elements from the cache so we don't end up with a memory leak.\r\n        this._engine.afterFlushAnimationsDone(() => elements.forEach(elm => this.clearElementCache(elm)));\r\n    }\r\n    triggerLeaveAnimation(element, context, destroyAfterComplete, defaultToFallback) {\r\n        const triggerStates = this._engine.statesByElement.get(element);\r\n        if (triggerStates) {\r\n            const players = [];\r\n            Object.keys(triggerStates).forEach(triggerName => {\r\n                // this check is here in the event that an element is removed\r\n                // twice (both on the host level and the component level)\r\n                if (this._triggers[triggerName]) {\r\n                    const player = this.trigger(element, triggerName, VOID_VALUE, defaultToFallback);\r\n                    if (player) {\r\n                        players.push(player);\r\n                    }\r\n                }\r\n            });\r\n            if (players.length) {\r\n                this._engine.markElementAsRemoved(this.id, element, true, context);\r\n                if (destroyAfterComplete) {\r\n                    optimizeGroupPlayer(players).onDone(() => this._engine.processLeaveNode(element));\r\n                }\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    }\r\n    prepareLeaveAnimationListeners(element) {\r\n        const listeners = this._elementListeners.get(element);\r\n        const elementStates = this._engine.statesByElement.get(element);\r\n        // if this statement fails then it means that the element was picked up\r\n        // by an earlier flush (or there are no listeners at all to track the leave).\r\n        if (listeners && elementStates) {\r\n            const visitedTriggers = new Set();\r\n            listeners.forEach(listener => {\r\n                const triggerName = listener.name;\r\n                if (visitedTriggers.has(triggerName))\r\n                    return;\r\n                visitedTriggers.add(triggerName);\r\n                const trigger = this._triggers[triggerName];\r\n                const transition = trigger.fallbackTransition;\r\n                const fromState = elementStates[triggerName] || DEFAULT_STATE_VALUE;\r\n                const toState = new StateValue(VOID_VALUE);\r\n                const player = new TransitionAnimationPlayer(this.id, triggerName, element);\r\n                this._engine.totalQueuedPlayers++;\r\n                this._queue.push({\r\n                    element,\r\n                    triggerName,\r\n                    transition,\r\n                    fromState,\r\n                    toState,\r\n                    player,\r\n                    isFallbackTransition: true\r\n                });\r\n            });\r\n        }\r\n    }\r\n    removeNode(element, context) {\r\n        const engine = this._engine;\r\n        if (element.childElementCount) {\r\n            this._signalRemovalForInnerTriggers(element, context);\r\n        }\r\n        // this means that a * => VOID animation was detected and kicked off\r\n        if (this.triggerLeaveAnimation(element, context, true))\r\n            return;\r\n        // find the player that is animating and make sure that the\r\n        // removal is delayed until that player has completed\r\n        let containsPotentialParentTransition = false;\r\n        if (engine.totalAnimations) {\r\n            const currentPlayers = engine.players.length ? engine.playersByQueriedElement.get(element) : [];\r\n            // when this `if statement` does not continue forward it means that\r\n            // a previous animation query has selected the current element and\r\n            // is animating it. In this situation want to continue forwards and\r\n            // allow the element to be queued up for animation later.\r\n            if (currentPlayers && currentPlayers.length) {\r\n                containsPotentialParentTransition = true;\r\n            }\r\n            else {\r\n                let parent = element;\r\n                while (parent = parent.parentNode) {\r\n                    const triggers = engine.statesByElement.get(parent);\r\n                    if (triggers) {\r\n                        containsPotentialParentTransition = true;\r\n                        break;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        // at this stage we know that the element will either get removed\r\n        // during flush or will be picked up by a parent query. Either way\r\n        // we need to fire the listeners for this element when it DOES get\r\n        // removed (once the query parent animation is done or after flush)\r\n        this.prepareLeaveAnimationListeners(element);\r\n        // whether or not a parent has an animation we need to delay the deferral of the leave\r\n        // operation until we have more information (which we do after flush() has been called)\r\n        if (containsPotentialParentTransition) {\r\n            engine.markElementAsRemoved(this.id, element, false, context);\r\n        }\r\n        else {\r\n            const removalFlag = element[REMOVAL_FLAG];\r\n            if (!removalFlag || removalFlag === NULL_REMOVAL_STATE) {\r\n                // we do this after the flush has occurred such\r\n                // that the callbacks can be fired\r\n                engine.afterFlush(() => this.clearElementCache(element));\r\n                engine.destroyInnerAnimations(element);\r\n                engine._onRemovalComplete(element, context);\r\n            }\r\n        }\r\n    }\r\n    insertNode(element, parent) {\r\n        addClass(element, this._hostClassName);\r\n    }\r\n    drainQueuedTransitions(microtaskId) {\r\n        const instructions = [];\r\n        this._queue.forEach(entry => {\r\n            const player = entry.player;\r\n            if (player.destroyed)\r\n                return;\r\n            const element = entry.element;\r\n            const listeners = this._elementListeners.get(element);\r\n            if (listeners) {\r\n                listeners.forEach((listener) => {\r\n                    if (listener.name == entry.triggerName) {\r\n                        const baseEvent = makeAnimationEvent(element, entry.triggerName, entry.fromState.value, entry.toState.value);\r\n                        baseEvent['_data'] = microtaskId;\r\n                        listenOnPlayer(entry.player, listener.phase, baseEvent, listener.callback);\r\n                    }\r\n                });\r\n            }\r\n            if (player.markedForDestroy) {\r\n                this._engine.afterFlush(() => {\r\n                    // now we can destroy the element properly since the event listeners have\r\n                    // been bound to the player\r\n                    player.destroy();\r\n                });\r\n            }\r\n            else {\r\n                instructions.push(entry);\r\n            }\r\n        });\r\n        this._queue = [];\r\n        return instructions.sort((a, b) => {\r\n            // if depCount == 0 them move to front\r\n            // otherwise if a contains b then move back\r\n            const d0 = a.transition.ast.depCount;\r\n            const d1 = b.transition.ast.depCount;\r\n            if (d0 == 0 || d1 == 0) {\r\n                return d0 - d1;\r\n            }\r\n            return this._engine.driver.containsElement(a.element, b.element) ? 1 : -1;\r\n        });\r\n    }\r\n    destroy(context) {\r\n        this.players.forEach(p => p.destroy());\r\n        this._signalRemovalForInnerTriggers(this.hostElement, context);\r\n    }\r\n    elementContainsData(element) {\r\n        let containsData = false;\r\n        if (this._elementListeners.has(element))\r\n            containsData = true;\r\n        containsData =\r\n            (this._queue.find(entry => entry.element === element) ? true : false) || containsData;\r\n        return containsData;\r\n    }\r\n}\r\nclass TransitionAnimationEngine {\r\n    constructor(bodyNode, driver, _normalizer) {\r\n        this.bodyNode = bodyNode;\r\n        this.driver = driver;\r\n        this._normalizer = _normalizer;\r\n        this.players = [];\r\n        this.newHostElements = new Map();\r\n        this.playersByElement = new Map();\r\n        this.playersByQueriedElement = new Map();\r\n        this.statesByElement = new Map();\r\n        this.disabledNodes = new Set();\r\n        this.totalAnimations = 0;\r\n        this.totalQueuedPlayers = 0;\r\n        this._namespaceLookup = {};\r\n        this._namespaceList = [];\r\n        this._flushFns = [];\r\n        this._whenQuietFns = [];\r\n        this.namespacesByHostElement = new Map();\r\n        this.collectedEnterElements = [];\r\n        this.collectedLeaveElements = [];\r\n        // this method is designed to be overridden by the code that uses this engine\r\n        this.onRemovalComplete = (element, context) => { };\r\n    }\r\n    /** @internal */\r\n    _onRemovalComplete(element, context) {\r\n        this.onRemovalComplete(element, context);\r\n    }\r\n    get queuedPlayers() {\r\n        const players = [];\r\n        this._namespaceList.forEach(ns => {\r\n            ns.players.forEach(player => {\r\n                if (player.queued) {\r\n                    players.push(player);\r\n                }\r\n            });\r\n        });\r\n        return players;\r\n    }\r\n    createNamespace(namespaceId, hostElement) {\r\n        const ns = new AnimationTransitionNamespace(namespaceId, hostElement, this);\r\n        if (this.bodyNode && this.driver.containsElement(this.bodyNode, hostElement)) {\r\n            this._balanceNamespaceList(ns, hostElement);\r\n        }\r\n        else {\r\n            // defer this later until flush during when the host element has\r\n            // been inserted so that we know exactly where to place it in\r\n            // the namespace list\r\n            this.newHostElements.set(hostElement, ns);\r\n            // given that this host element is apart of the animation code, it\r\n            // may or may not be inserted by a parent node that is of an\r\n            // animation renderer type. If this happens then we can still have\r\n            // access to this item when we query for :enter nodes. If the parent\r\n            // is a renderer then the set data-structure will normalize the entry\r\n            this.collectEnterElement(hostElement);\r\n        }\r\n        return this._namespaceLookup[namespaceId] = ns;\r\n    }\r\n    _balanceNamespaceList(ns, hostElement) {\r\n        const limit = this._namespaceList.length - 1;\r\n        if (limit >= 0) {\r\n            let found = false;\r\n            for (let i = limit; i >= 0; i--) {\r\n                const nextNamespace = this._namespaceList[i];\r\n                if (this.driver.containsElement(nextNamespace.hostElement, hostElement)) {\r\n                    this._namespaceList.splice(i + 1, 0, ns);\r\n                    found = true;\r\n                    break;\r\n                }\r\n            }\r\n            if (!found) {\r\n                this._namespaceList.splice(0, 0, ns);\r\n            }\r\n        }\r\n        else {\r\n            this._namespaceList.push(ns);\r\n        }\r\n        this.namespacesByHostElement.set(hostElement, ns);\r\n        return ns;\r\n    }\r\n    register(namespaceId, hostElement) {\r\n        let ns = this._namespaceLookup[namespaceId];\r\n        if (!ns) {\r\n            ns = this.createNamespace(namespaceId, hostElement);\r\n        }\r\n        return ns;\r\n    }\r\n    registerTrigger(namespaceId, name, trigger) {\r\n        let ns = this._namespaceLookup[namespaceId];\r\n        if (ns && ns.register(name, trigger)) {\r\n            this.totalAnimations++;\r\n        }\r\n    }\r\n    destroy(namespaceId, context) {\r\n        if (!namespaceId)\r\n            return;\r\n        const ns = this._fetchNamespace(namespaceId);\r\n        this.afterFlush(() => {\r\n            this.namespacesByHostElement.delete(ns.hostElement);\r\n            delete this._namespaceLookup[namespaceId];\r\n            const index = this._namespaceList.indexOf(ns);\r\n            if (index >= 0) {\r\n                this._namespaceList.splice(index, 1);\r\n            }\r\n        });\r\n        this.afterFlushAnimationsDone(() => ns.destroy(context));\r\n    }\r\n    _fetchNamespace(id) {\r\n        return this._namespaceLookup[id];\r\n    }\r\n    fetchNamespacesByElement(element) {\r\n        // normally there should only be one namespace per element, however\r\n        // if @triggers are placed on both the component element and then\r\n        // its host element (within the component code) then there will be\r\n        // two namespaces returned. We use a set here to simply the dedupe\r\n        // of namespaces incase there are multiple triggers both the elm and host\r\n        const namespaces = new Set();\r\n        const elementStates = this.statesByElement.get(element);\r\n        if (elementStates) {\r\n            const keys = Object.keys(elementStates);\r\n            for (let i = 0; i < keys.length; i++) {\r\n                const nsId = elementStates[keys[i]].namespaceId;\r\n                if (nsId) {\r\n                    const ns = this._fetchNamespace(nsId);\r\n                    if (ns) {\r\n                        namespaces.add(ns);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        return namespaces;\r\n    }\r\n    trigger(namespaceId, element, name, value) {\r\n        if (isElementNode(element)) {\r\n            const ns = this._fetchNamespace(namespaceId);\r\n            if (ns) {\r\n                ns.trigger(element, name, value);\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    }\r\n    insertNode(namespaceId, element, parent, insertBefore) {\r\n        if (!isElementNode(element))\r\n            return;\r\n        // special case for when an element is removed and reinserted (move operation)\r\n        // when this occurs we do not want to use the element for deletion later\r\n        const details = element[REMOVAL_FLAG];\r\n        if (details && details.setForRemoval) {\r\n            details.setForRemoval = false;\r\n            details.setForMove = true;\r\n            const index = this.collectedLeaveElements.indexOf(element);\r\n            if (index >= 0) {\r\n                this.collectedLeaveElements.splice(index, 1);\r\n            }\r\n        }\r\n        // in the event that the namespaceId is blank then the caller\r\n        // code does not contain any animation code in it, but it is\r\n        // just being called so that the node is marked as being inserted\r\n        if (namespaceId) {\r\n            const ns = this._fetchNamespace(namespaceId);\r\n            // This if-statement is a workaround for router issue #21947.\r\n            // The router sometimes hits a race condition where while a route\r\n            // is being instantiated a new navigation arrives, triggering leave\r\n            // animation of DOM that has not been fully initialized, until this\r\n            // is resolved, we need to handle the scenario when DOM is not in a\r\n            // consistent state during the animation.\r\n            if (ns) {\r\n                ns.insertNode(element, parent);\r\n            }\r\n        }\r\n        // only *directives and host elements are inserted before\r\n        if (insertBefore) {\r\n            this.collectEnterElement(element);\r\n        }\r\n    }\r\n    collectEnterElement(element) {\r\n        this.collectedEnterElements.push(element);\r\n    }\r\n    markElementAsDisabled(element, value) {\r\n        if (value) {\r\n            if (!this.disabledNodes.has(element)) {\r\n                this.disabledNodes.add(element);\r\n                addClass(element, DISABLED_CLASSNAME);\r\n            }\r\n        }\r\n        else if (this.disabledNodes.has(element)) {\r\n            this.disabledNodes.delete(element);\r\n            removeClass(element, DISABLED_CLASSNAME);\r\n        }\r\n    }\r\n    removeNode(namespaceId, element, isHostElement, context) {\r\n        if (isElementNode(element)) {\r\n            const ns = namespaceId ? this._fetchNamespace(namespaceId) : null;\r\n            if (ns) {\r\n                ns.removeNode(element, context);\r\n            }\r\n            else {\r\n                this.markElementAsRemoved(namespaceId, element, false, context);\r\n            }\r\n            if (isHostElement) {\r\n                const hostNS = this.namespacesByHostElement.get(element);\r\n                if (hostNS && hostNS.id !== namespaceId) {\r\n                    hostNS.removeNode(element, context);\r\n                }\r\n            }\r\n        }\r\n        else {\r\n            this._onRemovalComplete(element, context);\r\n        }\r\n    }\r\n    markElementAsRemoved(namespaceId, element, hasAnimation, context) {\r\n        this.collectedLeaveElements.push(element);\r\n        element[REMOVAL_FLAG] =\r\n            { namespaceId, setForRemoval: context, hasAnimation, removedBeforeQueried: false };\r\n    }\r\n    listen(namespaceId, element, name, phase, callback) {\r\n        if (isElementNode(element)) {\r\n            return this._fetchNamespace(namespaceId).listen(element, name, phase, callback);\r\n        }\r\n        return () => { };\r\n    }\r\n    _buildInstruction(entry, subTimelines, enterClassName, leaveClassName, skipBuildAst) {\r\n        return entry.transition.build(this.driver, entry.element, entry.fromState.value, entry.toState.value, enterClassName, leaveClassName, entry.fromState.options, entry.toState.options, subTimelines, skipBuildAst);\r\n    }\r\n    destroyInnerAnimations(containerElement) {\r\n        let elements = this.driver.query(containerElement, NG_TRIGGER_SELECTOR, true);\r\n        elements.forEach(element => this.destroyActiveAnimationsForElement(element));\r\n        if (this.playersByQueriedElement.size == 0)\r\n            return;\r\n        elements = this.driver.query(containerElement, NG_ANIMATING_SELECTOR, true);\r\n        elements.forEach(element => this.finishActiveQueriedAnimationOnElement(element));\r\n    }\r\n    destroyActiveAnimationsForElement(element) {\r\n        const players = this.playersByElement.get(element);\r\n        if (players) {\r\n            players.forEach(player => {\r\n                // special case for when an element is set for destruction, but hasn't started.\r\n                // in this situation we want to delay the destruction until the flush occurs\r\n                // so that any event listeners attached to the player are triggered.\r\n                if (player.queued) {\r\n                    player.markedForDestroy = true;\r\n                }\r\n                else {\r\n                    player.destroy();\r\n                }\r\n            });\r\n        }\r\n    }\r\n    finishActiveQueriedAnimationOnElement(element) {\r\n        const players = this.playersByQueriedElement.get(element);\r\n        if (players) {\r\n            players.forEach(player => player.finish());\r\n        }\r\n    }\r\n    whenRenderingDone() {\r\n        return new Promise(resolve => {\r\n            if (this.players.length) {\r\n                return optimizeGroupPlayer(this.players).onDone(() => resolve());\r\n            }\r\n            else {\r\n                resolve();\r\n            }\r\n        });\r\n    }\r\n    processLeaveNode(element) {\r\n        const details = element[REMOVAL_FLAG];\r\n        if (details && details.setForRemoval) {\r\n            // this will prevent it from removing it twice\r\n            element[REMOVAL_FLAG] = NULL_REMOVAL_STATE;\r\n            if (details.namespaceId) {\r\n                this.destroyInnerAnimations(element);\r\n                const ns = this._fetchNamespace(details.namespaceId);\r\n                if (ns) {\r\n                    ns.clearElementCache(element);\r\n                }\r\n            }\r\n            this._onRemovalComplete(element, details.setForRemoval);\r\n        }\r\n        if (this.driver.matchesElement(element, DISABLED_SELECTOR)) {\r\n            this.markElementAsDisabled(element, false);\r\n        }\r\n        this.driver.query(element, DISABLED_SELECTOR, true).forEach(node => {\r\n            this.markElementAsDisabled(node, false);\r\n        });\r\n    }\r\n    flush(microtaskId = -1) {\r\n        let players = [];\r\n        if (this.newHostElements.size) {\r\n            this.newHostElements.forEach((ns, element) => this._balanceNamespaceList(ns, element));\r\n            this.newHostElements.clear();\r\n        }\r\n        if (this.totalAnimations && this.collectedEnterElements.length) {\r\n            for (let i = 0; i < this.collectedEnterElements.length; i++) {\r\n                const elm = this.collectedEnterElements[i];\r\n                addClass(elm, STAR_CLASSNAME);\r\n            }\r\n        }\r\n        if (this._namespaceList.length &&\r\n            (this.totalQueuedPlayers || this.collectedLeaveElements.length)) {\r\n            const cleanupFns = [];\r\n            try {\r\n                players = this._flushAnimations(cleanupFns, microtaskId);\r\n            }\r\n            finally {\r\n                for (let i = 0; i < cleanupFns.length; i++) {\r\n                    cleanupFns[i]();\r\n                }\r\n            }\r\n        }\r\n        else {\r\n            for (let i = 0; i < this.collectedLeaveElements.length; i++) {\r\n                const element = this.collectedLeaveElements[i];\r\n                this.processLeaveNode(element);\r\n            }\r\n        }\r\n        this.totalQueuedPlayers = 0;\r\n        this.collectedEnterElements.length = 0;\r\n        this.collectedLeaveElements.length = 0;\r\n        this._flushFns.forEach(fn => fn());\r\n        this._flushFns = [];\r\n        if (this._whenQuietFns.length) {\r\n            // we move these over to a variable so that\r\n            // if any new callbacks are registered in another\r\n            // flush they do not populate the existing set\r\n            const quietFns = this._whenQuietFns;\r\n            this._whenQuietFns = [];\r\n            if (players.length) {\r\n                optimizeGroupPlayer(players).onDone(() => {\r\n                    quietFns.forEach(fn => fn());\r\n                });\r\n            }\r\n            else {\r\n                quietFns.forEach(fn => fn());\r\n            }\r\n        }\r\n    }\r\n    reportError(errors) {\r\n        throw new Error(`Unable to process animations due to the following failed trigger transitions\\n ${errors.join('\\n')}`);\r\n    }\r\n    _flushAnimations(cleanupFns, microtaskId) {\r\n        const subTimelines = new ElementInstructionMap();\r\n        const skippedPlayers = [];\r\n        const skippedPlayersMap = new Map();\r\n        const queuedInstructions = [];\r\n        const queriedElements = new Map();\r\n        const allPreStyleElements = new Map();\r\n        const allPostStyleElements = new Map();\r\n        const disabledElementsSet = new Set();\r\n        this.disabledNodes.forEach(node => {\r\n            disabledElementsSet.add(node);\r\n            const nodesThatAreDisabled = this.driver.query(node, QUEUED_SELECTOR, true);\r\n            for (let i = 0; i < nodesThatAreDisabled.length; i++) {\r\n                disabledElementsSet.add(nodesThatAreDisabled[i]);\r\n            }\r\n        });\r\n        const bodyNode = this.bodyNode;\r\n        const allTriggerElements = Array.from(this.statesByElement.keys());\r\n        const enterNodeMap = buildRootMap(allTriggerElements, this.collectedEnterElements);\r\n        // this must occur before the instructions are built below such that\r\n        // the :enter queries match the elements (since the timeline queries\r\n        // are fired during instruction building).\r\n        const enterNodeMapIds = new Map();\r\n        let i = 0;\r\n        enterNodeMap.forEach((nodes, root) => {\r\n            const className = ENTER_CLASSNAME + i++;\r\n            enterNodeMapIds.set(root, className);\r\n            nodes.forEach(node => addClass(node, className));\r\n        });\r\n        const allLeaveNodes = [];\r\n        const mergedLeaveNodes = new Set();\r\n        const leaveNodesWithoutAnimations = new Set();\r\n        for (let i = 0; i < this.collectedLeaveElements.length; i++) {\r\n            const element = this.collectedLeaveElements[i];\r\n            const details = element[REMOVAL_FLAG];\r\n            if (details && details.setForRemoval) {\r\n                allLeaveNodes.push(element);\r\n                mergedLeaveNodes.add(element);\r\n                if (details.hasAnimation) {\r\n                    this.driver.query(element, STAR_SELECTOR, true).forEach(elm => mergedLeaveNodes.add(elm));\r\n                }\r\n                else {\r\n                    leaveNodesWithoutAnimations.add(element);\r\n                }\r\n            }\r\n        }\r\n        const leaveNodeMapIds = new Map();\r\n        const leaveNodeMap = buildRootMap(allTriggerElements, Array.from(mergedLeaveNodes));\r\n        leaveNodeMap.forEach((nodes, root) => {\r\n            const className = LEAVE_CLASSNAME + i++;\r\n            leaveNodeMapIds.set(root, className);\r\n            nodes.forEach(node => addClass(node, className));\r\n        });\r\n        cleanupFns.push(() => {\r\n            enterNodeMap.forEach((nodes, root) => {\r\n                const className = enterNodeMapIds.get(root);\r\n                nodes.forEach(node => removeClass(node, className));\r\n            });\r\n            leaveNodeMap.forEach((nodes, root) => {\r\n                const className = leaveNodeMapIds.get(root);\r\n                nodes.forEach(node => removeClass(node, className));\r\n            });\r\n            allLeaveNodes.forEach(element => {\r\n                this.processLeaveNode(element);\r\n            });\r\n        });\r\n        const allPlayers = [];\r\n        const erroneousTransitions = [];\r\n        for (let i = this._namespaceList.length - 1; i >= 0; i--) {\r\n            const ns = this._namespaceList[i];\r\n            ns.drainQueuedTransitions(microtaskId).forEach(entry => {\r\n                const player = entry.player;\r\n                const element = entry.element;\r\n                allPlayers.push(player);\r\n                if (this.collectedEnterElements.length) {\r\n                    const details = element[REMOVAL_FLAG];\r\n                    // move animations are currently not supported...\r\n                    if (details && details.setForMove) {\r\n                        player.destroy();\r\n                        return;\r\n                    }\r\n                }\r\n                const nodeIsOrphaned = !bodyNode || !this.driver.containsElement(bodyNode, element);\r\n                const leaveClassName = leaveNodeMapIds.get(element);\r\n                const enterClassName = enterNodeMapIds.get(element);\r\n                const instruction = this._buildInstruction(entry, subTimelines, enterClassName, leaveClassName, nodeIsOrphaned);\r\n                if (instruction.errors && instruction.errors.length) {\r\n                    erroneousTransitions.push(instruction);\r\n                    return;\r\n                }\r\n                // even though the element may not be apart of the DOM, it may\r\n                // still be added at a later point (due to the mechanics of content\r\n                // projection and/or dynamic component insertion) therefore it's\r\n                // important we still style the element.\r\n                if (nodeIsOrphaned) {\r\n                    player.onStart(() => eraseStyles(element, instruction.fromStyles));\r\n                    player.onDestroy(() => setStyles(element, instruction.toStyles));\r\n                    skippedPlayers.push(player);\r\n                    return;\r\n                }\r\n                // if a unmatched transition is queued to go then it SHOULD NOT render\r\n                // an animation and cancel the previously running animations.\r\n                if (entry.isFallbackTransition) {\r\n                    player.onStart(() => eraseStyles(element, instruction.fromStyles));\r\n                    player.onDestroy(() => setStyles(element, instruction.toStyles));\r\n                    skippedPlayers.push(player);\r\n                    return;\r\n                }\r\n                // this means that if a parent animation uses this animation as a sub trigger\r\n                // then it will instruct the timeline builder to not add a player delay, but\r\n                // instead stretch the first keyframe gap up until the animation starts. The\r\n                // reason this is important is to prevent extra initialization styles from being\r\n                // required by the user in the animation.\r\n                instruction.timelines.forEach(tl => tl.stretchStartingKeyframe = true);\r\n                subTimelines.append(element, instruction.timelines);\r\n                const tuple = { instruction, player, element };\r\n                queuedInstructions.push(tuple);\r\n                instruction.queriedElements.forEach(element => getOrSetAsInMap(queriedElements, element, []).push(player));\r\n                instruction.preStyleProps.forEach((stringMap, element) => {\r\n                    const props = Object.keys(stringMap);\r\n                    if (props.length) {\r\n                        let setVal = allPreStyleElements.get(element);\r\n                        if (!setVal) {\r\n                            allPreStyleElements.set(element, setVal = new Set());\r\n                        }\r\n                        props.forEach(prop => setVal.add(prop));\r\n                    }\r\n                });\r\n                instruction.postStyleProps.forEach((stringMap, element) => {\r\n                    const props = Object.keys(stringMap);\r\n                    let setVal = allPostStyleElements.get(element);\r\n                    if (!setVal) {\r\n                        allPostStyleElements.set(element, setVal = new Set());\r\n                    }\r\n                    props.forEach(prop => setVal.add(prop));\r\n                });\r\n            });\r\n        }\r\n        if (erroneousTransitions.length) {\r\n            const errors = [];\r\n            erroneousTransitions.forEach(instruction => {\r\n                errors.push(`@${instruction.triggerName} has failed due to:\\n`);\r\n                instruction.errors.forEach(error => errors.push(`- ${error}\\n`));\r\n            });\r\n            allPlayers.forEach(player => player.destroy());\r\n            this.reportError(errors);\r\n        }\r\n        const allPreviousPlayersMap = new Map();\r\n        // this map works to tell which element in the DOM tree is contained by\r\n        // which animation. Further down below this map will get populated once\r\n        // the players are built and in doing so it can efficiently figure out\r\n        // if a sub player is skipped due to a parent player having priority.\r\n        const animationElementMap = new Map();\r\n        queuedInstructions.forEach(entry => {\r\n            const element = entry.element;\r\n            if (subTimelines.has(element)) {\r\n                animationElementMap.set(element, element);\r\n                this._beforeAnimationBuild(entry.player.namespaceId, entry.instruction, allPreviousPlayersMap);\r\n            }\r\n        });\r\n        skippedPlayers.forEach(player => {\r\n            const element = player.element;\r\n            const previousPlayers = this._getPreviousPlayers(element, false, player.namespaceId, player.triggerName, null);\r\n            previousPlayers.forEach(prevPlayer => {\r\n                getOrSetAsInMap(allPreviousPlayersMap, element, []).push(prevPlayer);\r\n                prevPlayer.destroy();\r\n            });\r\n        });\r\n        // this is a special case for nodes that will be removed (either by)\r\n        // having their own leave animations or by being queried in a container\r\n        // that will be removed once a parent animation is complete. The idea\r\n        // here is that * styles must be identical to ! styles because of\r\n        // backwards compatibility (* is also filled in by default in many places).\r\n        // Otherwise * styles will return an empty value or auto since the element\r\n        // that is being getComputedStyle'd will not be visible (since * = destination)\r\n        const replaceNodes = allLeaveNodes.filter(node => {\r\n            return replacePostStylesAsPre(node, allPreStyleElements, allPostStyleElements);\r\n        });\r\n        // POST STAGE: fill the * styles\r\n        const postStylesMap = new Map();\r\n        const allLeaveQueriedNodes = cloakAndComputeStyles(postStylesMap, this.driver, leaveNodesWithoutAnimations, allPostStyleElements, AUTO_STYLE);\r\n        allLeaveQueriedNodes.forEach(node => {\r\n            if (replacePostStylesAsPre(node, allPreStyleElements, allPostStyleElements)) {\r\n                replaceNodes.push(node);\r\n            }\r\n        });\r\n        // PRE STAGE: fill the ! styles\r\n        const preStylesMap = new Map();\r\n        enterNodeMap.forEach((nodes, root) => {\r\n            cloakAndComputeStyles(preStylesMap, this.driver, new Set(nodes), allPreStyleElements, ɵPRE_STYLE);\r\n        });\r\n        replaceNodes.forEach(node => {\r\n            const post = postStylesMap.get(node);\r\n            const pre = preStylesMap.get(node);\r\n            postStylesMap.set(node, Object.assign(Object.assign({}, post), pre));\r\n        });\r\n        const rootPlayers = [];\r\n        const subPlayers = [];\r\n        const NO_PARENT_ANIMATION_ELEMENT_DETECTED = {};\r\n        queuedInstructions.forEach(entry => {\r\n            const { element, player, instruction } = entry;\r\n            // this means that it was never consumed by a parent animation which\r\n            // means that it is independent and therefore should be set for animation\r\n            if (subTimelines.has(element)) {\r\n                if (disabledElementsSet.has(element)) {\r\n                    player.onDestroy(() => setStyles(element, instruction.toStyles));\r\n                    player.disabled = true;\r\n                    player.overrideTotalTime(instruction.totalTime);\r\n                    skippedPlayers.push(player);\r\n                    return;\r\n                }\r\n                // this will flow up the DOM and query the map to figure out\r\n                // if a parent animation has priority over it. In the situation\r\n                // that a parent is detected then it will cancel the loop. If\r\n                // nothing is detected, or it takes a few hops to find a parent,\r\n                // then it will fill in the missing nodes and signal them as having\r\n                // a detected parent (or a NO_PARENT value via a special constant).\r\n                let parentWithAnimation = NO_PARENT_ANIMATION_ELEMENT_DETECTED;\r\n                if (animationElementMap.size > 1) {\r\n                    let elm = element;\r\n                    const parentsToAdd = [];\r\n                    while (elm = elm.parentNode) {\r\n                        const detectedParent = animationElementMap.get(elm);\r\n                        if (detectedParent) {\r\n                            parentWithAnimation = detectedParent;\r\n                            break;\r\n                        }\r\n                        parentsToAdd.push(elm);\r\n                    }\r\n                    parentsToAdd.forEach(parent => animationElementMap.set(parent, parentWithAnimation));\r\n                }\r\n                const innerPlayer = this._buildAnimation(player.namespaceId, instruction, allPreviousPlayersMap, skippedPlayersMap, preStylesMap, postStylesMap);\r\n                player.setRealPlayer(innerPlayer);\r\n                if (parentWithAnimation === NO_PARENT_ANIMATION_ELEMENT_DETECTED) {\r\n                    rootPlayers.push(player);\r\n                }\r\n                else {\r\n                    const parentPlayers = this.playersByElement.get(parentWithAnimation);\r\n                    if (parentPlayers && parentPlayers.length) {\r\n                        player.parentPlayer = optimizeGroupPlayer(parentPlayers);\r\n                    }\r\n                    skippedPlayers.push(player);\r\n                }\r\n            }\r\n            else {\r\n                eraseStyles(element, instruction.fromStyles);\r\n                player.onDestroy(() => setStyles(element, instruction.toStyles));\r\n                // there still might be a ancestor player animating this\r\n                // element therefore we will still add it as a sub player\r\n                // even if its animation may be disabled\r\n                subPlayers.push(player);\r\n                if (disabledElementsSet.has(element)) {\r\n                    skippedPlayers.push(player);\r\n                }\r\n            }\r\n        });\r\n        // find all of the sub players' corresponding inner animation player\r\n        subPlayers.forEach(player => {\r\n            // even if any players are not found for a sub animation then it\r\n            // will still complete itself after the next tick since it's Noop\r\n            const playersForElement = skippedPlayersMap.get(player.element);\r\n            if (playersForElement && playersForElement.length) {\r\n                const innerPlayer = optimizeGroupPlayer(playersForElement);\r\n                player.setRealPlayer(innerPlayer);\r\n            }\r\n        });\r\n        // the reason why we don't actually play the animation is\r\n        // because all that a skipped player is designed to do is to\r\n        // fire the start/done transition callback events\r\n        skippedPlayers.forEach(player => {\r\n            if (player.parentPlayer) {\r\n                player.syncPlayerEvents(player.parentPlayer);\r\n            }\r\n            else {\r\n                player.destroy();\r\n            }\r\n        });\r\n        // run through all of the queued removals and see if they\r\n        // were picked up by a query. If not then perform the removal\r\n        // operation right away unless a parent animation is ongoing.\r\n        for (let i = 0; i < allLeaveNodes.length; i++) {\r\n            const element = allLeaveNodes[i];\r\n            const details = element[REMOVAL_FLAG];\r\n            removeClass(element, LEAVE_CLASSNAME);\r\n            // this means the element has a removal animation that is being\r\n            // taken care of and therefore the inner elements will hang around\r\n            // until that animation is over (or the parent queried animation)\r\n            if (details && details.hasAnimation)\r\n                continue;\r\n            let players = [];\r\n            // if this element is queried or if it contains queried children\r\n            // then we want for the element not to be removed from the page\r\n            // until the queried animations have finished\r\n            if (queriedElements.size) {\r\n                let queriedPlayerResults = queriedElements.get(element);\r\n                if (queriedPlayerResults && queriedPlayerResults.length) {\r\n                    players.push(...queriedPlayerResults);\r\n                }\r\n                let queriedInnerElements = this.driver.query(element, NG_ANIMATING_SELECTOR, true);\r\n                for (let j = 0; j < queriedInnerElements.length; j++) {\r\n                    let queriedPlayers = queriedElements.get(queriedInnerElements[j]);\r\n                    if (queriedPlayers && queriedPlayers.length) {\r\n                        players.push(...queriedPlayers);\r\n                    }\r\n                }\r\n            }\r\n            const activePlayers = players.filter(p => !p.destroyed);\r\n            if (activePlayers.length) {\r\n                removeNodesAfterAnimationDone(this, element, activePlayers);\r\n            }\r\n            else {\r\n                this.processLeaveNode(element);\r\n            }\r\n        }\r\n        // this is required so the cleanup method doesn't remove them\r\n        allLeaveNodes.length = 0;\r\n        rootPlayers.forEach(player => {\r\n            this.players.push(player);\r\n            player.onDone(() => {\r\n                player.destroy();\r\n                const index = this.players.indexOf(player);\r\n                this.players.splice(index, 1);\r\n            });\r\n            player.play();\r\n        });\r\n        return rootPlayers;\r\n    }\r\n    elementContainsData(namespaceId, element) {\r\n        let containsData = false;\r\n        const details = element[REMOVAL_FLAG];\r\n        if (details && details.setForRemoval)\r\n            containsData = true;\r\n        if (this.playersByElement.has(element))\r\n            containsData = true;\r\n        if (this.playersByQueriedElement.has(element))\r\n            containsData = true;\r\n        if (this.statesByElement.has(element))\r\n            containsData = true;\r\n        return this._fetchNamespace(namespaceId).elementContainsData(element) || containsData;\r\n    }\r\n    afterFlush(callback) {\r\n        this._flushFns.push(callback);\r\n    }\r\n    afterFlushAnimationsDone(callback) {\r\n        this._whenQuietFns.push(callback);\r\n    }\r\n    _getPreviousPlayers(element, isQueriedElement, namespaceId, triggerName, toStateValue) {\r\n        let players = [];\r\n        if (isQueriedElement) {\r\n            const queriedElementPlayers = this.playersByQueriedElement.get(element);\r\n            if (queriedElementPlayers) {\r\n                players = queriedElementPlayers;\r\n            }\r\n        }\r\n        else {\r\n            const elementPlayers = this.playersByElement.get(element);\r\n            if (elementPlayers) {\r\n                const isRemovalAnimation = !toStateValue || toStateValue == VOID_VALUE;\r\n                elementPlayers.forEach(player => {\r\n                    if (player.queued)\r\n                        return;\r\n                    if (!isRemovalAnimation && player.triggerName != triggerName)\r\n                        return;\r\n                    players.push(player);\r\n                });\r\n            }\r\n        }\r\n        if (namespaceId || triggerName) {\r\n            players = players.filter(player => {\r\n                if (namespaceId && namespaceId != player.namespaceId)\r\n                    return false;\r\n                if (triggerName && triggerName != player.triggerName)\r\n                    return false;\r\n                return true;\r\n            });\r\n        }\r\n        return players;\r\n    }\r\n    _beforeAnimationBuild(namespaceId, instruction, allPreviousPlayersMap) {\r\n        const triggerName = instruction.triggerName;\r\n        const rootElement = instruction.element;\r\n        // when a removal animation occurs, ALL previous players are collected\r\n        // and destroyed (even if they are outside of the current namespace)\r\n        const targetNameSpaceId = instruction.isRemovalTransition ? undefined : namespaceId;\r\n        const targetTriggerName = instruction.isRemovalTransition ? undefined : triggerName;\r\n        for (const timelineInstruction of instruction.timelines) {\r\n            const element = timelineInstruction.element;\r\n            const isQueriedElement = element !== rootElement;\r\n            const players = getOrSetAsInMap(allPreviousPlayersMap, element, []);\r\n            const previousPlayers = this._getPreviousPlayers(element, isQueriedElement, targetNameSpaceId, targetTriggerName, instruction.toState);\r\n            previousPlayers.forEach(player => {\r\n                const realPlayer = player.getRealPlayer();\r\n                if (realPlayer.beforeDestroy) {\r\n                    realPlayer.beforeDestroy();\r\n                }\r\n                player.destroy();\r\n                players.push(player);\r\n            });\r\n        }\r\n        // this needs to be done so that the PRE/POST styles can be\r\n        // computed properly without interfering with the previous animation\r\n        eraseStyles(rootElement, instruction.fromStyles);\r\n    }\r\n    _buildAnimation(namespaceId, instruction, allPreviousPlayersMap, skippedPlayersMap, preStylesMap, postStylesMap) {\r\n        const triggerName = instruction.triggerName;\r\n        const rootElement = instruction.element;\r\n        // we first run this so that the previous animation player\r\n        // data can be passed into the successive animation players\r\n        const allQueriedPlayers = [];\r\n        const allConsumedElements = new Set();\r\n        const allSubElements = new Set();\r\n        const allNewPlayers = instruction.timelines.map(timelineInstruction => {\r\n            const element = timelineInstruction.element;\r\n            allConsumedElements.add(element);\r\n            // FIXME (matsko): make sure to-be-removed animations are removed properly\r\n            const details = element[REMOVAL_FLAG];\r\n            if (details && details.removedBeforeQueried)\r\n                return new NoopAnimationPlayer(timelineInstruction.duration, timelineInstruction.delay);\r\n            const isQueriedElement = element !== rootElement;\r\n            const previousPlayers = flattenGroupPlayers((allPreviousPlayersMap.get(element) || EMPTY_PLAYER_ARRAY)\r\n                .map(p => p.getRealPlayer()))\r\n                .filter(p => {\r\n                // the `element` is not apart of the AnimationPlayer definition, but\r\n                // Mock/WebAnimations\r\n                // use the element within their implementation. This will be added in Angular5 to\r\n                // AnimationPlayer\r\n                const pp = p;\r\n                return pp.element ? pp.element === element : false;\r\n            });\r\n            const preStyles = preStylesMap.get(element);\r\n            const postStyles = postStylesMap.get(element);\r\n            const keyframes = normalizeKeyframes(this.driver, this._normalizer, element, timelineInstruction.keyframes, preStyles, postStyles);\r\n            const player = this._buildPlayer(timelineInstruction, keyframes, previousPlayers);\r\n            // this means that this particular player belongs to a sub trigger. It is\r\n            // important that we match this player up with the corresponding (@trigger.listener)\r\n            if (timelineInstruction.subTimeline && skippedPlayersMap) {\r\n                allSubElements.add(element);\r\n            }\r\n            if (isQueriedElement) {\r\n                const wrappedPlayer = new TransitionAnimationPlayer(namespaceId, triggerName, element);\r\n                wrappedPlayer.setRealPlayer(player);\r\n                allQueriedPlayers.push(wrappedPlayer);\r\n            }\r\n            return player;\r\n        });\r\n        allQueriedPlayers.forEach(player => {\r\n            getOrSetAsInMap(this.playersByQueriedElement, player.element, []).push(player);\r\n            player.onDone(() => deleteOrUnsetInMap(this.playersByQueriedElement, player.element, player));\r\n        });\r\n        allConsumedElements.forEach(element => addClass(element, NG_ANIMATING_CLASSNAME));\r\n        const player = optimizeGroupPlayer(allNewPlayers);\r\n        player.onDestroy(() => {\r\n            allConsumedElements.forEach(element => removeClass(element, NG_ANIMATING_CLASSNAME));\r\n            setStyles(rootElement, instruction.toStyles);\r\n        });\r\n        // this basically makes all of the callbacks for sub element animations\r\n        // be dependent on the upper players for when they finish\r\n        allSubElements.forEach(element => {\r\n            getOrSetAsInMap(skippedPlayersMap, element, []).push(player);\r\n        });\r\n        return player;\r\n    }\r\n    _buildPlayer(instruction, keyframes, previousPlayers) {\r\n        if (keyframes.length > 0) {\r\n            return this.driver.animate(instruction.element, keyframes, instruction.duration, instruction.delay, instruction.easing, previousPlayers);\r\n        }\r\n        // special case for when an empty transition|definition is provided\r\n        // ... there is no point in rendering an empty animation\r\n        return new NoopAnimationPlayer(instruction.duration, instruction.delay);\r\n    }\r\n}\r\nclass TransitionAnimationPlayer {\r\n    constructor(namespaceId, triggerName, element) {\r\n        this.namespaceId = namespaceId;\r\n        this.triggerName = triggerName;\r\n        this.element = element;\r\n        this._player = new NoopAnimationPlayer();\r\n        this._containsRealPlayer = false;\r\n        this._queuedCallbacks = {};\r\n        this.destroyed = false;\r\n        this.markedForDestroy = false;\r\n        this.disabled = false;\r\n        this.queued = true;\r\n        this.totalTime = 0;\r\n    }\r\n    setRealPlayer(player) {\r\n        if (this._containsRealPlayer)\r\n            return;\r\n        this._player = player;\r\n        Object.keys(this._queuedCallbacks).forEach(phase => {\r\n            this._queuedCallbacks[phase].forEach(callback => listenOnPlayer(player, phase, undefined, callback));\r\n        });\r\n        this._queuedCallbacks = {};\r\n        this._containsRealPlayer = true;\r\n        this.overrideTotalTime(player.totalTime);\r\n        this.queued = false;\r\n    }\r\n    getRealPlayer() {\r\n        return this._player;\r\n    }\r\n    overrideTotalTime(totalTime) {\r\n        this.totalTime = totalTime;\r\n    }\r\n    syncPlayerEvents(player) {\r\n        const p = this._player;\r\n        if (p.triggerCallback) {\r\n            player.onStart(() => p.triggerCallback('start'));\r\n        }\r\n        player.onDone(() => this.finish());\r\n        player.onDestroy(() => this.destroy());\r\n    }\r\n    _queueEvent(name, callback) {\r\n        getOrSetAsInMap(this._queuedCallbacks, name, []).push(callback);\r\n    }\r\n    onDone(fn) {\r\n        if (this.queued) {\r\n            this._queueEvent('done', fn);\r\n        }\r\n        this._player.onDone(fn);\r\n    }\r\n    onStart(fn) {\r\n        if (this.queued) {\r\n            this._queueEvent('start', fn);\r\n        }\r\n        this._player.onStart(fn);\r\n    }\r\n    onDestroy(fn) {\r\n        if (this.queued) {\r\n            this._queueEvent('destroy', fn);\r\n        }\r\n        this._player.onDestroy(fn);\r\n    }\r\n    init() {\r\n        this._player.init();\r\n    }\r\n    hasStarted() {\r\n        return this.queued ? false : this._player.hasStarted();\r\n    }\r\n    play() {\r\n        !this.queued && this._player.play();\r\n    }\r\n    pause() {\r\n        !this.queued && this._player.pause();\r\n    }\r\n    restart() {\r\n        !this.queued && this._player.restart();\r\n    }\r\n    finish() {\r\n        this._player.finish();\r\n    }\r\n    destroy() {\r\n        this.destroyed = true;\r\n        this._player.destroy();\r\n    }\r\n    reset() {\r\n        !this.queued && this._player.reset();\r\n    }\r\n    setPosition(p) {\r\n        if (!this.queued) {\r\n            this._player.setPosition(p);\r\n        }\r\n    }\r\n    getPosition() {\r\n        return this.queued ? 0 : this._player.getPosition();\r\n    }\r\n    /** @internal */\r\n    triggerCallback(phaseName) {\r\n        const p = this._player;\r\n        if (p.triggerCallback) {\r\n            p.triggerCallback(phaseName);\r\n        }\r\n    }\r\n}\r\nfunction deleteOrUnsetInMap(map, key, value) {\r\n    let currentValues;\r\n    if (map instanceof Map) {\r\n        currentValues = map.get(key);\r\n        if (currentValues) {\r\n            if (currentValues.length) {\r\n                const index = currentValues.indexOf(value);\r\n                currentValues.splice(index, 1);\r\n            }\r\n            if (currentValues.length == 0) {\r\n                map.delete(key);\r\n            }\r\n        }\r\n    }\r\n    else {\r\n        currentValues = map[key];\r\n        if (currentValues) {\r\n            if (currentValues.length) {\r\n                const index = currentValues.indexOf(value);\r\n                currentValues.splice(index, 1);\r\n            }\r\n            if (currentValues.length == 0) {\r\n                delete map[key];\r\n            }\r\n        }\r\n    }\r\n    return currentValues;\r\n}\r\nfunction normalizeTriggerValue(value) {\r\n    // we use `!= null` here because it's the most simple\r\n    // way to test against a \"falsy\" value without mixing\r\n    // in empty strings or a zero value. DO NOT OPTIMIZE.\r\n    return value != null ? value : null;\r\n}\r\nfunction isElementNode(node) {\r\n    return node && node['nodeType'] === 1;\r\n}\r\nfunction isTriggerEventValid(eventName) {\r\n    return eventName == 'start' || eventName == 'done';\r\n}\r\nfunction cloakElement(element, value) {\r\n    const oldValue = element.style.display;\r\n    element.style.display = value != null ? value : 'none';\r\n    return oldValue;\r\n}\r\nfunction cloakAndComputeStyles(valuesMap, driver, elements, elementPropsMap, defaultStyle) {\r\n    const cloakVals = [];\r\n    elements.forEach(element => cloakVals.push(cloakElement(element)));\r\n    const failedElements = [];\r\n    elementPropsMap.forEach((props, element) => {\r\n        const styles = {};\r\n        props.forEach(prop => {\r\n            const value = styles[prop] = driver.computeStyle(element, prop, defaultStyle);\r\n            // there is no easy way to detect this because a sub element could be removed\r\n            // by a parent animation element being detached.\r\n            if (!value || value.length == 0) {\r\n                element[REMOVAL_FLAG] = NULL_REMOVED_QUERIED_STATE;\r\n                failedElements.push(element);\r\n            }\r\n        });\r\n        valuesMap.set(element, styles);\r\n    });\r\n    // we use a index variable here since Set.forEach(a, i) does not return\r\n    // an index value for the closure (but instead just the value)\r\n    let i = 0;\r\n    elements.forEach(element => cloakElement(element, cloakVals[i++]));\r\n    return failedElements;\r\n}\r\n/*\r\nSince the Angular renderer code will return a collection of inserted\r\nnodes in all areas of a DOM tree, it's up to this algorithm to figure\r\nout which nodes are roots for each animation @trigger.\r\n\r\nBy placing each inserted node into a Set and traversing upwards, it\r\nis possible to find the @trigger elements and well any direct *star\r\ninsertion nodes, if a @trigger root is found then the enter element\r\nis placed into the Map[@trigger] spot.\r\n */\r\nfunction buildRootMap(roots, nodes) {\r\n    const rootMap = new Map();\r\n    roots.forEach(root => rootMap.set(root, []));\r\n    if (nodes.length == 0)\r\n        return rootMap;\r\n    const NULL_NODE = 1;\r\n    const nodeSet = new Set(nodes);\r\n    const localRootMap = new Map();\r\n    function getRoot(node) {\r\n        if (!node)\r\n            return NULL_NODE;\r\n        let root = localRootMap.get(node);\r\n        if (root)\r\n            return root;\r\n        const parent = node.parentNode;\r\n        if (rootMap.has(parent)) { // ngIf inside @trigger\r\n            root = parent;\r\n        }\r\n        else if (nodeSet.has(parent)) { // ngIf inside ngIf\r\n            root = NULL_NODE;\r\n        }\r\n        else { // recurse upwards\r\n            root = getRoot(parent);\r\n        }\r\n        localRootMap.set(node, root);\r\n        return root;\r\n    }\r\n    nodes.forEach(node => {\r\n        const root = getRoot(node);\r\n        if (root !== NULL_NODE) {\r\n            rootMap.get(root).push(node);\r\n        }\r\n    });\r\n    return rootMap;\r\n}\r\nconst CLASSES_CACHE_KEY = '$$classes';\r\nfunction containsClass(element, className) {\r\n    if (element.classList) {\r\n        return element.classList.contains(className);\r\n    }\r\n    else {\r\n        const classes = element[CLASSES_CACHE_KEY];\r\n        return classes && classes[className];\r\n    }\r\n}\r\nfunction addClass(element, className) {\r\n    if (element.classList) {\r\n        element.classList.add(className);\r\n    }\r\n    else {\r\n        let classes = element[CLASSES_CACHE_KEY];\r\n        if (!classes) {\r\n            classes = element[CLASSES_CACHE_KEY] = {};\r\n        }\r\n        classes[className] = true;\r\n    }\r\n}\r\nfunction removeClass(element, className) {\r\n    if (element.classList) {\r\n        element.classList.remove(className);\r\n    }\r\n    else {\r\n        let classes = element[CLASSES_CACHE_KEY];\r\n        if (classes) {\r\n            delete classes[className];\r\n        }\r\n    }\r\n}\r\nfunction removeNodesAfterAnimationDone(engine, element, players) {\r\n    optimizeGroupPlayer(players).onDone(() => engine.processLeaveNode(element));\r\n}\r\nfunction flattenGroupPlayers(players) {\r\n    const finalPlayers = [];\r\n    _flattenGroupPlayersRecur(players, finalPlayers);\r\n    return finalPlayers;\r\n}\r\nfunction _flattenGroupPlayersRecur(players, finalPlayers) {\r\n    for (let i = 0; i < players.length; i++) {\r\n        const player = players[i];\r\n        if (player instanceof ɵAnimationGroupPlayer) {\r\n            _flattenGroupPlayersRecur(player.players, finalPlayers);\r\n        }\r\n        else {\r\n            finalPlayers.push(player);\r\n        }\r\n    }\r\n}\r\nfunction objEquals(a, b) {\r\n    const k1 = Object.keys(a);\r\n    const k2 = Object.keys(b);\r\n    if (k1.length != k2.length)\r\n        return false;\r\n    for (let i = 0; i < k1.length; i++) {\r\n        const prop = k1[i];\r\n        if (!b.hasOwnProperty(prop) || a[prop] !== b[prop])\r\n            return false;\r\n    }\r\n    return true;\r\n}\r\nfunction replacePostStylesAsPre(element, allPreStyleElements, allPostStyleElements) {\r\n    const postEntry = allPostStyleElements.get(element);\r\n    if (!postEntry)\r\n        return false;\r\n    let preEntry = allPreStyleElements.get(element);\r\n    if (preEntry) {\r\n        postEntry.forEach(data => preEntry.add(data));\r\n    }\r\n    else {\r\n        allPreStyleElements.set(element, postEntry);\r\n    }\r\n    allPostStyleElements.delete(element);\r\n    return true;\r\n}\r\n\r\nclass AnimationEngine {\r\n    constructor(bodyNode, _driver, normalizer) {\r\n        this.bodyNode = bodyNode;\r\n        this._driver = _driver;\r\n        this._triggerCache = {};\r\n        // this method is designed to be overridden by the code that uses this engine\r\n        this.onRemovalComplete = (element, context) => { };\r\n        this._transitionEngine = new TransitionAnimationEngine(bodyNode, _driver, normalizer);\r\n        this._timelineEngine = new TimelineAnimationEngine(bodyNode, _driver, normalizer);\r\n        this._transitionEngine.onRemovalComplete = (element, context) => this.onRemovalComplete(element, context);\r\n    }\r\n    registerTrigger(componentId, namespaceId, hostElement, name, metadata) {\r\n        const cacheKey = componentId + '-' + name;\r\n        let trigger = this._triggerCache[cacheKey];\r\n        if (!trigger) {\r\n            const errors = [];\r\n            const ast = buildAnimationAst(this._driver, metadata, errors);\r\n            if (errors.length) {\r\n                throw new Error(`The animation trigger \"${name}\" has failed to build due to the following errors:\\n - ${errors.join('\\n - ')}`);\r\n            }\r\n            trigger = buildTrigger(name, ast);\r\n            this._triggerCache[cacheKey] = trigger;\r\n        }\r\n        this._transitionEngine.registerTrigger(namespaceId, name, trigger);\r\n    }\r\n    register(namespaceId, hostElement) {\r\n        this._transitionEngine.register(namespaceId, hostElement);\r\n    }\r\n    destroy(namespaceId, context) {\r\n        this._transitionEngine.destroy(namespaceId, context);\r\n    }\r\n    onInsert(namespaceId, element, parent, insertBefore) {\r\n        this._transitionEngine.insertNode(namespaceId, element, parent, insertBefore);\r\n    }\r\n    onRemove(namespaceId, element, context, isHostElement) {\r\n        this._transitionEngine.removeNode(namespaceId, element, isHostElement || false, context);\r\n    }\r\n    disableAnimations(element, disable) {\r\n        this._transitionEngine.markElementAsDisabled(element, disable);\r\n    }\r\n    process(namespaceId, element, property, value) {\r\n        if (property.charAt(0) == '@') {\r\n            const [id, action] = parseTimelineCommand(property);\r\n            const args = value;\r\n            this._timelineEngine.command(id, element, action, args);\r\n        }\r\n        else {\r\n            this._transitionEngine.trigger(namespaceId, element, property, value);\r\n        }\r\n    }\r\n    listen(namespaceId, element, eventName, eventPhase, callback) {\r\n        // @@listen\r\n        if (eventName.charAt(0) == '@') {\r\n            const [id, action] = parseTimelineCommand(eventName);\r\n            return this._timelineEngine.listen(id, element, action, callback);\r\n        }\r\n        return this._transitionEngine.listen(namespaceId, element, eventName, eventPhase, callback);\r\n    }\r\n    flush(microtaskId = -1) {\r\n        this._transitionEngine.flush(microtaskId);\r\n    }\r\n    get players() {\r\n        return this._transitionEngine.players\r\n            .concat(this._timelineEngine.players);\r\n    }\r\n    whenRenderingDone() {\r\n        return this._transitionEngine.whenRenderingDone();\r\n    }\r\n}\r\n\r\n/**\r\n * @license\r\n * Copyright Google LLC All Rights Reserved.\r\n *\r\n * Use of this source code is governed by an MIT-style license that can be\r\n * found in the LICENSE file at https://angular.io/license\r\n */\r\n/**\r\n * Returns an instance of `SpecialCasedStyles` if and when any special (non animateable) styles are\r\n * detected.\r\n *\r\n * In CSS there exist properties that cannot be animated within a keyframe animation\r\n * (whether it be via CSS keyframes or web-animations) and the animation implementation\r\n * will ignore them. This function is designed to detect those special cased styles and\r\n * return a container that will be executed at the start and end of the animation.\r\n *\r\n * @returns an instance of `SpecialCasedStyles` if any special styles are detected otherwise `null`\r\n */\r\nfunction packageNonAnimatableStyles(element, styles) {\r\n    let startStyles = null;\r\n    let endStyles = null;\r\n    if (Array.isArray(styles) && styles.length) {\r\n        startStyles = filterNonAnimatableStyles(styles[0]);\r\n        if (styles.length > 1) {\r\n            endStyles = filterNonAnimatableStyles(styles[styles.length - 1]);\r\n        }\r\n    }\r\n    else if (styles) {\r\n        startStyles = filterNonAnimatableStyles(styles);\r\n    }\r\n    return (startStyles || endStyles) ? new SpecialCasedStyles(element, startStyles, endStyles) :\r\n        null;\r\n}\r\n/**\r\n * Designed to be executed during a keyframe-based animation to apply any special-cased styles.\r\n *\r\n * When started (when the `start()` method is run) then the provided `startStyles`\r\n * will be applied. When finished (when the `finish()` method is called) the\r\n * `endStyles` will be applied as well any any starting styles. Finally when\r\n * `destroy()` is called then all styles will be removed.\r\n */\r\nclass SpecialCasedStyles {\r\n    constructor(_element, _startStyles, _endStyles) {\r\n        this._element = _element;\r\n        this._startStyles = _startStyles;\r\n        this._endStyles = _endStyles;\r\n        this._state = 0 /* Pending */;\r\n        let initialStyles = SpecialCasedStyles.initialStylesByElement.get(_element);\r\n        if (!initialStyles) {\r\n            SpecialCasedStyles.initialStylesByElement.set(_element, initialStyles = {});\r\n        }\r\n        this._initialStyles = initialStyles;\r\n    }\r\n    start() {\r\n        if (this._state < 1 /* Started */) {\r\n            if (this._startStyles) {\r\n                setStyles(this._element, this._startStyles, this._initialStyles);\r\n            }\r\n            this._state = 1 /* Started */;\r\n        }\r\n    }\r\n    finish() {\r\n        this.start();\r\n        if (this._state < 2 /* Finished */) {\r\n            setStyles(this._element, this._initialStyles);\r\n            if (this._endStyles) {\r\n                setStyles(this._element, this._endStyles);\r\n                this._endStyles = null;\r\n            }\r\n            this._state = 1 /* Started */;\r\n        }\r\n    }\r\n    destroy() {\r\n        this.finish();\r\n        if (this._state < 3 /* Destroyed */) {\r\n            SpecialCasedStyles.initialStylesByElement.delete(this._element);\r\n            if (this._startStyles) {\r\n                eraseStyles(this._element, this._startStyles);\r\n                this._endStyles = null;\r\n            }\r\n            if (this._endStyles) {\r\n                eraseStyles(this._element, this._endStyles);\r\n                this._endStyles = null;\r\n            }\r\n            setStyles(this._element, this._initialStyles);\r\n            this._state = 3 /* Destroyed */;\r\n        }\r\n    }\r\n}\r\nSpecialCasedStyles.initialStylesByElement = new WeakMap();\r\nfunction filterNonAnimatableStyles(styles) {\r\n    let result = null;\r\n    const props = Object.keys(styles);\r\n    for (let i = 0; i < props.length; i++) {\r\n        const prop = props[i];\r\n        if (isNonAnimatableStyle(prop)) {\r\n            result = result || {};\r\n            result[prop] = styles[prop];\r\n        }\r\n    }\r\n    return result;\r\n}\r\nfunction isNonAnimatableStyle(prop) {\r\n    return prop === 'display' || prop === 'position';\r\n}\r\n\r\n/**\r\n * @license\r\n * Copyright Google LLC All Rights Reserved.\r\n *\r\n * Use of this source code is governed by an MIT-style license that can be\r\n * found in the LICENSE file at https://angular.io/license\r\n */\r\nconst ELAPSED_TIME_MAX_DECIMAL_PLACES = 3;\r\nconst ANIMATION_PROP = 'animation';\r\nconst ANIMATIONEND_EVENT = 'animationend';\r\nconst ONE_SECOND$1 = 1000;\r\nclass ElementAnimationStyleHandler {\r\n    constructor(_element, _name, _duration, _delay, _easing, _fillMode, _onDoneFn) {\r\n        this._element = _element;\r\n        this._name = _name;\r\n        this._duration = _duration;\r\n        this._delay = _delay;\r\n        this._easing = _easing;\r\n        this._fillMode = _fillMode;\r\n        this._onDoneFn = _onDoneFn;\r\n        this._finished = false;\r\n        this._destroyed = false;\r\n        this._startTime = 0;\r\n        this._position = 0;\r\n        this._eventFn = (e) => this._handleCallback(e);\r\n    }\r\n    apply() {\r\n        applyKeyframeAnimation(this._element, `${this._duration}ms ${this._easing} ${this._delay}ms 1 normal ${this._fillMode} ${this._name}`);\r\n        addRemoveAnimationEvent(this._element, this._eventFn, false);\r\n        this._startTime = Date.now();\r\n    }\r\n    pause() {\r\n        playPauseAnimation(this._element, this._name, 'paused');\r\n    }\r\n    resume() {\r\n        playPauseAnimation(this._element, this._name, 'running');\r\n    }\r\n    setPosition(position) {\r\n        const index = findIndexForAnimation(this._element, this._name);\r\n        this._position = position * this._duration;\r\n        setAnimationStyle(this._element, 'Delay', `-${this._position}ms`, index);\r\n    }\r\n    getPosition() {\r\n        return this._position;\r\n    }\r\n    _handleCallback(event) {\r\n        const timestamp = event._ngTestManualTimestamp || Date.now();\r\n        const elapsedTime = parseFloat(event.elapsedTime.toFixed(ELAPSED_TIME_MAX_DECIMAL_PLACES)) * ONE_SECOND$1;\r\n        if (event.animationName == this._name &&\r\n            Math.max(timestamp - this._startTime, 0) >= this._delay && elapsedTime >= this._duration) {\r\n            this.finish();\r\n        }\r\n    }\r\n    finish() {\r\n        if (this._finished)\r\n            return;\r\n        this._finished = true;\r\n        this._onDoneFn();\r\n        addRemoveAnimationEvent(this._element, this._eventFn, true);\r\n    }\r\n    destroy() {\r\n        if (this._destroyed)\r\n            return;\r\n        this._destroyed = true;\r\n        this.finish();\r\n        removeKeyframeAnimation(this._element, this._name);\r\n    }\r\n}\r\nfunction playPauseAnimation(element, name, status) {\r\n    const index = findIndexForAnimation(element, name);\r\n    setAnimationStyle(element, 'PlayState', status, index);\r\n}\r\nfunction applyKeyframeAnimation(element, value) {\r\n    const anim = getAnimationStyle(element, '').trim();\r\n    let index = 0;\r\n    if (anim.length) {\r\n        index = countChars(anim, ',') + 1;\r\n        value = `${anim}, ${value}`;\r\n    }\r\n    setAnimationStyle(element, '', value);\r\n    return index;\r\n}\r\nfunction removeKeyframeAnimation(element, name) {\r\n    const anim = getAnimationStyle(element, '');\r\n    const tokens = anim.split(',');\r\n    const index = findMatchingTokenIndex(tokens, name);\r\n    if (index >= 0) {\r\n        tokens.splice(index, 1);\r\n        const newValue = tokens.join(',');\r\n        setAnimationStyle(element, '', newValue);\r\n    }\r\n}\r\nfunction findIndexForAnimation(element, value) {\r\n    const anim = getAnimationStyle(element, '');\r\n    if (anim.indexOf(',') > 0) {\r\n        const tokens = anim.split(',');\r\n        return findMatchingTokenIndex(tokens, value);\r\n    }\r\n    return findMatchingTokenIndex([anim], value);\r\n}\r\nfunction findMatchingTokenIndex(tokens, searchToken) {\r\n    for (let i = 0; i < tokens.length; i++) {\r\n        if (tokens[i].indexOf(searchToken) >= 0) {\r\n            return i;\r\n        }\r\n    }\r\n    return -1;\r\n}\r\nfunction addRemoveAnimationEvent(element, fn, doRemove) {\r\n    doRemove ? element.removeEventListener(ANIMATIONEND_EVENT, fn) :\r\n        element.addEventListener(ANIMATIONEND_EVENT, fn);\r\n}\r\nfunction setAnimationStyle(element, name, value, index) {\r\n    const prop = ANIMATION_PROP + name;\r\n    if (index != null) {\r\n        const oldValue = element.style[prop];\r\n        if (oldValue.length) {\r\n            const tokens = oldValue.split(',');\r\n            tokens[index] = value;\r\n            value = tokens.join(',');\r\n        }\r\n    }\r\n    element.style[prop] = value;\r\n}\r\nfunction getAnimationStyle(element, name) {\r\n    return element.style[ANIMATION_PROP + name] || '';\r\n}\r\nfunction countChars(value, char) {\r\n    let count = 0;\r\n    for (let i = 0; i < value.length; i++) {\r\n        const c = value.charAt(i);\r\n        if (c === char)\r\n            count++;\r\n    }\r\n    return count;\r\n}\r\n\r\nconst DEFAULT_FILL_MODE = 'forwards';\r\nconst DEFAULT_EASING = 'linear';\r\nclass CssKeyframesPlayer {\r\n    constructor(element, keyframes, animationName, _duration, _delay, easing, _finalStyles, _specialStyles) {\r\n        this.element = element;\r\n        this.keyframes = keyframes;\r\n        this.animationName = animationName;\r\n        this._duration = _duration;\r\n        this._delay = _delay;\r\n        this._finalStyles = _finalStyles;\r\n        this._specialStyles = _specialStyles;\r\n        this._onDoneFns = [];\r\n        this._onStartFns = [];\r\n        this._onDestroyFns = [];\r\n        this.currentSnapshot = {};\r\n        this._state = 0;\r\n        this.easing = easing || DEFAULT_EASING;\r\n        this.totalTime = _duration + _delay;\r\n        this._buildStyler();\r\n    }\r\n    onStart(fn) {\r\n        this._onStartFns.push(fn);\r\n    }\r\n    onDone(fn) {\r\n        this._onDoneFns.push(fn);\r\n    }\r\n    onDestroy(fn) {\r\n        this._onDestroyFns.push(fn);\r\n    }\r\n    destroy() {\r\n        this.init();\r\n        if (this._state >= 4 /* DESTROYED */)\r\n            return;\r\n        this._state = 4 /* DESTROYED */;\r\n        this._styler.destroy();\r\n        this._flushStartFns();\r\n        this._flushDoneFns();\r\n        if (this._specialStyles) {\r\n            this._specialStyles.destroy();\r\n        }\r\n        this._onDestroyFns.forEach(fn => fn());\r\n        this._onDestroyFns = [];\r\n    }\r\n    _flushDoneFns() {\r\n        this._onDoneFns.forEach(fn => fn());\r\n        this._onDoneFns = [];\r\n    }\r\n    _flushStartFns() {\r\n        this._onStartFns.forEach(fn => fn());\r\n        this._onStartFns = [];\r\n    }\r\n    finish() {\r\n        this.init();\r\n        if (this._state >= 3 /* FINISHED */)\r\n            return;\r\n        this._state = 3 /* FINISHED */;\r\n        this._styler.finish();\r\n        this._flushStartFns();\r\n        if (this._specialStyles) {\r\n            this._specialStyles.finish();\r\n        }\r\n        this._flushDoneFns();\r\n    }\r\n    setPosition(value) {\r\n        this._styler.setPosition(value);\r\n    }\r\n    getPosition() {\r\n        return this._styler.getPosition();\r\n    }\r\n    hasStarted() {\r\n        return this._state >= 2 /* STARTED */;\r\n    }\r\n    init() {\r\n        if (this._state >= 1 /* INITIALIZED */)\r\n            return;\r\n        this._state = 1 /* INITIALIZED */;\r\n        const elm = this.element;\r\n        this._styler.apply();\r\n        if (this._delay) {\r\n            this._styler.pause();\r\n        }\r\n    }\r\n    play() {\r\n        this.init();\r\n        if (!this.hasStarted()) {\r\n            this._flushStartFns();\r\n            this._state = 2 /* STARTED */;\r\n            if (this._specialStyles) {\r\n                this._specialStyles.start();\r\n            }\r\n        }\r\n        this._styler.resume();\r\n    }\r\n    pause() {\r\n        this.init();\r\n        this._styler.pause();\r\n    }\r\n    restart() {\r\n        this.reset();\r\n        this.play();\r\n    }\r\n    reset() {\r\n        this._state = 0 /* RESET */;\r\n        this._styler.destroy();\r\n        this._buildStyler();\r\n        this._styler.apply();\r\n    }\r\n    _buildStyler() {\r\n        this._styler = new ElementAnimationStyleHandler(this.element, this.animationName, this._duration, this._delay, this.easing, DEFAULT_FILL_MODE, () => this.finish());\r\n    }\r\n    /** @internal */\r\n    triggerCallback(phaseName) {\r\n        const methods = phaseName == 'start' ? this._onStartFns : this._onDoneFns;\r\n        methods.forEach(fn => fn());\r\n        methods.length = 0;\r\n    }\r\n    beforeDestroy() {\r\n        this.init();\r\n        const styles = {};\r\n        if (this.hasStarted()) {\r\n            const finished = this._state >= 3 /* FINISHED */;\r\n            Object.keys(this._finalStyles).forEach(prop => {\r\n                if (prop != 'offset') {\r\n                    styles[prop] = finished ? this._finalStyles[prop] : computeStyle(this.element, prop);\r\n                }\r\n            });\r\n        }\r\n        this.currentSnapshot = styles;\r\n    }\r\n}\r\n\r\n/**\r\n * @license\r\n * Copyright Google LLC All Rights Reserved.\r\n *\r\n * Use of this source code is governed by an MIT-style license that can be\r\n * found in the LICENSE file at https://angular.io/license\r\n */\r\nclass DirectStylePlayer extends NoopAnimationPlayer {\r\n    constructor(element, styles) {\r\n        super();\r\n        this.element = element;\r\n        this._startingStyles = {};\r\n        this.__initialized = false;\r\n        this._styles = hypenatePropsObject(styles);\r\n    }\r\n    init() {\r\n        if (this.__initialized || !this._startingStyles)\r\n            return;\r\n        this.__initialized = true;\r\n        Object.keys(this._styles).forEach(prop => {\r\n            this._startingStyles[prop] = this.element.style[prop];\r\n        });\r\n        super.init();\r\n    }\r\n    play() {\r\n        if (!this._startingStyles)\r\n            return;\r\n        this.init();\r\n        Object.keys(this._styles)\r\n            .forEach(prop => this.element.style.setProperty(prop, this._styles[prop]));\r\n        super.play();\r\n    }\r\n    destroy() {\r\n        if (!this._startingStyles)\r\n            return;\r\n        Object.keys(this._startingStyles).forEach(prop => {\r\n            const value = this._startingStyles[prop];\r\n            if (value) {\r\n                this.element.style.setProperty(prop, value);\r\n            }\r\n            else {\r\n                this.element.style.removeProperty(prop);\r\n            }\r\n        });\r\n        this._startingStyles = null;\r\n        super.destroy();\r\n    }\r\n}\r\n\r\nconst KEYFRAMES_NAME_PREFIX = 'gen_css_kf_';\r\nconst TAB_SPACE = ' ';\r\nclass CssKeyframesDriver {\r\n    constructor() {\r\n        this._count = 0;\r\n    }\r\n    validateStyleProperty(prop) {\r\n        return validateStyleProperty(prop);\r\n    }\r\n    matchesElement(element, selector) {\r\n        return matchesElement(element, selector);\r\n    }\r\n    containsElement(elm1, elm2) {\r\n        return containsElement(elm1, elm2);\r\n    }\r\n    query(element, selector, multi) {\r\n        return invokeQuery(element, selector, multi);\r\n    }\r\n    computeStyle(element, prop, defaultValue) {\r\n        return window.getComputedStyle(element)[prop];\r\n    }\r\n    buildKeyframeElement(element, name, keyframes) {\r\n        keyframes = keyframes.map(kf => hypenatePropsObject(kf));\r\n        let keyframeStr = `@keyframes ${name} {\\n`;\r\n        let tab = '';\r\n        keyframes.forEach(kf => {\r\n            tab = TAB_SPACE;\r\n            const offset = parseFloat(kf['offset']);\r\n            keyframeStr += `${tab}${offset * 100}% {\\n`;\r\n            tab += TAB_SPACE;\r\n            Object.keys(kf).forEach(prop => {\r\n                const value = kf[prop];\r\n                switch (prop) {\r\n                    case 'offset':\r\n                        return;\r\n                    case 'easing':\r\n                        if (value) {\r\n                            keyframeStr += `${tab}animation-timing-function: ${value};\\n`;\r\n                        }\r\n                        return;\r\n                    default:\r\n                        keyframeStr += `${tab}${prop}: ${value};\\n`;\r\n                        return;\r\n                }\r\n            });\r\n            keyframeStr += `${tab}}\\n`;\r\n        });\r\n        keyframeStr += `}\\n`;\r\n        const kfElm = document.createElement('style');\r\n        kfElm.textContent = keyframeStr;\r\n        return kfElm;\r\n    }\r\n    animate(element, keyframes, duration, delay, easing, previousPlayers = [], scrubberAccessRequested) {\r\n        if ((typeof ngDevMode === 'undefined' || ngDevMode) && scrubberAccessRequested) {\r\n            notifyFaultyScrubber();\r\n        }\r\n        const previousCssKeyframePlayers = previousPlayers.filter(player => player instanceof CssKeyframesPlayer);\r\n        const previousStyles = {};\r\n        if (allowPreviousPlayerStylesMerge(duration, delay)) {\r\n            previousCssKeyframePlayers.forEach(player => {\r\n                let styles = player.currentSnapshot;\r\n                Object.keys(styles).forEach(prop => previousStyles[prop] = styles[prop]);\r\n            });\r\n        }\r\n        keyframes = balancePreviousStylesIntoKeyframes(element, keyframes, previousStyles);\r\n        const finalStyles = flattenKeyframesIntoStyles(keyframes);\r\n        // if there is no animation then there is no point in applying\r\n        // styles and waiting for an event to get fired. This causes lag.\r\n        // It's better to just directly apply the styles to the element\r\n        // via the direct styling animation player.\r\n        if (duration == 0) {\r\n            return new DirectStylePlayer(element, finalStyles);\r\n        }\r\n        const animationName = `${KEYFRAMES_NAME_PREFIX}${this._count++}`;\r\n        const kfElm = this.buildKeyframeElement(element, animationName, keyframes);\r\n        const nodeToAppendKfElm = findNodeToAppendKeyframeElement(element);\r\n        nodeToAppendKfElm.appendChild(kfElm);\r\n        const specialStyles = packageNonAnimatableStyles(element, keyframes);\r\n        const player = new CssKeyframesPlayer(element, keyframes, animationName, duration, delay, easing, finalStyles, specialStyles);\r\n        player.onDestroy(() => removeElement(kfElm));\r\n        return player;\r\n    }\r\n}\r\nfunction findNodeToAppendKeyframeElement(element) {\r\n    var _a;\r\n    const rootNode = (_a = element.getRootNode) === null || _a === void 0 ? void 0 : _a.call(element);\r\n    if (typeof ShadowRoot !== 'undefined' && rootNode instanceof ShadowRoot) {\r\n        return rootNode;\r\n    }\r\n    return document.head;\r\n}\r\nfunction flattenKeyframesIntoStyles(keyframes) {\r\n    let flatKeyframes = {};\r\n    if (keyframes) {\r\n        const kfs = Array.isArray(keyframes) ? keyframes : [keyframes];\r\n        kfs.forEach(kf => {\r\n            Object.keys(kf).forEach(prop => {\r\n                if (prop == 'offset' || prop == 'easing')\r\n                    return;\r\n                flatKeyframes[prop] = kf[prop];\r\n            });\r\n        });\r\n    }\r\n    return flatKeyframes;\r\n}\r\nfunction removeElement(node) {\r\n    node.parentNode.removeChild(node);\r\n}\r\nlet warningIssued = false;\r\nfunction notifyFaultyScrubber() {\r\n    if (warningIssued)\r\n        return;\r\n    console.warn('@angular/animations: please load the web-animations.js polyfill to allow programmatic access...\\n', '  visit https://bit.ly/IWukam to learn more about using the web-animation-js polyfill.');\r\n    warningIssued = true;\r\n}\r\n\r\nclass WebAnimationsPlayer {\r\n    constructor(element, keyframes, options, _specialStyles) {\r\n        this.element = element;\r\n        this.keyframes = keyframes;\r\n        this.options = options;\r\n        this._specialStyles = _specialStyles;\r\n        this._onDoneFns = [];\r\n        this._onStartFns = [];\r\n        this._onDestroyFns = [];\r\n        this._initialized = false;\r\n        this._finished = false;\r\n        this._started = false;\r\n        this._destroyed = false;\r\n        this.time = 0;\r\n        this.parentPlayer = null;\r\n        this.currentSnapshot = {};\r\n        this._duration = options['duration'];\r\n        this._delay = options['delay'] || 0;\r\n        this.time = this._duration + this._delay;\r\n    }\r\n    _onFinish() {\r\n        if (!this._finished) {\r\n            this._finished = true;\r\n            this._onDoneFns.forEach(fn => fn());\r\n            this._onDoneFns = [];\r\n        }\r\n    }\r\n    init() {\r\n        this._buildPlayer();\r\n        this._preparePlayerBeforeStart();\r\n    }\r\n    _buildPlayer() {\r\n        if (this._initialized)\r\n            return;\r\n        this._initialized = true;\r\n        const keyframes = this.keyframes;\r\n        this.domPlayer =\r\n            this._triggerWebAnimation(this.element, keyframes, this.options);\r\n        this._finalKeyframe = keyframes.length ? keyframes[keyframes.length - 1] : {};\r\n        this.domPlayer.addEventListener('finish', () => this._onFinish());\r\n    }\r\n    _preparePlayerBeforeStart() {\r\n        // this is required so that the player doesn't start to animate right away\r\n        if (this._delay) {\r\n            this._resetDomPlayerState();\r\n        }\r\n        else {\r\n            this.domPlayer.pause();\r\n        }\r\n    }\r\n    /** @internal */\r\n    _triggerWebAnimation(element, keyframes, options) {\r\n        // jscompiler doesn't seem to know animate is a native property because it's not fully\r\n        // supported yet across common browsers (we polyfill it for Edge/Safari) [CL #143630929]\r\n        return element['animate'](keyframes, options);\r\n    }\r\n    onStart(fn) {\r\n        this._onStartFns.push(fn);\r\n    }\r\n    onDone(fn) {\r\n        this._onDoneFns.push(fn);\r\n    }\r\n    onDestroy(fn) {\r\n        this._onDestroyFns.push(fn);\r\n    }\r\n    play() {\r\n        this._buildPlayer();\r\n        if (!this.hasStarted()) {\r\n            this._onStartFns.forEach(fn => fn());\r\n            this._onStartFns = [];\r\n            this._started = true;\r\n            if (this._specialStyles) {\r\n                this._specialStyles.start();\r\n            }\r\n        }\r\n        this.domPlayer.play();\r\n    }\r\n    pause() {\r\n        this.init();\r\n        this.domPlayer.pause();\r\n    }\r\n    finish() {\r\n        this.init();\r\n        if (this._specialStyles) {\r\n            this._specialStyles.finish();\r\n        }\r\n        this._onFinish();\r\n        this.domPlayer.finish();\r\n    }\r\n    reset() {\r\n        this._resetDomPlayerState();\r\n        this._destroyed = false;\r\n        this._finished = false;\r\n        this._started = false;\r\n    }\r\n    _resetDomPlayerState() {\r\n        if (this.domPlayer) {\r\n            this.domPlayer.cancel();\r\n        }\r\n    }\r\n    restart() {\r\n        this.reset();\r\n        this.play();\r\n    }\r\n    hasStarted() {\r\n        return this._started;\r\n    }\r\n    destroy() {\r\n        if (!this._destroyed) {\r\n            this._destroyed = true;\r\n            this._resetDomPlayerState();\r\n            this._onFinish();\r\n            if (this._specialStyles) {\r\n                this._specialStyles.destroy();\r\n            }\r\n            this._onDestroyFns.forEach(fn => fn());\r\n            this._onDestroyFns = [];\r\n        }\r\n    }\r\n    setPosition(p) {\r\n        if (this.domPlayer === undefined) {\r\n            this.init();\r\n        }\r\n        this.domPlayer.currentTime = p * this.time;\r\n    }\r\n    getPosition() {\r\n        return this.domPlayer.currentTime / this.time;\r\n    }\r\n    get totalTime() {\r\n        return this._delay + this._duration;\r\n    }\r\n    beforeDestroy() {\r\n        const styles = {};\r\n        if (this.hasStarted()) {\r\n            Object.keys(this._finalKeyframe).forEach(prop => {\r\n                if (prop != 'offset') {\r\n                    styles[prop] =\r\n                        this._finished ? this._finalKeyframe[prop] : computeStyle(this.element, prop);\r\n                }\r\n            });\r\n        }\r\n        this.currentSnapshot = styles;\r\n    }\r\n    /** @internal */\r\n    triggerCallback(phaseName) {\r\n        const methods = phaseName == 'start' ? this._onStartFns : this._onDoneFns;\r\n        methods.forEach(fn => fn());\r\n        methods.length = 0;\r\n    }\r\n}\r\n\r\nclass WebAnimationsDriver {\r\n    constructor() {\r\n        this._isNativeImpl = /\\{\\s*\\[native\\s+code\\]\\s*\\}/.test(getElementAnimateFn().toString());\r\n        this._cssKeyframesDriver = new CssKeyframesDriver();\r\n    }\r\n    validateStyleProperty(prop) {\r\n        return validateStyleProperty(prop);\r\n    }\r\n    matchesElement(element, selector) {\r\n        return matchesElement(element, selector);\r\n    }\r\n    containsElement(elm1, elm2) {\r\n        return containsElement(elm1, elm2);\r\n    }\r\n    query(element, selector, multi) {\r\n        return invokeQuery(element, selector, multi);\r\n    }\r\n    computeStyle(element, prop, defaultValue) {\r\n        return window.getComputedStyle(element)[prop];\r\n    }\r\n    overrideWebAnimationsSupport(supported) {\r\n        this._isNativeImpl = supported;\r\n    }\r\n    animate(element, keyframes, duration, delay, easing, previousPlayers = [], scrubberAccessRequested) {\r\n        const useKeyframes = !scrubberAccessRequested && !this._isNativeImpl;\r\n        if (useKeyframes) {\r\n            return this._cssKeyframesDriver.animate(element, keyframes, duration, delay, easing, previousPlayers);\r\n        }\r\n        const fill = delay == 0 ? 'both' : 'forwards';\r\n        const playerOptions = { duration, delay, fill };\r\n        // we check for this to avoid having a null|undefined value be present\r\n        // for the easing (which results in an error for certain browsers #9752)\r\n        if (easing) {\r\n            playerOptions['easing'] = easing;\r\n        }\r\n        const previousStyles = {};\r\n        const previousWebAnimationPlayers = previousPlayers.filter(player => player instanceof WebAnimationsPlayer);\r\n        if (allowPreviousPlayerStylesMerge(duration, delay)) {\r\n            previousWebAnimationPlayers.forEach(player => {\r\n                let styles = player.currentSnapshot;\r\n                Object.keys(styles).forEach(prop => previousStyles[prop] = styles[prop]);\r\n            });\r\n        }\r\n        keyframes = keyframes.map(styles => copyStyles(styles, false));\r\n        keyframes = balancePreviousStylesIntoKeyframes(element, keyframes, previousStyles);\r\n        const specialStyles = packageNonAnimatableStyles(element, keyframes);\r\n        return new WebAnimationsPlayer(element, keyframes, playerOptions, specialStyles);\r\n    }\r\n}\r\nfunction supportsWebAnimations() {\r\n    return typeof getElementAnimateFn() === 'function';\r\n}\r\nfunction getElementAnimateFn() {\r\n    return (isBrowser() && Element.prototype['animate']) || {};\r\n}\r\n\r\n/**\r\n * @license\r\n * Copyright Google LLC All Rights Reserved.\r\n *\r\n * Use of this source code is governed by an MIT-style license that can be\r\n * found in the LICENSE file at https://angular.io/license\r\n */\r\n\r\n/**\r\n * @license\r\n * Copyright Google LLC All Rights Reserved.\r\n *\r\n * Use of this source code is governed by an MIT-style license that can be\r\n * found in the LICENSE file at https://angular.io/license\r\n */\r\n\r\n/**\r\n * @license\r\n * Copyright Google LLC All Rights Reserved.\r\n *\r\n * Use of this source code is governed by an MIT-style license that can be\r\n * found in the LICENSE file at https://angular.io/license\r\n */\r\n\r\n/**\r\n * @license\r\n * Copyright Google LLC All Rights Reserved.\r\n *\r\n * Use of this source code is governed by an MIT-style license that can be\r\n * found in the LICENSE file at https://angular.io/license\r\n */\r\n\r\n/**\r\n * Generated bundle index. Do not edit.\r\n */\r\n\r\nexport { AnimationDriver, Animation as ɵAnimation, AnimationEngine as ɵAnimationEngine, AnimationStyleNormalizer as ɵAnimationStyleNormalizer, CssKeyframesDriver as ɵCssKeyframesDriver, CssKeyframesPlayer as ɵCssKeyframesPlayer, NoopAnimationDriver as ɵNoopAnimationDriver, NoopAnimationStyleNormalizer as ɵNoopAnimationStyleNormalizer, WebAnimationsDriver as ɵWebAnimationsDriver, WebAnimationsPlayer as ɵWebAnimationsPlayer, WebAnimationsStyleNormalizer as ɵWebAnimationsStyleNormalizer, allowPreviousPlayerStylesMerge as ɵallowPreviousPlayerStylesMerge, SpecialCasedStyles as ɵangular_packages_animations_browser_browser_a, containsElement as ɵcontainsElement, invokeQuery as ɵinvokeQuery, matchesElement as ɵmatchesElement, supportsWebAnimations as ɵsupportsWebAnimations, validateStyleProperty as ɵvalidateStyleProperty };\r\n\r\n","/**\r\n * @license Angular v12.1.0\r\n * (c) 2010-2021 Google LLC. https://angular.io/\r\n * License: MIT\r\n */\r\n\r\nimport { ViewEncapsulation, Injectable, RendererFactory2, Inject, NgZone, InjectionToken, NgModule } from '@angular/core';\r\nimport { ɵDomRendererFactory2, BrowserModule } from '@angular/platform-browser';\r\nimport { AnimationBuilder, sequence, AnimationFactory } from '@angular/animations';\r\nimport { ɵAnimationEngine, AnimationDriver, ɵAnimationStyleNormalizer, ɵsupportsWebAnimations, ɵWebAnimationsDriver, ɵCssKeyframesDriver, ɵWebAnimationsStyleNormalizer, ɵNoopAnimationDriver } from '@angular/animations/browser';\r\nimport { DOCUMENT } from '@angular/common';\r\n\r\n/**\r\n * @license\r\n * Copyright Google LLC All Rights Reserved.\r\n *\r\n * Use of this source code is governed by an MIT-style license that can be\r\n * found in the LICENSE file at https://angular.io/license\r\n */\r\nimport * as ɵngcc0 from '@angular/core';\r\nimport * as ɵngcc1 from '@angular/animations/browser';\r\nclass BrowserAnimationBuilder extends AnimationBuilder {\r\n    constructor(rootRenderer, doc) {\r\n        super();\r\n        this._nextAnimationId = 0;\r\n        const typeData = { id: '0', encapsulation: ViewEncapsulation.None, styles: [], data: { animation: [] } };\r\n        this._renderer = rootRenderer.createRenderer(doc.body, typeData);\r\n    }\r\n    build(animation) {\r\n        const id = this._nextAnimationId.toString();\r\n        this._nextAnimationId++;\r\n        const entry = Array.isArray(animation) ? sequence(animation) : animation;\r\n        issueAnimationCommand(this._renderer, null, id, 'register', [entry]);\r\n        return new BrowserAnimationFactory(id, this._renderer);\r\n    }\r\n}\r\nBrowserAnimationBuilder.ɵfac = function BrowserAnimationBuilder_Factory(t) { return new (t || BrowserAnimationBuilder)(ɵngcc0.ɵɵinject(ɵngcc0.RendererFactory2), ɵngcc0.ɵɵinject(DOCUMENT)); };\r\nBrowserAnimationBuilder.ɵprov = /*@__PURE__*/ ɵngcc0.ɵɵdefineInjectable({ token: BrowserAnimationBuilder, factory: BrowserAnimationBuilder.ɵfac });\r\nBrowserAnimationBuilder.ctorParameters = () => [\r\n    { type: RendererFactory2 },\r\n    { type: undefined, decorators: [{ type: Inject, args: [DOCUMENT,] }] }\r\n];\r\n(function () { (typeof ngDevMode === \"undefined\" || ngDevMode) && ɵngcc0.ɵsetClassMetadata(BrowserAnimationBuilder, [{\r\n        type: Injectable\r\n    }], function () { return [{ type: ɵngcc0.RendererFactory2 }, { type: undefined, decorators: [{\r\n                type: Inject,\r\n                args: [DOCUMENT]\r\n            }] }]; }, null); })();\r\nclass BrowserAnimationFactory extends AnimationFactory {\r\n    constructor(_id, _renderer) {\r\n        super();\r\n        this._id = _id;\r\n        this._renderer = _renderer;\r\n    }\r\n    create(element, options) {\r\n        return new RendererAnimationPlayer(this._id, element, options || {}, this._renderer);\r\n    }\r\n}\r\nclass RendererAnimationPlayer {\r\n    constructor(id, element, options, _renderer) {\r\n        this.id = id;\r\n        this.element = element;\r\n        this._renderer = _renderer;\r\n        this.parentPlayer = null;\r\n        this._started = false;\r\n        this.totalTime = 0;\r\n        this._command('create', options);\r\n    }\r\n    _listen(eventName, callback) {\r\n        return this._renderer.listen(this.element, `@@${this.id}:${eventName}`, callback);\r\n    }\r\n    _command(command, ...args) {\r\n        return issueAnimationCommand(this._renderer, this.element, this.id, command, args);\r\n    }\r\n    onDone(fn) {\r\n        this._listen('done', fn);\r\n    }\r\n    onStart(fn) {\r\n        this._listen('start', fn);\r\n    }\r\n    onDestroy(fn) {\r\n        this._listen('destroy', fn);\r\n    }\r\n    init() {\r\n        this._command('init');\r\n    }\r\n    hasStarted() {\r\n        return this._started;\r\n    }\r\n    play() {\r\n        this._command('play');\r\n        this._started = true;\r\n    }\r\n    pause() {\r\n        this._command('pause');\r\n    }\r\n    restart() {\r\n        this._command('restart');\r\n    }\r\n    finish() {\r\n        this._command('finish');\r\n    }\r\n    destroy() {\r\n        this._command('destroy');\r\n    }\r\n    reset() {\r\n        this._command('reset');\r\n        this._started = false;\r\n    }\r\n    setPosition(p) {\r\n        this._command('setPosition', p);\r\n    }\r\n    getPosition() {\r\n        var _a, _b;\r\n        return (_b = (_a = this._renderer.engine.players[+this.id]) === null || _a === void 0 ? void 0 : _a.getPosition()) !== null && _b !== void 0 ? _b : 0;\r\n    }\r\n}\r\nfunction issueAnimationCommand(renderer, element, id, command, args) {\r\n    return renderer.setProperty(element, `@@${id}:${command}`, args);\r\n}\r\n\r\nconst ANIMATION_PREFIX = '@';\r\nconst DISABLE_ANIMATIONS_FLAG = '@.disabled';\r\nclass AnimationRendererFactory {\r\n    constructor(delegate, engine, _zone) {\r\n        this.delegate = delegate;\r\n        this.engine = engine;\r\n        this._zone = _zone;\r\n        this._currentId = 0;\r\n        this._microtaskId = 1;\r\n        this._animationCallbacksBuffer = [];\r\n        this._rendererCache = new Map();\r\n        this._cdRecurDepth = 0;\r\n        this.promise = Promise.resolve(0);\r\n        engine.onRemovalComplete = (element, delegate) => {\r\n            // Note: if an component element has a leave animation, and the component\r\n            // a host leave animation, the view engine will call `removeChild` for the parent\r\n            // component renderer as well as for the child component renderer.\r\n            // Therefore, we need to check if we already removed the element.\r\n            if (delegate && delegate.parentNode(element)) {\r\n                delegate.removeChild(element.parentNode, element);\r\n            }\r\n        };\r\n    }\r\n    createRenderer(hostElement, type) {\r\n        const EMPTY_NAMESPACE_ID = '';\r\n        // cache the delegates to find out which cached delegate can\r\n        // be used by which cached renderer\r\n        const delegate = this.delegate.createRenderer(hostElement, type);\r\n        if (!hostElement || !type || !type.data || !type.data['animation']) {\r\n            let renderer = this._rendererCache.get(delegate);\r\n            if (!renderer) {\r\n                renderer = new BaseAnimationRenderer(EMPTY_NAMESPACE_ID, delegate, this.engine);\r\n                // only cache this result when the base renderer is used\r\n                this._rendererCache.set(delegate, renderer);\r\n            }\r\n            return renderer;\r\n        }\r\n        const componentId = type.id;\r\n        const namespaceId = type.id + '-' + this._currentId;\r\n        this._currentId++;\r\n        this.engine.register(namespaceId, hostElement);\r\n        const registerTrigger = (trigger) => {\r\n            if (Array.isArray(trigger)) {\r\n                trigger.forEach(registerTrigger);\r\n            }\r\n            else {\r\n                this.engine.registerTrigger(componentId, namespaceId, hostElement, trigger.name, trigger);\r\n            }\r\n        };\r\n        const animationTriggers = type.data['animation'];\r\n        animationTriggers.forEach(registerTrigger);\r\n        return new AnimationRenderer(this, namespaceId, delegate, this.engine);\r\n    }\r\n    begin() {\r\n        this._cdRecurDepth++;\r\n        if (this.delegate.begin) {\r\n            this.delegate.begin();\r\n        }\r\n    }\r\n    _scheduleCountTask() {\r\n        // always use promise to schedule microtask instead of use Zone\r\n        this.promise.then(() => {\r\n            this._microtaskId++;\r\n        });\r\n    }\r\n    /** @internal */\r\n    scheduleListenerCallback(count, fn, data) {\r\n        if (count >= 0 && count < this._microtaskId) {\r\n            this._zone.run(() => fn(data));\r\n            return;\r\n        }\r\n        if (this._animationCallbacksBuffer.length == 0) {\r\n            Promise.resolve(null).then(() => {\r\n                this._zone.run(() => {\r\n                    this._animationCallbacksBuffer.forEach(tuple => {\r\n                        const [fn, data] = tuple;\r\n                        fn(data);\r\n                    });\r\n                    this._animationCallbacksBuffer = [];\r\n                });\r\n            });\r\n        }\r\n        this._animationCallbacksBuffer.push([fn, data]);\r\n    }\r\n    end() {\r\n        this._cdRecurDepth--;\r\n        // this is to prevent animations from running twice when an inner\r\n        // component does CD when a parent component instead has inserted it\r\n        if (this._cdRecurDepth == 0) {\r\n            this._zone.runOutsideAngular(() => {\r\n                this._scheduleCountTask();\r\n                this.engine.flush(this._microtaskId);\r\n            });\r\n        }\r\n        if (this.delegate.end) {\r\n            this.delegate.end();\r\n        }\r\n    }\r\n    whenRenderingDone() {\r\n        return this.engine.whenRenderingDone();\r\n    }\r\n}\r\nAnimationRendererFactory.ɵfac = function AnimationRendererFactory_Factory(t) { return new (t || AnimationRendererFactory)(ɵngcc0.ɵɵinject(ɵngcc0.RendererFactory2), ɵngcc0.ɵɵinject(ɵngcc1.ɵAnimationEngine), ɵngcc0.ɵɵinject(ɵngcc0.NgZone)); };\r\nAnimationRendererFactory.ɵprov = /*@__PURE__*/ ɵngcc0.ɵɵdefineInjectable({ token: AnimationRendererFactory, factory: AnimationRendererFactory.ɵfac });\r\nAnimationRendererFactory.ctorParameters = () => [\r\n    { type: RendererFactory2 },\r\n    { type: ɵAnimationEngine },\r\n    { type: NgZone }\r\n];\r\n(function () { (typeof ngDevMode === \"undefined\" || ngDevMode) && ɵngcc0.ɵsetClassMetadata(AnimationRendererFactory, [{\r\n        type: Injectable\r\n    }], function () { return [{ type: ɵngcc0.RendererFactory2 }, { type: ɵngcc1.ɵAnimationEngine }, { type: ɵngcc0.NgZone }]; }, null); })();\r\nclass BaseAnimationRenderer {\r\n    constructor(namespaceId, delegate, engine) {\r\n        this.namespaceId = namespaceId;\r\n        this.delegate = delegate;\r\n        this.engine = engine;\r\n        this.destroyNode = this.delegate.destroyNode ? (n) => delegate.destroyNode(n) : null;\r\n    }\r\n    get data() {\r\n        return this.delegate.data;\r\n    }\r\n    destroy() {\r\n        this.engine.destroy(this.namespaceId, this.delegate);\r\n        this.delegate.destroy();\r\n    }\r\n    createElement(name, namespace) {\r\n        return this.delegate.createElement(name, namespace);\r\n    }\r\n    createComment(value) {\r\n        return this.delegate.createComment(value);\r\n    }\r\n    createText(value) {\r\n        return this.delegate.createText(value);\r\n    }\r\n    appendChild(parent, newChild) {\r\n        this.delegate.appendChild(parent, newChild);\r\n        this.engine.onInsert(this.namespaceId, newChild, parent, false);\r\n    }\r\n    insertBefore(parent, newChild, refChild, isMove = true) {\r\n        this.delegate.insertBefore(parent, newChild, refChild);\r\n        // If `isMove` true than we should animate this insert.\r\n        this.engine.onInsert(this.namespaceId, newChild, parent, isMove);\r\n    }\r\n    removeChild(parent, oldChild, isHostElement) {\r\n        this.engine.onRemove(this.namespaceId, oldChild, this.delegate, isHostElement);\r\n    }\r\n    selectRootElement(selectorOrNode, preserveContent) {\r\n        return this.delegate.selectRootElement(selectorOrNode, preserveContent);\r\n    }\r\n    parentNode(node) {\r\n        return this.delegate.parentNode(node);\r\n    }\r\n    nextSibling(node) {\r\n        return this.delegate.nextSibling(node);\r\n    }\r\n    setAttribute(el, name, value, namespace) {\r\n        this.delegate.setAttribute(el, name, value, namespace);\r\n    }\r\n    removeAttribute(el, name, namespace) {\r\n        this.delegate.removeAttribute(el, name, namespace);\r\n    }\r\n    addClass(el, name) {\r\n        this.delegate.addClass(el, name);\r\n    }\r\n    removeClass(el, name) {\r\n        this.delegate.removeClass(el, name);\r\n    }\r\n    setStyle(el, style, value, flags) {\r\n        this.delegate.setStyle(el, style, value, flags);\r\n    }\r\n    removeStyle(el, style, flags) {\r\n        this.delegate.removeStyle(el, style, flags);\r\n    }\r\n    setProperty(el, name, value) {\r\n        if (name.charAt(0) == ANIMATION_PREFIX && name == DISABLE_ANIMATIONS_FLAG) {\r\n            this.disableAnimations(el, !!value);\r\n        }\r\n        else {\r\n            this.delegate.setProperty(el, name, value);\r\n        }\r\n    }\r\n    setValue(node, value) {\r\n        this.delegate.setValue(node, value);\r\n    }\r\n    listen(target, eventName, callback) {\r\n        return this.delegate.listen(target, eventName, callback);\r\n    }\r\n    disableAnimations(element, value) {\r\n        this.engine.disableAnimations(element, value);\r\n    }\r\n}\r\nclass AnimationRenderer extends BaseAnimationRenderer {\r\n    constructor(factory, namespaceId, delegate, engine) {\r\n        super(namespaceId, delegate, engine);\r\n        this.factory = factory;\r\n        this.namespaceId = namespaceId;\r\n    }\r\n    setProperty(el, name, value) {\r\n        if (name.charAt(0) == ANIMATION_PREFIX) {\r\n            if (name.charAt(1) == '.' && name == DISABLE_ANIMATIONS_FLAG) {\r\n                value = value === undefined ? true : !!value;\r\n                this.disableAnimations(el, value);\r\n            }\r\n            else {\r\n                this.engine.process(this.namespaceId, el, name.substr(1), value);\r\n            }\r\n        }\r\n        else {\r\n            this.delegate.setProperty(el, name, value);\r\n        }\r\n    }\r\n    listen(target, eventName, callback) {\r\n        if (eventName.charAt(0) == ANIMATION_PREFIX) {\r\n            const element = resolveElementFromTarget(target);\r\n            let name = eventName.substr(1);\r\n            let phase = '';\r\n            // @listener.phase is for trigger animation callbacks\r\n            // @@listener is for animation builder callbacks\r\n            if (name.charAt(0) != ANIMATION_PREFIX) {\r\n                [name, phase] = parseTriggerCallbackName(name);\r\n            }\r\n            return this.engine.listen(this.namespaceId, element, name, phase, event => {\r\n                const countId = event['_data'] || -1;\r\n                this.factory.scheduleListenerCallback(countId, callback, event);\r\n            });\r\n        }\r\n        return this.delegate.listen(target, eventName, callback);\r\n    }\r\n}\r\nfunction resolveElementFromTarget(target) {\r\n    switch (target) {\r\n        case 'body':\r\n            return document.body;\r\n        case 'document':\r\n            return document;\r\n        case 'window':\r\n            return window;\r\n        default:\r\n            return target;\r\n    }\r\n}\r\nfunction parseTriggerCallbackName(triggerName) {\r\n    const dotIndex = triggerName.indexOf('.');\r\n    const trigger = triggerName.substring(0, dotIndex);\r\n    const phase = triggerName.substr(dotIndex + 1);\r\n    return [trigger, phase];\r\n}\r\n\r\n/**\r\n * @license\r\n * Copyright Google LLC All Rights Reserved.\r\n *\r\n * Use of this source code is governed by an MIT-style license that can be\r\n * found in the LICENSE file at https://angular.io/license\r\n */\r\nclass InjectableAnimationEngine extends ɵAnimationEngine {\r\n    constructor(doc, driver, normalizer) {\r\n        super(doc.body, driver, normalizer);\r\n    }\r\n    ngOnDestroy() {\r\n        this.flush();\r\n    }\r\n}\r\nInjectableAnimationEngine.ɵfac = function InjectableAnimationEngine_Factory(t) { return new (t || InjectableAnimationEngine)(ɵngcc0.ɵɵinject(DOCUMENT), ɵngcc0.ɵɵinject(ɵngcc1.AnimationDriver), ɵngcc0.ɵɵinject(ɵngcc1.ɵAnimationStyleNormalizer)); };\r\nInjectableAnimationEngine.ɵprov = /*@__PURE__*/ ɵngcc0.ɵɵdefineInjectable({ token: InjectableAnimationEngine, factory: InjectableAnimationEngine.ɵfac });\r\nInjectableAnimationEngine.ctorParameters = () => [\r\n    { type: undefined, decorators: [{ type: Inject, args: [DOCUMENT,] }] },\r\n    { type: AnimationDriver },\r\n    { type: ɵAnimationStyleNormalizer }\r\n];\r\n(function () { (typeof ngDevMode === \"undefined\" || ngDevMode) && ɵngcc0.ɵsetClassMetadata(InjectableAnimationEngine, [{\r\n        type: Injectable\r\n    }], function () { return [{ type: undefined, decorators: [{\r\n                type: Inject,\r\n                args: [DOCUMENT]\r\n            }] }, { type: ɵngcc1.AnimationDriver }, { type: ɵngcc1.ɵAnimationStyleNormalizer }]; }, null); })();\r\nfunction instantiateSupportedAnimationDriver() {\r\n    return ɵsupportsWebAnimations() ? new ɵWebAnimationsDriver() : new ɵCssKeyframesDriver();\r\n}\r\nfunction instantiateDefaultStyleNormalizer() {\r\n    return new ɵWebAnimationsStyleNormalizer();\r\n}\r\nfunction instantiateRendererFactory(renderer, engine, zone) {\r\n    return new AnimationRendererFactory(renderer, engine, zone);\r\n}\r\n/**\r\n * @publicApi\r\n */\r\nconst ANIMATION_MODULE_TYPE = new InjectionToken('AnimationModuleType');\r\nconst SHARED_ANIMATION_PROVIDERS = [\r\n    { provide: AnimationBuilder, useClass: BrowserAnimationBuilder },\r\n    { provide: ɵAnimationStyleNormalizer, useFactory: instantiateDefaultStyleNormalizer },\r\n    { provide: ɵAnimationEngine, useClass: InjectableAnimationEngine }, {\r\n        provide: RendererFactory2,\r\n        useFactory: instantiateRendererFactory,\r\n        deps: [ɵDomRendererFactory2, ɵAnimationEngine, NgZone]\r\n    }\r\n];\r\n/**\r\n * Separate providers from the actual module so that we can do a local modification in Google3 to\r\n * include them in the BrowserModule.\r\n */\r\nconst BROWSER_ANIMATIONS_PROVIDERS = [\r\n    { provide: AnimationDriver, useFactory: instantiateSupportedAnimationDriver },\r\n    { provide: ANIMATION_MODULE_TYPE, useValue: 'BrowserAnimations' }, ...SHARED_ANIMATION_PROVIDERS\r\n];\r\n/**\r\n * Separate providers from the actual module so that we can do a local modification in Google3 to\r\n * include them in the BrowserTestingModule.\r\n */\r\nconst BROWSER_NOOP_ANIMATIONS_PROVIDERS = [\r\n    { provide: AnimationDriver, useClass: ɵNoopAnimationDriver },\r\n    { provide: ANIMATION_MODULE_TYPE, useValue: 'NoopAnimations' }, ...SHARED_ANIMATION_PROVIDERS\r\n];\r\n\r\n/**\r\n * @license\r\n * Copyright Google LLC All Rights Reserved.\r\n *\r\n * Use of this source code is governed by an MIT-style license that can be\r\n * found in the LICENSE file at https://angular.io/license\r\n */\r\n/**\r\n * Exports `BrowserModule` with additional [dependency-injection providers](guide/glossary#provider)\r\n * for use with animations. See [Animations](guide/animations).\r\n * @publicApi\r\n */\r\nclass BrowserAnimationsModule {\r\n    /**\r\n     * Configures the module based on the specified object.\r\n     *\r\n     * @param config Object used to configure the behavior of the `BrowserAnimationsModule`.\r\n     * @see `BrowserAnimationsModuleConfig`\r\n     *\r\n     * @usageNotes\r\n     * When registering the `BrowserAnimationsModule`, you can use the `withConfig`\r\n     * function as follows:\r\n     * ```\r\n     * @NgModule({\r\n     *   imports: [BrowserAnimationsModule.withConfig(config)]\r\n     * })\r\n     * class MyNgModule {}\r\n     * ```\r\n     */\r\n    static withConfig(config) {\r\n        return {\r\n            ngModule: BrowserAnimationsModule,\r\n            providers: config.disableAnimations ? BROWSER_NOOP_ANIMATIONS_PROVIDERS :\r\n                BROWSER_ANIMATIONS_PROVIDERS\r\n        };\r\n    }\r\n}\r\nBrowserAnimationsModule.ɵfac = function BrowserAnimationsModule_Factory(t) { return new (t || BrowserAnimationsModule)(); };\r\nBrowserAnimationsModule.ɵmod = /*@__PURE__*/ ɵngcc0.ɵɵdefineNgModule({ type: BrowserAnimationsModule });\r\nBrowserAnimationsModule.ɵinj = /*@__PURE__*/ ɵngcc0.ɵɵdefineInjector({ providers: BROWSER_ANIMATIONS_PROVIDERS, imports: [BrowserModule] });\r\n(function () { (typeof ngDevMode === \"undefined\" || ngDevMode) && ɵngcc0.ɵsetClassMetadata(BrowserAnimationsModule, [{\r\n        type: NgModule,\r\n        args: [{\r\n                exports: [BrowserModule],\r\n                providers: BROWSER_ANIMATIONS_PROVIDERS\r\n            }]\r\n    }], null, null); })();\r\n(function () { (typeof ngJitMode === \"undefined\" || ngJitMode) && ɵngcc0.ɵɵsetNgModuleScope(BrowserAnimationsModule, { exports: function () { return [BrowserModule]; } }); })();\r\n/**\r\n * A null player that must be imported to allow disabling of animations.\r\n * @publicApi\r\n */\r\nclass NoopAnimationsModule {\r\n}\r\nNoopAnimationsModule.ɵfac = function NoopAnimationsModule_Factory(t) { return new (t || NoopAnimationsModule)(); };\r\nNoopAnimationsModule.ɵmod = /*@__PURE__*/ ɵngcc0.ɵɵdefineNgModule({ type: NoopAnimationsModule });\r\nNoopAnimationsModule.ɵinj = /*@__PURE__*/ ɵngcc0.ɵɵdefineInjector({ providers: BROWSER_NOOP_ANIMATIONS_PROVIDERS, imports: [BrowserModule] });\r\n(function () { (typeof ngDevMode === \"undefined\" || ngDevMode) && ɵngcc0.ɵsetClassMetadata(NoopAnimationsModule, [{\r\n        type: NgModule,\r\n        args: [{\r\n                exports: [BrowserModule],\r\n                providers: BROWSER_NOOP_ANIMATIONS_PROVIDERS\r\n            }]\r\n    }], null, null); })();\r\n(function () { (typeof ngJitMode === \"undefined\" || ngJitMode) && ɵngcc0.ɵɵsetNgModuleScope(NoopAnimationsModule, { exports: function () { return [BrowserModule]; } }); })();\r\n\r\n/**\r\n * @license\r\n * Copyright Google LLC All Rights Reserved.\r\n *\r\n * Use of this source code is governed by an MIT-style license that can be\r\n * found in the LICENSE file at https://angular.io/license\r\n */\r\n\r\n/**\r\n * @license\r\n * Copyright Google LLC All Rights Reserved.\r\n *\r\n * Use of this source code is governed by an MIT-style license that can be\r\n * found in the LICENSE file at https://angular.io/license\r\n */\r\n\r\n/**\r\n * @license\r\n * Copyright Google LLC All Rights Reserved.\r\n *\r\n * Use of this source code is governed by an MIT-style license that can be\r\n * found in the LICENSE file at https://angular.io/license\r\n */\r\n\r\n/**\r\n * @license\r\n * Copyright Google LLC All Rights Reserved.\r\n *\r\n * Use of this source code is governed by an MIT-style license that can be\r\n * found in the LICENSE file at https://angular.io/license\r\n */\r\n\r\n/**\r\n * Generated bundle index. Do not edit.\r\n */\r\n\r\nexport { ANIMATION_MODULE_TYPE, BrowserAnimationsModule, NoopAnimationsModule, AnimationRenderer as ɵAnimationRenderer, AnimationRendererFactory as ɵAnimationRendererFactory, BrowserAnimationBuilder as ɵBrowserAnimationBuilder, BrowserAnimationFactory as ɵBrowserAnimationFactory, InjectableAnimationEngine as ɵInjectableAnimationEngine, instantiateSupportedAnimationDriver as ɵangular_packages_platform_browser_animations_animations_a, instantiateDefaultStyleNormalizer as ɵangular_packages_platform_browser_animations_animations_b, instantiateRendererFactory as ɵangular_packages_platform_browser_animations_animations_c, BROWSER_ANIMATIONS_PROVIDERS as ɵangular_packages_platform_browser_animations_animations_d, BROWSER_NOOP_ANIMATIONS_PROVIDERS as ɵangular_packages_platform_browser_animations_animations_e, BaseAnimationRenderer as ɵangular_packages_platform_browser_animations_animations_f };\r\n\r\n","/**\r\n * SuiteCRM is a customer relationship management program developed by SalesAgility Ltd.\r\n * Copyright (C) 2021 SalesAgility Ltd.\r\n *\r\n * This program is free software; you can redistribute it and/or modify it under\r\n * the terms of the GNU Affero General Public License version 3 as published by the\r\n * Free Software Foundation with the addition of the following permission added\r\n * to Section 15 as permitted in Section 7(a): FOR ANY PART OF THE COVERED WORK\r\n * IN WHICH THE COPYRIGHT IS OWNED BY SALESAGILITY, SALESAGILITY DISCLAIMS THE\r\n * WARRANTY OF NON INFRINGEMENT OF THIRD PARTY RIGHTS.\r\n *\r\n * This program is distributed in the hope that it will be useful, but WITHOUT\r\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS\r\n * FOR A PARTICULAR PURPOSE. See the GNU Affero General Public License for more\r\n * details.\r\n *\r\n * You should have received a copy of the GNU Affero General Public License\r\n * along with this program.  If not, see <http://www.gnu.org/licenses/>.\r\n *\r\n * In accordance with Section 7(b) of the GNU Affero General Public License\r\n * version 3, these Appropriate Legal Notices must retain the display of the\r\n * \"Supercharged by SuiteCRM\" logo. If the display of the logos is not reasonably\r\n * feasible for technical reasons, the Appropriate Legal Notices must display\r\n * the words \"Supercharged by SuiteCRM\".\r\n */\r\n\r\nimport {ActivatedRouteSnapshot, DetachedRouteHandle, RouteReuseStrategy} from '@angular/router';\r\nimport { Injectable } from \"@angular/core\";\r\n\r\n@Injectable()\r\nexport class AppRouteReuseStrategy implements RouteReuseStrategy {\r\n\r\n    shouldDetach(route: ActivatedRouteSnapshot): boolean {\r\n        return false;\r\n    }\r\n\r\n    store(route: ActivatedRouteSnapshot, detachedTree: DetachedRouteHandle): void {\r\n    }\r\n\r\n    shouldAttach(route: ActivatedRouteSnapshot): boolean {\r\n        return false;\r\n    }\r\n\r\n    retrieve(route: ActivatedRouteSnapshot): DetachedRouteHandle | null {\r\n        return null;\r\n    }\r\n\r\n    shouldReuseRoute(future: ActivatedRouteSnapshot, curr: ActivatedRouteSnapshot): boolean {\r\n        if (future.data && future.data.reuseRoute === false) {\r\n            return false;\r\n        }\r\n        return future.routeConfig === curr.routeConfig;\r\n    }\r\n}\r\n","/**\r\n * SuiteCRM is a customer relationship management program developed by SalesAgility Ltd.\r\n * Copyright (C) 2021 SalesAgility Ltd.\r\n *\r\n * This program is free software; you can redistribute it and/or modify it under\r\n * the terms of the GNU Affero General Public License version 3 as published by the\r\n * Free Software Foundation with the addition of the following permission added\r\n * to Section 15 as permitted in Section 7(a): FOR ANY PART OF THE COVERED WORK\r\n * IN WHICH THE COPYRIGHT IS OWNED BY SALESAGILITY, SALESAGILITY DISCLAIMS THE\r\n * WARRANTY OF NON INFRINGEMENT OF THIRD PARTY RIGHTS.\r\n *\r\n * This program is distributed in the hope that it will be useful, but WITHOUT\r\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS\r\n * FOR A PARTICULAR PURPOSE. See the GNU Affero General Public License for more\r\n * details.\r\n *\r\n * You should have received a copy of the GNU Affero General Public License\r\n * along with this program.  If not, see <http://www.gnu.org/licenses/>.\r\n *\r\n * In accordance with Section 7(b) of the GNU Affero General Public License\r\n * version 3, these Appropriate Legal Notices must retain the display of the\r\n * \"Supercharged by SuiteCRM\" logo. If the display of the logos is not reasonably\r\n * feasible for technical reasons, the Appropriate Legal Notices must display\r\n * the words \"Supercharged by SuiteCRM\".\r\n */\r\n\r\nimport {Injectable, Injector} from '@angular/core';\r\nimport {Router} from '@angular/router';\r\nimport {\r\n    AppStateStore,\r\n    AuthGuard,\r\n    BaseMetadataResolver,\r\n    BaseModuleResolver,\r\n    BaseRecordResolver,\r\n    ClassicViewResolver,\r\n    ClassicViewUiComponent,\r\n    CreateRecordComponent,\r\n    ExtensionLoader,\r\n    InstallAuthGuard,\r\n    InstallViewComponent,\r\n    ListComponent,\r\n    LoginAuthGuard,\r\n    LoginUiComponent,\r\n    RecordComponent,\r\n    SystemConfigStore\r\n} from 'core';\r\nimport {take} from 'rxjs/operators';\r\nimport {isFalse} from 'common';\r\n\r\n@Injectable()\r\nexport class AppInit {\r\n\r\n    constructor(\r\n        private router: Router,\r\n        protected systemConfigStore: SystemConfigStore,\r\n        protected appStore: AppStateStore,\r\n        protected injector: Injector,\r\n        protected extensionLoader: ExtensionLoader\r\n    ) {\r\n    }\r\n\r\n    init(): Promise<void> {\r\n\r\n        // eslint-disable-next-line compat/compat\r\n        return new Promise<void>((resolve) => {\r\n            this.systemConfigStore.load().subscribe(() => {\r\n                this.appStore.init();\r\n\r\n                this.extensionLoader.load(this.injector).pipe(take(1)).subscribe(() => {\r\n                    const routes = this.router.config;\r\n                    const configRoutes = this.systemConfigStore.getConfigValue('module_routing');\r\n\r\n                    routes.push({\r\n                        path: 'Login',\r\n                        component: LoginUiComponent,\r\n                        canActivate: [LoginAuthGuard],\r\n                        runGuardsAndResolvers: 'always',\r\n                        resolve: {\r\n                            metadata: BaseMetadataResolver\r\n                        },\r\n                        data: {\r\n                            reuseRoute: false,\r\n                            load: {\r\n                                navigation: false,\r\n                                preferences: false,\r\n                                languageStrings: ['appStrings']\r\n                            }\r\n                        }\r\n                    });\r\n\r\n                    routes.push({\r\n                        path: 'install',\r\n                        component: InstallViewComponent,\r\n                        canActivate: [InstallAuthGuard],\r\n                        runGuardsAndResolvers: 'always',\r\n                        resolve: {\r\n                            metadata: BaseMetadataResolver\r\n                        },\r\n                        data: {\r\n                            reuseRoute: false,\r\n                            checkSession: false,\r\n                            load: {\r\n                                navigation: false,\r\n                                preferences: false,\r\n                                languageStrings: ['appStrings']\r\n                            }\r\n                        }\r\n                    });\r\n\r\n                    Object.keys(configRoutes).forEach(routeName => {\r\n                        if (configRoutes[routeName].index) {\r\n                            routes.push({\r\n                                path: routeName,\r\n                                component: ListComponent,\r\n                                canActivate: [AuthGuard],\r\n                                runGuardsAndResolvers: 'always',\r\n                                resolve: {\r\n                                    metadata: BaseModuleResolver\r\n                                },\r\n                                data: {\r\n                                    reuseRoute: false,\r\n                                    checkSession: true,\r\n                                    module: routeName\r\n                                }\r\n                            });\r\n                            routes.push({\r\n                                path: routeName + '/index',\r\n                                component: ListComponent,\r\n                                canActivate: [AuthGuard],\r\n                                runGuardsAndResolvers: 'always',\r\n                                resolve: {\r\n                                    metadata: BaseModuleResolver\r\n                                },\r\n                                data: {\r\n                                    reuseRoute: false,\r\n                                    checkSession: true,\r\n                                    module: routeName\r\n                                }\r\n                            });\r\n                        }\r\n\r\n                        if (configRoutes[routeName].list) {\r\n                            routes.push({\r\n                                path: routeName + '/list',\r\n                                component: ListComponent,\r\n                                canActivate: [AuthGuard],\r\n                                runGuardsAndResolvers: 'always',\r\n                                resolve: {\r\n                                    metadata: BaseModuleResolver\r\n                                },\r\n                                data: {\r\n                                    reuseRoute: false,\r\n                                    checkSession: true,\r\n                                    module: routeName\r\n                                }\r\n                            });\r\n                        }\r\n\r\n                        if (!isFalse(configRoutes[routeName].create) && !isFalse(configRoutes[routeName].record)) {\r\n                            routes.push({\r\n                                path: routeName + '/create',\r\n                                component: CreateRecordComponent,\r\n                                canActivate: [AuthGuard],\r\n                                runGuardsAndResolvers: 'always',\r\n                                resolve: {\r\n                                    view: BaseModuleResolver,\r\n                                    metadata: BaseRecordResolver\r\n                                },\r\n                                data: {\r\n                                    reuseRoute: false,\r\n                                    checkSession: true,\r\n                                    module: routeName,\r\n                                    mode: 'create'\r\n                                }\r\n                            });\r\n\r\n                            routes.push({\r\n                                path: routeName + '/edit',\r\n                                component: CreateRecordComponent,\r\n                                canActivate: [AuthGuard],\r\n                                runGuardsAndResolvers: 'always',\r\n                                resolve: {\r\n                                    view: BaseModuleResolver,\r\n                                    metadata: BaseRecordResolver\r\n                                },\r\n                                data: {\r\n                                    reuseRoute: false,\r\n                                    checkSession: true,\r\n                                    module: routeName,\r\n                                    mode: 'create'\r\n                                }\r\n                            });\r\n                        }\r\n\r\n                        if (configRoutes[routeName].record) {\r\n                            routes.push({\r\n                                path: routeName + '/record/:record',\r\n                                component: RecordComponent,\r\n                                canActivate: [AuthGuard],\r\n                                runGuardsAndResolvers: 'always',\r\n                                resolve: {\r\n                                    view: BaseModuleResolver,\r\n                                    metadata: BaseRecordResolver\r\n                                },\r\n                                data: {\r\n                                    reuseRoute: false,\r\n                                    checkSession: true,\r\n                                    module: routeName\r\n                                }\r\n                            });\r\n                            routes.push({\r\n                                path: routeName + '/edit/:record',\r\n                                component: RecordComponent,\r\n                                canActivate: [AuthGuard],\r\n                                runGuardsAndResolvers: 'always',\r\n                                resolve: {\r\n                                    view: BaseModuleResolver,\r\n                                    metadata: BaseRecordResolver\r\n                                },\r\n                                data: {\r\n                                    reuseRoute: false,\r\n                                    checkSession: true,\r\n                                    module: routeName,\r\n                                    mode: 'edit'\r\n                                }\r\n                            });\r\n                            routes.push({\r\n                                path: routeName + '/detail/:record',\r\n                                component: RecordComponent,\r\n                                canActivate: [AuthGuard],\r\n                                runGuardsAndResolvers: 'always',\r\n                                resolve: {\r\n                                    view: BaseModuleResolver,\r\n                                    metadata: BaseRecordResolver\r\n                                },\r\n                                data: {\r\n                                    reuseRoute: false,\r\n                                    checkSession: true,\r\n                                    module: routeName\r\n                                }\r\n                            });\r\n                        }\r\n                    });\r\n\r\n                    routes.push({\r\n                        path: ':module',\r\n                        component: ClassicViewUiComponent,\r\n                        canActivate: [AuthGuard],\r\n                        runGuardsAndResolvers: 'always',\r\n                        resolve: {\r\n                            legacyUrl: ClassicViewResolver,\r\n                        },\r\n                        data: {\r\n                            reuseRoute: false,\r\n                            checkSession: true\r\n                        }\r\n                    });\r\n\r\n                    routes.push({\r\n                        path: ':module/:action',\r\n                        component: ClassicViewUiComponent,\r\n                        canActivate: [AuthGuard],\r\n                        runGuardsAndResolvers: 'always',\r\n                        resolve: {\r\n                            legacyUrl: ClassicViewResolver,\r\n                        },\r\n                        data: {\r\n                            reuseRoute: false,\r\n                            checkSession: true\r\n                        }\r\n                    });\r\n\r\n                    routes.push({\r\n                        path: ':module/:action/:record',\r\n                        component: ClassicViewUiComponent,\r\n                        canActivate: [AuthGuard],\r\n                        runGuardsAndResolvers: 'always',\r\n                        resolve: {\r\n                            legacyUrl: ClassicViewResolver,\r\n                        },\r\n                        data: {\r\n                            reuseRoute: false,\r\n                            checkSession: true\r\n                        }\r\n                    });\r\n\r\n                    routes.push({\r\n                        path: '**',\r\n                        redirectTo: 'Login'\r\n                    });\r\n\r\n                    routes.push({\r\n                        path: '',\r\n                        component: ClassicViewUiComponent\r\n                    });\r\n\r\n                    this.router.resetConfig(routes);\r\n                    resolve();\r\n                });\r\n\r\n            });\r\n        });\r\n    }\r\n}\r\n","import * as i0 from '@angular/core';\r\nimport { Injectable } from '@angular/core';\r\nimport * as i1 from '@angular/common/http';\r\nimport { HttpHeaders, HttpClient } from '@angular/common/http';\r\nimport { ApolloLink, Observable as Observable$1 } from '@apollo/client/core';\r\nimport { print } from 'graphql';\r\nimport { extractFiles } from 'extract-files';\r\nimport { Observable } from 'rxjs';\r\nimport { BatchLink } from '@apollo/client/link/batch';\r\n\r\nimport * as ɵngcc0 from '@angular/core';\r\nimport * as ɵngcc1 from '@angular/common/http';\r\nconst fetch = (req, httpClient, extractFiles) => {\r\n    const shouldUseBody = ['POST', 'PUT', 'PATCH'].indexOf(req.method.toUpperCase()) !== -1;\r\n    const shouldStringify = (param) => ['variables', 'extensions'].indexOf(param.toLowerCase()) !== -1;\r\n    const isBatching = req.body.length;\r\n    let shouldUseMultipart = req.options && req.options.useMultipart;\r\n    let multipartInfo;\r\n    if (shouldUseMultipart) {\r\n        if (isBatching) {\r\n            return new Observable((observer) => observer.error(new Error('File upload is not available when combined with Batching')));\r\n        }\r\n        if (!shouldUseBody) {\r\n            return new Observable((observer) => observer.error(new Error('File upload is not available when GET is used')));\r\n        }\r\n        multipartInfo = extractFiles(req.body);\r\n        shouldUseMultipart = !!multipartInfo.files.size;\r\n    }\r\n    // `body` for some, `params` for others\r\n    let bodyOrParams = {};\r\n    if (isBatching) {\r\n        if (!shouldUseBody) {\r\n            return new Observable((observer) => observer.error(new Error('Batching is not available for GET requests')));\r\n        }\r\n        bodyOrParams = {\r\n            body: req.body,\r\n        };\r\n    }\r\n    else {\r\n        const body = shouldUseMultipart ? multipartInfo.clone : req.body;\r\n        if (shouldUseBody) {\r\n            bodyOrParams = {\r\n                body,\r\n            };\r\n        }\r\n        else {\r\n            const params = Object.keys(req.body).reduce((obj, param) => {\r\n                const value = req.body[param];\r\n                obj[param] = shouldStringify(param) ? JSON.stringify(value) : value;\r\n                return obj;\r\n            }, {});\r\n            bodyOrParams = { params: params };\r\n        }\r\n    }\r\n    if (shouldUseMultipart && shouldUseBody) {\r\n        const form = new FormData();\r\n        form.append('operations', JSON.stringify(bodyOrParams.body));\r\n        const map = {};\r\n        const files = multipartInfo.files;\r\n        let i = 0;\r\n        files.forEach((paths) => {\r\n            map[++i] = paths;\r\n        });\r\n        form.append('map', JSON.stringify(map));\r\n        i = 0;\r\n        files.forEach((_, file) => {\r\n            form.append(++i + '', file, file.name);\r\n        });\r\n        bodyOrParams.body = form;\r\n    }\r\n    // create a request\r\n    return httpClient.request(req.method, req.url, Object.assign(Object.assign({ observe: 'response', responseType: 'json', reportProgress: false }, bodyOrParams), req.options));\r\n};\r\nconst mergeHeaders = (source, destination) => {\r\n    if (source && destination) {\r\n        const merged = destination\r\n            .keys()\r\n            .reduce((headers, name) => headers.set(name, destination.getAll(name)), source);\r\n        return merged;\r\n    }\r\n    return destination || source;\r\n};\r\nfunction prioritize(...values) {\r\n    const picked = values.find((val) => typeof val !== 'undefined');\r\n    if (typeof picked === 'undefined') {\r\n        return values[values.length - 1];\r\n    }\r\n    return picked;\r\n}\r\nfunction createHeadersWithClientAwereness(context) {\r\n    // `apollographql-client-*` headers are automatically set if a\r\n    // `clientAwareness` object is found in the context. These headers are\r\n    // set first, followed by the rest of the headers pulled from\r\n    // `context.headers`.\r\n    let headers = context.headers && context.headers instanceof HttpHeaders\r\n        ? context.headers\r\n        : new HttpHeaders(context.headers);\r\n    if (context.clientAwareness) {\r\n        const { name, version } = context.clientAwareness;\r\n        // If desired, `apollographql-client-*` headers set by\r\n        // the `clientAwareness` object can be overridden by\r\n        // `apollographql-client-*` headers set in `context.headers`.\r\n        if (name && !headers.has('apollographql-client-name')) {\r\n            headers = headers.set('apollographql-client-name', name);\r\n        }\r\n        if (version && !headers.has('apollographql-client-version')) {\r\n            headers = headers.set('apollographql-client-version', version);\r\n        }\r\n    }\r\n    return headers;\r\n}\r\n\r\n// XXX find a better name for it\r\nclass HttpLinkHandler extends ApolloLink {\r\n    constructor(httpClient, options) {\r\n        super();\r\n        this.httpClient = httpClient;\r\n        this.options = options;\r\n        this.print = print;\r\n        if (this.options.operationPrinter) {\r\n            this.print = this.options.operationPrinter;\r\n        }\r\n        this.requester = (operation) => new Observable$1((observer) => {\r\n            const context = operation.getContext();\r\n            // decides which value to pick, Context, Options or to just use the default\r\n            const pick = (key, init) => {\r\n                return prioritize(context[key], this.options[key], init);\r\n            };\r\n            const includeQuery = pick('includeQuery', true);\r\n            const includeExtensions = pick('includeExtensions', false);\r\n            const method = pick('method', 'POST');\r\n            const url = pick('uri', 'graphql');\r\n            const withCredentials = pick('withCredentials');\r\n            const useMultipart = pick('useMultipart');\r\n            const req = {\r\n                method,\r\n                url: typeof url === 'function' ? url(operation) : url,\r\n                body: {\r\n                    operationName: operation.operationName,\r\n                    variables: operation.variables,\r\n                },\r\n                options: {\r\n                    withCredentials,\r\n                    useMultipart,\r\n                    headers: this.options.headers,\r\n                },\r\n            };\r\n            if (includeExtensions) {\r\n                req.body.extensions = operation.extensions;\r\n            }\r\n            if (includeQuery) {\r\n                req.body.query = this.print(operation.query);\r\n            }\r\n            const headers = createHeadersWithClientAwereness(context);\r\n            req.options.headers = mergeHeaders(req.options.headers, headers);\r\n            const sub = fetch(req, this.httpClient, extractFiles).subscribe({\r\n                next: (response) => {\r\n                    operation.setContext({ response });\r\n                    observer.next(response.body);\r\n                },\r\n                error: (err) => observer.error(err),\r\n                complete: () => observer.complete(),\r\n            });\r\n            return () => {\r\n                if (!sub.closed) {\r\n                    sub.unsubscribe();\r\n                }\r\n            };\r\n        });\r\n    }\r\n    request(op) {\r\n        return this.requester(op);\r\n    }\r\n}\r\nclass HttpLink {\r\n    constructor(httpClient) {\r\n        this.httpClient = httpClient;\r\n    }\r\n    create(options) {\r\n        return new HttpLinkHandler(this.httpClient, options);\r\n    }\r\n}\r\nHttpLink.ɵfac = function HttpLink_Factory(t) { return new (t || HttpLink)(ɵngcc0.ɵɵinject(ɵngcc1.HttpClient)); };\r\nHttpLink.ɵprov = i0.ɵɵdefineInjectable({ factory: function HttpLink_Factory() { return new HttpLink(i0.ɵɵinject(i1.HttpClient)); }, token: HttpLink, providedIn: \"root\" });\r\nHttpLink.ctorParameters = () => [\r\n    { type: HttpClient }\r\n];\r\n(function () { (typeof ngDevMode === \"undefined\" || ngDevMode) && ɵngcc0.ɵsetClassMetadata(HttpLink, [{\r\n        type: Injectable,\r\n        args: [{\r\n                providedIn: 'root'\r\n            }]\r\n    }], function () { return [{ type: ɵngcc1.HttpClient }]; }, null); })();\r\n\r\nconst defaults = {\r\n    batchInterval: 10,\r\n    batchMax: 10,\r\n    uri: 'graphql',\r\n    method: 'POST',\r\n};\r\nclass HttpBatchLinkHandler extends ApolloLink {\r\n    constructor(httpClient, options) {\r\n        super();\r\n        this.httpClient = httpClient;\r\n        this.options = options;\r\n        this.print = print;\r\n        this.batchInterval = options.batchInterval || defaults.batchInterval;\r\n        this.batchMax = options.batchMax || defaults.batchMax;\r\n        if (this.options.operationPrinter) {\r\n            this.print = this.options.operationPrinter;\r\n        }\r\n        const batchHandler = (operations) => {\r\n            return new Observable$1((observer) => {\r\n                const body = this.createBody(operations);\r\n                const headers = this.createHeaders(operations);\r\n                const { method, uri, withCredentials } = this.createOptions(operations);\r\n                if (typeof uri === 'function') {\r\n                    throw new Error(`Option 'uri' is a function, should be a string`);\r\n                }\r\n                const req = {\r\n                    method,\r\n                    url: uri,\r\n                    body: body,\r\n                    options: {\r\n                        withCredentials,\r\n                        headers,\r\n                    },\r\n                };\r\n                const sub = fetch(req, this.httpClient, () => {\r\n                    throw new Error('File upload is not available when combined with Batching');\r\n                }).subscribe({\r\n                    next: (result) => observer.next(result.body),\r\n                    error: (err) => observer.error(err),\r\n                    complete: () => observer.complete(),\r\n                });\r\n                return () => {\r\n                    if (!sub.closed) {\r\n                        sub.unsubscribe();\r\n                    }\r\n                };\r\n            });\r\n        };\r\n        const batchKey = options.batchKey ||\r\n            ((operation) => {\r\n                return this.createBatchKey(operation);\r\n            });\r\n        this.batcher = new BatchLink({\r\n            batchInterval: this.batchInterval,\r\n            batchMax: this.batchMax,\r\n            batchKey,\r\n            batchHandler,\r\n        });\r\n    }\r\n    createOptions(operations) {\r\n        const context = operations[0].getContext();\r\n        return {\r\n            method: prioritize(context.method, this.options.method, defaults.method),\r\n            uri: prioritize(context.uri, this.options.uri, defaults.uri),\r\n            withCredentials: prioritize(context.withCredentials, this.options.withCredentials),\r\n        };\r\n    }\r\n    createBody(operations) {\r\n        return operations.map((operation) => {\r\n            const includeExtensions = prioritize(operation.getContext().includeExtensions, this.options.includeExtensions, false);\r\n            const includeQuery = prioritize(operation.getContext().includeQuery, this.options.includeQuery, true);\r\n            const body = {\r\n                operationName: operation.operationName,\r\n                variables: operation.variables,\r\n            };\r\n            if (includeExtensions) {\r\n                body.extensions = operation.extensions;\r\n            }\r\n            if (includeQuery) {\r\n                body.query = this.print(operation.query);\r\n            }\r\n            return body;\r\n        });\r\n    }\r\n    createHeaders(operations) {\r\n        var _a, _b;\r\n        return operations.reduce((headers, operation) => {\r\n            return mergeHeaders(headers, operation.getContext().headers);\r\n        }, createHeadersWithClientAwereness({\r\n            headers: this.options.headers,\r\n            clientAwareness: (_b = (_a = operations[0]) === null || _a === void 0 ? void 0 : _a.getContext()) === null || _b === void 0 ? void 0 : _b.clientAwareness,\r\n        }));\r\n    }\r\n    createBatchKey(operation) {\r\n        const context = operation.getContext();\r\n        if (context.skipBatching) {\r\n            return Math.random().toString(36).substr(2, 9);\r\n        }\r\n        const headers = context.headers &&\r\n            context.headers.keys().map((k) => context.headers.get(k));\r\n        const opts = JSON.stringify({\r\n            includeQuery: context.includeQuery,\r\n            includeExtensions: context.includeExtensions,\r\n            headers,\r\n        });\r\n        return prioritize(context.uri, this.options.uri) + opts;\r\n    }\r\n    request(op) {\r\n        return this.batcher.request(op);\r\n    }\r\n}\r\nclass HttpBatchLink {\r\n    constructor(httpClient) {\r\n        this.httpClient = httpClient;\r\n    }\r\n    create(options) {\r\n        return new HttpBatchLinkHandler(this.httpClient, options);\r\n    }\r\n}\r\nHttpBatchLink.ɵfac = function HttpBatchLink_Factory(t) { return new (t || HttpBatchLink)(ɵngcc0.ɵɵinject(ɵngcc1.HttpClient)); };\r\nHttpBatchLink.ɵprov = i0.ɵɵdefineInjectable({ factory: function HttpBatchLink_Factory() { return new HttpBatchLink(i0.ɵɵinject(i1.HttpClient)); }, token: HttpBatchLink, providedIn: \"root\" });\r\nHttpBatchLink.ctorParameters = () => [\r\n    { type: HttpClient }\r\n];\r\n(function () { (typeof ngDevMode === \"undefined\" || ngDevMode) && ɵngcc0.ɵsetClassMetadata(HttpBatchLink, [{\r\n        type: Injectable,\r\n        args: [{\r\n                providedIn: 'root'\r\n            }]\r\n    }], function () { return [{ type: ɵngcc1.HttpClient }]; }, null); })();\r\n\r\n// http\r\n\r\n/**\r\n * Generated bundle index. Do not edit.\r\n */\r\n\r\nexport { HttpBatchLink, HttpBatchLinkHandler, HttpLink, HttpLinkHandler };\r\n\r\n","/**\r\n * SuiteCRM is a customer relationship management program developed by SalesAgility Ltd.\r\n * Copyright (C) 2021 SalesAgility Ltd.\r\n *\r\n * This program is free software; you can redistribute it and/or modify it under\r\n * the terms of the GNU Affero General Public License version 3 as published by the\r\n * Free Software Foundation with the addition of the following permission added\r\n * to Section 15 as permitted in Section 7(a): FOR ANY PART OF THE COVERED WORK\r\n * IN WHICH THE COPYRIGHT IS OWNED BY SALESAGILITY, SALESAGILITY DISCLAIMS THE\r\n * WARRANTY OF NON INFRINGEMENT OF THIRD PARTY RIGHTS.\r\n *\r\n * This program is distributed in the hope that it will be useful, but WITHOUT\r\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS\r\n * FOR A PARTICULAR PURPOSE. See the GNU Affero General Public License for more\r\n * details.\r\n *\r\n * You should have received a copy of the GNU Affero General Public License\r\n * along with this program.  If not, see <http://www.gnu.org/licenses/>.\r\n *\r\n * In accordance with Section 7(b) of the GNU Affero General Public License\r\n * version 3, these Appropriate Legal Notices must retain the display of the\r\n * \"Supercharged by SuiteCRM\" logo. If the display of the logos is not reasonably\r\n * feasible for technical reasons, the Appropriate Legal Notices must display\r\n * the words \"Supercharged by SuiteCRM\".\r\n */\r\n\r\nimport {APP_INITIALIZER, NgModule} from '@angular/core';\r\nimport {BrowserModule} from '@angular/platform-browser';\r\nimport {HTTP_INTERCEPTORS, HttpClientModule} from '@angular/common/http';\r\n\r\nimport {Apollo} from 'apollo-angular';\r\nimport {HttpLink} from 'apollo-angular/http';\r\nimport {ApolloLink, InMemoryCache} from '@apollo/client/core';\r\nimport {onError} from '@apollo/link-error';\r\nimport {FetchPolicy} from '@apollo/client/core/watchQueryOptions';\r\n\r\nimport {AppRoutingModule} from './app-routing.module';\r\nimport {AppComponent} from './app.component';\r\n\r\nimport {\r\n    AppStateStore,\r\n    AuthService,\r\n    ClassicViewUiModule,\r\n    ColumnChooserModule,\r\n    CreateRecordModule,\r\n    ErrorInterceptor,\r\n    FilterUiModule,\r\n    FooterUiModule,\r\n    FullPageSpinnerModule,\r\n    ImageModule,\r\n    InstallViewModule,\r\n    ListContainerModule,\r\n    ListHeaderModule,\r\n    ListModule,\r\n    MessageModalModule,\r\n    MessageUiModule,\r\n    ModuleTitleModule,\r\n    NavbarUiModule,\r\n    RecordListModalModule,\r\n    RecordModule,\r\n    TableModule,\r\n} from 'core';\r\n\r\nimport {BrowserAnimationsModule} from '@angular/platform-browser/animations';\r\nimport {NgbModule} from '@ng-bootstrap/ng-bootstrap';\r\n\r\nimport {environment} from '../environments/environment';\r\nimport {RouteReuseStrategy} from '@angular/router';\r\nimport {AppRouteReuseStrategy} from './app-router-reuse-strategy';\r\nimport {BnNgIdleService} from 'bn-ng-idle';\r\nimport {AppInit} from '@app/app-initializer';\r\nimport {GraphQLError} from 'graphql';\r\nimport {AngularSvgIconModule} from 'angular-svg-icon';\r\n\r\nexport const initializeApp = (appInitService: AppInit) => (): Promise<any> => appInitService.init();\r\n\r\n@NgModule({\r\n    declarations: [\r\n        AppComponent,\r\n    ],\r\n    imports: [\r\n        BrowserModule,\r\n        HttpClientModule,\r\n        AppRoutingModule,\r\n        FooterUiModule,\r\n        NavbarUiModule,\r\n        MessageUiModule,\r\n        ClassicViewUiModule,\r\n        FilterUiModule,\r\n        ListModule,\r\n        RecordModule,\r\n        CreateRecordModule,\r\n        InstallViewModule,\r\n        TableModule,\r\n        ModuleTitleModule,\r\n        ListHeaderModule,\r\n        ListContainerModule,\r\n        ColumnChooserModule,\r\n        AngularSvgIconModule.forRoot(),\r\n        ImageModule,\r\n        BrowserAnimationsModule,\r\n        NgbModule,\r\n        FullPageSpinnerModule,\r\n        MessageModalModule,\r\n        RecordListModalModule\r\n    ],\r\n    providers: [\r\n        {provide: HTTP_INTERCEPTORS, useClass: ErrorInterceptor, multi: true},\r\n        {provide: RouteReuseStrategy, useClass: AppRouteReuseStrategy},\r\n        BnNgIdleService,\r\n        AppInit,\r\n        {\r\n            provide: APP_INITIALIZER,\r\n            useFactory: initializeApp,\r\n            multi: true,\r\n            deps: [AppInit]\r\n        }\r\n    ],\r\n    bootstrap: [AppComponent]\r\n})\r\nexport class AppModule {\r\n    constructor(apollo: Apollo, httpLink: HttpLink, protected auth: AuthService, protected appStore: AppStateStore) {\r\n\r\n        const defaultOptions = {\r\n            watchQuery: {\r\n                fetchPolicy: 'no-cache' as FetchPolicy\r\n            },\r\n            query: {\r\n                fetchPolicy: 'no-cache' as FetchPolicy\r\n            },\r\n        };\r\n\r\n        const http = httpLink.create({\r\n            uri: environment.graphqlApiUrl,\r\n            withCredentials: true\r\n        });\r\n\r\n        const logoutLink = onError((err) => {\r\n            if (err.graphQLErrors && err.graphQLErrors.length > 0) {\r\n                err.graphQLErrors.forEach((value: GraphQLError) => {\r\n                    if (this.auth.isUserLoggedIn.value === true && value.message.includes('Access Denied')) {\r\n                        auth.logout('LBL_SESSION_EXPIRED');\r\n                    }\r\n                });\r\n            }\r\n        });\r\n\r\n        const middleware = new ApolloLink((operation, forward) => {\r\n            appStore.addActiveRequest();\r\n            return forward(operation);\r\n        });\r\n\r\n        const afterware = new ApolloLink((operation, forward) => {\r\n            return forward(operation).map(response => {\r\n                appStore.removeActiveRequest();\r\n                return response;\r\n            });\r\n        });\r\n\r\n        apollo.create({\r\n            defaultOptions,\r\n            link: ApolloLink.from([middleware, afterware, logoutLink.concat(http)]),\r\n            cache: new InMemoryCache()\r\n        });\r\n    }\r\n}\r\n","/**\r\n * SuiteCRM is a customer relationship management program developed by SalesAgility Ltd.\r\n * Copyright (C) 2021 SalesAgility Ltd.\r\n *\r\n * This program is free software; you can redistribute it and/or modify it under\r\n * the terms of the GNU Affero General Public License version 3 as published by the\r\n * Free Software Foundation with the addition of the following permission added\r\n * to Section 15 as permitted in Section 7(a): FOR ANY PART OF THE COVERED WORK\r\n * IN WHICH THE COPYRIGHT IS OWNED BY SALESAGILITY, SALESAGILITY DISCLAIMS THE\r\n * WARRANTY OF NON INFRINGEMENT OF THIRD PARTY RIGHTS.\r\n *\r\n * This program is distributed in the hope that it will be useful, but WITHOUT\r\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS\r\n * FOR A PARTICULAR PURPOSE. See the GNU Affero General Public License for more\r\n * details.\r\n *\r\n * You should have received a copy of the GNU Affero General Public License\r\n * along with this program.  If not, see <http://www.gnu.org/licenses/>.\r\n *\r\n * In accordance with Section 7(b) of the GNU Affero General Public License\r\n * version 3, these Appropriate Legal Notices must retain the display of the\r\n * \"Supercharged by SuiteCRM\" logo. If the display of the logos is not reasonably\r\n * feasible for technical reasons, the Appropriate Legal Notices must display\r\n * the words \"Supercharged by SuiteCRM\".\r\n */\r\n\r\n// The file contents for the current environment will overwrite these during build.\r\n// The build system defaults to the dev environment which uses `environment.ts`, but if you do\r\n// `ng build --prod` then `environment.prod.ts` will be used instead.\r\n// The list of which env maps to which file can be found in `.angular.json`.\r\n\r\nexport const environment = {\r\n    production: false,\r\n    apiUrl: './api',\r\n    graphqlApiUrl: './api/graphql'\r\n};\r\n","import {enableProdMode} from '@angular/core';\r\nimport {platformBrowserDynamic} from '@angular/platform-browser-dynamic';\r\n\r\nimport {AppModule} from '@app/app.module';\r\nimport {environment} from './environments/environment';\r\n\r\nif (environment.production) {\r\n  enableProdMode();\r\n}\r\n\r\nplatformBrowserDynamic().bootstrapModule(AppModule)\r\n    .catch(err => console.error(err));\r\n\r\n","/**\r\n * @license Angular v12.1.0\r\n * (c) 2010-2021 Google LLC. https://angular.io/\r\n * License: MIT\r\n */\r\n\r\nimport { ɵDomAdapter, ɵsetRootDomAdapter, ɵparseCookieValue, ɵgetDOM, DOCUMENT, ɵPLATFORM_BROWSER_ID, XhrFactory, CommonModule } from '@angular/common';\r\nimport * as ɵngcc0 from '@angular/core';\r\nexport { ɵgetDOM } from '@angular/common';\r\nimport { InjectionToken, ApplicationInitStatus, APP_INITIALIZER, Injector, setTestabilityGetter, ɵglobal, Injectable, ApplicationRef, NgZone, ɵgetDebugNodeR2, NgProbeToken, Optional, Inject, ViewEncapsulation, APP_ID, RendererStyleFlags2, ɵConsole, NgModule, ɵɵdefineInjectable, ɵɵinject, forwardRef, SecurityContext, ɵallowSanitizationBypassAndThrow, ɵunwrapSafeValue, ɵgetSanitizationBypassType, ɵ_sanitizeUrl, ɵ_sanitizeHtml, ɵbypassSanitizationTrustHtml, ɵbypassSanitizationTrustStyle, ɵbypassSanitizationTrustScript, ɵbypassSanitizationTrustUrl, ɵbypassSanitizationTrustResourceUrl, INJECTOR, ErrorHandler, ɵsetDocument, PLATFORM_ID, PLATFORM_INITIALIZER, Sanitizer, createPlatformFactory, platformCore, ɵINJECTOR_SCOPE, RendererFactory2, Testability, ApplicationModule, SkipSelf, Version } from '@angular/core';\r\n\r\n/**\r\n * @license\r\n * Copyright Google LLC All Rights Reserved.\r\n *\r\n * Use of this source code is governed by an MIT-style license that can be\r\n * found in the LICENSE file at https://angular.io/license\r\n */\r\n/**\r\n * Provides DOM operations in any browser environment.\r\n *\r\n * @security Tread carefully! Interacting with the DOM directly is dangerous and\r\n * can introduce XSS risks.\r\n */\r\nclass GenericBrowserDomAdapter extends ɵDomAdapter {\r\n    constructor() {\r\n        super(...arguments);\r\n        this.supportsDOMEvents = true;\r\n    }\r\n}\r\n\r\n/**\r\n * @license\r\n * Copyright Google LLC All Rights Reserved.\r\n *\r\n * Use of this source code is governed by an MIT-style license that can be\r\n * found in the LICENSE file at https://angular.io/license\r\n */\r\n/**\r\n * A `DomAdapter` powered by full browser DOM APIs.\r\n *\r\n * @security Tread carefully! Interacting with the DOM directly is dangerous and\r\n * can introduce XSS risks.\r\n */\r\n/* tslint:disable:requireParameterType no-console */\r\nclass BrowserDomAdapter extends GenericBrowserDomAdapter {\r\n    static makeCurrent() {\r\n        ɵsetRootDomAdapter(new BrowserDomAdapter());\r\n    }\r\n    onAndCancel(el, evt, listener) {\r\n        el.addEventListener(evt, listener, false);\r\n        // Needed to follow Dart's subscription semantic, until fix of\r\n        // https://code.google.com/p/dart/issues/detail?id=17406\r\n        return () => {\r\n            el.removeEventListener(evt, listener, false);\r\n        };\r\n    }\r\n    dispatchEvent(el, evt) {\r\n        el.dispatchEvent(evt);\r\n    }\r\n    remove(node) {\r\n        if (node.parentNode) {\r\n            node.parentNode.removeChild(node);\r\n        }\r\n    }\r\n    createElement(tagName, doc) {\r\n        doc = doc || this.getDefaultDocument();\r\n        return doc.createElement(tagName);\r\n    }\r\n    createHtmlDocument() {\r\n        return document.implementation.createHTMLDocument('fakeTitle');\r\n    }\r\n    getDefaultDocument() {\r\n        return document;\r\n    }\r\n    isElementNode(node) {\r\n        return node.nodeType === Node.ELEMENT_NODE;\r\n    }\r\n    isShadowRoot(node) {\r\n        return node instanceof DocumentFragment;\r\n    }\r\n    /** @deprecated No longer being used in Ivy code. To be removed in version 14. */\r\n    getGlobalEventTarget(doc, target) {\r\n        if (target === 'window') {\r\n            return window;\r\n        }\r\n        if (target === 'document') {\r\n            return doc;\r\n        }\r\n        if (target === 'body') {\r\n            return doc.body;\r\n        }\r\n        return null;\r\n    }\r\n    getBaseHref(doc) {\r\n        const href = getBaseElementHref();\r\n        return href == null ? null : relativePath(href);\r\n    }\r\n    resetBaseElement() {\r\n        baseElement = null;\r\n    }\r\n    getUserAgent() {\r\n        return window.navigator.userAgent;\r\n    }\r\n    getCookie(name) {\r\n        return ɵparseCookieValue(document.cookie, name);\r\n    }\r\n}\r\nlet baseElement = null;\r\nfunction getBaseElementHref() {\r\n    baseElement = baseElement || document.querySelector('base');\r\n    return baseElement ? baseElement.getAttribute('href') : null;\r\n}\r\n// based on urlUtils.js in AngularJS 1\r\nlet urlParsingNode;\r\nfunction relativePath(url) {\r\n    urlParsingNode = urlParsingNode || document.createElement('a');\r\n    urlParsingNode.setAttribute('href', url);\r\n    const pathName = urlParsingNode.pathname;\r\n    return pathName.charAt(0) === '/' ? pathName : `/${pathName}`;\r\n}\r\n\r\n/**\r\n * @license\r\n * Copyright Google LLC All Rights Reserved.\r\n *\r\n * Use of this source code is governed by an MIT-style license that can be\r\n * found in the LICENSE file at https://angular.io/license\r\n */\r\n/**\r\n * An id that identifies a particular application being bootstrapped, that should\r\n * match across the client/server boundary.\r\n */\r\nconst TRANSITION_ID = new InjectionToken('TRANSITION_ID');\r\nfunction appInitializerFactory(transitionId, document, injector) {\r\n    return () => {\r\n        // Wait for all application initializers to be completed before removing the styles set by\r\n        // the server.\r\n        injector.get(ApplicationInitStatus).donePromise.then(() => {\r\n            const dom = ɵgetDOM();\r\n            const styles = Array.prototype.slice.apply(document.querySelectorAll(`style[ng-transition]`));\r\n            styles.filter(el => el.getAttribute('ng-transition') === transitionId)\r\n                .forEach(el => dom.remove(el));\r\n        });\r\n    };\r\n}\r\nconst SERVER_TRANSITION_PROVIDERS = [\r\n    {\r\n        provide: APP_INITIALIZER,\r\n        useFactory: appInitializerFactory,\r\n        deps: [TRANSITION_ID, DOCUMENT, Injector],\r\n        multi: true\r\n    },\r\n];\r\n\r\n/**\r\n * @license\r\n * Copyright Google LLC All Rights Reserved.\r\n *\r\n * Use of this source code is governed by an MIT-style license that can be\r\n * found in the LICENSE file at https://angular.io/license\r\n */\r\nclass BrowserGetTestability {\r\n    static init() {\r\n        setTestabilityGetter(new BrowserGetTestability());\r\n    }\r\n    addToWindow(registry) {\r\n        ɵglobal['getAngularTestability'] = (elem, findInAncestors = true) => {\r\n            const testability = registry.findTestabilityInTree(elem, findInAncestors);\r\n            if (testability == null) {\r\n                throw new Error('Could not find testability for element.');\r\n            }\r\n            return testability;\r\n        };\r\n        ɵglobal['getAllAngularTestabilities'] = () => registry.getAllTestabilities();\r\n        ɵglobal['getAllAngularRootElements'] = () => registry.getAllRootElements();\r\n        const whenAllStable = (callback /** TODO #9100 */) => {\r\n            const testabilities = ɵglobal['getAllAngularTestabilities']();\r\n            let count = testabilities.length;\r\n            let didWork = false;\r\n            const decrement = function (didWork_ /** TODO #9100 */) {\r\n                didWork = didWork || didWork_;\r\n                count--;\r\n                if (count == 0) {\r\n                    callback(didWork);\r\n                }\r\n            };\r\n            testabilities.forEach(function (testability /** TODO #9100 */) {\r\n                testability.whenStable(decrement);\r\n            });\r\n        };\r\n        if (!ɵglobal['frameworkStabilizers']) {\r\n            ɵglobal['frameworkStabilizers'] = [];\r\n        }\r\n        ɵglobal['frameworkStabilizers'].push(whenAllStable);\r\n    }\r\n    findTestabilityInTree(registry, elem, findInAncestors) {\r\n        if (elem == null) {\r\n            return null;\r\n        }\r\n        const t = registry.getTestability(elem);\r\n        if (t != null) {\r\n            return t;\r\n        }\r\n        else if (!findInAncestors) {\r\n            return null;\r\n        }\r\n        if (ɵgetDOM().isShadowRoot(elem)) {\r\n            return this.findTestabilityInTree(registry, elem.host, true);\r\n        }\r\n        return this.findTestabilityInTree(registry, elem.parentElement, true);\r\n    }\r\n}\r\n\r\n/**\r\n * @license\r\n * Copyright Google LLC All Rights Reserved.\r\n *\r\n * Use of this source code is governed by an MIT-style license that can be\r\n * found in the LICENSE file at https://angular.io/license\r\n */\r\n/**\r\n * A factory for `HttpXhrBackend` that uses the `XMLHttpRequest` browser API.\r\n */\r\nclass BrowserXhr {\r\n    build() {\r\n        return new XMLHttpRequest();\r\n    }\r\n}\r\nBrowserXhr.ɵfac = function BrowserXhr_Factory(t) { return new (t || BrowserXhr)(); };\r\nBrowserXhr.ɵprov = /*@__PURE__*/ ɵngcc0.ɵɵdefineInjectable({ token: BrowserXhr, factory: BrowserXhr.ɵfac });\r\n(function () { (typeof ngDevMode === \"undefined\" || ngDevMode) && ɵngcc0.ɵsetClassMetadata(BrowserXhr, [{\r\n        type: Injectable\r\n    }], null, null); })();\r\n\r\n/**\r\n * @license\r\n * Copyright Google LLC All Rights Reserved.\r\n *\r\n * Use of this source code is governed by an MIT-style license that can be\r\n * found in the LICENSE file at https://angular.io/license\r\n */\r\nconst CAMEL_CASE_REGEXP = /([A-Z])/g;\r\nconst DASH_CASE_REGEXP = /-([a-z])/g;\r\nfunction camelCaseToDashCase(input) {\r\n    return input.replace(CAMEL_CASE_REGEXP, (...m) => '-' + m[1].toLowerCase());\r\n}\r\nfunction dashCaseToCamelCase(input) {\r\n    return input.replace(DASH_CASE_REGEXP, (...m) => m[1].toUpperCase());\r\n}\r\n/**\r\n * Exports the value under a given `name` in the global property `ng`. For example `ng.probe` if\r\n * `name` is `'probe'`.\r\n * @param name Name under which it will be exported. Keep in mind this will be a property of the\r\n * global `ng` object.\r\n * @param value The value to export.\r\n */\r\nfunction exportNgVar(name, value) {\r\n    if (typeof COMPILED === 'undefined' || !COMPILED) {\r\n        // Note: we can't export `ng` when using closure enhanced optimization as:\r\n        // - closure declares globals itself for minified names, which sometimes clobber our `ng` global\r\n        // - we can't declare a closure extern as the namespace `ng` is already used within Google\r\n        //   for typings for angularJS (via `goog.provide('ng....')`).\r\n        const ng = ɵglobal['ng'] = ɵglobal['ng'] || {};\r\n        ng[name] = value;\r\n    }\r\n}\r\n\r\n/**\r\n * @license\r\n * Copyright Google LLC All Rights Reserved.\r\n *\r\n * Use of this source code is governed by an MIT-style license that can be\r\n * found in the LICENSE file at https://angular.io/license\r\n */\r\nconst ɵ0 = () => ({\r\n    'ApplicationRef': ApplicationRef,\r\n    'NgZone': NgZone,\r\n});\r\nconst CORE_TOKENS = (ɵ0)();\r\nconst INSPECT_GLOBAL_NAME = 'probe';\r\nconst CORE_TOKENS_GLOBAL_NAME = 'coreTokens';\r\n/**\r\n * Returns a {@link DebugElement} for the given native DOM element, or\r\n * null if the given native element does not have an Angular view associated\r\n * with it.\r\n */\r\nfunction inspectNativeElementR2(element) {\r\n    return ɵgetDebugNodeR2(element);\r\n}\r\nfunction _createNgProbeR2(coreTokens) {\r\n    exportNgVar(INSPECT_GLOBAL_NAME, inspectNativeElementR2);\r\n    exportNgVar(CORE_TOKENS_GLOBAL_NAME, Object.assign(Object.assign({}, CORE_TOKENS), _ngProbeTokensToMap(coreTokens || [])));\r\n    return () => inspectNativeElementR2;\r\n}\r\nfunction _ngProbeTokensToMap(tokens) {\r\n    return tokens.reduce((prev, t) => (prev[t.name] = t.token, prev), {});\r\n}\r\n/**\r\n * In Ivy, we don't support NgProbe because we have our own set of testing utilities\r\n * with more robust functionality.\r\n *\r\n * We shouldn't bring in NgProbe because it prevents DebugNode and friends from\r\n * tree-shaking properly.\r\n */\r\nconst ELEMENT_PROBE_PROVIDERS__POST_R3__ = [];\r\n/**\r\n * Providers which support debugging Angular applications (e.g. via `ng.probe`).\r\n */\r\nconst ELEMENT_PROBE_PROVIDERS__PRE_R3__ = [\r\n    {\r\n        provide: APP_INITIALIZER,\r\n        useFactory: _createNgProbeR2,\r\n        deps: [\r\n            [NgProbeToken, new Optional()],\r\n        ],\r\n        multi: true,\r\n    },\r\n];\r\nconst ELEMENT_PROBE_PROVIDERS = ELEMENT_PROBE_PROVIDERS__POST_R3__;\r\n\r\n/**\r\n * @license\r\n * Copyright Google LLC All Rights Reserved.\r\n *\r\n * Use of this source code is governed by an MIT-style license that can be\r\n * found in the LICENSE file at https://angular.io/license\r\n */\r\n/**\r\n * The injection token for the event-manager plug-in service.\r\n *\r\n * @publicApi\r\n */\r\nconst EVENT_MANAGER_PLUGINS = new InjectionToken('EventManagerPlugins');\r\n/**\r\n * An injectable service that provides event management for Angular\r\n * through a browser plug-in.\r\n *\r\n * @publicApi\r\n */\r\nclass EventManager {\r\n    /**\r\n     * Initializes an instance of the event-manager service.\r\n     */\r\n    constructor(plugins, _zone) {\r\n        this._zone = _zone;\r\n        this._eventNameToPlugin = new Map();\r\n        plugins.forEach(p => p.manager = this);\r\n        this._plugins = plugins.slice().reverse();\r\n    }\r\n    /**\r\n     * Registers a handler for a specific element and event.\r\n     *\r\n     * @param element The HTML element to receive event notifications.\r\n     * @param eventName The name of the event to listen for.\r\n     * @param handler A function to call when the notification occurs. Receives the\r\n     * event object as an argument.\r\n     * @returns  A callback function that can be used to remove the handler.\r\n     */\r\n    addEventListener(element, eventName, handler) {\r\n        const plugin = this._findPluginFor(eventName);\r\n        return plugin.addEventListener(element, eventName, handler);\r\n    }\r\n    /**\r\n     * Registers a global handler for an event in a target view.\r\n     *\r\n     * @param target A target for global event notifications. One of \"window\", \"document\", or \"body\".\r\n     * @param eventName The name of the event to listen for.\r\n     * @param handler A function to call when the notification occurs. Receives the\r\n     * event object as an argument.\r\n     * @returns A callback function that can be used to remove the handler.\r\n     * @deprecated No longer being used in Ivy code. To be removed in version 14.\r\n     */\r\n    addGlobalEventListener(target, eventName, handler) {\r\n        const plugin = this._findPluginFor(eventName);\r\n        return plugin.addGlobalEventListener(target, eventName, handler);\r\n    }\r\n    /**\r\n     * Retrieves the compilation zone in which event listeners are registered.\r\n     */\r\n    getZone() {\r\n        return this._zone;\r\n    }\r\n    /** @internal */\r\n    _findPluginFor(eventName) {\r\n        const plugin = this._eventNameToPlugin.get(eventName);\r\n        if (plugin) {\r\n            return plugin;\r\n        }\r\n        const plugins = this._plugins;\r\n        for (let i = 0; i < plugins.length; i++) {\r\n            const plugin = plugins[i];\r\n            if (plugin.supports(eventName)) {\r\n                this._eventNameToPlugin.set(eventName, plugin);\r\n                return plugin;\r\n            }\r\n        }\r\n        throw new Error(`No event manager plugin found for event ${eventName}`);\r\n    }\r\n}\r\nEventManager.ɵfac = function EventManager_Factory(t) { return new (t || EventManager)(ɵngcc0.ɵɵinject(EVENT_MANAGER_PLUGINS), ɵngcc0.ɵɵinject(ɵngcc0.NgZone)); };\r\nEventManager.ɵprov = /*@__PURE__*/ ɵngcc0.ɵɵdefineInjectable({ token: EventManager, factory: EventManager.ɵfac });\r\nEventManager.ctorParameters = () => [\r\n    { type: Array, decorators: [{ type: Inject, args: [EVENT_MANAGER_PLUGINS,] }] },\r\n    { type: NgZone }\r\n];\r\n(function () { (typeof ngDevMode === \"undefined\" || ngDevMode) && ɵngcc0.ɵsetClassMetadata(EventManager, [{\r\n        type: Injectable\r\n    }], function () { return [{ type: Array, decorators: [{\r\n                type: Inject,\r\n                args: [EVENT_MANAGER_PLUGINS]\r\n            }] }, { type: ɵngcc0.NgZone }]; }, null); })();\r\nclass EventManagerPlugin {\r\n    constructor(_doc) {\r\n        this._doc = _doc;\r\n    }\r\n    addGlobalEventListener(element, eventName, handler) {\r\n        const target = ɵgetDOM().getGlobalEventTarget(this._doc, element);\r\n        if (!target) {\r\n            throw new Error(`Unsupported event target ${target} for event ${eventName}`);\r\n        }\r\n        return this.addEventListener(target, eventName, handler);\r\n    }\r\n}\r\n\r\n/**\r\n * @license\r\n * Copyright Google LLC All Rights Reserved.\r\n *\r\n * Use of this source code is governed by an MIT-style license that can be\r\n * found in the LICENSE file at https://angular.io/license\r\n */\r\nclass SharedStylesHost {\r\n    constructor() {\r\n        /** @internal */\r\n        this._stylesSet = new Set();\r\n    }\r\n    addStyles(styles) {\r\n        const additions = new Set();\r\n        styles.forEach(style => {\r\n            if (!this._stylesSet.has(style)) {\r\n                this._stylesSet.add(style);\r\n                additions.add(style);\r\n            }\r\n        });\r\n        this.onStylesAdded(additions);\r\n    }\r\n    onStylesAdded(additions) { }\r\n    getAllStyles() {\r\n        return Array.from(this._stylesSet);\r\n    }\r\n}\r\nSharedStylesHost.ɵfac = function SharedStylesHost_Factory(t) { return new (t || SharedStylesHost)(); };\r\nSharedStylesHost.ɵprov = /*@__PURE__*/ ɵngcc0.ɵɵdefineInjectable({ token: SharedStylesHost, factory: SharedStylesHost.ɵfac });\r\n(function () { (typeof ngDevMode === \"undefined\" || ngDevMode) && ɵngcc0.ɵsetClassMetadata(SharedStylesHost, [{\r\n        type: Injectable\r\n    }], function () { return []; }, null); })();\r\nclass DomSharedStylesHost extends SharedStylesHost {\r\n    constructor(_doc) {\r\n        super();\r\n        this._doc = _doc;\r\n        // Maps all registered host nodes to a list of style nodes that have been added to the host node.\r\n        this._hostNodes = new Map();\r\n        this._hostNodes.set(_doc.head, []);\r\n    }\r\n    _addStylesToHost(styles, host, styleNodes) {\r\n        styles.forEach((style) => {\r\n            const styleEl = this._doc.createElement('style');\r\n            styleEl.textContent = style;\r\n            styleNodes.push(host.appendChild(styleEl));\r\n        });\r\n    }\r\n    addHost(hostNode) {\r\n        const styleNodes = [];\r\n        this._addStylesToHost(this._stylesSet, hostNode, styleNodes);\r\n        this._hostNodes.set(hostNode, styleNodes);\r\n    }\r\n    removeHost(hostNode) {\r\n        const styleNodes = this._hostNodes.get(hostNode);\r\n        if (styleNodes) {\r\n            styleNodes.forEach(removeStyle);\r\n        }\r\n        this._hostNodes.delete(hostNode);\r\n    }\r\n    onStylesAdded(additions) {\r\n        this._hostNodes.forEach((styleNodes, hostNode) => {\r\n            this._addStylesToHost(additions, hostNode, styleNodes);\r\n        });\r\n    }\r\n    ngOnDestroy() {\r\n        this._hostNodes.forEach(styleNodes => styleNodes.forEach(removeStyle));\r\n    }\r\n}\r\nDomSharedStylesHost.ɵfac = function DomSharedStylesHost_Factory(t) { return new (t || DomSharedStylesHost)(ɵngcc0.ɵɵinject(DOCUMENT)); };\r\nDomSharedStylesHost.ɵprov = /*@__PURE__*/ ɵngcc0.ɵɵdefineInjectable({ token: DomSharedStylesHost, factory: DomSharedStylesHost.ɵfac });\r\nDomSharedStylesHost.ctorParameters = () => [\r\n    { type: undefined, decorators: [{ type: Inject, args: [DOCUMENT,] }] }\r\n];\r\n(function () { (typeof ngDevMode === \"undefined\" || ngDevMode) && ɵngcc0.ɵsetClassMetadata(DomSharedStylesHost, [{\r\n        type: Injectable\r\n    }], function () { return [{ type: undefined, decorators: [{\r\n                type: Inject,\r\n                args: [DOCUMENT]\r\n            }] }]; }, null); })();\r\nfunction removeStyle(styleNode) {\r\n    ɵgetDOM().remove(styleNode);\r\n}\r\n\r\n/**\r\n * @license\r\n * Copyright Google LLC All Rights Reserved.\r\n *\r\n * Use of this source code is governed by an MIT-style license that can be\r\n * found in the LICENSE file at https://angular.io/license\r\n */\r\nconst NAMESPACE_URIS = {\r\n    'svg': 'http://www.w3.org/2000/svg',\r\n    'xhtml': 'http://www.w3.org/1999/xhtml',\r\n    'xlink': 'http://www.w3.org/1999/xlink',\r\n    'xml': 'http://www.w3.org/XML/1998/namespace',\r\n    'xmlns': 'http://www.w3.org/2000/xmlns/',\r\n};\r\nconst COMPONENT_REGEX = /%COMP%/g;\r\nconst NG_DEV_MODE = typeof ngDevMode === 'undefined' || !!ngDevMode;\r\nconst COMPONENT_VARIABLE = '%COMP%';\r\nconst HOST_ATTR = `_nghost-${COMPONENT_VARIABLE}`;\r\nconst CONTENT_ATTR = `_ngcontent-${COMPONENT_VARIABLE}`;\r\nfunction shimContentAttribute(componentShortId) {\r\n    return CONTENT_ATTR.replace(COMPONENT_REGEX, componentShortId);\r\n}\r\nfunction shimHostAttribute(componentShortId) {\r\n    return HOST_ATTR.replace(COMPONENT_REGEX, componentShortId);\r\n}\r\nfunction flattenStyles(compId, styles, target) {\r\n    for (let i = 0; i < styles.length; i++) {\r\n        let style = styles[i];\r\n        if (Array.isArray(style)) {\r\n            flattenStyles(compId, style, target);\r\n        }\r\n        else {\r\n            style = style.replace(COMPONENT_REGEX, compId);\r\n            target.push(style);\r\n        }\r\n    }\r\n    return target;\r\n}\r\nfunction decoratePreventDefault(eventHandler) {\r\n    // `DebugNode.triggerEventHandler` needs to know if the listener was created with\r\n    // decoratePreventDefault or is a listener added outside the Angular context so it can handle the\r\n    // two differently. In the first case, the special '__ngUnwrap__' token is passed to the unwrap\r\n    // the listener (see below).\r\n    return (event) => {\r\n        // Ivy uses '__ngUnwrap__' as a special token that allows us to unwrap the function\r\n        // so that it can be invoked programmatically by `DebugNode.triggerEventHandler`. The debug_node\r\n        // can inspect the listener toString contents for the existence of this special token. Because\r\n        // the token is a string literal, it is ensured to not be modified by compiled code.\r\n        if (event === '__ngUnwrap__') {\r\n            return eventHandler;\r\n        }\r\n        const allowDefaultBehavior = eventHandler(event);\r\n        if (allowDefaultBehavior === false) {\r\n            // TODO(tbosch): move preventDefault into event plugins...\r\n            event.preventDefault();\r\n            event.returnValue = false;\r\n        }\r\n        return undefined;\r\n    };\r\n}\r\nlet hasLoggedNativeEncapsulationWarning = false;\r\nclass DomRendererFactory2 {\r\n    constructor(eventManager, sharedStylesHost, appId) {\r\n        this.eventManager = eventManager;\r\n        this.sharedStylesHost = sharedStylesHost;\r\n        this.appId = appId;\r\n        this.rendererByCompId = new Map();\r\n        this.defaultRenderer = new DefaultDomRenderer2(eventManager);\r\n    }\r\n    createRenderer(element, type) {\r\n        if (!element || !type) {\r\n            return this.defaultRenderer;\r\n        }\r\n        switch (type.encapsulation) {\r\n            case ViewEncapsulation.Emulated: {\r\n                let renderer = this.rendererByCompId.get(type.id);\r\n                if (!renderer) {\r\n                    renderer = new EmulatedEncapsulationDomRenderer2(this.eventManager, this.sharedStylesHost, type, this.appId);\r\n                    this.rendererByCompId.set(type.id, renderer);\r\n                }\r\n                renderer.applyToHost(element);\r\n                return renderer;\r\n            }\r\n            // @ts-ignore TODO: Remove as part of FW-2290. TS complains about us dealing with an enum\r\n            // value that is not known (but previously was the value for ViewEncapsulation.Native)\r\n            case 1:\r\n            case ViewEncapsulation.ShadowDom:\r\n                // TODO(FW-2290): remove the `case 1:` fallback logic and the warning in v12.\r\n                if ((typeof ngDevMode === 'undefined' || ngDevMode) &&\r\n                    // @ts-ignore TODO: Remove as part of FW-2290. TS complains about us dealing with an\r\n                    // enum value that is not known (but previously was the value for\r\n                    // ViewEncapsulation.Native)\r\n                    !hasLoggedNativeEncapsulationWarning && type.encapsulation === 1) {\r\n                    hasLoggedNativeEncapsulationWarning = true;\r\n                    console.warn('ViewEncapsulation.Native is no longer supported. Falling back to ViewEncapsulation.ShadowDom. The fallback will be removed in v12.');\r\n                }\r\n                return new ShadowDomRenderer(this.eventManager, this.sharedStylesHost, element, type);\r\n            default: {\r\n                if (!this.rendererByCompId.has(type.id)) {\r\n                    const styles = flattenStyles(type.id, type.styles, []);\r\n                    this.sharedStylesHost.addStyles(styles);\r\n                    this.rendererByCompId.set(type.id, this.defaultRenderer);\r\n                }\r\n                return this.defaultRenderer;\r\n            }\r\n        }\r\n    }\r\n    begin() { }\r\n    end() { }\r\n}\r\nDomRendererFactory2.ɵfac = function DomRendererFactory2_Factory(t) { return new (t || DomRendererFactory2)(ɵngcc0.ɵɵinject(EventManager), ɵngcc0.ɵɵinject(DomSharedStylesHost), ɵngcc0.ɵɵinject(APP_ID)); };\r\nDomRendererFactory2.ɵprov = /*@__PURE__*/ ɵngcc0.ɵɵdefineInjectable({ token: DomRendererFactory2, factory: DomRendererFactory2.ɵfac });\r\nDomRendererFactory2.ctorParameters = () => [\r\n    { type: EventManager },\r\n    { type: DomSharedStylesHost },\r\n    { type: String, decorators: [{ type: Inject, args: [APP_ID,] }] }\r\n];\r\n(function () { (typeof ngDevMode === \"undefined\" || ngDevMode) && ɵngcc0.ɵsetClassMetadata(DomRendererFactory2, [{\r\n        type: Injectable\r\n    }], function () { return [{ type: EventManager }, { type: DomSharedStylesHost }, { type: String, decorators: [{\r\n                type: Inject,\r\n                args: [APP_ID]\r\n            }] }]; }, null); })();\r\nclass DefaultDomRenderer2 {\r\n    constructor(eventManager) {\r\n        this.eventManager = eventManager;\r\n        this.data = Object.create(null);\r\n    }\r\n    destroy() { }\r\n    createElement(name, namespace) {\r\n        if (namespace) {\r\n            // In cases where Ivy (not ViewEngine) is giving us the actual namespace, the look up by key\r\n            // will result in undefined, so we just return the namespace here.\r\n            return document.createElementNS(NAMESPACE_URIS[namespace] || namespace, name);\r\n        }\r\n        return document.createElement(name);\r\n    }\r\n    createComment(value) {\r\n        return document.createComment(value);\r\n    }\r\n    createText(value) {\r\n        return document.createTextNode(value);\r\n    }\r\n    appendChild(parent, newChild) {\r\n        parent.appendChild(newChild);\r\n    }\r\n    insertBefore(parent, newChild, refChild) {\r\n        if (parent) {\r\n            parent.insertBefore(newChild, refChild);\r\n        }\r\n    }\r\n    removeChild(parent, oldChild) {\r\n        if (parent) {\r\n            parent.removeChild(oldChild);\r\n        }\r\n    }\r\n    selectRootElement(selectorOrNode, preserveContent) {\r\n        let el = typeof selectorOrNode === 'string' ? document.querySelector(selectorOrNode) :\r\n            selectorOrNode;\r\n        if (!el) {\r\n            throw new Error(`The selector \"${selectorOrNode}\" did not match any elements`);\r\n        }\r\n        if (!preserveContent) {\r\n            el.textContent = '';\r\n        }\r\n        return el;\r\n    }\r\n    parentNode(node) {\r\n        return node.parentNode;\r\n    }\r\n    nextSibling(node) {\r\n        return node.nextSibling;\r\n    }\r\n    setAttribute(el, name, value, namespace) {\r\n        if (namespace) {\r\n            name = namespace + ':' + name;\r\n            // TODO(FW-811): Ivy may cause issues here because it's passing around\r\n            // full URIs for namespaces, therefore this lookup will fail.\r\n            const namespaceUri = NAMESPACE_URIS[namespace];\r\n            if (namespaceUri) {\r\n                el.setAttributeNS(namespaceUri, name, value);\r\n            }\r\n            else {\r\n                el.setAttribute(name, value);\r\n            }\r\n        }\r\n        else {\r\n            el.setAttribute(name, value);\r\n        }\r\n    }\r\n    removeAttribute(el, name, namespace) {\r\n        if (namespace) {\r\n            // TODO(FW-811): Ivy may cause issues here because it's passing around\r\n            // full URIs for namespaces, therefore this lookup will fail.\r\n            const namespaceUri = NAMESPACE_URIS[namespace];\r\n            if (namespaceUri) {\r\n                el.removeAttributeNS(namespaceUri, name);\r\n            }\r\n            else {\r\n                // TODO(FW-811): Since ivy is passing around full URIs for namespaces\r\n                // this could result in properties like `http://www.w3.org/2000/svg:cx=\"123\"`,\r\n                // which is wrong.\r\n                el.removeAttribute(`${namespace}:${name}`);\r\n            }\r\n        }\r\n        else {\r\n            el.removeAttribute(name);\r\n        }\r\n    }\r\n    addClass(el, name) {\r\n        el.classList.add(name);\r\n    }\r\n    removeClass(el, name) {\r\n        el.classList.remove(name);\r\n    }\r\n    setStyle(el, style, value, flags) {\r\n        if (flags & (RendererStyleFlags2.DashCase | RendererStyleFlags2.Important)) {\r\n            el.style.setProperty(style, value, flags & RendererStyleFlags2.Important ? 'important' : '');\r\n        }\r\n        else {\r\n            el.style[style] = value;\r\n        }\r\n    }\r\n    removeStyle(el, style, flags) {\r\n        if (flags & RendererStyleFlags2.DashCase) {\r\n            el.style.removeProperty(style);\r\n        }\r\n        else {\r\n            // IE requires '' instead of null\r\n            // see https://github.com/angular/angular/issues/7916\r\n            el.style[style] = '';\r\n        }\r\n    }\r\n    setProperty(el, name, value) {\r\n        NG_DEV_MODE && checkNoSyntheticProp(name, 'property');\r\n        el[name] = value;\r\n    }\r\n    setValue(node, value) {\r\n        node.nodeValue = value;\r\n    }\r\n    listen(target, event, callback) {\r\n        NG_DEV_MODE && checkNoSyntheticProp(event, 'listener');\r\n        if (typeof target === 'string') {\r\n            return this.eventManager.addGlobalEventListener(target, event, decoratePreventDefault(callback));\r\n        }\r\n        return this.eventManager.addEventListener(target, event, decoratePreventDefault(callback));\r\n    }\r\n}\r\nconst ɵ0$1 = () => '@'.charCodeAt(0);\r\nconst AT_CHARCODE = (ɵ0$1)();\r\nfunction checkNoSyntheticProp(name, nameKind) {\r\n    if (name.charCodeAt(0) === AT_CHARCODE) {\r\n        throw new Error(`Found the synthetic ${nameKind} ${name}. Please include either \"BrowserAnimationsModule\" or \"NoopAnimationsModule\" in your application.`);\r\n    }\r\n}\r\nclass EmulatedEncapsulationDomRenderer2 extends DefaultDomRenderer2 {\r\n    constructor(eventManager, sharedStylesHost, component, appId) {\r\n        super(eventManager);\r\n        this.component = component;\r\n        const styles = flattenStyles(appId + '-' + component.id, component.styles, []);\r\n        sharedStylesHost.addStyles(styles);\r\n        this.contentAttr = shimContentAttribute(appId + '-' + component.id);\r\n        this.hostAttr = shimHostAttribute(appId + '-' + component.id);\r\n    }\r\n    applyToHost(element) {\r\n        super.setAttribute(element, this.hostAttr, '');\r\n    }\r\n    createElement(parent, name) {\r\n        const el = super.createElement(parent, name);\r\n        super.setAttribute(el, this.contentAttr, '');\r\n        return el;\r\n    }\r\n}\r\nclass ShadowDomRenderer extends DefaultDomRenderer2 {\r\n    constructor(eventManager, sharedStylesHost, hostEl, component) {\r\n        super(eventManager);\r\n        this.sharedStylesHost = sharedStylesHost;\r\n        this.hostEl = hostEl;\r\n        this.shadowRoot = hostEl.attachShadow({ mode: 'open' });\r\n        this.sharedStylesHost.addHost(this.shadowRoot);\r\n        const styles = flattenStyles(component.id, component.styles, []);\r\n        for (let i = 0; i < styles.length; i++) {\r\n            const styleEl = document.createElement('style');\r\n            styleEl.textContent = styles[i];\r\n            this.shadowRoot.appendChild(styleEl);\r\n        }\r\n    }\r\n    nodeOrShadowRoot(node) {\r\n        return node === this.hostEl ? this.shadowRoot : node;\r\n    }\r\n    destroy() {\r\n        this.sharedStylesHost.removeHost(this.shadowRoot);\r\n    }\r\n    appendChild(parent, newChild) {\r\n        return super.appendChild(this.nodeOrShadowRoot(parent), newChild);\r\n    }\r\n    insertBefore(parent, newChild, refChild) {\r\n        return super.insertBefore(this.nodeOrShadowRoot(parent), newChild, refChild);\r\n    }\r\n    removeChild(parent, oldChild) {\r\n        return super.removeChild(this.nodeOrShadowRoot(parent), oldChild);\r\n    }\r\n    parentNode(node) {\r\n        return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(node)));\r\n    }\r\n}\r\n\r\n/**\r\n * @license\r\n * Copyright Google LLC All Rights Reserved.\r\n *\r\n * Use of this source code is governed by an MIT-style license that can be\r\n * found in the LICENSE file at https://angular.io/license\r\n */\r\nclass DomEventsPlugin extends EventManagerPlugin {\r\n    constructor(doc) {\r\n        super(doc);\r\n    }\r\n    // This plugin should come last in the list of plugins, because it accepts all\r\n    // events.\r\n    supports(eventName) {\r\n        return true;\r\n    }\r\n    addEventListener(element, eventName, handler) {\r\n        element.addEventListener(eventName, handler, false);\r\n        return () => this.removeEventListener(element, eventName, handler);\r\n    }\r\n    removeEventListener(target, eventName, callback) {\r\n        return target.removeEventListener(eventName, callback);\r\n    }\r\n}\r\nDomEventsPlugin.ɵfac = function DomEventsPlugin_Factory(t) { return new (t || DomEventsPlugin)(ɵngcc0.ɵɵinject(DOCUMENT)); };\r\nDomEventsPlugin.ɵprov = /*@__PURE__*/ ɵngcc0.ɵɵdefineInjectable({ token: DomEventsPlugin, factory: DomEventsPlugin.ɵfac });\r\nDomEventsPlugin.ctorParameters = () => [\r\n    { type: undefined, decorators: [{ type: Inject, args: [DOCUMENT,] }] }\r\n];\r\n(function () { (typeof ngDevMode === \"undefined\" || ngDevMode) && ɵngcc0.ɵsetClassMetadata(DomEventsPlugin, [{\r\n        type: Injectable\r\n    }], function () { return [{ type: undefined, decorators: [{\r\n                type: Inject,\r\n                args: [DOCUMENT]\r\n            }] }]; }, null); })();\r\n\r\n/**\r\n * @license\r\n * Copyright Google LLC All Rights Reserved.\r\n *\r\n * Use of this source code is governed by an MIT-style license that can be\r\n * found in the LICENSE file at https://angular.io/license\r\n */\r\n/**\r\n * Supported HammerJS recognizer event names.\r\n */\r\nconst EVENT_NAMES = {\r\n    // pan\r\n    'pan': true,\r\n    'panstart': true,\r\n    'panmove': true,\r\n    'panend': true,\r\n    'pancancel': true,\r\n    'panleft': true,\r\n    'panright': true,\r\n    'panup': true,\r\n    'pandown': true,\r\n    // pinch\r\n    'pinch': true,\r\n    'pinchstart': true,\r\n    'pinchmove': true,\r\n    'pinchend': true,\r\n    'pinchcancel': true,\r\n    'pinchin': true,\r\n    'pinchout': true,\r\n    // press\r\n    'press': true,\r\n    'pressup': true,\r\n    // rotate\r\n    'rotate': true,\r\n    'rotatestart': true,\r\n    'rotatemove': true,\r\n    'rotateend': true,\r\n    'rotatecancel': true,\r\n    // swipe\r\n    'swipe': true,\r\n    'swipeleft': true,\r\n    'swiperight': true,\r\n    'swipeup': true,\r\n    'swipedown': true,\r\n    // tap\r\n    'tap': true,\r\n    'doubletap': true\r\n};\r\n/**\r\n * DI token for providing [HammerJS](https://hammerjs.github.io/) support to Angular.\r\n * @see `HammerGestureConfig`\r\n *\r\n * @ngModule HammerModule\r\n * @publicApi\r\n */\r\nconst HAMMER_GESTURE_CONFIG = new InjectionToken('HammerGestureConfig');\r\n/**\r\n * Injection token used to provide a {@link HammerLoader} to Angular.\r\n *\r\n * @publicApi\r\n */\r\nconst HAMMER_LOADER = new InjectionToken('HammerLoader');\r\n/**\r\n * An injectable [HammerJS Manager](https://hammerjs.github.io/api/#hammermanager)\r\n * for gesture recognition. Configures specific event recognition.\r\n * @publicApi\r\n */\r\nclass HammerGestureConfig {\r\n    constructor() {\r\n        /**\r\n         * A set of supported event names for gestures to be used in Angular.\r\n         * Angular supports all built-in recognizers, as listed in\r\n         * [HammerJS documentation](https://hammerjs.github.io/).\r\n         */\r\n        this.events = [];\r\n        /**\r\n         * Maps gesture event names to a set of configuration options\r\n         * that specify overrides to the default values for specific properties.\r\n         *\r\n         * The key is a supported event name to be configured,\r\n         * and the options object contains a set of properties, with override values\r\n         * to be applied to the named recognizer event.\r\n         * For example, to disable recognition of the rotate event, specify\r\n         *  `{\"rotate\": {\"enable\": false}}`.\r\n         *\r\n         * Properties that are not present take the HammerJS default values.\r\n         * For information about which properties are supported for which events,\r\n         * and their allowed and default values, see\r\n         * [HammerJS documentation](https://hammerjs.github.io/).\r\n         *\r\n         */\r\n        this.overrides = {};\r\n    }\r\n    /**\r\n     * Creates a [HammerJS Manager](https://hammerjs.github.io/api/#hammermanager)\r\n     * and attaches it to a given HTML element.\r\n     * @param element The element that will recognize gestures.\r\n     * @returns A HammerJS event-manager object.\r\n     */\r\n    buildHammer(element) {\r\n        const mc = new Hammer(element, this.options);\r\n        mc.get('pinch').set({ enable: true });\r\n        mc.get('rotate').set({ enable: true });\r\n        for (const eventName in this.overrides) {\r\n            mc.get(eventName).set(this.overrides[eventName]);\r\n        }\r\n        return mc;\r\n    }\r\n}\r\nHammerGestureConfig.ɵfac = function HammerGestureConfig_Factory(t) { return new (t || HammerGestureConfig)(); };\r\nHammerGestureConfig.ɵprov = /*@__PURE__*/ ɵngcc0.ɵɵdefineInjectable({ token: HammerGestureConfig, factory: HammerGestureConfig.ɵfac });\r\n(function () { (typeof ngDevMode === \"undefined\" || ngDevMode) && ɵngcc0.ɵsetClassMetadata(HammerGestureConfig, [{\r\n        type: Injectable\r\n    }], function () { return []; }, null); })();\r\n/**\r\n * Event plugin that adds Hammer support to an application.\r\n *\r\n * @ngModule HammerModule\r\n */\r\nclass HammerGesturesPlugin extends EventManagerPlugin {\r\n    constructor(doc, _config, console, loader) {\r\n        super(doc);\r\n        this._config = _config;\r\n        this.console = console;\r\n        this.loader = loader;\r\n        this._loaderPromise = null;\r\n    }\r\n    supports(eventName) {\r\n        if (!EVENT_NAMES.hasOwnProperty(eventName.toLowerCase()) && !this.isCustomEvent(eventName)) {\r\n            return false;\r\n        }\r\n        if (!window.Hammer && !this.loader) {\r\n            if (typeof ngDevMode === 'undefined' || ngDevMode) {\r\n                this.console.warn(`The \"${eventName}\" event cannot be bound because Hammer.JS is not ` +\r\n                    `loaded and no custom loader has been specified.`);\r\n            }\r\n            return false;\r\n        }\r\n        return true;\r\n    }\r\n    addEventListener(element, eventName, handler) {\r\n        const zone = this.manager.getZone();\r\n        eventName = eventName.toLowerCase();\r\n        // If Hammer is not present but a loader is specified, we defer adding the event listener\r\n        // until Hammer is loaded.\r\n        if (!window.Hammer && this.loader) {\r\n            this._loaderPromise = this._loaderPromise || this.loader();\r\n            // This `addEventListener` method returns a function to remove the added listener.\r\n            // Until Hammer is loaded, the returned function needs to *cancel* the registration rather\r\n            // than remove anything.\r\n            let cancelRegistration = false;\r\n            let deregister = () => {\r\n                cancelRegistration = true;\r\n            };\r\n            this._loaderPromise\r\n                .then(() => {\r\n                // If Hammer isn't actually loaded when the custom loader resolves, give up.\r\n                if (!window.Hammer) {\r\n                    if (typeof ngDevMode === 'undefined' || ngDevMode) {\r\n                        this.console.warn(`The custom HAMMER_LOADER completed, but Hammer.JS is not present.`);\r\n                    }\r\n                    deregister = () => { };\r\n                    return;\r\n                }\r\n                if (!cancelRegistration) {\r\n                    // Now that Hammer is loaded and the listener is being loaded for real,\r\n                    // the deregistration function changes from canceling registration to removal.\r\n                    deregister = this.addEventListener(element, eventName, handler);\r\n                }\r\n            })\r\n                .catch(() => {\r\n                if (typeof ngDevMode === 'undefined' || ngDevMode) {\r\n                    this.console.warn(`The \"${eventName}\" event cannot be bound because the custom ` +\r\n                        `Hammer.JS loader failed.`);\r\n                }\r\n                deregister = () => { };\r\n            });\r\n            // Return a function that *executes* `deregister` (and not `deregister` itself) so that we\r\n            // can change the behavior of `deregister` once the listener is added. Using a closure in\r\n            // this way allows us to avoid any additional data structures to track listener removal.\r\n            return () => {\r\n                deregister();\r\n            };\r\n        }\r\n        return zone.runOutsideAngular(() => {\r\n            // Creating the manager bind events, must be done outside of angular\r\n            const mc = this._config.buildHammer(element);\r\n            const callback = function (eventObj) {\r\n                zone.runGuarded(function () {\r\n                    handler(eventObj);\r\n                });\r\n            };\r\n            mc.on(eventName, callback);\r\n            return () => {\r\n                mc.off(eventName, callback);\r\n                // destroy mc to prevent memory leak\r\n                if (typeof mc.destroy === 'function') {\r\n                    mc.destroy();\r\n                }\r\n            };\r\n        });\r\n    }\r\n    isCustomEvent(eventName) {\r\n        return this._config.events.indexOf(eventName) > -1;\r\n    }\r\n}\r\nHammerGesturesPlugin.ɵfac = function HammerGesturesPlugin_Factory(t) { return new (t || HammerGesturesPlugin)(ɵngcc0.ɵɵinject(DOCUMENT), ɵngcc0.ɵɵinject(HAMMER_GESTURE_CONFIG), ɵngcc0.ɵɵinject(ɵngcc0.ɵConsole), ɵngcc0.ɵɵinject(HAMMER_LOADER, 8)); };\r\nHammerGesturesPlugin.ɵprov = /*@__PURE__*/ ɵngcc0.ɵɵdefineInjectable({ token: HammerGesturesPlugin, factory: HammerGesturesPlugin.ɵfac });\r\nHammerGesturesPlugin.ctorParameters = () => [\r\n    { type: undefined, decorators: [{ type: Inject, args: [DOCUMENT,] }] },\r\n    { type: HammerGestureConfig, decorators: [{ type: Inject, args: [HAMMER_GESTURE_CONFIG,] }] },\r\n    { type: ɵConsole },\r\n    { type: undefined, decorators: [{ type: Optional }, { type: Inject, args: [HAMMER_LOADER,] }] }\r\n];\r\n(function () { (typeof ngDevMode === \"undefined\" || ngDevMode) && ɵngcc0.ɵsetClassMetadata(HammerGesturesPlugin, [{\r\n        type: Injectable\r\n    }], function () { return [{ type: undefined, decorators: [{\r\n                type: Inject,\r\n                args: [DOCUMENT]\r\n            }] }, { type: HammerGestureConfig, decorators: [{\r\n                type: Inject,\r\n                args: [HAMMER_GESTURE_CONFIG]\r\n            }] }, { type: ɵngcc0.ɵConsole }, { type: undefined, decorators: [{\r\n                type: Optional\r\n            }, {\r\n                type: Inject,\r\n                args: [HAMMER_LOADER]\r\n            }] }]; }, null); })();\r\n/**\r\n * In Ivy, support for Hammer gestures is optional, so applications must\r\n * import the `HammerModule` at root to turn on support. This means that\r\n * Hammer-specific code can be tree-shaken away if not needed.\r\n */\r\nconst HAMMER_PROVIDERS__POST_R3__ = [];\r\n/**\r\n * In View Engine, support for Hammer gestures is built-in by default.\r\n */\r\nconst HAMMER_PROVIDERS__PRE_R3__ = [\r\n    {\r\n        provide: EVENT_MANAGER_PLUGINS,\r\n        useClass: HammerGesturesPlugin,\r\n        multi: true,\r\n        deps: [DOCUMENT, HAMMER_GESTURE_CONFIG, ɵConsole, [new Optional(), HAMMER_LOADER]]\r\n    },\r\n    { provide: HAMMER_GESTURE_CONFIG, useClass: HammerGestureConfig, deps: [] },\r\n];\r\nconst HAMMER_PROVIDERS = HAMMER_PROVIDERS__POST_R3__;\r\n/**\r\n * Adds support for HammerJS.\r\n *\r\n * Import this module at the root of your application so that Angular can work with\r\n * HammerJS to detect gesture events.\r\n *\r\n * Note that applications still need to include the HammerJS script itself. This module\r\n * simply sets up the coordination layer between HammerJS and Angular's EventManager.\r\n *\r\n * @publicApi\r\n */\r\nclass HammerModule {\r\n}\r\nHammerModule.ɵfac = function HammerModule_Factory(t) { return new (t || HammerModule)(); };\r\nHammerModule.ɵmod = /*@__PURE__*/ ɵngcc0.ɵɵdefineNgModule({ type: HammerModule });\r\nHammerModule.ɵinj = /*@__PURE__*/ ɵngcc0.ɵɵdefineInjector({ providers: HAMMER_PROVIDERS__PRE_R3__ });\r\n(function () { (typeof ngDevMode === \"undefined\" || ngDevMode) && ɵngcc0.ɵsetClassMetadata(HammerModule, [{\r\n        type: NgModule,\r\n        args: [{ providers: HAMMER_PROVIDERS__PRE_R3__ }]\r\n    }], null, null); })();\r\n\r\n/**\r\n * @license\r\n * Copyright Google LLC All Rights Reserved.\r\n *\r\n * Use of this source code is governed by an MIT-style license that can be\r\n * found in the LICENSE file at https://angular.io/license\r\n */\r\n/**\r\n * Defines supported modifiers for key events.\r\n */\r\nconst MODIFIER_KEYS = ['alt', 'control', 'meta', 'shift'];\r\nconst DOM_KEY_LOCATION_NUMPAD = 3;\r\n// Map to convert some key or keyIdentifier values to what will be returned by getEventKey\r\nconst _keyMap = {\r\n    // The following values are here for cross-browser compatibility and to match the W3C standard\r\n    // cf https://www.w3.org/TR/DOM-Level-3-Events-key/\r\n    '\\b': 'Backspace',\r\n    '\\t': 'Tab',\r\n    '\\x7F': 'Delete',\r\n    '\\x1B': 'Escape',\r\n    'Del': 'Delete',\r\n    'Esc': 'Escape',\r\n    'Left': 'ArrowLeft',\r\n    'Right': 'ArrowRight',\r\n    'Up': 'ArrowUp',\r\n    'Down': 'ArrowDown',\r\n    'Menu': 'ContextMenu',\r\n    'Scroll': 'ScrollLock',\r\n    'Win': 'OS'\r\n};\r\n// There is a bug in Chrome for numeric keypad keys:\r\n// https://code.google.com/p/chromium/issues/detail?id=155654\r\n// 1, 2, 3 ... are reported as A, B, C ...\r\nconst _chromeNumKeyPadMap = {\r\n    'A': '1',\r\n    'B': '2',\r\n    'C': '3',\r\n    'D': '4',\r\n    'E': '5',\r\n    'F': '6',\r\n    'G': '7',\r\n    'H': '8',\r\n    'I': '9',\r\n    'J': '*',\r\n    'K': '+',\r\n    'M': '-',\r\n    'N': '.',\r\n    'O': '/',\r\n    '\\x60': '0',\r\n    '\\x90': 'NumLock'\r\n};\r\nconst ɵ0$2 = (event) => event.altKey, ɵ1 = (event) => event.ctrlKey, ɵ2 = (event) => event.metaKey, ɵ3 = (event) => event.shiftKey;\r\n/**\r\n * Retrieves modifiers from key-event objects.\r\n */\r\nconst MODIFIER_KEY_GETTERS = {\r\n    'alt': ɵ0$2,\r\n    'control': ɵ1,\r\n    'meta': ɵ2,\r\n    'shift': ɵ3\r\n};\r\n/**\r\n * @publicApi\r\n * A browser plug-in that provides support for handling of key events in Angular.\r\n */\r\nclass KeyEventsPlugin extends EventManagerPlugin {\r\n    /**\r\n     * Initializes an instance of the browser plug-in.\r\n     * @param doc The document in which key events will be detected.\r\n     */\r\n    constructor(doc) {\r\n        super(doc);\r\n    }\r\n    /**\r\n     * Reports whether a named key event is supported.\r\n     * @param eventName The event name to query.\r\n     * @return True if the named key event is supported.\r\n     */\r\n    supports(eventName) {\r\n        return KeyEventsPlugin.parseEventName(eventName) != null;\r\n    }\r\n    /**\r\n     * Registers a handler for a specific element and key event.\r\n     * @param element The HTML element to receive event notifications.\r\n     * @param eventName The name of the key event to listen for.\r\n     * @param handler A function to call when the notification occurs. Receives the\r\n     * event object as an argument.\r\n     * @returns The key event that was registered.\r\n     */\r\n    addEventListener(element, eventName, handler) {\r\n        const parsedEvent = KeyEventsPlugin.parseEventName(eventName);\r\n        const outsideHandler = KeyEventsPlugin.eventCallback(parsedEvent['fullKey'], handler, this.manager.getZone());\r\n        return this.manager.getZone().runOutsideAngular(() => {\r\n            return ɵgetDOM().onAndCancel(element, parsedEvent['domEventName'], outsideHandler);\r\n        });\r\n    }\r\n    static parseEventName(eventName) {\r\n        const parts = eventName.toLowerCase().split('.');\r\n        const domEventName = parts.shift();\r\n        if ((parts.length === 0) || !(domEventName === 'keydown' || domEventName === 'keyup')) {\r\n            return null;\r\n        }\r\n        const key = KeyEventsPlugin._normalizeKey(parts.pop());\r\n        let fullKey = '';\r\n        MODIFIER_KEYS.forEach(modifierName => {\r\n            const index = parts.indexOf(modifierName);\r\n            if (index > -1) {\r\n                parts.splice(index, 1);\r\n                fullKey += modifierName + '.';\r\n            }\r\n        });\r\n        fullKey += key;\r\n        if (parts.length != 0 || key.length === 0) {\r\n            // returning null instead of throwing to let another plugin process the event\r\n            return null;\r\n        }\r\n        // NOTE: Please don't rewrite this as so, as it will break JSCompiler property renaming.\r\n        //       The code must remain in the `result['domEventName']` form.\r\n        // return {domEventName, fullKey};\r\n        const result = {};\r\n        result['domEventName'] = domEventName;\r\n        result['fullKey'] = fullKey;\r\n        return result;\r\n    }\r\n    static getEventFullKey(event) {\r\n        let fullKey = '';\r\n        let key = getEventKey(event);\r\n        key = key.toLowerCase();\r\n        if (key === ' ') {\r\n            key = 'space'; // for readability\r\n        }\r\n        else if (key === '.') {\r\n            key = 'dot'; // because '.' is used as a separator in event names\r\n        }\r\n        MODIFIER_KEYS.forEach(modifierName => {\r\n            if (modifierName != key) {\r\n                const modifierGetter = MODIFIER_KEY_GETTERS[modifierName];\r\n                if (modifierGetter(event)) {\r\n                    fullKey += modifierName + '.';\r\n                }\r\n            }\r\n        });\r\n        fullKey += key;\r\n        return fullKey;\r\n    }\r\n    /**\r\n     * Configures a handler callback for a key event.\r\n     * @param fullKey The event name that combines all simultaneous keystrokes.\r\n     * @param handler The function that responds to the key event.\r\n     * @param zone The zone in which the event occurred.\r\n     * @returns A callback function.\r\n     */\r\n    static eventCallback(fullKey, handler, zone) {\r\n        return (event /** TODO #9100 */) => {\r\n            if (KeyEventsPlugin.getEventFullKey(event) === fullKey) {\r\n                zone.runGuarded(() => handler(event));\r\n            }\r\n        };\r\n    }\r\n    /** @internal */\r\n    static _normalizeKey(keyName) {\r\n        // TODO: switch to a Map if the mapping grows too much\r\n        switch (keyName) {\r\n            case 'esc':\r\n                return 'escape';\r\n            default:\r\n                return keyName;\r\n        }\r\n    }\r\n}\r\nKeyEventsPlugin.ɵfac = function KeyEventsPlugin_Factory(t) { return new (t || KeyEventsPlugin)(ɵngcc0.ɵɵinject(DOCUMENT)); };\r\nKeyEventsPlugin.ɵprov = /*@__PURE__*/ ɵngcc0.ɵɵdefineInjectable({ token: KeyEventsPlugin, factory: KeyEventsPlugin.ɵfac });\r\nKeyEventsPlugin.ctorParameters = () => [\r\n    { type: undefined, decorators: [{ type: Inject, args: [DOCUMENT,] }] }\r\n];\r\n(function () { (typeof ngDevMode === \"undefined\" || ngDevMode) && ɵngcc0.ɵsetClassMetadata(KeyEventsPlugin, [{\r\n        type: Injectable\r\n    }], function () { return [{ type: undefined, decorators: [{\r\n                type: Inject,\r\n                args: [DOCUMENT]\r\n            }] }]; }, null); })();\r\nfunction getEventKey(event) {\r\n    let key = event.key;\r\n    if (key == null) {\r\n        key = event.keyIdentifier;\r\n        // keyIdentifier is defined in the old draft of DOM Level 3 Events implemented by Chrome and\r\n        // Safari cf\r\n        // https://www.w3.org/TR/2007/WD-DOM-Level-3-Events-20071221/events.html#Events-KeyboardEvents-Interfaces\r\n        if (key == null) {\r\n            return 'Unidentified';\r\n        }\r\n        if (key.startsWith('U+')) {\r\n            key = String.fromCharCode(parseInt(key.substring(2), 16));\r\n            if (event.location === DOM_KEY_LOCATION_NUMPAD && _chromeNumKeyPadMap.hasOwnProperty(key)) {\r\n                // There is a bug in Chrome for numeric keypad keys:\r\n                // https://code.google.com/p/chromium/issues/detail?id=155654\r\n                // 1, 2, 3 ... are reported as A, B, C ...\r\n                key = _chromeNumKeyPadMap[key];\r\n            }\r\n        }\r\n    }\r\n    return _keyMap[key] || key;\r\n}\r\n\r\n/**\r\n * @license\r\n * Copyright Google LLC All Rights Reserved.\r\n *\r\n * Use of this source code is governed by an MIT-style license that can be\r\n * found in the LICENSE file at https://angular.io/license\r\n */\r\n/**\r\n * DomSanitizer helps preventing Cross Site Scripting Security bugs (XSS) by sanitizing\r\n * values to be safe to use in the different DOM contexts.\r\n *\r\n * For example, when binding a URL in an `<a [href]=\"someValue\">` hyperlink, `someValue` will be\r\n * sanitized so that an attacker cannot inject e.g. a `javascript:` URL that would execute code on\r\n * the website.\r\n *\r\n * In specific situations, it might be necessary to disable sanitization, for example if the\r\n * application genuinely needs to produce a `javascript:` style link with a dynamic value in it.\r\n * Users can bypass security by constructing a value with one of the `bypassSecurityTrust...`\r\n * methods, and then binding to that value from the template.\r\n *\r\n * These situations should be very rare, and extraordinary care must be taken to avoid creating a\r\n * Cross Site Scripting (XSS) security bug!\r\n *\r\n * When using `bypassSecurityTrust...`, make sure to call the method as early as possible and as\r\n * close as possible to the source of the value, to make it easy to verify no security bug is\r\n * created by its use.\r\n *\r\n * It is not required (and not recommended) to bypass security if the value is safe, e.g. a URL that\r\n * does not start with a suspicious protocol, or an HTML snippet that does not contain dangerous\r\n * code. The sanitizer leaves safe values intact.\r\n *\r\n * @security Calling any of the `bypassSecurityTrust...` APIs disables Angular's built-in\r\n * sanitization for the value passed in. Carefully check and audit all values and code paths going\r\n * into this call. Make sure any user data is appropriately escaped for this security context.\r\n * For more detail, see the [Security Guide](https://g.co/ng/security).\r\n *\r\n * @publicApi\r\n */\r\nclass DomSanitizer {\r\n}\r\nDomSanitizer.ɵfac = function DomSanitizer_Factory(t) { return new (t || DomSanitizer)(); };\r\nDomSanitizer.ɵprov = ɵɵdefineInjectable({ factory: function DomSanitizer_Factory() { return ɵɵinject(DomSanitizerImpl); }, token: DomSanitizer, providedIn: \"root\" });\r\n(function () { (typeof ngDevMode === \"undefined\" || ngDevMode) && ɵngcc0.ɵsetClassMetadata(DomSanitizer, [{\r\n        type: Injectable,\r\n        args: [{ providedIn: 'root', useExisting: forwardRef(() => DomSanitizerImpl) }]\r\n    }], null, null); })();\r\nfunction domSanitizerImplFactory(injector) {\r\n    return new DomSanitizerImpl(injector.get(DOCUMENT));\r\n}\r\nclass DomSanitizerImpl extends DomSanitizer {\r\n    constructor(_doc) {\r\n        super();\r\n        this._doc = _doc;\r\n    }\r\n    sanitize(ctx, value) {\r\n        if (value == null)\r\n            return null;\r\n        switch (ctx) {\r\n            case SecurityContext.NONE:\r\n                return value;\r\n            case SecurityContext.HTML:\r\n                if (ɵallowSanitizationBypassAndThrow(value, \"HTML\" /* Html */)) {\r\n                    return ɵunwrapSafeValue(value);\r\n                }\r\n                return ɵ_sanitizeHtml(this._doc, String(value)).toString();\r\n            case SecurityContext.STYLE:\r\n                if (ɵallowSanitizationBypassAndThrow(value, \"Style\" /* Style */)) {\r\n                    return ɵunwrapSafeValue(value);\r\n                }\r\n                return value;\r\n            case SecurityContext.SCRIPT:\r\n                if (ɵallowSanitizationBypassAndThrow(value, \"Script\" /* Script */)) {\r\n                    return ɵunwrapSafeValue(value);\r\n                }\r\n                throw new Error('unsafe value used in a script context');\r\n            case SecurityContext.URL:\r\n                const type = ɵgetSanitizationBypassType(value);\r\n                if (ɵallowSanitizationBypassAndThrow(value, \"URL\" /* Url */)) {\r\n                    return ɵunwrapSafeValue(value);\r\n                }\r\n                return ɵ_sanitizeUrl(String(value));\r\n            case SecurityContext.RESOURCE_URL:\r\n                if (ɵallowSanitizationBypassAndThrow(value, \"ResourceURL\" /* ResourceUrl */)) {\r\n                    return ɵunwrapSafeValue(value);\r\n                }\r\n                throw new Error('unsafe value used in a resource URL context (see https://g.co/ng/security#xss)');\r\n            default:\r\n                throw new Error(`Unexpected SecurityContext ${ctx} (see https://g.co/ng/security#xss)`);\r\n        }\r\n    }\r\n    bypassSecurityTrustHtml(value) {\r\n        return ɵbypassSanitizationTrustHtml(value);\r\n    }\r\n    bypassSecurityTrustStyle(value) {\r\n        return ɵbypassSanitizationTrustStyle(value);\r\n    }\r\n    bypassSecurityTrustScript(value) {\r\n        return ɵbypassSanitizationTrustScript(value);\r\n    }\r\n    bypassSecurityTrustUrl(value) {\r\n        return ɵbypassSanitizationTrustUrl(value);\r\n    }\r\n    bypassSecurityTrustResourceUrl(value) {\r\n        return ɵbypassSanitizationTrustResourceUrl(value);\r\n    }\r\n}\r\nDomSanitizerImpl.ɵfac = function DomSanitizerImpl_Factory(t) { return new (t || DomSanitizerImpl)(ɵngcc0.ɵɵinject(DOCUMENT)); };\r\nDomSanitizerImpl.ɵprov = ɵɵdefineInjectable({ factory: function DomSanitizerImpl_Factory() { return domSanitizerImplFactory(ɵɵinject(INJECTOR)); }, token: DomSanitizerImpl, providedIn: \"root\" });\r\nDomSanitizerImpl.ctorParameters = () => [\r\n    { type: undefined, decorators: [{ type: Inject, args: [DOCUMENT,] }] }\r\n];\r\n(function () { (typeof ngDevMode === \"undefined\" || ngDevMode) && ɵngcc0.ɵsetClassMetadata(DomSanitizerImpl, [{\r\n        type: Injectable,\r\n        args: [{ providedIn: 'root', useFactory: domSanitizerImplFactory, deps: [Injector] }]\r\n    }], function () { return [{ type: undefined, decorators: [{\r\n                type: Inject,\r\n                args: [DOCUMENT]\r\n            }] }]; }, null); })();\r\n\r\n/**\r\n * @license\r\n * Copyright Google LLC All Rights Reserved.\r\n *\r\n * Use of this source code is governed by an MIT-style license that can be\r\n * found in the LICENSE file at https://angular.io/license\r\n */\r\nfunction initDomAdapter() {\r\n    BrowserDomAdapter.makeCurrent();\r\n    BrowserGetTestability.init();\r\n}\r\nfunction errorHandler() {\r\n    return new ErrorHandler();\r\n}\r\nfunction _document() {\r\n    // Tell ivy about the global document\r\n    ɵsetDocument(document);\r\n    return document;\r\n}\r\nconst ɵ0$3 = ɵPLATFORM_BROWSER_ID;\r\nconst INTERNAL_BROWSER_PLATFORM_PROVIDERS = [\r\n    { provide: PLATFORM_ID, useValue: ɵ0$3 },\r\n    { provide: PLATFORM_INITIALIZER, useValue: initDomAdapter, multi: true },\r\n    { provide: DOCUMENT, useFactory: _document, deps: [] },\r\n];\r\nconst BROWSER_SANITIZATION_PROVIDERS__PRE_R3__ = [\r\n    { provide: Sanitizer, useExisting: DomSanitizer },\r\n    { provide: DomSanitizer, useClass: DomSanitizerImpl, deps: [DOCUMENT] },\r\n];\r\nconst BROWSER_SANITIZATION_PROVIDERS__POST_R3__ = [];\r\n/**\r\n * @security Replacing built-in sanitization providers exposes the application to XSS risks.\r\n * Attacker-controlled data introduced by an unsanitized provider could expose your\r\n * application to XSS risks. For more detail, see the [Security Guide](https://g.co/ng/security).\r\n * @publicApi\r\n */\r\nconst BROWSER_SANITIZATION_PROVIDERS = BROWSER_SANITIZATION_PROVIDERS__POST_R3__;\r\n/**\r\n * A factory function that returns a `PlatformRef` instance associated with browser service\r\n * providers.\r\n *\r\n * @publicApi\r\n */\r\nconst platformBrowser = createPlatformFactory(platformCore, 'browser', INTERNAL_BROWSER_PLATFORM_PROVIDERS);\r\nconst BROWSER_MODULE_PROVIDERS = [\r\n    BROWSER_SANITIZATION_PROVIDERS,\r\n    { provide: ɵINJECTOR_SCOPE, useValue: 'root' },\r\n    { provide: ErrorHandler, useFactory: errorHandler, deps: [] },\r\n    {\r\n        provide: EVENT_MANAGER_PLUGINS,\r\n        useClass: DomEventsPlugin,\r\n        multi: true,\r\n        deps: [DOCUMENT, NgZone, PLATFORM_ID]\r\n    },\r\n    { provide: EVENT_MANAGER_PLUGINS, useClass: KeyEventsPlugin, multi: true, deps: [DOCUMENT] },\r\n    HAMMER_PROVIDERS,\r\n    {\r\n        provide: DomRendererFactory2,\r\n        useClass: DomRendererFactory2,\r\n        deps: [EventManager, DomSharedStylesHost, APP_ID]\r\n    },\r\n    { provide: RendererFactory2, useExisting: DomRendererFactory2 },\r\n    { provide: SharedStylesHost, useExisting: DomSharedStylesHost },\r\n    { provide: DomSharedStylesHost, useClass: DomSharedStylesHost, deps: [DOCUMENT] },\r\n    { provide: Testability, useClass: Testability, deps: [NgZone] },\r\n    { provide: EventManager, useClass: EventManager, deps: [EVENT_MANAGER_PLUGINS, NgZone] },\r\n    { provide: XhrFactory, useClass: BrowserXhr, deps: [] },\r\n    ELEMENT_PROBE_PROVIDERS,\r\n];\r\n/**\r\n * Exports required infrastructure for all Angular apps.\r\n * Included by default in all Angular apps created with the CLI\r\n * `new` command.\r\n * Re-exports `CommonModule` and `ApplicationModule`, making their\r\n * exports and providers available to all apps.\r\n *\r\n * @publicApi\r\n */\r\nclass BrowserModule {\r\n    constructor(parentModule) {\r\n        if (parentModule) {\r\n            throw new Error(`BrowserModule has already been loaded. If you need access to common directives such as NgIf and NgFor from a lazy loaded module, import CommonModule instead.`);\r\n        }\r\n    }\r\n    /**\r\n     * Configures a browser-based app to transition from a server-rendered app, if\r\n     * one is present on the page.\r\n     *\r\n     * @param params An object containing an identifier for the app to transition.\r\n     * The ID must match between the client and server versions of the app.\r\n     * @returns The reconfigured `BrowserModule` to import into the app's root `AppModule`.\r\n     */\r\n    static withServerTransition(params) {\r\n        return {\r\n            ngModule: BrowserModule,\r\n            providers: [\r\n                { provide: APP_ID, useValue: params.appId },\r\n                { provide: TRANSITION_ID, useExisting: APP_ID },\r\n                SERVER_TRANSITION_PROVIDERS,\r\n            ],\r\n        };\r\n    }\r\n}\r\nBrowserModule.ɵfac = function BrowserModule_Factory(t) { return new (t || BrowserModule)(ɵngcc0.ɵɵinject(BrowserModule, 12)); };\r\nBrowserModule.ɵmod = /*@__PURE__*/ ɵngcc0.ɵɵdefineNgModule({ type: BrowserModule });\r\nBrowserModule.ɵinj = /*@__PURE__*/ ɵngcc0.ɵɵdefineInjector({ providers: BROWSER_MODULE_PROVIDERS, imports: [CommonModule, ApplicationModule] });\r\nBrowserModule.ctorParameters = () => [\r\n    { type: BrowserModule, decorators: [{ type: Optional }, { type: SkipSelf }, { type: Inject, args: [BrowserModule,] }] }\r\n];\r\n(function () { (typeof ngDevMode === \"undefined\" || ngDevMode) && ɵngcc0.ɵsetClassMetadata(BrowserModule, [{\r\n        type: NgModule,\r\n        args: [{ providers: BROWSER_MODULE_PROVIDERS, exports: [CommonModule, ApplicationModule] }]\r\n    }], function () { return [{ type: BrowserModule, decorators: [{\r\n                type: Optional\r\n            }, {\r\n                type: SkipSelf\r\n            }, {\r\n                type: Inject,\r\n                args: [BrowserModule]\r\n            }] }]; }, null); })();\r\n(function () { (typeof ngJitMode === \"undefined\" || ngJitMode) && ɵngcc0.ɵɵsetNgModuleScope(BrowserModule, { exports: function () { return [CommonModule, ApplicationModule]; } }); })();\r\n\r\n/**\r\n * @license\r\n * Copyright Google LLC All Rights Reserved.\r\n *\r\n * Use of this source code is governed by an MIT-style license that can be\r\n * found in the LICENSE file at https://angular.io/license\r\n */\r\n/**\r\n * Factory to create a `Meta` service instance for the current DOM document.\r\n */\r\nfunction createMeta() {\r\n    return new Meta(ɵɵinject(DOCUMENT));\r\n}\r\n/**\r\n * A service for managing HTML `<meta>` tags.\r\n *\r\n * Properties of the `MetaDefinition` object match the attributes of the\r\n * HTML `<meta>` tag. These tags define document metadata that is important for\r\n * things like configuring a Content Security Policy, defining browser compatibility\r\n * and security settings, setting HTTP Headers, defining rich content for social sharing,\r\n * and Search Engine Optimization (SEO).\r\n *\r\n * To identify specific `<meta>` tags in a document, use an attribute selection\r\n * string in the format `\"tag_attribute='value string'\"`.\r\n * For example, an `attrSelector` value of `\"name='description'\"` matches a tag\r\n * whose `name` attribute has the value `\"description\"`.\r\n * Selectors are used with the `querySelector()` Document method,\r\n * in the format `meta[{attrSelector}]`.\r\n *\r\n * @see [HTML meta tag](https://developer.mozilla.org/docs/Web/HTML/Element/meta)\r\n * @see [Document.querySelector()](https://developer.mozilla.org/docs/Web/API/Document/querySelector)\r\n *\r\n *\r\n * @publicApi\r\n */\r\nclass Meta {\r\n    constructor(_doc) {\r\n        this._doc = _doc;\r\n        this._dom = ɵgetDOM();\r\n    }\r\n    /**\r\n     * Retrieves or creates a specific `<meta>` tag element in the current HTML document.\r\n     * In searching for an existing tag, Angular attempts to match the `name` or `property` attribute\r\n     * values in the provided tag definition, and verifies that all other attribute values are equal.\r\n     * If an existing element is found, it is returned and is not modified in any way.\r\n     * @param tag The definition of a `<meta>` element to match or create.\r\n     * @param forceCreation True to create a new element without checking whether one already exists.\r\n     * @returns The existing element with the same attributes and values if found,\r\n     * the new element if no match is found, or `null` if the tag parameter is not defined.\r\n     */\r\n    addTag(tag, forceCreation = false) {\r\n        if (!tag)\r\n            return null;\r\n        return this._getOrCreateElement(tag, forceCreation);\r\n    }\r\n    /**\r\n     * Retrieves or creates a set of `<meta>` tag elements in the current HTML document.\r\n     * In searching for an existing tag, Angular attempts to match the `name` or `property` attribute\r\n     * values in the provided tag definition, and verifies that all other attribute values are equal.\r\n     * @param tags An array of tag definitions to match or create.\r\n     * @param forceCreation True to create new elements without checking whether they already exist.\r\n     * @returns The matching elements if found, or the new elements.\r\n     */\r\n    addTags(tags, forceCreation = false) {\r\n        if (!tags)\r\n            return [];\r\n        return tags.reduce((result, tag) => {\r\n            if (tag) {\r\n                result.push(this._getOrCreateElement(tag, forceCreation));\r\n            }\r\n            return result;\r\n        }, []);\r\n    }\r\n    /**\r\n     * Retrieves a `<meta>` tag element in the current HTML document.\r\n     * @param attrSelector The tag attribute and value to match against, in the format\r\n     * `\"tag_attribute='value string'\"`.\r\n     * @returns The matching element, if any.\r\n     */\r\n    getTag(attrSelector) {\r\n        if (!attrSelector)\r\n            return null;\r\n        return this._doc.querySelector(`meta[${attrSelector}]`) || null;\r\n    }\r\n    /**\r\n     * Retrieves a set of `<meta>` tag elements in the current HTML document.\r\n     * @param attrSelector The tag attribute and value to match against, in the format\r\n     * `\"tag_attribute='value string'\"`.\r\n     * @returns The matching elements, if any.\r\n     */\r\n    getTags(attrSelector) {\r\n        if (!attrSelector)\r\n            return [];\r\n        const list /*NodeList*/ = this._doc.querySelectorAll(`meta[${attrSelector}]`);\r\n        return list ? [].slice.call(list) : [];\r\n    }\r\n    /**\r\n     * Modifies an existing `<meta>` tag element in the current HTML document.\r\n     * @param tag The tag description with which to replace the existing tag content.\r\n     * @param selector A tag attribute and value to match against, to identify\r\n     * an existing tag. A string in the format `\"tag_attribute=`value string`\"`.\r\n     * If not supplied, matches a tag with the same `name` or `property` attribute value as the\r\n     * replacement tag.\r\n     * @return The modified element.\r\n     */\r\n    updateTag(tag, selector) {\r\n        if (!tag)\r\n            return null;\r\n        selector = selector || this._parseSelector(tag);\r\n        const meta = this.getTag(selector);\r\n        if (meta) {\r\n            return this._setMetaElementAttributes(tag, meta);\r\n        }\r\n        return this._getOrCreateElement(tag, true);\r\n    }\r\n    /**\r\n     * Removes an existing `<meta>` tag element from the current HTML document.\r\n     * @param attrSelector A tag attribute and value to match against, to identify\r\n     * an existing tag. A string in the format `\"tag_attribute=`value string`\"`.\r\n     */\r\n    removeTag(attrSelector) {\r\n        this.removeTagElement(this.getTag(attrSelector));\r\n    }\r\n    /**\r\n     * Removes an existing `<meta>` tag element from the current HTML document.\r\n     * @param meta The tag definition to match against to identify an existing tag.\r\n     */\r\n    removeTagElement(meta) {\r\n        if (meta) {\r\n            this._dom.remove(meta);\r\n        }\r\n    }\r\n    _getOrCreateElement(meta, forceCreation = false) {\r\n        if (!forceCreation) {\r\n            const selector = this._parseSelector(meta);\r\n            const elem = this.getTag(selector);\r\n            // It's allowed to have multiple elements with the same name so it's not enough to\r\n            // just check that element with the same name already present on the page. We also need to\r\n            // check if element has tag attributes\r\n            if (elem && this._containsAttributes(meta, elem))\r\n                return elem;\r\n        }\r\n        const element = this._dom.createElement('meta');\r\n        this._setMetaElementAttributes(meta, element);\r\n        const head = this._doc.getElementsByTagName('head')[0];\r\n        head.appendChild(element);\r\n        return element;\r\n    }\r\n    _setMetaElementAttributes(tag, el) {\r\n        Object.keys(tag).forEach((prop) => el.setAttribute(this._getMetaKeyMap(prop), tag[prop]));\r\n        return el;\r\n    }\r\n    _parseSelector(tag) {\r\n        const attr = tag.name ? 'name' : 'property';\r\n        return `${attr}=\"${tag[attr]}\"`;\r\n    }\r\n    _containsAttributes(tag, elem) {\r\n        return Object.keys(tag).every((key) => elem.getAttribute(this._getMetaKeyMap(key)) === tag[key]);\r\n    }\r\n    _getMetaKeyMap(prop) {\r\n        return META_KEYS_MAP[prop] || prop;\r\n    }\r\n}\r\nMeta.ɵfac = function Meta_Factory(t) { return new (t || Meta)(ɵngcc0.ɵɵinject(DOCUMENT)); };\r\nMeta.ɵprov = ɵɵdefineInjectable({ factory: createMeta, token: Meta, providedIn: \"root\" });\r\nMeta.ctorParameters = () => [\r\n    { type: undefined, decorators: [{ type: Inject, args: [DOCUMENT,] }] }\r\n];\r\n(function () { (typeof ngDevMode === \"undefined\" || ngDevMode) && ɵngcc0.ɵsetClassMetadata(Meta, [{\r\n        type: Injectable,\r\n        args: [{ providedIn: 'root', useFactory: createMeta, deps: [] }]\r\n    }], function () { return [{ type: undefined, decorators: [{\r\n                type: Inject,\r\n                args: [DOCUMENT]\r\n            }] }]; }, null); })();\r\n/**\r\n * Mapping for MetaDefinition properties with their correct meta attribute names\r\n */\r\nconst META_KEYS_MAP = {\r\n    httpEquiv: 'http-equiv'\r\n};\r\n\r\n/**\r\n * @license\r\n * Copyright Google LLC All Rights Reserved.\r\n *\r\n * Use of this source code is governed by an MIT-style license that can be\r\n * found in the LICENSE file at https://angular.io/license\r\n */\r\n/**\r\n * Factory to create Title service.\r\n */\r\nfunction createTitle() {\r\n    return new Title(ɵɵinject(DOCUMENT));\r\n}\r\n/**\r\n * A service that can be used to get and set the title of a current HTML document.\r\n *\r\n * Since an Angular application can't be bootstrapped on the entire HTML document (`<html>` tag)\r\n * it is not possible to bind to the `text` property of the `HTMLTitleElement` elements\r\n * (representing the `<title>` tag). Instead, this service can be used to set and get the current\r\n * title value.\r\n *\r\n * @publicApi\r\n */\r\nclass Title {\r\n    constructor(_doc) {\r\n        this._doc = _doc;\r\n    }\r\n    /**\r\n     * Get the title of the current HTML document.\r\n     */\r\n    getTitle() {\r\n        return this._doc.title;\r\n    }\r\n    /**\r\n     * Set the title of the current HTML document.\r\n     * @param newTitle\r\n     */\r\n    setTitle(newTitle) {\r\n        this._doc.title = newTitle || '';\r\n    }\r\n}\r\nTitle.ɵfac = function Title_Factory(t) { return new (t || Title)(ɵngcc0.ɵɵinject(DOCUMENT)); };\r\nTitle.ɵprov = ɵɵdefineInjectable({ factory: createTitle, token: Title, providedIn: \"root\" });\r\nTitle.ctorParameters = () => [\r\n    { type: undefined, decorators: [{ type: Inject, args: [DOCUMENT,] }] }\r\n];\r\n(function () { (typeof ngDevMode === \"undefined\" || ngDevMode) && ɵngcc0.ɵsetClassMetadata(Title, [{\r\n        type: Injectable,\r\n        args: [{ providedIn: 'root', useFactory: createTitle, deps: [] }]\r\n    }], function () { return [{ type: undefined, decorators: [{\r\n                type: Inject,\r\n                args: [DOCUMENT]\r\n            }] }]; }, null); })();\r\n\r\n/**\r\n * @license\r\n * Copyright Google LLC All Rights Reserved.\r\n *\r\n * Use of this source code is governed by an MIT-style license that can be\r\n * found in the LICENSE file at https://angular.io/license\r\n */\r\nconst win = typeof window !== 'undefined' && window || {};\r\n\r\n/**\r\n * @license\r\n * Copyright Google LLC All Rights Reserved.\r\n *\r\n * Use of this source code is governed by an MIT-style license that can be\r\n * found in the LICENSE file at https://angular.io/license\r\n */\r\nclass ChangeDetectionPerfRecord {\r\n    constructor(msPerTick, numTicks) {\r\n        this.msPerTick = msPerTick;\r\n        this.numTicks = numTicks;\r\n    }\r\n}\r\n/**\r\n * Entry point for all Angular profiling-related debug tools. This object\r\n * corresponds to the `ng.profiler` in the dev console.\r\n */\r\nclass AngularProfiler {\r\n    constructor(ref) {\r\n        this.appRef = ref.injector.get(ApplicationRef);\r\n    }\r\n    // tslint:disable:no-console\r\n    /**\r\n     * Exercises change detection in a loop and then prints the average amount of\r\n     * time in milliseconds how long a single round of change detection takes for\r\n     * the current state of the UI. It runs a minimum of 5 rounds for a minimum\r\n     * of 500 milliseconds.\r\n     *\r\n     * Optionally, a user may pass a `config` parameter containing a map of\r\n     * options. Supported options are:\r\n     *\r\n     * `record` (boolean) - causes the profiler to record a CPU profile while\r\n     * it exercises the change detector. Example:\r\n     *\r\n     * ```\r\n     * ng.profiler.timeChangeDetection({record: true})\r\n     * ```\r\n     */\r\n    timeChangeDetection(config) {\r\n        const record = config && config['record'];\r\n        const profileName = 'Change Detection';\r\n        // Profiler is not available in Android browsers without dev tools opened\r\n        const isProfilerAvailable = win.console.profile != null;\r\n        if (record && isProfilerAvailable) {\r\n            win.console.profile(profileName);\r\n        }\r\n        const start = performanceNow();\r\n        let numTicks = 0;\r\n        while (numTicks < 5 || (performanceNow() - start) < 500) {\r\n            this.appRef.tick();\r\n            numTicks++;\r\n        }\r\n        const end = performanceNow();\r\n        if (record && isProfilerAvailable) {\r\n            win.console.profileEnd(profileName);\r\n        }\r\n        const msPerTick = (end - start) / numTicks;\r\n        win.console.log(`ran ${numTicks} change detection cycles`);\r\n        win.console.log(`${msPerTick.toFixed(2)} ms per check`);\r\n        return new ChangeDetectionPerfRecord(msPerTick, numTicks);\r\n    }\r\n}\r\nfunction performanceNow() {\r\n    return win.performance && win.performance.now ? win.performance.now() :\r\n        new Date().getTime();\r\n}\r\n\r\n/**\r\n * @license\r\n * Copyright Google LLC All Rights Reserved.\r\n *\r\n * Use of this source code is governed by an MIT-style license that can be\r\n * found in the LICENSE file at https://angular.io/license\r\n */\r\nconst PROFILER_GLOBAL_NAME = 'profiler';\r\n/**\r\n * Enabled Angular debug tools that are accessible via your browser's\r\n * developer console.\r\n *\r\n * Usage:\r\n *\r\n * 1. Open developer console (e.g. in Chrome Ctrl + Shift + j)\r\n * 1. Type `ng.` (usually the console will show auto-complete suggestion)\r\n * 1. Try the change detection profiler `ng.profiler.timeChangeDetection()`\r\n *    then hit Enter.\r\n *\r\n * @publicApi\r\n */\r\nfunction enableDebugTools(ref) {\r\n    exportNgVar(PROFILER_GLOBAL_NAME, new AngularProfiler(ref));\r\n    return ref;\r\n}\r\n/**\r\n * Disables Angular tools.\r\n *\r\n * @publicApi\r\n */\r\nfunction disableDebugTools() {\r\n    exportNgVar(PROFILER_GLOBAL_NAME, null);\r\n}\r\n\r\n/**\r\n * @license\r\n * Copyright Google LLC All Rights Reserved.\r\n *\r\n * Use of this source code is governed by an MIT-style license that can be\r\n * found in the LICENSE file at https://angular.io/license\r\n */\r\nfunction escapeHtml(text) {\r\n    const escapedText = {\r\n        '&': '&a;',\r\n        '\"': '&q;',\r\n        '\\'': '&s;',\r\n        '<': '&l;',\r\n        '>': '&g;',\r\n    };\r\n    return text.replace(/[&\"'<>]/g, s => escapedText[s]);\r\n}\r\nfunction unescapeHtml(text) {\r\n    const unescapedText = {\r\n        '&a;': '&',\r\n        '&q;': '\"',\r\n        '&s;': '\\'',\r\n        '&l;': '<',\r\n        '&g;': '>',\r\n    };\r\n    return text.replace(/&[^;]+;/g, s => unescapedText[s]);\r\n}\r\n/**\r\n * Create a `StateKey<T>` that can be used to store value of type T with `TransferState`.\r\n *\r\n * Example:\r\n *\r\n * ```\r\n * const COUNTER_KEY = makeStateKey<number>('counter');\r\n * let value = 10;\r\n *\r\n * transferState.set(COUNTER_KEY, value);\r\n * ```\r\n *\r\n * @publicApi\r\n */\r\nfunction makeStateKey(key) {\r\n    return key;\r\n}\r\n/**\r\n * A key value store that is transferred from the application on the server side to the application\r\n * on the client side.\r\n *\r\n * `TransferState` will be available as an injectable token. To use it import\r\n * `ServerTransferStateModule` on the server and `BrowserTransferStateModule` on the client.\r\n *\r\n * The values in the store are serialized/deserialized using JSON.stringify/JSON.parse. So only\r\n * boolean, number, string, null and non-class objects will be serialized and deserialized in a\r\n * non-lossy manner.\r\n *\r\n * @publicApi\r\n */\r\nclass TransferState {\r\n    constructor() {\r\n        this.store = {};\r\n        this.onSerializeCallbacks = {};\r\n    }\r\n    /** @internal */\r\n    static init(initState) {\r\n        const transferState = new TransferState();\r\n        transferState.store = initState;\r\n        return transferState;\r\n    }\r\n    /**\r\n     * Get the value corresponding to a key. Return `defaultValue` if key is not found.\r\n     */\r\n    get(key, defaultValue) {\r\n        return this.store[key] !== undefined ? this.store[key] : defaultValue;\r\n    }\r\n    /**\r\n     * Set the value corresponding to a key.\r\n     */\r\n    set(key, value) {\r\n        this.store[key] = value;\r\n    }\r\n    /**\r\n     * Remove a key from the store.\r\n     */\r\n    remove(key) {\r\n        delete this.store[key];\r\n    }\r\n    /**\r\n     * Test whether a key exists in the store.\r\n     */\r\n    hasKey(key) {\r\n        return this.store.hasOwnProperty(key);\r\n    }\r\n    /**\r\n     * Register a callback to provide the value for a key when `toJson` is called.\r\n     */\r\n    onSerialize(key, callback) {\r\n        this.onSerializeCallbacks[key] = callback;\r\n    }\r\n    /**\r\n     * Serialize the current state of the store to JSON.\r\n     */\r\n    toJson() {\r\n        // Call the onSerialize callbacks and put those values into the store.\r\n        for (const key in this.onSerializeCallbacks) {\r\n            if (this.onSerializeCallbacks.hasOwnProperty(key)) {\r\n                try {\r\n                    this.store[key] = this.onSerializeCallbacks[key]();\r\n                }\r\n                catch (e) {\r\n                    console.warn('Exception in onSerialize callback: ', e);\r\n                }\r\n            }\r\n        }\r\n        return JSON.stringify(this.store);\r\n    }\r\n}\r\nTransferState.ɵfac = function TransferState_Factory(t) { return new (t || TransferState)(); };\r\nTransferState.ɵprov = /*@__PURE__*/ ɵngcc0.ɵɵdefineInjectable({ token: TransferState, factory: TransferState.ɵfac });\r\n(function () { (typeof ngDevMode === \"undefined\" || ngDevMode) && ɵngcc0.ɵsetClassMetadata(TransferState, [{\r\n        type: Injectable\r\n    }], function () { return []; }, null); })();\r\nfunction initTransferState(doc, appId) {\r\n    // Locate the script tag with the JSON data transferred from the server.\r\n    // The id of the script tag is set to the Angular appId + 'state'.\r\n    const script = doc.getElementById(appId + '-state');\r\n    let initialState = {};\r\n    if (script && script.textContent) {\r\n        try {\r\n            // Avoid using any here as it triggers lint errors in google3 (any is not allowed).\r\n            initialState = JSON.parse(unescapeHtml(script.textContent));\r\n        }\r\n        catch (e) {\r\n            console.warn('Exception while restoring TransferState for app ' + appId, e);\r\n        }\r\n    }\r\n    return TransferState.init(initialState);\r\n}\r\n/**\r\n * NgModule to install on the client side while using the `TransferState` to transfer state from\r\n * server to client.\r\n *\r\n * @publicApi\r\n */\r\nclass BrowserTransferStateModule {\r\n}\r\nBrowserTransferStateModule.ɵfac = function BrowserTransferStateModule_Factory(t) { return new (t || BrowserTransferStateModule)(); };\r\nBrowserTransferStateModule.ɵmod = /*@__PURE__*/ ɵngcc0.ɵɵdefineNgModule({ type: BrowserTransferStateModule });\r\nBrowserTransferStateModule.ɵinj = /*@__PURE__*/ ɵngcc0.ɵɵdefineInjector({ providers: [{ provide: TransferState, useFactory: initTransferState, deps: [DOCUMENT, APP_ID] }] });\r\n(function () { (typeof ngDevMode === \"undefined\" || ngDevMode) && ɵngcc0.ɵsetClassMetadata(BrowserTransferStateModule, [{\r\n        type: NgModule,\r\n        args: [{\r\n                providers: [{ provide: TransferState, useFactory: initTransferState, deps: [DOCUMENT, APP_ID] }]\r\n            }]\r\n    }], null, null); })();\r\n\r\n/**\r\n * @license\r\n * Copyright Google LLC All Rights Reserved.\r\n *\r\n * Use of this source code is governed by an MIT-style license that can be\r\n * found in the LICENSE file at https://angular.io/license\r\n */\r\n/**\r\n * Predicates for use with {@link DebugElement}'s query functions.\r\n *\r\n * @publicApi\r\n */\r\nclass By {\r\n    /**\r\n     * Match all nodes.\r\n     *\r\n     * @usageNotes\r\n     * ### Example\r\n     *\r\n     * {@example platform-browser/dom/debug/ts/by/by.ts region='by_all'}\r\n     */\r\n    static all() {\r\n        return () => true;\r\n    }\r\n    /**\r\n     * Match elements by the given CSS selector.\r\n     *\r\n     * @usageNotes\r\n     * ### Example\r\n     *\r\n     * {@example platform-browser/dom/debug/ts/by/by.ts region='by_css'}\r\n     */\r\n    static css(selector) {\r\n        return (debugElement) => {\r\n            return debugElement.nativeElement != null ?\r\n                elementMatches(debugElement.nativeElement, selector) :\r\n                false;\r\n        };\r\n    }\r\n    /**\r\n     * Match nodes that have the given directive present.\r\n     *\r\n     * @usageNotes\r\n     * ### Example\r\n     *\r\n     * {@example platform-browser/dom/debug/ts/by/by.ts region='by_directive'}\r\n     */\r\n    static directive(type) {\r\n        return (debugNode) => debugNode.providerTokens.indexOf(type) !== -1;\r\n    }\r\n}\r\nfunction elementMatches(n, selector) {\r\n    if (ɵgetDOM().isElementNode(n)) {\r\n        return n.matches && n.matches(selector) ||\r\n            n.msMatchesSelector && n.msMatchesSelector(selector) ||\r\n            n.webkitMatchesSelector && n.webkitMatchesSelector(selector);\r\n    }\r\n    return false;\r\n}\r\n\r\n/**\r\n * @license\r\n * Copyright Google LLC All Rights Reserved.\r\n *\r\n * Use of this source code is governed by an MIT-style license that can be\r\n * found in the LICENSE file at https://angular.io/license\r\n */\r\n\r\n/**\r\n * @license\r\n * Copyright Google LLC All Rights Reserved.\r\n *\r\n * Use of this source code is governed by an MIT-style license that can be\r\n * found in the LICENSE file at https://angular.io/license\r\n */\r\n/**\r\n * @publicApi\r\n */\r\nconst VERSION = new Version('12.1.0');\r\n\r\n/**\r\n * @license\r\n * Copyright Google LLC All Rights Reserved.\r\n *\r\n * Use of this source code is governed by an MIT-style license that can be\r\n * found in the LICENSE file at https://angular.io/license\r\n */\r\n\r\n/**\r\n * @license\r\n * Copyright Google LLC All Rights Reserved.\r\n *\r\n * Use of this source code is governed by an MIT-style license that can be\r\n * found in the LICENSE file at https://angular.io/license\r\n */\r\n// This file only reexports content of the `src` folder. Keep it that way.\r\n\r\n/**\r\n * @license\r\n * Copyright Google LLC All Rights Reserved.\r\n *\r\n * Use of this source code is governed by an MIT-style license that can be\r\n * found in the LICENSE file at https://angular.io/license\r\n */\r\n\r\n/**\r\n * Generated bundle index. Do not edit.\r\n */\r\n\r\nexport { BrowserModule, BrowserTransferStateModule, By, DomSanitizer, EVENT_MANAGER_PLUGINS, EventManager, HAMMER_GESTURE_CONFIG, HAMMER_LOADER, HammerGestureConfig, HammerModule, Meta, Title, TransferState, VERSION, disableDebugTools, enableDebugTools, makeStateKey, platformBrowser, BROWSER_SANITIZATION_PROVIDERS as ɵBROWSER_SANITIZATION_PROVIDERS, BROWSER_SANITIZATION_PROVIDERS__POST_R3__ as ɵBROWSER_SANITIZATION_PROVIDERS__POST_R3__, BrowserDomAdapter as ɵBrowserDomAdapter, BrowserGetTestability as ɵBrowserGetTestability, DomEventsPlugin as ɵDomEventsPlugin, DomRendererFactory2 as ɵDomRendererFactory2, DomSanitizerImpl as ɵDomSanitizerImpl, DomSharedStylesHost as ɵDomSharedStylesHost, ELEMENT_PROBE_PROVIDERS as ɵELEMENT_PROBE_PROVIDERS, ELEMENT_PROBE_PROVIDERS__POST_R3__ as ɵELEMENT_PROBE_PROVIDERS__POST_R3__, HAMMER_PROVIDERS__POST_R3__ as ɵHAMMER_PROVIDERS__POST_R3__, HammerGesturesPlugin as ɵHammerGesturesPlugin, INTERNAL_BROWSER_PLATFORM_PROVIDERS as ɵINTERNAL_BROWSER_PLATFORM_PROVIDERS, KeyEventsPlugin as ɵKeyEventsPlugin, NAMESPACE_URIS as ɵNAMESPACE_URIS, SharedStylesHost as ɵSharedStylesHost, TRANSITION_ID as ɵTRANSITION_ID, errorHandler as ɵangular_packages_platform_browser_platform_browser_a, _document as ɵangular_packages_platform_browser_platform_browser_b, BROWSER_MODULE_PROVIDERS as ɵangular_packages_platform_browser_platform_browser_c, createMeta as ɵangular_packages_platform_browser_platform_browser_d, createTitle as ɵangular_packages_platform_browser_platform_browser_e, initTransferState as ɵangular_packages_platform_browser_platform_browser_f, EventManagerPlugin as ɵangular_packages_platform_browser_platform_browser_g, HAMMER_PROVIDERS__PRE_R3__ as ɵangular_packages_platform_browser_platform_browser_h, HAMMER_PROVIDERS as ɵangular_packages_platform_browser_platform_browser_i, domSanitizerImplFactory as ɵangular_packages_platform_browser_platform_browser_j, appInitializerFactory as ɵangular_packages_platform_browser_platform_browser_k, SERVER_TRANSITION_PROVIDERS as ɵangular_packages_platform_browser_platform_browser_l, _createNgProbeR2 as ɵangular_packages_platform_browser_platform_browser_m, ELEMENT_PROBE_PROVIDERS__PRE_R3__ as ɵangular_packages_platform_browser_platform_browser_n, BrowserXhr as ɵangular_packages_platform_browser_platform_browser_o, GenericBrowserDomAdapter as ɵangular_packages_platform_browser_platform_browser_p, escapeHtml as ɵescapeHtml, flattenStyles as ɵflattenStyles, initDomAdapter as ɵinitDomAdapter, shimContentAttribute as ɵshimContentAttribute, shimHostAttribute as ɵshimHostAttribute };\r\n\r\n","import { __assign } from \"tslib\";\r\nimport \"../../utilities/globals/index.js\";\r\nimport { Trie } from \"@wry/trie\";\r\nimport { canUseWeakMap, canUseWeakSet, isNonNullObject as isObjectOrArray, } from \"../../utilities/index.js\";\r\nfunction shallowCopy(value) {\r\n    if (isObjectOrArray(value)) {\r\n        return Array.isArray(value)\r\n            ? value.slice(0)\r\n            : __assign({ __proto__: Object.getPrototypeOf(value) }, value);\r\n    }\r\n    return value;\r\n}\r\nvar ObjectCanon = (function () {\r\n    function ObjectCanon() {\r\n        this.known = new (canUseWeakSet ? WeakSet : Set)();\r\n        this.pool = new Trie(canUseWeakMap);\r\n        this.passes = new WeakMap();\r\n        this.keysByJSON = new Map();\r\n        this.empty = this.admit({});\r\n    }\r\n    ObjectCanon.prototype.isKnown = function (value) {\r\n        return isObjectOrArray(value) && this.known.has(value);\r\n    };\r\n    ObjectCanon.prototype.pass = function (value) {\r\n        if (isObjectOrArray(value)) {\r\n            var copy = shallowCopy(value);\r\n            this.passes.set(copy, value);\r\n            return copy;\r\n        }\r\n        return value;\r\n    };\r\n    ObjectCanon.prototype.admit = function (value) {\r\n        var _this = this;\r\n        if (isObjectOrArray(value)) {\r\n            var original = this.passes.get(value);\r\n            if (original)\r\n                return original;\r\n            var proto = Object.getPrototypeOf(value);\r\n            switch (proto) {\r\n                case Array.prototype: {\r\n                    if (this.known.has(value))\r\n                        return value;\r\n                    var array = value.map(this.admit, this);\r\n                    var node = this.pool.lookupArray(array);\r\n                    if (!node.array) {\r\n                        this.known.add(node.array = array);\r\n                        if (__DEV__) {\r\n                            Object.freeze(array);\r\n                        }\r\n                    }\r\n                    return node.array;\r\n                }\r\n                case null:\r\n                case Object.prototype: {\r\n                    if (this.known.has(value))\r\n                        return value;\r\n                    var proto_1 = Object.getPrototypeOf(value);\r\n                    var array_1 = [proto_1];\r\n                    var keys = this.sortedKeys(value);\r\n                    array_1.push(keys.json);\r\n                    var firstValueIndex_1 = array_1.length;\r\n                    keys.sorted.forEach(function (key) {\r\n                        array_1.push(_this.admit(value[key]));\r\n                    });\r\n                    var node = this.pool.lookupArray(array_1);\r\n                    if (!node.object) {\r\n                        var obj_1 = node.object = Object.create(proto_1);\r\n                        this.known.add(obj_1);\r\n                        keys.sorted.forEach(function (key, i) {\r\n                            obj_1[key] = array_1[firstValueIndex_1 + i];\r\n                        });\r\n                        if (__DEV__) {\r\n                            Object.freeze(obj_1);\r\n                        }\r\n                    }\r\n                    return node.object;\r\n                }\r\n            }\r\n        }\r\n        return value;\r\n    };\r\n    ObjectCanon.prototype.sortedKeys = function (obj) {\r\n        var keys = Object.keys(obj);\r\n        var node = this.pool.lookupArray(keys);\r\n        if (!node.keys) {\r\n            keys.sort();\r\n            var json = JSON.stringify(keys);\r\n            if (!(node.keys = this.keysByJSON.get(json))) {\r\n                this.keysByJSON.set(json, node.keys = { sorted: keys, json: json });\r\n            }\r\n        }\r\n        return node.keys;\r\n    };\r\n    return ObjectCanon;\r\n}());\r\nexport { ObjectCanon };\r\nexport var canonicalStringify = Object.assign(function (value) {\r\n    if (isObjectOrArray(value)) {\r\n        if (stringifyCanon === void 0) {\r\n            resetCanonicalStringify();\r\n        }\r\n        var canonical = stringifyCanon.admit(value);\r\n        var json = stringifyCache.get(canonical);\r\n        if (json === void 0) {\r\n            stringifyCache.set(canonical, json = JSON.stringify(canonical));\r\n        }\r\n        return json;\r\n    }\r\n    return JSON.stringify(value);\r\n}, {\r\n    reset: resetCanonicalStringify,\r\n});\r\nvar stringifyCanon;\r\nvar stringifyCache;\r\nfunction resetCanonicalStringify() {\r\n    stringifyCanon = new ObjectCanon;\r\n    stringifyCache = new (canUseWeakMap ? WeakMap : Map)();\r\n}\r\n","import { dep } from \"optimism\";\r\nimport { Slot } from \"@wry/context\";\r\nexport var cacheSlot = new Slot();\r\nvar cacheInfoMap = new WeakMap();\r\nfunction getCacheInfo(cache) {\r\n    var info = cacheInfoMap.get(cache);\r\n    if (!info) {\r\n        cacheInfoMap.set(cache, info = {\r\n            vars: new Set,\r\n            dep: dep(),\r\n        });\r\n    }\r\n    return info;\r\n}\r\nexport function forgetCache(cache) {\r\n    getCacheInfo(cache).vars.forEach(function (rv) { return rv.forgetCache(cache); });\r\n}\r\nexport function recallCache(cache) {\r\n    getCacheInfo(cache).vars.forEach(function (rv) { return rv.attachCache(cache); });\r\n}\r\nexport function makeVar(value) {\r\n    var caches = new Set();\r\n    var listeners = new Set();\r\n    var rv = function (newValue) {\r\n        if (arguments.length > 0) {\r\n            if (value !== newValue) {\r\n                value = newValue;\r\n                caches.forEach(function (cache) {\r\n                    getCacheInfo(cache).dep.dirty(rv);\r\n                    broadcast(cache);\r\n                });\r\n                var oldListeners = Array.from(listeners);\r\n                listeners.clear();\r\n                oldListeners.forEach(function (listener) { return listener(value); });\r\n            }\r\n        }\r\n        else {\r\n            var cache = cacheSlot.getValue();\r\n            if (cache) {\r\n                attach(cache);\r\n                getCacheInfo(cache).dep(rv);\r\n            }\r\n        }\r\n        return value;\r\n    };\r\n    rv.onNextChange = function (listener) {\r\n        listeners.add(listener);\r\n        return function () {\r\n            listeners.delete(listener);\r\n        };\r\n    };\r\n    var attach = rv.attachCache = function (cache) {\r\n        caches.add(cache);\r\n        getCacheInfo(cache).vars.add(rv);\r\n        return rv;\r\n    };\r\n    rv.forgetCache = function (cache) { return caches.delete(cache); };\r\n    return rv;\r\n}\r\nfunction broadcast(cache) {\r\n    if (cache.broadcastWatches) {\r\n        cache.broadcastWatches();\r\n    }\r\n}\r\n","import { __extends } from \"tslib\";\r\nimport { InvariantError, invariant } from \"../../utilities/globals/index.js\";\r\nimport { Observable } from \"../../utilities/index.js\";\r\nimport { validateOperation, createOperation, transformOperation, } from \"../utils/index.js\";\r\nfunction passthrough(op, forward) {\r\n    return (forward ? forward(op) : Observable.of());\r\n}\r\nfunction toLink(handler) {\r\n    return typeof handler === 'function' ? new ApolloLink(handler) : handler;\r\n}\r\nfunction isTerminating(link) {\r\n    return link.request.length <= 1;\r\n}\r\nvar LinkError = (function (_super) {\r\n    __extends(LinkError, _super);\r\n    function LinkError(message, link) {\r\n        var _this = _super.call(this, message) || this;\r\n        _this.link = link;\r\n        return _this;\r\n    }\r\n    return LinkError;\r\n}(Error));\r\nvar ApolloLink = (function () {\r\n    function ApolloLink(request) {\r\n        if (request)\r\n            this.request = request;\r\n    }\r\n    ApolloLink.empty = function () {\r\n        return new ApolloLink(function () { return Observable.of(); });\r\n    };\r\n    ApolloLink.from = function (links) {\r\n        if (links.length === 0)\r\n            return ApolloLink.empty();\r\n        return links.map(toLink).reduce(function (x, y) { return x.concat(y); });\r\n    };\r\n    ApolloLink.split = function (test, left, right) {\r\n        var leftLink = toLink(left);\r\n        var rightLink = toLink(right || new ApolloLink(passthrough));\r\n        if (isTerminating(leftLink) && isTerminating(rightLink)) {\r\n            return new ApolloLink(function (operation) {\r\n                return test(operation)\r\n                    ? leftLink.request(operation) || Observable.of()\r\n                    : rightLink.request(operation) || Observable.of();\r\n            });\r\n        }\r\n        else {\r\n            return new ApolloLink(function (operation, forward) {\r\n                return test(operation)\r\n                    ? leftLink.request(operation, forward) || Observable.of()\r\n                    : rightLink.request(operation, forward) || Observable.of();\r\n            });\r\n        }\r\n    };\r\n    ApolloLink.execute = function (link, operation) {\r\n        return (link.request(createOperation(operation.context, transformOperation(validateOperation(operation)))) || Observable.of());\r\n    };\r\n    ApolloLink.concat = function (first, second) {\r\n        var firstLink = toLink(first);\r\n        if (isTerminating(firstLink)) {\r\n            __DEV__ && invariant.warn(new LinkError(\"You are calling concat on a terminating link, which will have no effect\", firstLink));\r\n            return firstLink;\r\n        }\r\n        var nextLink = toLink(second);\r\n        if (isTerminating(nextLink)) {\r\n            return new ApolloLink(function (operation) {\r\n                return firstLink.request(operation, function (op) { return nextLink.request(op) || Observable.of(); }) || Observable.of();\r\n            });\r\n        }\r\n        else {\r\n            return new ApolloLink(function (operation, forward) {\r\n                return (firstLink.request(operation, function (op) {\r\n                    return nextLink.request(op, forward) || Observable.of();\r\n                }) || Observable.of());\r\n            });\r\n        }\r\n    };\r\n    ApolloLink.prototype.split = function (test, left, right) {\r\n        return this.concat(ApolloLink.split(test, left, right || new ApolloLink(passthrough)));\r\n    };\r\n    ApolloLink.prototype.concat = function (next) {\r\n        return ApolloLink.concat(this, next);\r\n    };\r\n    ApolloLink.prototype.request = function (operation, forward) {\r\n        throw __DEV__ ? new InvariantError('request is not implemented') : new InvariantError(21);\r\n    };\r\n    ApolloLink.prototype.onError = function (error, observer) {\r\n        if (observer && observer.error) {\r\n            observer.error(error);\r\n            return false;\r\n        }\r\n        throw error;\r\n    };\r\n    ApolloLink.prototype.setOnError = function (fn) {\r\n        this.onError = fn;\r\n        return this;\r\n    };\r\n    return ApolloLink;\r\n}());\r\nexport { ApolloLink };\r\n","import { __assign } from \"tslib\";\r\nexport function createOperation(starting, operation) {\r\n    var context = __assign({}, starting);\r\n    var setContext = function (next) {\r\n        if (typeof next === 'function') {\r\n            context = __assign(__assign({}, context), next(context));\r\n        }\r\n        else {\r\n            context = __assign(__assign({}, context), next);\r\n        }\r\n    };\r\n    var getContext = function () { return (__assign({}, context)); };\r\n    Object.defineProperty(operation, 'setContext', {\r\n        enumerable: false,\r\n        value: setContext,\r\n    });\r\n    Object.defineProperty(operation, 'getContext', {\r\n        enumerable: false,\r\n        value: getContext,\r\n    });\r\n    return operation;\r\n}\r\n","import { getOperationName } from \"../../utilities/index.js\";\r\nexport function transformOperation(operation) {\r\n    var transformedOperation = {\r\n        variables: operation.variables || {},\r\n        extensions: operation.extensions || {},\r\n        operationName: operation.operationName,\r\n        query: operation.query,\r\n    };\r\n    if (!transformedOperation.operationName) {\r\n        transformedOperation.operationName =\r\n            typeof transformedOperation.query !== 'string'\r\n                ? getOperationName(transformedOperation.query) || undefined\r\n                : '';\r\n    }\r\n    return transformedOperation;\r\n}\r\n","import { InvariantError } from \"../../utilities/globals/index.js\";\r\nexport function validateOperation(operation) {\r\n    var OPERATION_FIELDS = [\r\n        'query',\r\n        'operationName',\r\n        'variables',\r\n        'extensions',\r\n        'context',\r\n    ];\r\n    for (var _i = 0, _a = Object.keys(operation); _i < _a.length; _i++) {\r\n        var key = _a[_i];\r\n        if (OPERATION_FIELDS.indexOf(key) < 0) {\r\n            throw __DEV__ ? new InvariantError(\"illegal argument: \" + key) : new InvariantError(26);\r\n        }\r\n    }\r\n    return operation;\r\n}\r\n","export var canUseWeakMap = typeof WeakMap === 'function' && !(typeof navigator === 'object' &&\r\n    navigator.product === 'ReactNative');\r\nexport var canUseWeakSet = typeof WeakSet === 'function';\r\n","var toString = Object.prototype.toString;\r\nexport function cloneDeep(value) {\r\n    return cloneDeepHelper(value);\r\n}\r\nfunction cloneDeepHelper(val, seen) {\r\n    switch (toString.call(val)) {\r\n        case \"[object Array]\": {\r\n            seen = seen || new Map;\r\n            if (seen.has(val))\r\n                return seen.get(val);\r\n            var copy_1 = val.slice(0);\r\n            seen.set(val, copy_1);\r\n            copy_1.forEach(function (child, i) {\r\n                copy_1[i] = cloneDeepHelper(child, seen);\r\n            });\r\n            return copy_1;\r\n        }\r\n        case \"[object Object]\": {\r\n            seen = seen || new Map;\r\n            if (seen.has(val))\r\n                return seen.get(val);\r\n            var copy_2 = Object.create(Object.getPrototypeOf(val));\r\n            seen.set(val, copy_2);\r\n            Object.keys(val).forEach(function (key) {\r\n                copy_2[key] = cloneDeepHelper(val[key], seen);\r\n            });\r\n            return copy_2;\r\n        }\r\n        default:\r\n            return val;\r\n    }\r\n}\r\n","var prefixCounts = new Map();\r\nexport function makeUniqueId(prefix) {\r\n    var count = prefixCounts.get(prefix) || 1;\r\n    prefixCounts.set(prefix, count + 1);\r\n    return prefix + \":\" + count + \":\" + Math.random().toString(36).slice(2);\r\n}\r\n","import { __assign, __spreadArray } from \"tslib\";\r\nimport { isNonNullObject } from \"./objects.js\";\r\nvar hasOwnProperty = Object.prototype.hasOwnProperty;\r\nexport function mergeDeep() {\r\n    var sources = [];\r\n    for (var _i = 0; _i < arguments.length; _i++) {\r\n        sources[_i] = arguments[_i];\r\n    }\r\n    return mergeDeepArray(sources);\r\n}\r\nexport function mergeDeepArray(sources) {\r\n    var target = sources[0] || {};\r\n    var count = sources.length;\r\n    if (count > 1) {\r\n        var merger = new DeepMerger();\r\n        for (var i = 1; i < count; ++i) {\r\n            target = merger.merge(target, sources[i]);\r\n        }\r\n    }\r\n    return target;\r\n}\r\nvar defaultReconciler = function (target, source, property) {\r\n    return this.merge(target[property], source[property]);\r\n};\r\nvar DeepMerger = (function () {\r\n    function DeepMerger(reconciler) {\r\n        if (reconciler === void 0) { reconciler = defaultReconciler; }\r\n        this.reconciler = reconciler;\r\n        this.isObject = isNonNullObject;\r\n        this.pastCopies = new Set();\r\n    }\r\n    DeepMerger.prototype.merge = function (target, source) {\r\n        var _this = this;\r\n        var context = [];\r\n        for (var _i = 2; _i < arguments.length; _i++) {\r\n            context[_i - 2] = arguments[_i];\r\n        }\r\n        if (isNonNullObject(source) && isNonNullObject(target)) {\r\n            Object.keys(source).forEach(function (sourceKey) {\r\n                if (hasOwnProperty.call(target, sourceKey)) {\r\n                    var targetValue = target[sourceKey];\r\n                    if (source[sourceKey] !== targetValue) {\r\n                        var result = _this.reconciler.apply(_this, __spreadArray([target, source, sourceKey], context, false));\r\n                        if (result !== targetValue) {\r\n                            target = _this.shallowCopyForMerge(target);\r\n                            target[sourceKey] = result;\r\n                        }\r\n                    }\r\n                }\r\n                else {\r\n                    target = _this.shallowCopyForMerge(target);\r\n                    target[sourceKey] = source[sourceKey];\r\n                }\r\n            });\r\n            return target;\r\n        }\r\n        return source;\r\n    };\r\n    DeepMerger.prototype.shallowCopyForMerge = function (value) {\r\n        if (isNonNullObject(value) && !this.pastCopies.has(value)) {\r\n            if (Array.isArray(value)) {\r\n                value = value.slice(0);\r\n            }\r\n            else {\r\n                value = __assign({ __proto__: Object.getPrototypeOf(value) }, value);\r\n            }\r\n            this.pastCopies.add(value);\r\n        }\r\n        return value;\r\n    };\r\n    return DeepMerger;\r\n}());\r\nexport { DeepMerger };\r\n","export function isNonNullObject(obj) {\r\n    return obj !== null && typeof obj === 'object';\r\n}\r\n","import { __extends } from 'tslib';\r\n\r\nvar genericMessage = \"Invariant Violation\";\r\nvar _a = Object.setPrototypeOf, setPrototypeOf = _a === void 0 ? function (obj, proto) {\r\n    obj.__proto__ = proto;\r\n    return obj;\r\n} : _a;\r\nvar InvariantError = /** @class */ (function (_super) {\r\n    __extends(InvariantError, _super);\r\n    function InvariantError(message) {\r\n        if (message === void 0) { message = genericMessage; }\r\n        var _this = _super.call(this, typeof message === \"number\"\r\n            ? genericMessage + \": \" + message + \" (see https://github.com/apollographql/invariant-packages)\"\r\n            : message) || this;\r\n        _this.framesToPop = 1;\r\n        _this.name = genericMessage;\r\n        setPrototypeOf(_this, InvariantError.prototype);\r\n        return _this;\r\n    }\r\n    return InvariantError;\r\n}(Error));\r\nfunction invariant(condition, message) {\r\n    if (!condition) {\r\n        throw new InvariantError(message);\r\n    }\r\n}\r\nvar verbosityLevels = [\"debug\", \"log\", \"warn\", \"error\", \"silent\"];\r\nvar verbosityLevel = verbosityLevels.indexOf(\"log\");\r\nfunction wrapConsoleMethod(name) {\r\n    return function () {\r\n        if (verbosityLevels.indexOf(name) >= verbosityLevel) {\r\n            // Default to console.log if this host environment happens not to provide\r\n            // all the console.* methods we need.\r\n            var method = console[name] || console.log;\r\n            return method.apply(console, arguments);\r\n        }\r\n    };\r\n}\r\n(function (invariant) {\r\n    invariant.debug = wrapConsoleMethod(\"debug\");\r\n    invariant.log = wrapConsoleMethod(\"log\");\r\n    invariant.warn = wrapConsoleMethod(\"warn\");\r\n    invariant.error = wrapConsoleMethod(\"error\");\r\n})(invariant || (invariant = {}));\r\nfunction setVerbosity(level) {\r\n    var old = verbosityLevels[verbosityLevel];\r\n    verbosityLevel = Math.max(0, verbosityLevels.indexOf(level));\r\n    return old;\r\n}\r\nvar invariant$1 = invariant;\r\n\r\nexport { InvariantError, invariant$1 as default, invariant, setVerbosity };\r\n\n","export function maybe(thunk) {\r\n    try {\r\n        return thunk();\r\n    }\r\n    catch (_a) { }\r\n}\r\n","import { maybe } from \"./maybe.js\";\r\nexport default (maybe(function () { return globalThis; }) ||\r\n    maybe(function () { return window; }) ||\r\n    maybe(function () { return self; }) ||\r\n    maybe(function () { return global; }) ||\r\n    maybe(function () { return Function(\"return this\")(); }));\r\n","import global from \"./global.js\";\r\nimport { maybe } from \"./maybe.js\";\r\nvar __ = \"__\";\r\nvar GLOBAL_KEY = [__, __].join(\"DEV\");\r\nfunction getDEV() {\r\n    try {\r\n        return Boolean(__DEV__);\r\n    }\r\n    catch (_a) {\r\n        Object.defineProperty(global, GLOBAL_KEY, {\r\n            value: maybe(function () { return process.env.NODE_ENV; }) !== \"production\",\r\n            enumerable: false,\r\n            configurable: true,\r\n            writable: true,\r\n        });\r\n        return global[GLOBAL_KEY];\r\n    }\r\n}\r\nexport default getDEV();\r\n","function maybe(thunk) {\r\n  try { return thunk() } catch (_) {}\r\n}\r\n\r\nvar safeGlobal = (\r\n  maybe(function() { return globalThis }) ||\r\n  maybe(function() { return window }) ||\r\n  maybe(function() { return self }) ||\r\n  maybe(function() { return global }) ||\r\n  maybe(function() { return Function(\"return this\")() })\r\n);\r\n\r\nvar needToRemove = false;\r\n\r\nexport function install() {\r\n  if (safeGlobal &&\r\n      !maybe(function() { return process.env.NODE_ENV }) &&\r\n      !maybe(function() { return process })) {\r\n    Object.defineProperty(safeGlobal, \"process\", {\r\n      value: {\r\n        env: {\r\n          // This default needs to be \"production\" instead of \"development\", to\r\n          // avoid the problem https://github.com/graphql/graphql-js/pull/2894\r\n          // will eventually solve, once merged and released.\r\n          NODE_ENV: \"production\",\r\n        },\r\n      },\r\n      // Let anyone else change global.process as they see fit, but hide it from\r\n      // Object.keys(global) enumeration.\r\n      configurable: true,\r\n      enumerable: false,\r\n      writable: true,\r\n    });\r\n    needToRemove = true;\r\n  }\r\n}\r\n\r\n// Call install() at least once, when this module is imported.\r\ninstall();\r\n\r\nexport function remove() {\r\n  if (needToRemove) {\r\n    delete safeGlobal.process;\r\n    needToRemove = false;\r\n  }\r\n}\r\n","import { remove } from 'ts-invariant/process';\r\nimport { isType } from 'graphql';\r\nexport function removeTemporaryGlobals() {\r\n    isType(null);\r\n    return remove();\r\n}\r\n","import { invariant, InvariantError } from \"ts-invariant\";\r\nimport DEV from \"./DEV.js\";\r\nexport { DEV };\r\nexport function checkDEV() {\r\n    __DEV__ ? invariant(\"boolean\" === typeof DEV, DEV) : invariant(\"boolean\" === typeof DEV, 38);\r\n}\r\nimport { removeTemporaryGlobals } from \"./graphql.js\";\r\nremoveTemporaryGlobals();\r\nexport { maybe } from \"./maybe.js\";\r\nexport { default as global } from \"./global.js\";\r\nexport { invariant, InvariantError };\r\ncheckDEV();\r\n","import { invariant } from \"../globals/index.js\";\r\nimport { visit, } from 'graphql';\r\nexport function shouldInclude(_a, variables) {\r\n    var directives = _a.directives;\r\n    if (!directives || !directives.length) {\r\n        return true;\r\n    }\r\n    return getInclusionDirectives(directives).every(function (_a) {\r\n        var directive = _a.directive, ifArgument = _a.ifArgument;\r\n        var evaledValue = false;\r\n        if (ifArgument.value.kind === 'Variable') {\r\n            evaledValue = variables && variables[ifArgument.value.name.value];\r\n            __DEV__ ? invariant(evaledValue !== void 0, \"Invalid variable referenced in @\" + directive.name.value + \" directive.\") : invariant(evaledValue !== void 0, 39);\r\n        }\r\n        else {\r\n            evaledValue = ifArgument.value.value;\r\n        }\r\n        return directive.name.value === 'skip' ? !evaledValue : evaledValue;\r\n    });\r\n}\r\nexport function getDirectiveNames(root) {\r\n    var names = [];\r\n    visit(root, {\r\n        Directive: function (node) {\r\n            names.push(node.name.value);\r\n        },\r\n    });\r\n    return names;\r\n}\r\nexport function hasDirectives(names, root) {\r\n    return getDirectiveNames(root).some(function (name) { return names.indexOf(name) > -1; });\r\n}\r\nexport function hasClientExports(document) {\r\n    return (document &&\r\n        hasDirectives(['client'], document) &&\r\n        hasDirectives(['export'], document));\r\n}\r\nfunction isInclusionDirective(_a) {\r\n    var value = _a.name.value;\r\n    return value === 'skip' || value === 'include';\r\n}\r\nexport function getInclusionDirectives(directives) {\r\n    var result = [];\r\n    if (directives && directives.length) {\r\n        directives.forEach(function (directive) {\r\n            if (!isInclusionDirective(directive))\r\n                return;\r\n            var directiveArguments = directive.arguments;\r\n            var directiveName = directive.name.value;\r\n            __DEV__ ? invariant(directiveArguments && directiveArguments.length === 1, \"Incorrect number of arguments for the @\" + directiveName + \" directive.\") : invariant(directiveArguments && directiveArguments.length === 1, 40);\r\n            var ifArgument = directiveArguments[0];\r\n            __DEV__ ? invariant(ifArgument.name && ifArgument.name.value === 'if', \"Invalid argument for the @\" + directiveName + \" directive.\") : invariant(ifArgument.name && ifArgument.name.value === 'if', 41);\r\n            var ifValue = ifArgument.value;\r\n            __DEV__ ? invariant(ifValue &&\r\n                (ifValue.kind === 'Variable' || ifValue.kind === 'BooleanValue'), \"Argument for the @\" + directiveName + \" directive must be a variable or a boolean value.\") : invariant(ifValue &&\r\n                (ifValue.kind === 'Variable' || ifValue.kind === 'BooleanValue'), 42);\r\n            result.push({ directive: directive, ifArgument: ifArgument });\r\n        });\r\n    }\r\n    return result;\r\n}\r\n","import { __assign, __spreadArray } from \"tslib\";\r\nimport { invariant, InvariantError } from \"../globals/index.js\";\r\nexport function getFragmentQueryDocument(document, fragmentName) {\r\n    var actualFragmentName = fragmentName;\r\n    var fragments = [];\r\n    document.definitions.forEach(function (definition) {\r\n        if (definition.kind === 'OperationDefinition') {\r\n            throw __DEV__ ? new InvariantError(\"Found a \" + definition.operation + \" operation\" + (definition.name ? \" named '\" + definition.name.value + \"'\" : '') + \". \" +\r\n                'No operations are allowed when using a fragment as a query. Only fragments are allowed.') : new InvariantError(43);\r\n        }\r\n        if (definition.kind === 'FragmentDefinition') {\r\n            fragments.push(definition);\r\n        }\r\n    });\r\n    if (typeof actualFragmentName === 'undefined') {\r\n        __DEV__ ? invariant(fragments.length === 1, \"Found \" + fragments.length + \" fragments. `fragmentName` must be provided when there is not exactly 1 fragment.\") : invariant(fragments.length === 1, 44);\r\n        actualFragmentName = fragments[0].name.value;\r\n    }\r\n    var query = __assign(__assign({}, document), { definitions: __spreadArray([\r\n            {\r\n                kind: 'OperationDefinition',\r\n                operation: 'query',\r\n                selectionSet: {\r\n                    kind: 'SelectionSet',\r\n                    selections: [\r\n                        {\r\n                            kind: 'FragmentSpread',\r\n                            name: {\r\n                                kind: 'Name',\r\n                                value: actualFragmentName,\r\n                            },\r\n                        },\r\n                    ],\r\n                },\r\n            }\r\n        ], document.definitions, true) });\r\n    return query;\r\n}\r\nexport function createFragmentMap(fragments) {\r\n    if (fragments === void 0) { fragments = []; }\r\n    var symTable = {};\r\n    fragments.forEach(function (fragment) {\r\n        symTable[fragment.name.value] = fragment;\r\n    });\r\n    return symTable;\r\n}\r\nexport function getFragmentFromSelection(selection, fragmentMap) {\r\n    switch (selection.kind) {\r\n        case 'InlineFragment':\r\n            return selection;\r\n        case 'FragmentSpread': {\r\n            var fragment = fragmentMap && fragmentMap[selection.name.value];\r\n            __DEV__ ? invariant(fragment, \"No fragment named \" + selection.name.value + \".\") : invariant(fragment, 45);\r\n            return fragment;\r\n        }\r\n        default:\r\n            return null;\r\n    }\r\n}\r\n","import { invariant, InvariantError } from \"../globals/index.js\";\r\nimport { valueToObjectRepresentation } from \"./storeUtils.js\";\r\nexport function checkDocument(doc) {\r\n    __DEV__ ? invariant(doc && doc.kind === 'Document', \"Expecting a parsed GraphQL document. Perhaps you need to wrap the query string in a \\\"gql\\\" tag? http://docs.apollostack.com/apollo-client/core.html#gql\") : invariant(doc && doc.kind === 'Document', 46);\r\n    var operations = doc.definitions\r\n        .filter(function (d) { return d.kind !== 'FragmentDefinition'; })\r\n        .map(function (definition) {\r\n        if (definition.kind !== 'OperationDefinition') {\r\n            throw __DEV__ ? new InvariantError(\"Schema type definitions not allowed in queries. Found: \\\"\" + definition.kind + \"\\\"\") : new InvariantError(47);\r\n        }\r\n        return definition;\r\n    });\r\n    __DEV__ ? invariant(operations.length <= 1, \"Ambiguous GraphQL document: contains \" + operations.length + \" operations\") : invariant(operations.length <= 1, 48);\r\n    return doc;\r\n}\r\nexport function getOperationDefinition(doc) {\r\n    checkDocument(doc);\r\n    return doc.definitions.filter(function (definition) { return definition.kind === 'OperationDefinition'; })[0];\r\n}\r\nexport function getOperationName(doc) {\r\n    return (doc.definitions\r\n        .filter(function (definition) {\r\n        return definition.kind === 'OperationDefinition' && definition.name;\r\n    })\r\n        .map(function (x) { return x.name.value; })[0] || null);\r\n}\r\nexport function getFragmentDefinitions(doc) {\r\n    return doc.definitions.filter(function (definition) { return definition.kind === 'FragmentDefinition'; });\r\n}\r\nexport function getQueryDefinition(doc) {\r\n    var queryDef = getOperationDefinition(doc);\r\n    __DEV__ ? invariant(queryDef && queryDef.operation === 'query', 'Must contain a query definition.') : invariant(queryDef && queryDef.operation === 'query', 49);\r\n    return queryDef;\r\n}\r\nexport function getFragmentDefinition(doc) {\r\n    __DEV__ ? invariant(doc.kind === 'Document', \"Expecting a parsed GraphQL document. Perhaps you need to wrap the query string in a \\\"gql\\\" tag? http://docs.apollostack.com/apollo-client/core.html#gql\") : invariant(doc.kind === 'Document', 50);\r\n    __DEV__ ? invariant(doc.definitions.length <= 1, 'Fragment must have exactly one definition.') : invariant(doc.definitions.length <= 1, 51);\r\n    var fragmentDef = doc.definitions[0];\r\n    __DEV__ ? invariant(fragmentDef.kind === 'FragmentDefinition', 'Must be a fragment definition.') : invariant(fragmentDef.kind === 'FragmentDefinition', 52);\r\n    return fragmentDef;\r\n}\r\nexport function getMainDefinition(queryDoc) {\r\n    checkDocument(queryDoc);\r\n    var fragmentDefinition;\r\n    for (var _i = 0, _a = queryDoc.definitions; _i < _a.length; _i++) {\r\n        var definition = _a[_i];\r\n        if (definition.kind === 'OperationDefinition') {\r\n            var operation = definition.operation;\r\n            if (operation === 'query' ||\r\n                operation === 'mutation' ||\r\n                operation === 'subscription') {\r\n                return definition;\r\n            }\r\n        }\r\n        if (definition.kind === 'FragmentDefinition' && !fragmentDefinition) {\r\n            fragmentDefinition = definition;\r\n        }\r\n    }\r\n    if (fragmentDefinition) {\r\n        return fragmentDefinition;\r\n    }\r\n    throw __DEV__ ? new InvariantError('Expected a parsed GraphQL query with a query, mutation, subscription, or a fragment.') : new InvariantError(53);\r\n}\r\nexport function getDefaultValues(definition) {\r\n    var defaultValues = Object.create(null);\r\n    var defs = definition && definition.variableDefinitions;\r\n    if (defs && defs.length) {\r\n        defs.forEach(function (def) {\r\n            if (def.defaultValue) {\r\n                valueToObjectRepresentation(defaultValues, def.variable.name, def.defaultValue);\r\n            }\r\n        });\r\n    }\r\n    return defaultValues;\r\n}\r\n","import { InvariantError } from \"../globals/index.js\";\r\nimport { isNonNullObject } from \"../common/objects.js\";\r\nimport { getFragmentFromSelection } from \"./fragments.js\";\r\nexport function makeReference(id) {\r\n    return { __ref: String(id) };\r\n}\r\nexport function isReference(obj) {\r\n    return Boolean(obj && typeof obj === 'object' && typeof obj.__ref === 'string');\r\n}\r\nexport function isDocumentNode(value) {\r\n    return (isNonNullObject(value) &&\r\n        value.kind === \"Document\" &&\r\n        Array.isArray(value.definitions));\r\n}\r\nfunction isStringValue(value) {\r\n    return value.kind === 'StringValue';\r\n}\r\nfunction isBooleanValue(value) {\r\n    return value.kind === 'BooleanValue';\r\n}\r\nfunction isIntValue(value) {\r\n    return value.kind === 'IntValue';\r\n}\r\nfunction isFloatValue(value) {\r\n    return value.kind === 'FloatValue';\r\n}\r\nfunction isVariable(value) {\r\n    return value.kind === 'Variable';\r\n}\r\nfunction isObjectValue(value) {\r\n    return value.kind === 'ObjectValue';\r\n}\r\nfunction isListValue(value) {\r\n    return value.kind === 'ListValue';\r\n}\r\nfunction isEnumValue(value) {\r\n    return value.kind === 'EnumValue';\r\n}\r\nfunction isNullValue(value) {\r\n    return value.kind === 'NullValue';\r\n}\r\nexport function valueToObjectRepresentation(argObj, name, value, variables) {\r\n    if (isIntValue(value) || isFloatValue(value)) {\r\n        argObj[name.value] = Number(value.value);\r\n    }\r\n    else if (isBooleanValue(value) || isStringValue(value)) {\r\n        argObj[name.value] = value.value;\r\n    }\r\n    else if (isObjectValue(value)) {\r\n        var nestedArgObj_1 = {};\r\n        value.fields.map(function (obj) {\r\n            return valueToObjectRepresentation(nestedArgObj_1, obj.name, obj.value, variables);\r\n        });\r\n        argObj[name.value] = nestedArgObj_1;\r\n    }\r\n    else if (isVariable(value)) {\r\n        var variableValue = (variables || {})[value.name.value];\r\n        argObj[name.value] = variableValue;\r\n    }\r\n    else if (isListValue(value)) {\r\n        argObj[name.value] = value.values.map(function (listValue) {\r\n            var nestedArgArrayObj = {};\r\n            valueToObjectRepresentation(nestedArgArrayObj, name, listValue, variables);\r\n            return nestedArgArrayObj[name.value];\r\n        });\r\n    }\r\n    else if (isEnumValue(value)) {\r\n        argObj[name.value] = value.value;\r\n    }\r\n    else if (isNullValue(value)) {\r\n        argObj[name.value] = null;\r\n    }\r\n    else {\r\n        throw __DEV__ ? new InvariantError(\"The inline argument \\\"\" + name.value + \"\\\" of kind \\\"\" + value.kind + \"\\\"\" +\r\n            'is not supported. Use variables instead of inline arguments to ' +\r\n            'overcome this limitation.') : new InvariantError(54);\r\n    }\r\n}\r\nexport function storeKeyNameFromField(field, variables) {\r\n    var directivesObj = null;\r\n    if (field.directives) {\r\n        directivesObj = {};\r\n        field.directives.forEach(function (directive) {\r\n            directivesObj[directive.name.value] = {};\r\n            if (directive.arguments) {\r\n                directive.arguments.forEach(function (_a) {\r\n                    var name = _a.name, value = _a.value;\r\n                    return valueToObjectRepresentation(directivesObj[directive.name.value], name, value, variables);\r\n                });\r\n            }\r\n        });\r\n    }\r\n    var argObj = null;\r\n    if (field.arguments && field.arguments.length) {\r\n        argObj = {};\r\n        field.arguments.forEach(function (_a) {\r\n            var name = _a.name, value = _a.value;\r\n            return valueToObjectRepresentation(argObj, name, value, variables);\r\n        });\r\n    }\r\n    return getStoreKeyName(field.name.value, argObj, directivesObj);\r\n}\r\nvar KNOWN_DIRECTIVES = [\r\n    'connection',\r\n    'include',\r\n    'skip',\r\n    'client',\r\n    'rest',\r\n    'export',\r\n];\r\nexport var getStoreKeyName = Object.assign(function (fieldName, args, directives) {\r\n    if (args &&\r\n        directives &&\r\n        directives['connection'] &&\r\n        directives['connection']['key']) {\r\n        if (directives['connection']['filter'] &&\r\n            directives['connection']['filter'].length > 0) {\r\n            var filterKeys = directives['connection']['filter']\r\n                ? directives['connection']['filter']\r\n                : [];\r\n            filterKeys.sort();\r\n            var filteredArgs_1 = {};\r\n            filterKeys.forEach(function (key) {\r\n                filteredArgs_1[key] = args[key];\r\n            });\r\n            return directives['connection']['key'] + \"(\" + stringify(filteredArgs_1) + \")\";\r\n        }\r\n        else {\r\n            return directives['connection']['key'];\r\n        }\r\n    }\r\n    var completeFieldName = fieldName;\r\n    if (args) {\r\n        var stringifiedArgs = stringify(args);\r\n        completeFieldName += \"(\" + stringifiedArgs + \")\";\r\n    }\r\n    if (directives) {\r\n        Object.keys(directives).forEach(function (key) {\r\n            if (KNOWN_DIRECTIVES.indexOf(key) !== -1)\r\n                return;\r\n            if (directives[key] && Object.keys(directives[key]).length) {\r\n                completeFieldName += \"@\" + key + \"(\" + stringify(directives[key]) + \")\";\r\n            }\r\n            else {\r\n                completeFieldName += \"@\" + key;\r\n            }\r\n        });\r\n    }\r\n    return completeFieldName;\r\n}, {\r\n    setStringify: function (s) {\r\n        var previous = stringify;\r\n        stringify = s;\r\n        return previous;\r\n    },\r\n});\r\nvar stringify = function defaultStringify(value) {\r\n    return JSON.stringify(value, stringifyReplacer);\r\n};\r\nfunction stringifyReplacer(_key, value) {\r\n    if (isNonNullObject(value) && !Array.isArray(value)) {\r\n        value = Object.keys(value).sort().reduce(function (copy, key) {\r\n            copy[key] = value[key];\r\n            return copy;\r\n        }, {});\r\n    }\r\n    return value;\r\n}\r\nexport function argumentsObjectFromField(field, variables) {\r\n    if (field.arguments && field.arguments.length) {\r\n        var argObj_1 = {};\r\n        field.arguments.forEach(function (_a) {\r\n            var name = _a.name, value = _a.value;\r\n            return valueToObjectRepresentation(argObj_1, name, value, variables);\r\n        });\r\n        return argObj_1;\r\n    }\r\n    return null;\r\n}\r\nexport function resultKeyNameFromField(field) {\r\n    return field.alias ? field.alias.value : field.name.value;\r\n}\r\nexport function getTypenameFromResult(result, selectionSet, fragmentMap) {\r\n    if (typeof result.__typename === 'string') {\r\n        return result.__typename;\r\n    }\r\n    for (var _i = 0, _a = selectionSet.selections; _i < _a.length; _i++) {\r\n        var selection = _a[_i];\r\n        if (isField(selection)) {\r\n            if (selection.name.value === '__typename') {\r\n                return result[resultKeyNameFromField(selection)];\r\n            }\r\n        }\r\n        else {\r\n            var typename = getTypenameFromResult(result, getFragmentFromSelection(selection, fragmentMap).selectionSet, fragmentMap);\r\n            if (typeof typename === 'string') {\r\n                return typename;\r\n            }\r\n        }\r\n    }\r\n}\r\nexport function isField(selection) {\r\n    return selection.kind === 'Field';\r\n}\r\nexport function isInlineFragment(selection) {\r\n    return selection.kind === 'InlineFragment';\r\n}\r\n","export function filterInPlace(array, test, context) {\r\n    var target = 0;\r\n    array.forEach(function (elem, i) {\r\n        if (test.call(this, elem, i, array)) {\r\n            array[target++] = elem;\r\n        }\r\n    }, context);\r\n    array.length = target;\r\n    return array;\r\n}\r\n","import { __assign, __spreadArray } from \"tslib\";\r\nimport { invariant } from \"../globals/index.js\";\r\nimport { visit, } from 'graphql';\r\nimport { checkDocument, getOperationDefinition, getFragmentDefinition, getFragmentDefinitions, getMainDefinition, } from \"./getFromAST.js\";\r\nimport { filterInPlace } from \"../common/filterInPlace.js\";\r\nimport { isField, isInlineFragment } from \"./storeUtils.js\";\r\nimport { createFragmentMap, } from \"./fragments.js\";\r\nvar TYPENAME_FIELD = {\r\n    kind: 'Field',\r\n    name: {\r\n        kind: 'Name',\r\n        value: '__typename',\r\n    },\r\n};\r\nfunction isEmpty(op, fragments) {\r\n    return op.selectionSet.selections.every(function (selection) {\r\n        return selection.kind === 'FragmentSpread' &&\r\n            isEmpty(fragments[selection.name.value], fragments);\r\n    });\r\n}\r\nfunction nullIfDocIsEmpty(doc) {\r\n    return isEmpty(getOperationDefinition(doc) || getFragmentDefinition(doc), createFragmentMap(getFragmentDefinitions(doc)))\r\n        ? null\r\n        : doc;\r\n}\r\nfunction getDirectiveMatcher(directives) {\r\n    return function directiveMatcher(directive) {\r\n        return directives.some(function (dir) {\r\n            return (dir.name && dir.name === directive.name.value) ||\r\n                (dir.test && dir.test(directive));\r\n        });\r\n    };\r\n}\r\nexport function removeDirectivesFromDocument(directives, doc) {\r\n    var variablesInUse = Object.create(null);\r\n    var variablesToRemove = [];\r\n    var fragmentSpreadsInUse = Object.create(null);\r\n    var fragmentSpreadsToRemove = [];\r\n    var modifiedDoc = nullIfDocIsEmpty(visit(doc, {\r\n        Variable: {\r\n            enter: function (node, _key, parent) {\r\n                if (parent.kind !== 'VariableDefinition') {\r\n                    variablesInUse[node.name.value] = true;\r\n                }\r\n            },\r\n        },\r\n        Field: {\r\n            enter: function (node) {\r\n                if (directives && node.directives) {\r\n                    var shouldRemoveField = directives.some(function (directive) { return directive.remove; });\r\n                    if (shouldRemoveField &&\r\n                        node.directives &&\r\n                        node.directives.some(getDirectiveMatcher(directives))) {\r\n                        if (node.arguments) {\r\n                            node.arguments.forEach(function (arg) {\r\n                                if (arg.value.kind === 'Variable') {\r\n                                    variablesToRemove.push({\r\n                                        name: arg.value.name.value,\r\n                                    });\r\n                                }\r\n                            });\r\n                        }\r\n                        if (node.selectionSet) {\r\n                            getAllFragmentSpreadsFromSelectionSet(node.selectionSet).forEach(function (frag) {\r\n                                fragmentSpreadsToRemove.push({\r\n                                    name: frag.name.value,\r\n                                });\r\n                            });\r\n                        }\r\n                        return null;\r\n                    }\r\n                }\r\n            },\r\n        },\r\n        FragmentSpread: {\r\n            enter: function (node) {\r\n                fragmentSpreadsInUse[node.name.value] = true;\r\n            },\r\n        },\r\n        Directive: {\r\n            enter: function (node) {\r\n                if (getDirectiveMatcher(directives)(node)) {\r\n                    return null;\r\n                }\r\n            },\r\n        },\r\n    }));\r\n    if (modifiedDoc &&\r\n        filterInPlace(variablesToRemove, function (v) { return !!v.name && !variablesInUse[v.name]; }).length) {\r\n        modifiedDoc = removeArgumentsFromDocument(variablesToRemove, modifiedDoc);\r\n    }\r\n    if (modifiedDoc &&\r\n        filterInPlace(fragmentSpreadsToRemove, function (fs) { return !!fs.name && !fragmentSpreadsInUse[fs.name]; })\r\n            .length) {\r\n        modifiedDoc = removeFragmentSpreadFromDocument(fragmentSpreadsToRemove, modifiedDoc);\r\n    }\r\n    return modifiedDoc;\r\n}\r\nexport var addTypenameToDocument = Object.assign(function (doc) {\r\n    return visit(checkDocument(doc), {\r\n        SelectionSet: {\r\n            enter: function (node, _key, parent) {\r\n                if (parent &&\r\n                    parent.kind === 'OperationDefinition') {\r\n                    return;\r\n                }\r\n                var selections = node.selections;\r\n                if (!selections) {\r\n                    return;\r\n                }\r\n                var skip = selections.some(function (selection) {\r\n                    return (isField(selection) &&\r\n                        (selection.name.value === '__typename' ||\r\n                            selection.name.value.lastIndexOf('__', 0) === 0));\r\n                });\r\n                if (skip) {\r\n                    return;\r\n                }\r\n                var field = parent;\r\n                if (isField(field) &&\r\n                    field.directives &&\r\n                    field.directives.some(function (d) { return d.name.value === 'export'; })) {\r\n                    return;\r\n                }\r\n                return __assign(__assign({}, node), { selections: __spreadArray(__spreadArray([], selections, true), [TYPENAME_FIELD], false) });\r\n            },\r\n        },\r\n    });\r\n}, {\r\n    added: function (field) {\r\n        return field === TYPENAME_FIELD;\r\n    },\r\n});\r\nvar connectionRemoveConfig = {\r\n    test: function (directive) {\r\n        var willRemove = directive.name.value === 'connection';\r\n        if (willRemove) {\r\n            if (!directive.arguments ||\r\n                !directive.arguments.some(function (arg) { return arg.name.value === 'key'; })) {\r\n                __DEV__ && invariant.warn('Removing an @connection directive even though it does not have a key. ' +\r\n                    'You may want to use the key parameter to specify a store key.');\r\n            }\r\n        }\r\n        return willRemove;\r\n    },\r\n};\r\nexport function removeConnectionDirectiveFromDocument(doc) {\r\n    return removeDirectivesFromDocument([connectionRemoveConfig], checkDocument(doc));\r\n}\r\nfunction hasDirectivesInSelectionSet(directives, selectionSet, nestedCheck) {\r\n    if (nestedCheck === void 0) { nestedCheck = true; }\r\n    return (!!selectionSet &&\r\n        selectionSet.selections &&\r\n        selectionSet.selections.some(function (selection) {\r\n            return hasDirectivesInSelection(directives, selection, nestedCheck);\r\n        }));\r\n}\r\nfunction hasDirectivesInSelection(directives, selection, nestedCheck) {\r\n    if (nestedCheck === void 0) { nestedCheck = true; }\r\n    if (!isField(selection)) {\r\n        return true;\r\n    }\r\n    if (!selection.directives) {\r\n        return false;\r\n    }\r\n    return (selection.directives.some(getDirectiveMatcher(directives)) ||\r\n        (nestedCheck &&\r\n            hasDirectivesInSelectionSet(directives, selection.selectionSet, nestedCheck)));\r\n}\r\nfunction getArgumentMatcher(config) {\r\n    return function argumentMatcher(argument) {\r\n        return config.some(function (aConfig) {\r\n            return argument.value &&\r\n                argument.value.kind === 'Variable' &&\r\n                argument.value.name &&\r\n                (aConfig.name === argument.value.name.value ||\r\n                    (aConfig.test && aConfig.test(argument)));\r\n        });\r\n    };\r\n}\r\nexport function removeArgumentsFromDocument(config, doc) {\r\n    var argMatcher = getArgumentMatcher(config);\r\n    return nullIfDocIsEmpty(visit(doc, {\r\n        OperationDefinition: {\r\n            enter: function (node) {\r\n                return __assign(__assign({}, node), { variableDefinitions: node.variableDefinitions ? node.variableDefinitions.filter(function (varDef) {\r\n                        return !config.some(function (arg) { return arg.name === varDef.variable.name.value; });\r\n                    }) : [] });\r\n            },\r\n        },\r\n        Field: {\r\n            enter: function (node) {\r\n                var shouldRemoveField = config.some(function (argConfig) { return argConfig.remove; });\r\n                if (shouldRemoveField) {\r\n                    var argMatchCount_1 = 0;\r\n                    if (node.arguments) {\r\n                        node.arguments.forEach(function (arg) {\r\n                            if (argMatcher(arg)) {\r\n                                argMatchCount_1 += 1;\r\n                            }\r\n                        });\r\n                    }\r\n                    if (argMatchCount_1 === 1) {\r\n                        return null;\r\n                    }\r\n                }\r\n            },\r\n        },\r\n        Argument: {\r\n            enter: function (node) {\r\n                if (argMatcher(node)) {\r\n                    return null;\r\n                }\r\n            },\r\n        },\r\n    }));\r\n}\r\nexport function removeFragmentSpreadFromDocument(config, doc) {\r\n    function enter(node) {\r\n        if (config.some(function (def) { return def.name === node.name.value; })) {\r\n            return null;\r\n        }\r\n    }\r\n    return nullIfDocIsEmpty(visit(doc, {\r\n        FragmentSpread: { enter: enter },\r\n        FragmentDefinition: { enter: enter },\r\n    }));\r\n}\r\nfunction getAllFragmentSpreadsFromSelectionSet(selectionSet) {\r\n    var allFragments = [];\r\n    selectionSet.selections.forEach(function (selection) {\r\n        if ((isField(selection) || isInlineFragment(selection)) &&\r\n            selection.selectionSet) {\r\n            getAllFragmentSpreadsFromSelectionSet(selection.selectionSet).forEach(function (frag) { return allFragments.push(frag); });\r\n        }\r\n        else if (selection.kind === 'FragmentSpread') {\r\n            allFragments.push(selection);\r\n        }\r\n    });\r\n    return allFragments;\r\n}\r\nexport function buildQueryFromSelectionSet(document) {\r\n    var definition = getMainDefinition(document);\r\n    var definitionOperation = definition.operation;\r\n    if (definitionOperation === 'query') {\r\n        return document;\r\n    }\r\n    var modifiedDoc = visit(document, {\r\n        OperationDefinition: {\r\n            enter: function (node) {\r\n                return __assign(__assign({}, node), { operation: 'query' });\r\n            },\r\n        },\r\n    });\r\n    return modifiedDoc;\r\n}\r\nexport function removeClientSetsFromDocument(document) {\r\n    checkDocument(document);\r\n    var modifiedDoc = removeDirectivesFromDocument([\r\n        {\r\n            test: function (directive) { return directive.name.value === 'client'; },\r\n            remove: true,\r\n        },\r\n    ], document);\r\n    if (modifiedDoc) {\r\n        modifiedDoc = visit(modifiedDoc, {\r\n            FragmentDefinition: {\r\n                enter: function (node) {\r\n                    if (node.selectionSet) {\r\n                        var isTypenameOnly = node.selectionSet.selections.every(function (selection) {\r\n                            return isField(selection) && selection.name.value === '__typename';\r\n                        });\r\n                        if (isTypenameOnly) {\r\n                            return null;\r\n                        }\r\n                    }\r\n                },\r\n            },\r\n        });\r\n    }\r\n    return modifiedDoc;\r\n}\r\n","// This currentContext variable will only be used if the makeSlotClass\r\n// function is called, which happens only if this is the first copy of the\r\n// @wry/context package to be imported.\r\nvar currentContext = null;\r\n// This unique internal object is used to denote the absence of a value\r\n// for a given Slot, and is never exposed to outside code.\r\nvar MISSING_VALUE = {};\r\nvar idCounter = 1;\r\n// Although we can't do anything about the cost of duplicated code from\r\n// accidentally bundling multiple copies of the @wry/context package, we can\r\n// avoid creating the Slot class more than once using makeSlotClass.\r\nvar makeSlotClass = function () { return /** @class */ (function () {\r\n    function Slot() {\r\n        // If you have a Slot object, you can find out its slot.id, but you cannot\r\n        // guess the slot.id of a Slot you don't have access to, thanks to the\r\n        // randomized suffix.\r\n        this.id = [\r\n            \"slot\",\r\n            idCounter++,\r\n            Date.now(),\r\n            Math.random().toString(36).slice(2),\r\n        ].join(\":\");\r\n    }\r\n    Slot.prototype.hasValue = function () {\r\n        for (var context_1 = currentContext; context_1; context_1 = context_1.parent) {\r\n            // We use the Slot object iself as a key to its value, which means the\r\n            // value cannot be obtained without a reference to the Slot object.\r\n            if (this.id in context_1.slots) {\r\n                var value = context_1.slots[this.id];\r\n                if (value === MISSING_VALUE)\r\n                    break;\r\n                if (context_1 !== currentContext) {\r\n                    // Cache the value in currentContext.slots so the next lookup will\r\n                    // be faster. This caching is safe because the tree of contexts and\r\n                    // the values of the slots are logically immutable.\r\n                    currentContext.slots[this.id] = value;\r\n                }\r\n                return true;\r\n            }\r\n        }\r\n        if (currentContext) {\r\n            // If a value was not found for this Slot, it's never going to be found\r\n            // no matter how many times we look it up, so we might as well cache\r\n            // the absence of the value, too.\r\n            currentContext.slots[this.id] = MISSING_VALUE;\r\n        }\r\n        return false;\r\n    };\r\n    Slot.prototype.getValue = function () {\r\n        if (this.hasValue()) {\r\n            return currentContext.slots[this.id];\r\n        }\r\n    };\r\n    Slot.prototype.withValue = function (value, callback, \r\n    // Given the prevalence of arrow functions, specifying arguments is likely\r\n    // to be much more common than specifying `this`, hence this ordering:\r\n    args, thisArg) {\r\n        var _a;\r\n        var slots = (_a = {\r\n                __proto__: null\r\n            },\r\n            _a[this.id] = value,\r\n            _a);\r\n        var parent = currentContext;\r\n        currentContext = { parent: parent, slots: slots };\r\n        try {\r\n            // Function.prototype.apply allows the arguments array argument to be\r\n            // omitted or undefined, so args! is fine here.\r\n            return callback.apply(thisArg, args);\r\n        }\r\n        finally {\r\n            currentContext = parent;\r\n        }\r\n    };\r\n    // Capture the current context and wrap a callback function so that it\r\n    // reestablishes the captured context when called.\r\n    Slot.bind = function (callback) {\r\n        var context = currentContext;\r\n        return function () {\r\n            var saved = currentContext;\r\n            try {\r\n                currentContext = context;\r\n                return callback.apply(this, arguments);\r\n            }\r\n            finally {\r\n                currentContext = saved;\r\n            }\r\n        };\r\n    };\r\n    // Immediately run a callback function without any captured context.\r\n    Slot.noContext = function (callback, \r\n    // Given the prevalence of arrow functions, specifying arguments is likely\r\n    // to be much more common than specifying `this`, hence this ordering:\r\n    args, thisArg) {\r\n        if (currentContext) {\r\n            var saved = currentContext;\r\n            try {\r\n                currentContext = null;\r\n                // Function.prototype.apply allows the arguments array argument to be\r\n                // omitted or undefined, so args! is fine here.\r\n                return callback.apply(thisArg, args);\r\n            }\r\n            finally {\r\n                currentContext = saved;\r\n            }\r\n        }\r\n        else {\r\n            return callback.apply(thisArg, args);\r\n        }\r\n    };\r\n    return Slot;\r\n}()); };\r\n// We store a single global implementation of the Slot class as a permanent\r\n// non-enumerable symbol property of the Array constructor. This obfuscation\r\n// does nothing to prevent access to the Slot class, but at least it ensures\r\n// the implementation (i.e. currentContext) cannot be tampered with, and all\r\n// copies of the @wry/context package (hopefully just one) will share the\r\n// same Slot implementation. Since the first copy of the @wry/context package\r\n// to be imported wins, this technique imposes a very high cost for any\r\n// future breaking changes to the Slot class.\r\nvar globalKey = \"@wry/context:Slot\";\r\nvar host = Array;\r\nvar Slot = host[globalKey] || function () {\r\n    var Slot = makeSlotClass();\r\n    try {\r\n        Object.defineProperty(host, globalKey, {\r\n            value: host[globalKey] = Slot,\r\n            enumerable: false,\r\n            writable: false,\r\n            configurable: false,\r\n        });\r\n    }\r\n    finally {\r\n        return Slot;\r\n    }\r\n}();\r\n\r\nvar bind = Slot.bind, noContext = Slot.noContext;\r\nfunction setTimeoutWithContext(callback, delay) {\r\n    return setTimeout(bind(callback), delay);\r\n}\r\n// Turn any generator function into an async function (using yield instead\r\n// of await), with context automatically preserved across yields.\r\nfunction asyncFromGen(genFn) {\r\n    return function () {\r\n        var gen = genFn.apply(this, arguments);\r\n        var boundNext = bind(gen.next);\r\n        var boundThrow = bind(gen.throw);\r\n        return new Promise(function (resolve, reject) {\r\n            function invoke(method, argument) {\r\n                try {\r\n                    var result = method.call(gen, argument);\r\n                }\r\n                catch (error) {\r\n                    return reject(error);\r\n                }\r\n                var next = result.done ? resolve : invokeNext;\r\n                if (isPromiseLike(result.value)) {\r\n                    result.value.then(next, result.done ? reject : invokeThrow);\r\n                }\r\n                else {\r\n                    next(result.value);\r\n                }\r\n            }\r\n            var invokeNext = function (value) { return invoke(boundNext, value); };\r\n            var invokeThrow = function (error) { return invoke(boundThrow, error); };\r\n            invokeNext();\r\n        });\r\n    };\r\n}\r\nfunction isPromiseLike(value) {\r\n    return value && typeof value.then === \"function\";\r\n}\r\n// If you use the fibers npm package to implement coroutines in Node.js,\r\n// you should call this function at least once to ensure context management\r\n// remains coherent across any yields.\r\nvar wrappedFibers = [];\r\nfunction wrapYieldingFiberMethods(Fiber) {\r\n    // There can be only one implementation of Fiber per process, so this array\r\n    // should never grow longer than one element.\r\n    if (wrappedFibers.indexOf(Fiber) < 0) {\r\n        var wrap = function (obj, method) {\r\n            var fn = obj[method];\r\n            obj[method] = function () {\r\n                return noContext(fn, arguments, this);\r\n            };\r\n        };\r\n        // These methods can yield, according to\r\n        // https://github.com/laverdet/node-fibers/blob/ddebed9b8ae3883e57f822e2108e6943e5c8d2a8/fibers.js#L97-L100\r\n        wrap(Fiber, \"yield\");\r\n        wrap(Fiber.prototype, \"run\");\r\n        wrap(Fiber.prototype, \"throwInto\");\r\n        wrappedFibers.push(Fiber);\r\n    }\r\n    return Fiber;\r\n}\r\n\r\nexport { Slot, asyncFromGen, bind, noContext, setTimeoutWithContext as setTimeout, wrapYieldingFiberMethods };\r\n\n","var _a = Object.prototype, toString = _a.toString, hasOwnProperty = _a.hasOwnProperty;\r\nvar fnToStr = Function.prototype.toString;\r\nvar previousComparisons = new Map();\r\n/**\r\n * Performs a deep equality check on two JavaScript values, tolerating cycles.\r\n */\r\nfunction equal(a, b) {\r\n    try {\r\n        return check(a, b);\r\n    }\r\n    finally {\r\n        previousComparisons.clear();\r\n    }\r\n}\r\nfunction check(a, b) {\r\n    // If the two values are strictly equal, our job is easy.\r\n    if (a === b) {\r\n        return true;\r\n    }\r\n    // Object.prototype.toString returns a representation of the runtime type of\r\n    // the given value that is considerably more precise than typeof.\r\n    var aTag = toString.call(a);\r\n    var bTag = toString.call(b);\r\n    // If the runtime types of a and b are different, they could maybe be equal\r\n    // under some interpretation of equality, but for simplicity and performance\r\n    // we just return false instead.\r\n    if (aTag !== bTag) {\r\n        return false;\r\n    }\r\n    switch (aTag) {\r\n        case '[object Array]':\r\n            // Arrays are a lot like other objects, but we can cheaply compare their\r\n            // lengths as a short-cut before comparing their elements.\r\n            if (a.length !== b.length)\r\n                return false;\r\n        // Fall through to object case...\r\n        case '[object Object]': {\r\n            if (previouslyCompared(a, b))\r\n                return true;\r\n            var aKeys = definedKeys(a);\r\n            var bKeys = definedKeys(b);\r\n            // If `a` and `b` have a different number of enumerable keys, they\r\n            // must be different.\r\n            var keyCount = aKeys.length;\r\n            if (keyCount !== bKeys.length)\r\n                return false;\r\n            // Now make sure they have the same keys.\r\n            for (var k = 0; k < keyCount; ++k) {\r\n                if (!hasOwnProperty.call(b, aKeys[k])) {\r\n                    return false;\r\n                }\r\n            }\r\n            // Finally, check deep equality of all child properties.\r\n            for (var k = 0; k < keyCount; ++k) {\r\n                var key = aKeys[k];\r\n                if (!check(a[key], b[key])) {\r\n                    return false;\r\n                }\r\n            }\r\n            return true;\r\n        }\r\n        case '[object Error]':\r\n            return a.name === b.name && a.message === b.message;\r\n        case '[object Number]':\r\n            // Handle NaN, which is !== itself.\r\n            if (a !== a)\r\n                return b !== b;\r\n        // Fall through to shared +a === +b case...\r\n        case '[object Boolean]':\r\n        case '[object Date]':\r\n            return +a === +b;\r\n        case '[object RegExp]':\r\n        case '[object String]':\r\n            return a == \"\" + b;\r\n        case '[object Map]':\r\n        case '[object Set]': {\r\n            if (a.size !== b.size)\r\n                return false;\r\n            if (previouslyCompared(a, b))\r\n                return true;\r\n            var aIterator = a.entries();\r\n            var isMap = aTag === '[object Map]';\r\n            while (true) {\r\n                var info = aIterator.next();\r\n                if (info.done)\r\n                    break;\r\n                // If a instanceof Set, aValue === aKey.\r\n                var _a = info.value, aKey = _a[0], aValue = _a[1];\r\n                // So this works the same way for both Set and Map.\r\n                if (!b.has(aKey)) {\r\n                    return false;\r\n                }\r\n                // However, we care about deep equality of values only when dealing\r\n                // with Map structures.\r\n                if (isMap && !check(aValue, b.get(aKey))) {\r\n                    return false;\r\n                }\r\n            }\r\n            return true;\r\n        }\r\n        case '[object Uint16Array]':\r\n        case '[object Uint8Array]': // Buffer, in Node.js.\r\n        case '[object Uint32Array]':\r\n        case '[object Int32Array]':\r\n        case '[object Int8Array]':\r\n        case '[object Int16Array]':\r\n        case '[object ArrayBuffer]':\r\n            // DataView doesn't need these conversions, but the equality check is\r\n            // otherwise the same.\r\n            a = new Uint8Array(a);\r\n            b = new Uint8Array(b);\r\n        // Fall through...\r\n        case '[object DataView]': {\r\n            var len = a.byteLength;\r\n            if (len === b.byteLength) {\r\n                while (len-- && a[len] === b[len]) {\r\n                    // Keep looping as long as the bytes are equal.\r\n                }\r\n            }\r\n            return len === -1;\r\n        }\r\n        case '[object AsyncFunction]':\r\n        case '[object GeneratorFunction]':\r\n        case '[object AsyncGeneratorFunction]':\r\n        case '[object Function]': {\r\n            var aCode = fnToStr.call(a);\r\n            if (aCode !== fnToStr.call(b)) {\r\n                return false;\r\n            }\r\n            // We consider non-native functions equal if they have the same code\r\n            // (native functions require === because their code is censored).\r\n            // Note that this behavior is not entirely sound, since !== function\r\n            // objects with the same code can behave differently depending on\r\n            // their closure scope. However, any function can behave differently\r\n            // depending on the values of its input arguments (including this)\r\n            // and its calling context (including its closure scope), even\r\n            // though the function object is === to itself; and it is entirely\r\n            // possible for functions that are not === to behave exactly the\r\n            // same under all conceivable circumstances. Because none of these\r\n            // factors are statically decidable in JavaScript, JS function\r\n            // equality is not well-defined. This ambiguity allows us to\r\n            // consider the best possible heuristic among various imperfect\r\n            // options, and equating non-native functions that have the same\r\n            // code has enormous practical benefits, such as when comparing\r\n            // functions that are repeatedly passed as fresh function\r\n            // expressions within objects that are otherwise deeply equal. Since\r\n            // any function created from the same syntactic expression (in the\r\n            // same code location) will always stringify to the same code\r\n            // according to fnToStr.call, we can reasonably expect these\r\n            // repeatedly passed function expressions to have the same code, and\r\n            // thus behave \"the same\" (with all the caveats mentioned above),\r\n            // even though the runtime function objects are !== to one another.\r\n            return !endsWith(aCode, nativeCodeSuffix);\r\n        }\r\n    }\r\n    // Otherwise the values are not equal.\r\n    return false;\r\n}\r\nfunction definedKeys(obj) {\r\n    // Remember that the second argument to Array.prototype.filter will be\r\n    // used as `this` within the callback function.\r\n    return Object.keys(obj).filter(isDefinedKey, obj);\r\n}\r\nfunction isDefinedKey(key) {\r\n    return this[key] !== void 0;\r\n}\r\nvar nativeCodeSuffix = \"{ [native code] }\";\r\nfunction endsWith(full, suffix) {\r\n    var fromIndex = full.length - suffix.length;\r\n    return fromIndex >= 0 &&\r\n        full.indexOf(suffix, fromIndex) === fromIndex;\r\n}\r\nfunction previouslyCompared(a, b) {\r\n    // Though cyclic references can make an object graph appear infinite from the\r\n    // perspective of a depth-first traversal, the graph still contains a finite\r\n    // number of distinct object references. We use the previousComparisons cache\r\n    // to avoid comparing the same pair of object references more than once, which\r\n    // guarantees termination (even if we end up comparing every object in one\r\n    // graph to every object in the other graph, which is extremely unlikely),\r\n    // while still allowing weird isomorphic structures (like rings with different\r\n    // lengths) a chance to pass the equality test.\r\n    var bSet = previousComparisons.get(a);\r\n    if (bSet) {\r\n        // Return true here because we can be sure false will be returned somewhere\r\n        // else if the objects are not equivalent.\r\n        if (bSet.has(b))\r\n            return true;\r\n    }\r\n    else {\r\n        previousComparisons.set(a, bSet = new Set);\r\n    }\r\n    bSet.add(b);\r\n    return false;\r\n}\r\n\r\nexport { equal as default, equal };\r\n\n","// A [trie](https://en.wikipedia.org/wiki/Trie) data structure that holds\r\n// object keys weakly, yet can also hold non-object keys, unlike the\r\n// native `WeakMap`.\r\n// If no makeData function is supplied, the looked-up data will be an empty,\r\n// null-prototype Object.\r\nvar defaultMakeData = function () { return Object.create(null); };\r\n// Useful for processing arguments objects as well as arrays.\r\nvar _a = Array.prototype, forEach = _a.forEach, slice = _a.slice;\r\nvar Trie = /** @class */ (function () {\r\n    function Trie(weakness, makeData) {\r\n        if (weakness === void 0) { weakness = true; }\r\n        if (makeData === void 0) { makeData = defaultMakeData; }\r\n        this.weakness = weakness;\r\n        this.makeData = makeData;\r\n    }\r\n    Trie.prototype.lookup = function () {\r\n        var array = [];\r\n        for (var _i = 0; _i < arguments.length; _i++) {\r\n            array[_i] = arguments[_i];\r\n        }\r\n        return this.lookupArray(array);\r\n    };\r\n    Trie.prototype.lookupArray = function (array) {\r\n        var node = this;\r\n        forEach.call(array, function (key) { return node = node.getChildTrie(key); });\r\n        return node.data || (node.data = this.makeData(slice.call(array)));\r\n    };\r\n    Trie.prototype.getChildTrie = function (key) {\r\n        var map = this.weakness && isObjRef(key)\r\n            ? this.weak || (this.weak = new WeakMap())\r\n            : this.strong || (this.strong = new Map());\r\n        var child = map.get(key);\r\n        if (!child)\r\n            map.set(key, child = new Trie(this.weakness, this.makeData));\r\n        return child;\r\n    };\r\n    return Trie;\r\n}());\r\nfunction isObjRef(value) {\r\n    switch (typeof value) {\r\n        case \"object\":\r\n            if (value === null)\r\n                break;\r\n        // Fall through to return true...\r\n        case \"function\":\r\n            return true;\r\n    }\r\n    return false;\r\n}\r\n\r\nexport { Trie };\r\n\n","'use strict';\r\n\r\nmodule.exports = function ReactNativeFile(_ref) {\r\n  var uri = _ref.uri,\r\n    name = _ref.name,\r\n    type = _ref.type;\r\n  this.uri = uri;\r\n  this.name = name;\r\n  this.type = type;\r\n};\r\n","'use strict';\r\n\r\nvar defaultIsExtractableFile = require('./isExtractableFile');\r\n\r\nmodule.exports = function extractFiles(value, path, isExtractableFile) {\r\n  if (path === void 0) {\r\n    path = '';\r\n  }\r\n\r\n  if (isExtractableFile === void 0) {\r\n    isExtractableFile = defaultIsExtractableFile;\r\n  }\r\n\r\n  var clone;\r\n  var files = new Map();\r\n\r\n  function addFile(paths, file) {\r\n    var storedPaths = files.get(file);\r\n    if (storedPaths) storedPaths.push.apply(storedPaths, paths);\r\n    else files.set(file, paths);\r\n  }\r\n\r\n  if (isExtractableFile(value)) {\r\n    clone = null;\r\n    addFile([path], value);\r\n  } else {\r\n    var prefix = path ? path + '.' : '';\r\n    if (typeof FileList !== 'undefined' && value instanceof FileList)\r\n      clone = Array.prototype.map.call(value, function (file, i) {\r\n        addFile(['' + prefix + i], file);\r\n        return null;\r\n      });\r\n    else if (Array.isArray(value))\r\n      clone = value.map(function (child, i) {\r\n        var result = extractFiles(child, '' + prefix + i, isExtractableFile);\r\n        result.files.forEach(addFile);\r\n        return result.clone;\r\n      });\r\n    else if (value && value.constructor === Object) {\r\n      clone = {};\r\n\r\n      for (var i in value) {\r\n        var result = extractFiles(value[i], '' + prefix + i, isExtractableFile);\r\n        result.files.forEach(addFile);\r\n        clone[i] = result.clone;\r\n      }\r\n    } else clone = value;\r\n  }\r\n\r\n  return {\r\n    clone: clone,\r\n    files: files,\r\n  };\r\n};\r\n","'use strict';\r\n\r\nvar ReactNativeFile = require('./ReactNativeFile');\r\n\r\nmodule.exports = function isExtractableFile(value) {\r\n  return (\r\n    (typeof File !== 'undefined' && value instanceof File) ||\r\n    (typeof Blob !== 'undefined' && value instanceof Blob) ||\r\n    value instanceof ReactNativeFile\r\n  );\r\n};\r\n","import { Trie } from '@wry/trie';\r\nexport { Trie as KeyTrie } from '@wry/trie';\r\nimport { Slot } from '@wry/context';\r\nexport { asyncFromGen, bind as bindContext, noContext, setTimeout } from '@wry/context';\r\n\r\nfunction defaultDispose() { }\r\nvar Cache = /** @class */ (function () {\r\n    function Cache(max, dispose) {\r\n        if (max === void 0) { max = Infinity; }\r\n        if (dispose === void 0) { dispose = defaultDispose; }\r\n        this.max = max;\r\n        this.dispose = dispose;\r\n        this.map = new Map();\r\n        this.newest = null;\r\n        this.oldest = null;\r\n    }\r\n    Cache.prototype.has = function (key) {\r\n        return this.map.has(key);\r\n    };\r\n    Cache.prototype.get = function (key) {\r\n        var node = this.getNode(key);\r\n        return node && node.value;\r\n    };\r\n    Cache.prototype.getNode = function (key) {\r\n        var node = this.map.get(key);\r\n        if (node && node !== this.newest) {\r\n            var older = node.older, newer = node.newer;\r\n            if (newer) {\r\n                newer.older = older;\r\n            }\r\n            if (older) {\r\n                older.newer = newer;\r\n            }\r\n            node.older = this.newest;\r\n            node.older.newer = node;\r\n            node.newer = null;\r\n            this.newest = node;\r\n            if (node === this.oldest) {\r\n                this.oldest = newer;\r\n            }\r\n        }\r\n        return node;\r\n    };\r\n    Cache.prototype.set = function (key, value) {\r\n        var node = this.getNode(key);\r\n        if (node) {\r\n            return node.value = value;\r\n        }\r\n        node = {\r\n            key: key,\r\n            value: value,\r\n            newer: null,\r\n            older: this.newest\r\n        };\r\n        if (this.newest) {\r\n            this.newest.newer = node;\r\n        }\r\n        this.newest = node;\r\n        this.oldest = this.oldest || node;\r\n        this.map.set(key, node);\r\n        return node.value;\r\n    };\r\n    Cache.prototype.clean = function () {\r\n        while (this.oldest && this.map.size > this.max) {\r\n            this.delete(this.oldest.key);\r\n        }\r\n    };\r\n    Cache.prototype.delete = function (key) {\r\n        var node = this.map.get(key);\r\n        if (node) {\r\n            if (node === this.newest) {\r\n                this.newest = node.older;\r\n            }\r\n            if (node === this.oldest) {\r\n                this.oldest = node.newer;\r\n            }\r\n            if (node.newer) {\r\n                node.newer.older = node.older;\r\n            }\r\n            if (node.older) {\r\n                node.older.newer = node.newer;\r\n            }\r\n            this.map.delete(key);\r\n            this.dispose(node.value, key);\r\n            return true;\r\n        }\r\n        return false;\r\n    };\r\n    return Cache;\r\n}());\r\n\r\nvar parentEntrySlot = new Slot();\r\n\r\nvar _a;\r\nvar hasOwnProperty = Object.prototype.hasOwnProperty;\r\nvar \r\n// This Array.from polyfill is restricted to working with Set<any> for now,\r\n// but we can improve the polyfill and add other input types, as needed. Note\r\n// that this fallback implementation will only be used if the host environment\r\n// does not support a native Array.from function. In most modern JS runtimes,\r\n// the toArray function exported here will be === Array.from.\r\ntoArray = (_a = Array.from, _a === void 0 ? function (collection) {\r\n    var array = [];\r\n    collection.forEach(function (item) { return array.push(item); });\r\n    return array;\r\n} : _a);\r\nfunction maybeUnsubscribe(entryOrDep) {\r\n    var unsubscribe = entryOrDep.unsubscribe;\r\n    if (typeof unsubscribe === \"function\") {\r\n        entryOrDep.unsubscribe = void 0;\r\n        unsubscribe();\r\n    }\r\n}\r\n\r\nvar emptySetPool = [];\r\nvar POOL_TARGET_SIZE = 100;\r\n// Since this package might be used browsers, we should avoid using the\r\n// Node built-in assert module.\r\nfunction assert(condition, optionalMessage) {\r\n    if (!condition) {\r\n        throw new Error(optionalMessage || \"assertion failure\");\r\n    }\r\n}\r\nfunction valueIs(a, b) {\r\n    var len = a.length;\r\n    return (\r\n    // Unknown values are not equal to each other.\r\n    len > 0 &&\r\n        // Both values must be ordinary (or both exceptional) to be equal.\r\n        len === b.length &&\r\n        // The underlying value or exception must be the same.\r\n        a[len - 1] === b[len - 1]);\r\n}\r\nfunction valueGet(value) {\r\n    switch (value.length) {\r\n        case 0: throw new Error(\"unknown value\");\r\n        case 1: return value[0];\r\n        case 2: throw value[1];\r\n    }\r\n}\r\nfunction valueCopy(value) {\r\n    return value.slice(0);\r\n}\r\nvar Entry = /** @class */ (function () {\r\n    function Entry(fn) {\r\n        this.fn = fn;\r\n        this.parents = new Set();\r\n        this.childValues = new Map();\r\n        // When this Entry has children that are dirty, this property becomes\r\n        // a Set containing other Entry objects, borrowed from emptySetPool.\r\n        // When the set becomes empty, it gets recycled back to emptySetPool.\r\n        this.dirtyChildren = null;\r\n        this.dirty = true;\r\n        this.recomputing = false;\r\n        this.value = [];\r\n        this.deps = null;\r\n        ++Entry.count;\r\n    }\r\n    Entry.prototype.peek = function () {\r\n        if (this.value.length === 1 && !mightBeDirty(this)) {\r\n            rememberParent(this);\r\n            return this.value[0];\r\n        }\r\n    };\r\n    // This is the most important method of the Entry API, because it\r\n    // determines whether the cached this.value can be returned immediately,\r\n    // or must be recomputed. The overall performance of the caching system\r\n    // depends on the truth of the following observations: (1) this.dirty is\r\n    // usually false, (2) this.dirtyChildren is usually null/empty, and thus\r\n    // (3) valueGet(this.value) is usually returned without recomputation.\r\n    Entry.prototype.recompute = function (args) {\r\n        assert(!this.recomputing, \"already recomputing\");\r\n        rememberParent(this);\r\n        return mightBeDirty(this)\r\n            ? reallyRecompute(this, args)\r\n            : valueGet(this.value);\r\n    };\r\n    Entry.prototype.setDirty = function () {\r\n        if (this.dirty)\r\n            return;\r\n        this.dirty = true;\r\n        this.value.length = 0;\r\n        reportDirty(this);\r\n        // We can go ahead and unsubscribe here, since any further dirty\r\n        // notifications we receive will be redundant, and unsubscribing may\r\n        // free up some resources, e.g. file watchers.\r\n        maybeUnsubscribe(this);\r\n    };\r\n    Entry.prototype.dispose = function () {\r\n        var _this = this;\r\n        this.setDirty();\r\n        // Sever any dependency relationships with our own children, so those\r\n        // children don't retain this parent Entry in their child.parents sets,\r\n        // thereby preventing it from being fully garbage collected.\r\n        forgetChildren(this);\r\n        // Because this entry has been kicked out of the cache (in index.js),\r\n        // we've lost the ability to find out if/when this entry becomes dirty,\r\n        // whether that happens through a subscription, because of a direct call\r\n        // to entry.setDirty(), or because one of its children becomes dirty.\r\n        // Because of this loss of future information, we have to assume the\r\n        // worst (that this entry might have become dirty very soon), so we must\r\n        // immediately mark this entry's parents as dirty. Normally we could\r\n        // just call entry.setDirty() rather than calling parent.setDirty() for\r\n        // each parent, but that would leave this entry in parent.childValues\r\n        // and parent.dirtyChildren, which would prevent the child from being\r\n        // truly forgotten.\r\n        eachParent(this, function (parent, child) {\r\n            parent.setDirty();\r\n            forgetChild(parent, _this);\r\n        });\r\n    };\r\n    Entry.prototype.forget = function () {\r\n        // The code that creates Entry objects in index.ts will replace this method\r\n        // with one that actually removes the Entry from the cache, which will also\r\n        // trigger the entry.dispose method.\r\n        this.dispose();\r\n    };\r\n    Entry.prototype.dependOn = function (dep) {\r\n        dep.add(this);\r\n        if (!this.deps) {\r\n            this.deps = emptySetPool.pop() || new Set();\r\n        }\r\n        this.deps.add(dep);\r\n    };\r\n    Entry.prototype.forgetDeps = function () {\r\n        var _this = this;\r\n        if (this.deps) {\r\n            toArray(this.deps).forEach(function (dep) { return dep.delete(_this); });\r\n            this.deps.clear();\r\n            emptySetPool.push(this.deps);\r\n            this.deps = null;\r\n        }\r\n    };\r\n    Entry.count = 0;\r\n    return Entry;\r\n}());\r\nfunction rememberParent(child) {\r\n    var parent = parentEntrySlot.getValue();\r\n    if (parent) {\r\n        child.parents.add(parent);\r\n        if (!parent.childValues.has(child)) {\r\n            parent.childValues.set(child, []);\r\n        }\r\n        if (mightBeDirty(child)) {\r\n            reportDirtyChild(parent, child);\r\n        }\r\n        else {\r\n            reportCleanChild(parent, child);\r\n        }\r\n        return parent;\r\n    }\r\n}\r\nfunction reallyRecompute(entry, args) {\r\n    forgetChildren(entry);\r\n    // Set entry as the parent entry while calling recomputeNewValue(entry).\r\n    parentEntrySlot.withValue(entry, recomputeNewValue, [entry, args]);\r\n    if (maybeSubscribe(entry, args)) {\r\n        // If we successfully recomputed entry.value and did not fail to\r\n        // (re)subscribe, then this Entry is no longer explicitly dirty.\r\n        setClean(entry);\r\n    }\r\n    return valueGet(entry.value);\r\n}\r\nfunction recomputeNewValue(entry, args) {\r\n    entry.recomputing = true;\r\n    // Set entry.value as unknown.\r\n    entry.value.length = 0;\r\n    try {\r\n        // If entry.fn succeeds, entry.value will become a normal Value.\r\n        entry.value[0] = entry.fn.apply(null, args);\r\n    }\r\n    catch (e) {\r\n        // If entry.fn throws, entry.value will become exceptional.\r\n        entry.value[1] = e;\r\n    }\r\n    // Either way, this line is always reached.\r\n    entry.recomputing = false;\r\n}\r\nfunction mightBeDirty(entry) {\r\n    return entry.dirty || !!(entry.dirtyChildren && entry.dirtyChildren.size);\r\n}\r\nfunction setClean(entry) {\r\n    entry.dirty = false;\r\n    if (mightBeDirty(entry)) {\r\n        // This Entry may still have dirty children, in which case we can't\r\n        // let our parents know we're clean just yet.\r\n        return;\r\n    }\r\n    reportClean(entry);\r\n}\r\nfunction reportDirty(child) {\r\n    eachParent(child, reportDirtyChild);\r\n}\r\nfunction reportClean(child) {\r\n    eachParent(child, reportCleanChild);\r\n}\r\nfunction eachParent(child, callback) {\r\n    var parentCount = child.parents.size;\r\n    if (parentCount) {\r\n        var parents = toArray(child.parents);\r\n        for (var i = 0; i < parentCount; ++i) {\r\n            callback(parents[i], child);\r\n        }\r\n    }\r\n}\r\n// Let a parent Entry know that one of its children may be dirty.\r\nfunction reportDirtyChild(parent, child) {\r\n    // Must have called rememberParent(child) before calling\r\n    // reportDirtyChild(parent, child).\r\n    assert(parent.childValues.has(child));\r\n    assert(mightBeDirty(child));\r\n    var parentWasClean = !mightBeDirty(parent);\r\n    if (!parent.dirtyChildren) {\r\n        parent.dirtyChildren = emptySetPool.pop() || new Set;\r\n    }\r\n    else if (parent.dirtyChildren.has(child)) {\r\n        // If we already know this child is dirty, then we must have already\r\n        // informed our own parents that we are dirty, so we can terminate\r\n        // the recursion early.\r\n        return;\r\n    }\r\n    parent.dirtyChildren.add(child);\r\n    // If parent was clean before, it just became (possibly) dirty (according to\r\n    // mightBeDirty), since we just added child to parent.dirtyChildren.\r\n    if (parentWasClean) {\r\n        reportDirty(parent);\r\n    }\r\n}\r\n// Let a parent Entry know that one of its children is no longer dirty.\r\nfunction reportCleanChild(parent, child) {\r\n    // Must have called rememberChild(child) before calling\r\n    // reportCleanChild(parent, child).\r\n    assert(parent.childValues.has(child));\r\n    assert(!mightBeDirty(child));\r\n    var childValue = parent.childValues.get(child);\r\n    if (childValue.length === 0) {\r\n        parent.childValues.set(child, valueCopy(child.value));\r\n    }\r\n    else if (!valueIs(childValue, child.value)) {\r\n        parent.setDirty();\r\n    }\r\n    removeDirtyChild(parent, child);\r\n    if (mightBeDirty(parent)) {\r\n        return;\r\n    }\r\n    reportClean(parent);\r\n}\r\nfunction removeDirtyChild(parent, child) {\r\n    var dc = parent.dirtyChildren;\r\n    if (dc) {\r\n        dc.delete(child);\r\n        if (dc.size === 0) {\r\n            if (emptySetPool.length < POOL_TARGET_SIZE) {\r\n                emptySetPool.push(dc);\r\n            }\r\n            parent.dirtyChildren = null;\r\n        }\r\n    }\r\n}\r\n// Removes all children from this entry and returns an array of the\r\n// removed children.\r\nfunction forgetChildren(parent) {\r\n    if (parent.childValues.size > 0) {\r\n        parent.childValues.forEach(function (_value, child) {\r\n            forgetChild(parent, child);\r\n        });\r\n    }\r\n    // Remove this parent Entry from any sets to which it was added by the\r\n    // addToSet method.\r\n    parent.forgetDeps();\r\n    // After we forget all our children, this.dirtyChildren must be empty\r\n    // and therefore must have been reset to null.\r\n    assert(parent.dirtyChildren === null);\r\n}\r\nfunction forgetChild(parent, child) {\r\n    child.parents.delete(parent);\r\n    parent.childValues.delete(child);\r\n    removeDirtyChild(parent, child);\r\n}\r\nfunction maybeSubscribe(entry, args) {\r\n    if (typeof entry.subscribe === \"function\") {\r\n        try {\r\n            maybeUnsubscribe(entry); // Prevent double subscriptions.\r\n            entry.unsubscribe = entry.subscribe.apply(null, args);\r\n        }\r\n        catch (e) {\r\n            // If this Entry has a subscribe function and it threw an exception\r\n            // (or an unsubscribe function it previously returned now throws),\r\n            // return false to indicate that we were not able to subscribe (or\r\n            // unsubscribe), and this Entry should remain dirty.\r\n            entry.setDirty();\r\n            return false;\r\n        }\r\n    }\r\n    // Returning true indicates either that there was no entry.subscribe\r\n    // function or that it succeeded.\r\n    return true;\r\n}\r\n\r\nvar EntryMethods = {\r\n    setDirty: true,\r\n    dispose: true,\r\n    forget: true,\r\n};\r\nfunction dep(options) {\r\n    var depsByKey = new Map();\r\n    var subscribe = options && options.subscribe;\r\n    function depend(key) {\r\n        var parent = parentEntrySlot.getValue();\r\n        if (parent) {\r\n            var dep_1 = depsByKey.get(key);\r\n            if (!dep_1) {\r\n                depsByKey.set(key, dep_1 = new Set);\r\n            }\r\n            parent.dependOn(dep_1);\r\n            if (typeof subscribe === \"function\") {\r\n                maybeUnsubscribe(dep_1);\r\n                dep_1.unsubscribe = subscribe(key);\r\n            }\r\n        }\r\n    }\r\n    depend.dirty = function dirty(key, entryMethodName) {\r\n        var dep = depsByKey.get(key);\r\n        if (dep) {\r\n            var m_1 = (entryMethodName &&\r\n                hasOwnProperty.call(EntryMethods, entryMethodName)) ? entryMethodName : \"setDirty\";\r\n            // We have to use toArray(dep).forEach instead of dep.forEach, because\r\n            // modifying a Set while iterating over it can cause elements in the Set\r\n            // to be removed from the Set before they've been iterated over.\r\n            toArray(dep).forEach(function (entry) { return entry[m_1](); });\r\n            depsByKey.delete(key);\r\n            maybeUnsubscribe(dep);\r\n        }\r\n    };\r\n    return depend;\r\n}\r\n\r\nfunction makeDefaultMakeCacheKeyFunction() {\r\n    var keyTrie = new Trie(typeof WeakMap === \"function\");\r\n    return function () {\r\n        return keyTrie.lookupArray(arguments);\r\n    };\r\n}\r\n// The defaultMakeCacheKey function is remarkably powerful, because it gives\r\n// a unique object for any shallow-identical list of arguments. If you need\r\n// to implement a custom makeCacheKey function, you may find it helpful to\r\n// delegate the final work to defaultMakeCacheKey, which is why we export it\r\n// here. However, you may want to avoid defaultMakeCacheKey if your runtime\r\n// does not support WeakMap, or you have the ability to return a string key.\r\n// In those cases, just write your own custom makeCacheKey functions.\r\nvar defaultMakeCacheKey = makeDefaultMakeCacheKeyFunction();\r\nvar caches = new Set();\r\nfunction wrap(originalFunction, options) {\r\n    if (options === void 0) { options = Object.create(null); }\r\n    var cache = new Cache(options.max || Math.pow(2, 16), function (entry) { return entry.dispose(); });\r\n    var keyArgs = options.keyArgs;\r\n    var makeCacheKey = options.makeCacheKey ||\r\n        makeDefaultMakeCacheKeyFunction();\r\n    var optimistic = function () {\r\n        var key = makeCacheKey.apply(null, keyArgs ? keyArgs.apply(null, arguments) : arguments);\r\n        if (key === void 0) {\r\n            return originalFunction.apply(null, arguments);\r\n        }\r\n        var entry = cache.get(key);\r\n        if (!entry) {\r\n            cache.set(key, entry = new Entry(originalFunction));\r\n            entry.subscribe = options.subscribe;\r\n            // Give the Entry the ability to trigger cache.delete(key), even though\r\n            // the Entry itself does not know about key or cache.\r\n            entry.forget = function () { return cache.delete(key); };\r\n        }\r\n        var value = entry.recompute(Array.prototype.slice.call(arguments));\r\n        // Move this entry to the front of the least-recently used queue,\r\n        // since we just finished computing its value.\r\n        cache.set(key, entry);\r\n        caches.add(cache);\r\n        // Clean up any excess entries in the cache, but only if there is no\r\n        // active parent entry, meaning we're not in the middle of a larger\r\n        // computation that might be flummoxed by the cleaning.\r\n        if (!parentEntrySlot.hasValue()) {\r\n            caches.forEach(function (cache) { return cache.clean(); });\r\n            caches.clear();\r\n        }\r\n        return value;\r\n    };\r\n    Object.defineProperty(optimistic, \"size\", {\r\n        get: function () {\r\n            return cache[\"map\"].size;\r\n        },\r\n        configurable: false,\r\n        enumerable: false,\r\n    });\r\n    function dirtyKey(key) {\r\n        var entry = cache.get(key);\r\n        if (entry) {\r\n            entry.setDirty();\r\n        }\r\n    }\r\n    optimistic.dirtyKey = dirtyKey;\r\n    optimistic.dirty = function dirty() {\r\n        dirtyKey(makeCacheKey.apply(null, arguments));\r\n    };\r\n    function peekKey(key) {\r\n        var entry = cache.get(key);\r\n        if (entry) {\r\n            return entry.peek();\r\n        }\r\n    }\r\n    optimistic.peekKey = peekKey;\r\n    optimistic.peek = function peek() {\r\n        return peekKey(makeCacheKey.apply(null, arguments));\r\n    };\r\n    function forgetKey(key) {\r\n        return cache.delete(key);\r\n    }\r\n    optimistic.forgetKey = forgetKey;\r\n    optimistic.forget = function forget() {\r\n        return forgetKey(makeCacheKey.apply(null, arguments));\r\n    };\r\n    optimistic.makeCacheKey = makeCacheKey;\r\n    optimistic.getKey = keyArgs ? function getKey() {\r\n        return makeCacheKey.apply(null, keyArgs.apply(null, arguments));\r\n    } : makeCacheKey;\r\n    return Object.freeze(optimistic);\r\n}\r\n\r\nexport { defaultMakeCacheKey, dep, wrap };\r\n\n","function _createForOfIteratorHelperLoose(o, allowArrayLike) { var it = typeof Symbol !== \"undefined\" && o[Symbol.iterator] || o[\"@@iterator\"]; if (it) return (it = it.call(o)).next.bind(it); if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") { if (it) o = it; var i = 0; return function () { if (i >= o.length) return { done: true }; return { done: false, value: o[i++] }; }; } throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\r\n\r\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\r\n\r\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\r\n\r\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\r\n\r\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\r\n\r\n// === Symbol Support ===\r\nvar hasSymbols = function () {\r\n  return typeof Symbol === 'function';\r\n};\r\n\r\nvar hasSymbol = function (name) {\r\n  return hasSymbols() && Boolean(Symbol[name]);\r\n};\r\n\r\nvar getSymbol = function (name) {\r\n  return hasSymbol(name) ? Symbol[name] : '@@' + name;\r\n};\r\n\r\nif (hasSymbols() && !hasSymbol('observable')) {\r\n  Symbol.observable = Symbol('observable');\r\n}\r\n\r\nvar SymbolIterator = getSymbol('iterator');\r\nvar SymbolObservable = getSymbol('observable');\r\nvar SymbolSpecies = getSymbol('species'); // === Abstract Operations ===\r\n\r\nfunction getMethod(obj, key) {\r\n  var value = obj[key];\r\n  if (value == null) return undefined;\r\n  if (typeof value !== 'function') throw new TypeError(value + ' is not a function');\r\n  return value;\r\n}\r\n\r\nfunction getSpecies(obj) {\r\n  var ctor = obj.constructor;\r\n\r\n  if (ctor !== undefined) {\r\n    ctor = ctor[SymbolSpecies];\r\n\r\n    if (ctor === null) {\r\n      ctor = undefined;\r\n    }\r\n  }\r\n\r\n  return ctor !== undefined ? ctor : Observable;\r\n}\r\n\r\nfunction isObservable(x) {\r\n  return x instanceof Observable; // SPEC: Brand check\r\n}\r\n\r\nfunction hostReportError(e) {\r\n  if (hostReportError.log) {\r\n    hostReportError.log(e);\r\n  } else {\r\n    setTimeout(function () {\r\n      throw e;\r\n    });\r\n  }\r\n}\r\n\r\nfunction enqueue(fn) {\r\n  Promise.resolve().then(function () {\r\n    try {\r\n      fn();\r\n    } catch (e) {\r\n      hostReportError(e);\r\n    }\r\n  });\r\n}\r\n\r\nfunction cleanupSubscription(subscription) {\r\n  var cleanup = subscription._cleanup;\r\n  if (cleanup === undefined) return;\r\n  subscription._cleanup = undefined;\r\n\r\n  if (!cleanup) {\r\n    return;\r\n  }\r\n\r\n  try {\r\n    if (typeof cleanup === 'function') {\r\n      cleanup();\r\n    } else {\r\n      var unsubscribe = getMethod(cleanup, 'unsubscribe');\r\n\r\n      if (unsubscribe) {\r\n        unsubscribe.call(cleanup);\r\n      }\r\n    }\r\n  } catch (e) {\r\n    hostReportError(e);\r\n  }\r\n}\r\n\r\nfunction closeSubscription(subscription) {\r\n  subscription._observer = undefined;\r\n  subscription._queue = undefined;\r\n  subscription._state = 'closed';\r\n}\r\n\r\nfunction flushSubscription(subscription) {\r\n  var queue = subscription._queue;\r\n\r\n  if (!queue) {\r\n    return;\r\n  }\r\n\r\n  subscription._queue = undefined;\r\n  subscription._state = 'ready';\r\n\r\n  for (var i = 0; i < queue.length; ++i) {\r\n    notifySubscription(subscription, queue[i].type, queue[i].value);\r\n    if (subscription._state === 'closed') break;\r\n  }\r\n}\r\n\r\nfunction notifySubscription(subscription, type, value) {\r\n  subscription._state = 'running';\r\n  var observer = subscription._observer;\r\n\r\n  try {\r\n    var m = getMethod(observer, type);\r\n\r\n    switch (type) {\r\n      case 'next':\r\n        if (m) m.call(observer, value);\r\n        break;\r\n\r\n      case 'error':\r\n        closeSubscription(subscription);\r\n        if (m) m.call(observer, value);else throw value;\r\n        break;\r\n\r\n      case 'complete':\r\n        closeSubscription(subscription);\r\n        if (m) m.call(observer);\r\n        break;\r\n    }\r\n  } catch (e) {\r\n    hostReportError(e);\r\n  }\r\n\r\n  if (subscription._state === 'closed') cleanupSubscription(subscription);else if (subscription._state === 'running') subscription._state = 'ready';\r\n}\r\n\r\nfunction onNotify(subscription, type, value) {\r\n  if (subscription._state === 'closed') return;\r\n\r\n  if (subscription._state === 'buffering') {\r\n    subscription._queue.push({\r\n      type: type,\r\n      value: value\r\n    });\r\n\r\n    return;\r\n  }\r\n\r\n  if (subscription._state !== 'ready') {\r\n    subscription._state = 'buffering';\r\n    subscription._queue = [{\r\n      type: type,\r\n      value: value\r\n    }];\r\n    enqueue(function () {\r\n      return flushSubscription(subscription);\r\n    });\r\n    return;\r\n  }\r\n\r\n  notifySubscription(subscription, type, value);\r\n}\r\n\r\nvar Subscription = /*#__PURE__*/function () {\r\n  function Subscription(observer, subscriber) {\r\n    // ASSERT: observer is an object\r\n    // ASSERT: subscriber is callable\r\n    this._cleanup = undefined;\r\n    this._observer = observer;\r\n    this._queue = undefined;\r\n    this._state = 'initializing';\r\n    var subscriptionObserver = new SubscriptionObserver(this);\r\n\r\n    try {\r\n      this._cleanup = subscriber.call(undefined, subscriptionObserver);\r\n    } catch (e) {\r\n      subscriptionObserver.error(e);\r\n    }\r\n\r\n    if (this._state === 'initializing') this._state = 'ready';\r\n  }\r\n\r\n  var _proto = Subscription.prototype;\r\n\r\n  _proto.unsubscribe = function unsubscribe() {\r\n    if (this._state !== 'closed') {\r\n      closeSubscription(this);\r\n      cleanupSubscription(this);\r\n    }\r\n  };\r\n\r\n  _createClass(Subscription, [{\r\n    key: \"closed\",\r\n    get: function () {\r\n      return this._state === 'closed';\r\n    }\r\n  }]);\r\n\r\n  return Subscription;\r\n}();\r\n\r\nvar SubscriptionObserver = /*#__PURE__*/function () {\r\n  function SubscriptionObserver(subscription) {\r\n    this._subscription = subscription;\r\n  }\r\n\r\n  var _proto2 = SubscriptionObserver.prototype;\r\n\r\n  _proto2.next = function next(value) {\r\n    onNotify(this._subscription, 'next', value);\r\n  };\r\n\r\n  _proto2.error = function error(value) {\r\n    onNotify(this._subscription, 'error', value);\r\n  };\r\n\r\n  _proto2.complete = function complete() {\r\n    onNotify(this._subscription, 'complete');\r\n  };\r\n\r\n  _createClass(SubscriptionObserver, [{\r\n    key: \"closed\",\r\n    get: function () {\r\n      return this._subscription._state === 'closed';\r\n    }\r\n  }]);\r\n\r\n  return SubscriptionObserver;\r\n}();\r\n\r\nvar Observable = /*#__PURE__*/function () {\r\n  function Observable(subscriber) {\r\n    if (!(this instanceof Observable)) throw new TypeError('Observable cannot be called as a function');\r\n    if (typeof subscriber !== 'function') throw new TypeError('Observable initializer must be a function');\r\n    this._subscriber = subscriber;\r\n  }\r\n\r\n  var _proto3 = Observable.prototype;\r\n\r\n  _proto3.subscribe = function subscribe(observer) {\r\n    if (typeof observer !== 'object' || observer === null) {\r\n      observer = {\r\n        next: observer,\r\n        error: arguments[1],\r\n        complete: arguments[2]\r\n      };\r\n    }\r\n\r\n    return new Subscription(observer, this._subscriber);\r\n  };\r\n\r\n  _proto3.forEach = function forEach(fn) {\r\n    var _this = this;\r\n\r\n    return new Promise(function (resolve, reject) {\r\n      if (typeof fn !== 'function') {\r\n        reject(new TypeError(fn + ' is not a function'));\r\n        return;\r\n      }\r\n\r\n      function done() {\r\n        subscription.unsubscribe();\r\n        resolve();\r\n      }\r\n\r\n      var subscription = _this.subscribe({\r\n        next: function (value) {\r\n          try {\r\n            fn(value, done);\r\n          } catch (e) {\r\n            reject(e);\r\n            subscription.unsubscribe();\r\n          }\r\n        },\r\n        error: reject,\r\n        complete: resolve\r\n      });\r\n    });\r\n  };\r\n\r\n  _proto3.map = function map(fn) {\r\n    var _this2 = this;\r\n\r\n    if (typeof fn !== 'function') throw new TypeError(fn + ' is not a function');\r\n    var C = getSpecies(this);\r\n    return new C(function (observer) {\r\n      return _this2.subscribe({\r\n        next: function (value) {\r\n          try {\r\n            value = fn(value);\r\n          } catch (e) {\r\n            return observer.error(e);\r\n          }\r\n\r\n          observer.next(value);\r\n        },\r\n        error: function (e) {\r\n          observer.error(e);\r\n        },\r\n        complete: function () {\r\n          observer.complete();\r\n        }\r\n      });\r\n    });\r\n  };\r\n\r\n  _proto3.filter = function filter(fn) {\r\n    var _this3 = this;\r\n\r\n    if (typeof fn !== 'function') throw new TypeError(fn + ' is not a function');\r\n    var C = getSpecies(this);\r\n    return new C(function (observer) {\r\n      return _this3.subscribe({\r\n        next: function (value) {\r\n          try {\r\n            if (!fn(value)) return;\r\n          } catch (e) {\r\n            return observer.error(e);\r\n          }\r\n\r\n          observer.next(value);\r\n        },\r\n        error: function (e) {\r\n          observer.error(e);\r\n        },\r\n        complete: function () {\r\n          observer.complete();\r\n        }\r\n      });\r\n    });\r\n  };\r\n\r\n  _proto3.reduce = function reduce(fn) {\r\n    var _this4 = this;\r\n\r\n    if (typeof fn !== 'function') throw new TypeError(fn + ' is not a function');\r\n    var C = getSpecies(this);\r\n    var hasSeed = arguments.length > 1;\r\n    var hasValue = false;\r\n    var seed = arguments[1];\r\n    var acc = seed;\r\n    return new C(function (observer) {\r\n      return _this4.subscribe({\r\n        next: function (value) {\r\n          var first = !hasValue;\r\n          hasValue = true;\r\n\r\n          if (!first || hasSeed) {\r\n            try {\r\n              acc = fn(acc, value);\r\n            } catch (e) {\r\n              return observer.error(e);\r\n            }\r\n          } else {\r\n            acc = value;\r\n          }\r\n        },\r\n        error: function (e) {\r\n          observer.error(e);\r\n        },\r\n        complete: function () {\r\n          if (!hasValue && !hasSeed) return observer.error(new TypeError('Cannot reduce an empty sequence'));\r\n          observer.next(acc);\r\n          observer.complete();\r\n        }\r\n      });\r\n    });\r\n  };\r\n\r\n  _proto3.concat = function concat() {\r\n    var _this5 = this;\r\n\r\n    for (var _len = arguments.length, sources = new Array(_len), _key = 0; _key < _len; _key++) {\r\n      sources[_key] = arguments[_key];\r\n    }\r\n\r\n    var C = getSpecies(this);\r\n    return new C(function (observer) {\r\n      var subscription;\r\n      var index = 0;\r\n\r\n      function startNext(next) {\r\n        subscription = next.subscribe({\r\n          next: function (v) {\r\n            observer.next(v);\r\n          },\r\n          error: function (e) {\r\n            observer.error(e);\r\n          },\r\n          complete: function () {\r\n            if (index === sources.length) {\r\n              subscription = undefined;\r\n              observer.complete();\r\n            } else {\r\n              startNext(C.from(sources[index++]));\r\n            }\r\n          }\r\n        });\r\n      }\r\n\r\n      startNext(_this5);\r\n      return function () {\r\n        if (subscription) {\r\n          subscription.unsubscribe();\r\n          subscription = undefined;\r\n        }\r\n      };\r\n    });\r\n  };\r\n\r\n  _proto3.flatMap = function flatMap(fn) {\r\n    var _this6 = this;\r\n\r\n    if (typeof fn !== 'function') throw new TypeError(fn + ' is not a function');\r\n    var C = getSpecies(this);\r\n    return new C(function (observer) {\r\n      var subscriptions = [];\r\n\r\n      var outer = _this6.subscribe({\r\n        next: function (value) {\r\n          if (fn) {\r\n            try {\r\n              value = fn(value);\r\n            } catch (e) {\r\n              return observer.error(e);\r\n            }\r\n          }\r\n\r\n          var inner = C.from(value).subscribe({\r\n            next: function (value) {\r\n              observer.next(value);\r\n            },\r\n            error: function (e) {\r\n              observer.error(e);\r\n            },\r\n            complete: function () {\r\n              var i = subscriptions.indexOf(inner);\r\n              if (i >= 0) subscriptions.splice(i, 1);\r\n              completeIfDone();\r\n            }\r\n          });\r\n          subscriptions.push(inner);\r\n        },\r\n        error: function (e) {\r\n          observer.error(e);\r\n        },\r\n        complete: function () {\r\n          completeIfDone();\r\n        }\r\n      });\r\n\r\n      function completeIfDone() {\r\n        if (outer.closed && subscriptions.length === 0) observer.complete();\r\n      }\r\n\r\n      return function () {\r\n        subscriptions.forEach(function (s) {\r\n          return s.unsubscribe();\r\n        });\r\n        outer.unsubscribe();\r\n      };\r\n    });\r\n  };\r\n\r\n  _proto3[SymbolObservable] = function () {\r\n    return this;\r\n  };\r\n\r\n  Observable.from = function from(x) {\r\n    var C = typeof this === 'function' ? this : Observable;\r\n    if (x == null) throw new TypeError(x + ' is not an object');\r\n    var method = getMethod(x, SymbolObservable);\r\n\r\n    if (method) {\r\n      var observable = method.call(x);\r\n      if (Object(observable) !== observable) throw new TypeError(observable + ' is not an object');\r\n      if (isObservable(observable) && observable.constructor === C) return observable;\r\n      return new C(function (observer) {\r\n        return observable.subscribe(observer);\r\n      });\r\n    }\r\n\r\n    if (hasSymbol('iterator')) {\r\n      method = getMethod(x, SymbolIterator);\r\n\r\n      if (method) {\r\n        return new C(function (observer) {\r\n          enqueue(function () {\r\n            if (observer.closed) return;\r\n\r\n            for (var _iterator = _createForOfIteratorHelperLoose(method.call(x)), _step; !(_step = _iterator()).done;) {\r\n              var item = _step.value;\r\n              observer.next(item);\r\n              if (observer.closed) return;\r\n            }\r\n\r\n            observer.complete();\r\n          });\r\n        });\r\n      }\r\n    }\r\n\r\n    if (Array.isArray(x)) {\r\n      return new C(function (observer) {\r\n        enqueue(function () {\r\n          if (observer.closed) return;\r\n\r\n          for (var i = 0; i < x.length; ++i) {\r\n            observer.next(x[i]);\r\n            if (observer.closed) return;\r\n          }\r\n\r\n          observer.complete();\r\n        });\r\n      });\r\n    }\r\n\r\n    throw new TypeError(x + ' is not observable');\r\n  };\r\n\r\n  Observable.of = function of() {\r\n    for (var _len2 = arguments.length, items = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\r\n      items[_key2] = arguments[_key2];\r\n    }\r\n\r\n    var C = typeof this === 'function' ? this : Observable;\r\n    return new C(function (observer) {\r\n      enqueue(function () {\r\n        if (observer.closed) return;\r\n\r\n        for (var i = 0; i < items.length; ++i) {\r\n          observer.next(items[i]);\r\n          if (observer.closed) return;\r\n        }\r\n\r\n        observer.complete();\r\n      });\r\n    });\r\n  };\r\n\r\n  _createClass(Observable, null, [{\r\n    key: SymbolSpecies,\r\n    get: function () {\r\n      return this;\r\n    }\r\n  }]);\r\n\r\n  return Observable;\r\n}();\r\n\r\nif (hasSymbols()) {\r\n  Object.defineProperty(Observable, Symbol('extensions'), {\r\n    value: {\r\n      symbol: SymbolObservable,\r\n      hostReportError: hostReportError\r\n    },\r\n    configurable: true\r\n  });\r\n}\r\n\r\nexport { Observable };\r\n"]}